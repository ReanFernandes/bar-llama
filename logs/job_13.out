Starting job 13 at Thu Mar  6 10:05:19 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=json_fact_first_zero_shot_structured train=json_fact_first_zero_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '13', 'training']
Updating job 13 to status training with exit code None
Status update completed for job 13
[2025-03-06 10:05:25,218][root][INFO] - Global seed set to 314
[2025-03-06 10:05:25,219][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 10:05:25,219][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 10:05:25,219][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 10:05:25,219][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:05:25,220][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 10:05:25,239][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:05:25,243][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 10:05:25,244][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 10:05:25,268][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 10:05:25,734][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 10:05:38,053][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-03-06 10:06:06,684][root][INFO] - Model prepared for kbit training
[2025-03-06 10:06:06,685][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'v_proj', 'up_proj', 'q_proj', 'gate_proj', 'k_proj', 'down_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 10:06:08,409][root][INFO] - Lora adapter added to model
[2025-03-06 10:06:08,411][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_fact_first_zero_shot_structured
[2025-03-06 10:06:08,554][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.4682, 'grad_norm': 0.13916686177253723, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.326, 'grad_norm': 0.1778945028781891, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.2115, 'grad_norm': 0.18581312894821167, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.1192, 'grad_norm': 0.2324414998292923, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.9525, 'grad_norm': 0.2418835163116455, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 363.3864, 'train_samples_per_second': 0.289, 'train_steps_per_second': 0.041, 'train_loss': 1.2154862403869628, 'epoch': 15.0}
[2025-03-06 10:12:15,071][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_json_fact_first_zero_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '13', 'trained', '0']
Updating job 13 to status trained with exit code 0
Status update completed for job 13
Starting evaluations for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 10:12:26,721][root][INFO] - Setting global seed to 206
[2025-03-06 10:12:26,729][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:12:26,730][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:12:26,732][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:12:26,734][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:12:26,737][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:12:26,738][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:12:26,913][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 10:12:27,193][root][INFO] - Full model selected, loading model
[2025-03-06 10:12:43,258][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:13:46,157][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:13:46,158][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:14:12,055][root][INFO] - Peft model loaded successfully
[2025-03-06 10:14:18,359][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:14:18,360][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:14:18,361][root][INFO] - Starting inference
[2025-03-06 10:14:18,570][root][INFO] - Processing question number 0
[2025-03-06 10:14:18,571][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:14:25,638][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:14:41,692][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:14:55,670][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:15:13,360][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:15:29,717][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:15:45,438][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:16:01,498][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:16:11,690][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:16:23,357][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:16:37,074][root][INFO] - Processing question number 10
[2025-03-06 10:16:37,077][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:17:00,502][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:17:10,357][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:17:27,729][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:17:54,933][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:18:06,297][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:18:25,478][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:18:49,084][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:18:57,152][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:19:07,003][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:19:28,534][root][INFO] - Processing question number 20
[2025-03-06 10:19:28,537][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:19:37,184][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:19:47,996][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:20:10,250][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:20:36,331][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:20:55,041][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:21:06,411][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:21:16,422][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:21:26,877][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:21:35,152][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:21:47,892][root][INFO] - Processing question number 30
[2025-03-06 10:21:47,895][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:22:14,480][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:22:31,876][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:22:40,748][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:22:57,205][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:23:10,968][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:23:23,449][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:23:34,859][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:23:53,368][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:24:10,851][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:24:26,490][root][INFO] - Processing question number 40
[2025-03-06 10:24:26,494][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:24:45,321][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:25:05,360][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:25:28,932][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:25:48,527][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:26:00,347][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:26:13,550][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:26:41,442][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:26:58,140][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:27:09,120][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:27:27,239][root][INFO] - Processing question number 50
[2025-03-06 10:27:27,243][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:27:41,815][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:27:54,982][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:28:09,921][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:28:25,563][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:28:37,317][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:28:47,347][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:29:01,722][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:29:09,311][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:29:36,548][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:29:55,413][root][INFO] - Processing question number 60
[2025-03-06 10:29:55,417][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:30:03,871][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:30:15,820][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:30:26,947][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:30:35,179][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:30:54,183][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:31:00,928][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:31:09,853][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:31:22,629][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:31:35,972][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:31:44,572][root][INFO] - Processing question number 70
[2025-03-06 10:31:44,577][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:31:58,078][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:32:06,049][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:32:19,556][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:32:43,379][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:33:02,248][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:33:15,954][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:33:37,184][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:33:48,673][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:34:12,737][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:34:27,378][root][INFO] - Processing question number 80
[2025-03-06 10:34:27,382][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:34:54,270][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:35:12,975][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:35:25,046][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:35:45,867][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:36:13,110][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:36:30,565][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:36:49,176][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:37:08,528][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:37:21,871][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:37:31,860][root][INFO] - Processing question number 90
[2025-03-06 10:37:31,864][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:37:46,723][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:37:57,531][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:38:09,012][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:38:16,881][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:38:34,308][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:39:00,442][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:39:13,321][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:39:34,666][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:39:44,012][root][INFO] - Inference complete
[2025-03-06 10:39:44,012][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,018][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,019][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,019][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:39:44,020][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,020][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,021][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:39:44,021][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,025][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,026][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:39:44,026][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,027][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,028][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:39:44,028][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,031][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,031][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:39:44,031][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,032][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,032][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:39:44,032][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,032][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,033][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:39:44,033][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,033][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,033][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:39:44,033][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,034][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,034][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:39:44,034][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,035][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,035][root][WARNING] - |Q. 57||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:39:44,035][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,035][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:39:44,036][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:39:44,036][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:39:44,037][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,042][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,042][root][INFO] - Saved parsed outputs
[2025-03-06 10:39:44,042][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,043][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,043][root][INFO] - Saved parsing metadata
[2025-03-06 10:39:44,044][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,045][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:39:44,047][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:39:44,054][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 10:39:44,054][root][INFO] - Summary of metrics : {'label_accuracy': 0.2727272727272727, 'misclassification_rate': 0.7272727272727273, 'combined_accuracy': 0.0, 'malformed_label': 13, 'malformed_domain': 98, 'total_predictions': 99, 'correct_predictions': 27, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.030303030303030304, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 27, 'both_wrong': 71}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 10:39:50,789][root][INFO] - Setting global seed to 206
[2025-03-06 10:39:50,796][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:39:50,796][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:39:50,797][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:39:50,799][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:39:50,801][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:39:50,801][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:39:50,952][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 10:39:51,208][root][INFO] - Full model selected, loading model
[2025-03-06 10:40:08,066][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:40:08,066][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:40:14,707][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:40:14,709][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:40:14,709][root][INFO] - Starting inference
[2025-03-06 10:40:14,893][root][INFO] - Processing question number 0
[2025-03-06 10:40:14,895][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:40:41,306][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:41:08,126][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:41:34,536][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:42:01,381][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:42:27,710][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:42:53,997][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:43:21,000][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:43:47,555][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:44:13,799][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:44:40,655][root][INFO] - Processing question number 10
[2025-03-06 10:44:40,657][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:45:08,805][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:45:34,778][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:46:01,294][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:46:28,414][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:46:55,445][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:47:21,482][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:47:35,754][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:48:02,240][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:48:28,708][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:48:54,965][root][INFO] - Processing question number 20
[2025-03-06 10:48:54,967][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:49:21,412][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:49:48,043][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:50:14,099][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:50:40,086][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:51:06,832][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:51:33,336][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:52:00,623][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:52:27,178][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:52:54,011][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:53:20,146][root][INFO] - Processing question number 30
[2025-03-06 10:53:20,148][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:53:47,083][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:54:14,331][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:54:41,024][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:55:07,659][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:55:34,005][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:56:01,004][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:56:27,414][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:56:54,202][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:57:20,766][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:57:48,050][root][INFO] - Processing question number 40
[2025-03-06 10:57:48,053][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:58:14,671][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:58:41,280][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:59:08,401][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:59:35,401][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:00:01,741][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:00:28,318][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:00:56,134][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:01:21,806][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:01:48,273][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:02:15,428][root][INFO] - Processing question number 50
[2025-03-06 11:02:15,431][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:02:42,751][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:03:09,476][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:03:35,398][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:04:03,070][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:04:29,766][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:04:55,459][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:05:22,753][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:05:48,854][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:06:09,513][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:06:37,388][root][INFO] - Processing question number 60
[2025-03-06 11:06:37,391][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:07:03,445][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:07:29,881][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:07:56,878][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:08:22,908][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:08:49,455][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:09:16,061][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:09:35,112][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:10:02,020][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:10:28,760][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:10:56,006][root][INFO] - Processing question number 70
[2025-03-06 11:10:56,010][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:11:22,416][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:11:48,854][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:12:15,181][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:12:42,064][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:13:08,902][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:13:35,059][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:14:01,992][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:14:28,774][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:14:55,710][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:15:22,112][root][INFO] - Processing question number 80
[2025-03-06 11:15:22,116][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:15:48,926][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:16:15,729][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:16:42,073][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:17:08,455][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:17:35,600][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:18:02,568][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:18:29,756][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:18:56,123][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:19:22,888][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:19:48,916][root][INFO] - Processing question number 90
[2025-03-06 11:19:48,921][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:20:16,382][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:20:41,951][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:21:08,397][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:21:34,118][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:22:01,078][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:22:27,125][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:22:53,513][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:23:20,203][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:23:47,349][root][INFO] - Inference complete
[2025-03-06 11:23:47,350][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,355][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,360][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,360][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,361][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,365][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,365][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,366][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,367][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,367][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,367][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,367][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,367][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,368][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,368][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,368][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,368][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,369][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,369][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,369][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,370][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,370][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,370][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,371][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,371][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,371][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,372][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,372][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,372][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,372][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,372][root][WARNING] - |Q. 27||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,373][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,373][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,373][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,373][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,374][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,374][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,375][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,375][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,375][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,375][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,376][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,376][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,376][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,377][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,377][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,377][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,378][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,378][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,378][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,379][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,379][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,379][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,381][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,381][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,381][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,384][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,385][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,385][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,385][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,385][root][WARNING] - |Q. 53||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,386][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,386][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,386][root][WARNING] - |Q. 59||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,386][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,389][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,389][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,389][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,390][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,391][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,391][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,391][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,391][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,392][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,392][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,392][root][WARNING] - |Q. 97||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,392][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,392][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,393][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,393][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,393][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,393][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,393][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,394][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,394][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:23:47,394][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,394][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,394][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,395][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,395][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,395][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,395][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,396][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,396][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,396][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,397][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,397][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,397][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,398][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:47,398][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:47,398][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:47,399][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,404][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,404][root][INFO] - Saved parsed outputs
[2025-03-06 11:23:47,404][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,405][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,406][root][INFO] - Saved parsing metadata
[2025-03-06 11:23:47,406][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,407][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:23:47,409][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:23:47,426][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 11:23:47,426][root][INFO] - Summary of metrics : {'label_accuracy': 0.1919191919191919, 'misclassification_rate': 0.8080808080808081, 'combined_accuracy': 0.0, 'malformed_label': 42, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 19, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 19, 'both_wrong': 80}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 11:23:54,645][root][INFO] - Setting global seed to 206
[2025-03-06 11:23:54,653][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:23:54,653][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:23:54,654][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:23:54,656][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:23:54,658][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:23:54,658][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:23:54,816][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 11:23:55,086][root][INFO] - Full model selected, loading model
[2025-03-06 11:24:13,774][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:25:16,139][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:25:16,148][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:25:42,868][root][INFO] - Peft model loaded successfully
[2025-03-06 11:25:49,236][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:25:49,238][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:25:49,238][root][INFO] - Starting inference
[2025-03-06 11:25:49,464][root][INFO] - Processing question number 0
[2025-03-06 11:25:49,466][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:26:15,768][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:26:35,271][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:26:57,963][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:27:16,348][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:27:37,790][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:27:46,541][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:28:13,907][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:28:30,939][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:28:42,737][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:29:09,881][root][INFO] - Processing question number 10
[2025-03-06 11:29:09,883][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:29:38,337][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:30:04,628][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:30:23,401][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:30:34,418][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:30:46,622][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:30:54,588][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:31:20,863][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:31:32,412][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:31:44,513][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:32:00,861][root][INFO] - Processing question number 20
[2025-03-06 11:32:00,863][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:32:15,774][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:32:24,849][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:32:34,906][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:32:45,638][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:32:59,941][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:33:16,420][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:33:25,084][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:33:31,814][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:33:43,502][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:33:54,241][root][INFO] - Processing question number 30
[2025-03-06 11:33:54,244][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:34:19,235][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:34:37,149][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:34:52,258][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:35:07,311][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:35:20,783][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:35:33,611][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:35:44,374][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:36:06,382][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:36:23,825][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:36:42,657][root][INFO] - Processing question number 40
[2025-03-06 11:36:42,659][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:37:07,950][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:37:27,323][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:37:47,714][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:38:02,545][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:38:18,017][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:38:30,565][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:38:58,678][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:39:13,589][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:39:23,438][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:39:37,954][root][INFO] - Processing question number 50
[2025-03-06 11:39:37,957][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:40:01,080][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:40:15,412][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:40:35,737][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:40:50,626][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:41:02,120][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:41:12,911][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:41:35,762][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:41:48,083][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:42:14,101][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:42:26,154][root][INFO] - Processing question number 60
[2025-03-06 11:42:26,157][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:42:34,848][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:42:49,983][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:42:59,431][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:43:16,270][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:43:31,915][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:43:39,400][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:44:02,701][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:44:22,139][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:44:38,948][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:44:54,547][root][INFO] - Processing question number 70
[2025-03-06 11:44:54,550][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:45:04,544][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:45:18,665][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:45:34,532][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:46:01,704][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:46:17,861][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:46:29,384][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:46:37,820][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:47:04,899][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:47:29,473][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:47:56,154][root][INFO] - Processing question number 80
[2025-03-06 11:47:56,158][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:48:23,250][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:48:50,331][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:49:16,949][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:49:34,088][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:49:55,007][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:50:22,182][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:50:40,158][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:51:00,688][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:51:17,691][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:51:25,910][root][INFO] - Processing question number 90
[2025-03-06 11:51:25,915][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:51:53,749][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:52:02,255][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:52:28,990][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:52:39,533][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:53:04,095][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:53:16,026][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:53:27,178][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:53:51,894][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:54:01,177][root][INFO] - Inference complete
[2025-03-06 11:54:01,177][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,183][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,184][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,184][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:54:01,184][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,185][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,186][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,187][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,187][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,187][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,187][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,187][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,188][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:54:01,188][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,188][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,188][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:54:01,189][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,189][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,189][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,189][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,190][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,190][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:54:01,190][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,191][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,191][root][WARNING] - |Q. 25||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:54:01,191][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,194][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,195][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,195][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,198][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,198][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,198][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,199][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,199][root][WARNING] - |Q. 48||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:54:01,199][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,200][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,200][root][WARNING] - |Q. 61||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:54:01,200][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,200][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,200][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,201][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,201][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,201][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,201][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,202][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,202][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,202][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,203][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:54:01,203][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:54:01,203][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:54:01,205][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,210][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,210][root][INFO] - Saved parsed outputs
[2025-03-06 11:54:01,210][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,211][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,211][root][INFO] - Saved parsing metadata
[2025-03-06 11:54:01,212][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,214][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:01,215][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:54:01,248][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 11:54:01,248][root][INFO] - Summary of metrics : {'label_accuracy': 0.23232323232323232, 'misclassification_rate': 0.7676767676767677, 'combined_accuracy': 0.010101010101010102, 'malformed_label': 17, 'malformed_domain': 92, 'total_predictions': 99, 'correct_predictions': 23, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.010101010101010102, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.06060606060606061, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 6, 'correct_label_wrong_domain': 22, 'both_wrong': 70}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 11:54:15,806][root][INFO] - Setting global seed to 206
[2025-03-06 11:54:15,817][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:54:15,818][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:54:15,819][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:54:15,820][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:54:15,823][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:54:15,823][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:54:15,992][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 11:54:16,256][root][INFO] - Full model selected, loading model
[2025-03-06 11:54:32,179][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:54:32,179][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:54:38,640][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:54:38,641][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:54:38,641][root][INFO] - Starting inference
[2025-03-06 11:54:38,812][root][INFO] - Processing question number 0
[2025-03-06 11:54:38,814][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:55:04,939][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:55:31,968][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:55:44,189][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:56:02,617][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:56:29,313][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:56:55,989][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:57:23,202][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:57:49,979][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:58:16,442][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:58:43,507][root][INFO] - Processing question number 10
[2025-03-06 11:58:43,509][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:59:11,864][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:59:38,062][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:00:04,793][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:00:32,110][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:00:59,347][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:01:25,614][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:01:51,803][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:02:09,734][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:02:36,403][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:03:02,865][root][INFO] - Processing question number 20
[2025-03-06 12:03:02,867][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:03:29,518][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:03:56,311][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:04:22,575][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:04:48,780][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:05:11,609][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:05:38,320][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:06:05,795][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:06:32,473][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:06:59,268][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:07:25,406][root][INFO] - Processing question number 30
[2025-03-06 12:07:25,408][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:07:52,412][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:08:19,650][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:08:46,438][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:09:13,079][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:09:39,616][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:10:06,792][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:10:33,396][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:11:00,407][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:11:27,360][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:11:55,036][root][INFO] - Processing question number 40
[2025-03-06 12:11:55,039][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:12:21,998][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:12:48,994][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:13:16,457][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:13:43,860][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:14:10,555][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:14:24,497][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:14:52,504][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:15:18,400][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:15:45,076][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:16:12,426][root][INFO] - Processing question number 50
[2025-03-06 12:16:12,429][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:16:39,935][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:17:06,845][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:17:32,984][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:18:00,849][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:18:27,751][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:18:53,623][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:19:21,117][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:19:47,405][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:20:14,756][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:20:42,837][root][INFO] - Processing question number 60
[2025-03-06 12:20:42,840][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:21:09,108][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:21:35,761][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:22:02,969][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:22:12,408][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:22:39,170][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:23:05,985][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:23:32,850][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:23:59,973][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:24:26,912][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:24:54,356][root][INFO] - Processing question number 70
[2025-03-06 12:24:54,360][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:25:20,974][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:25:47,634][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:26:14,176][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:26:41,267][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:27:01,735][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:27:28,121][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:27:55,255][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:28:22,236][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:28:49,368][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:29:15,991][root][INFO] - Processing question number 80
[2025-03-06 12:29:15,995][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:29:43,004][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:29:47,052][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:30:13,600][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:30:40,203][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:31:07,546][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:31:34,647][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:32:01,801][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:32:26,540][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:32:53,498][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:33:19,753][root][INFO] - Processing question number 90
[2025-03-06 12:33:19,758][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:33:47,423][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:34:13,218][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:34:39,877][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:35:05,778][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:35:32,931][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:35:59,178][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:36:25,773][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:36:52,649][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:37:05,770][root][INFO] - Inference complete
[2025-03-06 12:37:05,770][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,775][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,778][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,778][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,779][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,781][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,781][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,781][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,786][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,786][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,786][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,787][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,787][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,788][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,788][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,788][root][WARNING] - |Q. 60||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,788][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,789][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,789][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,789][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,789][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,790][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,790][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,790][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,791][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,791][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,791][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,792][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,792][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,792][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,793][root][WARNING] - |Q. 58||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,793][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,795][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,795][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,795][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,804][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,804][root][WARNING] - |Q. 78||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,804][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,805][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,806][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,806][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,806][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,806][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,807][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,807][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,807][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,807][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,808][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,808][root][WARNING] - |Q. 97||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,808][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,809][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,809][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,809][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,810][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,810][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:37:05,810][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,810][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,811][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,811][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,811][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,811][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,811][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,812][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,813][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,813][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,813][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:37:05,813][root][WARNING] - |Q. 80||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:37:05,813][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:37:05,815][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,820][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,820][root][INFO] - Saved parsed outputs
[2025-03-06 12:37:05,820][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,821][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,821][root][INFO] - Saved parsing metadata
[2025-03-06 12:37:05,821][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,823][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:37:05,824][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:37:05,840][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 12:37:05,840][root][INFO] - Summary of metrics : {'label_accuracy': 0.20202020202020202, 'misclassification_rate': 0.797979797979798, 'combined_accuracy': 0.0, 'malformed_label': 44, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 20, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 20, 'both_wrong': 79}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 12:37:14,990][root][INFO] - Setting global seed to 206
[2025-03-06 12:37:14,997][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:37:14,997][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:37:14,999][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:37:15,001][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:37:15,003][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:37:15,003][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:37:15,191][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 12:37:15,465][root][INFO] - Full model selected, loading model
[2025-03-06 12:37:33,079][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:38:35,435][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:38:35,436][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:39:02,056][root][INFO] - Peft model loaded successfully
[2025-03-06 12:39:08,291][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:39:08,292][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:39:08,292][root][INFO] - Starting inference
[2025-03-06 12:39:08,532][root][INFO] - Processing question number 0
[2025-03-06 12:39:08,534][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:39:17,707][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:39:44,768][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:39:55,350][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:40:22,446][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:40:34,556][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:40:46,735][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:41:06,044][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:41:22,159][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:41:37,621][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:42:04,730][root][INFO] - Processing question number 10
[2025-03-06 12:42:04,731][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:42:33,137][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:42:59,392][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:43:13,668][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:43:24,223][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:43:51,580][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:44:04,109][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:44:19,902][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:44:30,213][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:44:40,687][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:44:51,384][root][INFO] - Processing question number 20
[2025-03-06 12:44:51,386][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:45:04,771][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:45:12,030][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:45:20,151][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:45:30,286][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:45:41,779][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:45:57,766][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:46:08,900][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:46:17,951][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:46:30,800][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:46:42,330][root][INFO] - Processing question number 30
[2025-03-06 12:46:42,333][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:46:59,474][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:47:12,510][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:47:31,334][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:47:57,995][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:48:14,502][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:48:37,460][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:49:04,090][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:49:19,329][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:49:46,181][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:50:13,707][root][INFO] - Processing question number 40
[2025-03-06 12:50:13,710][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:50:34,934][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:50:51,437][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:51:00,717][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:51:14,490][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:51:27,998][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:51:52,474][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:52:20,544][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:52:34,393][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:52:49,612][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:53:08,878][root][INFO] - Processing question number 50
[2025-03-06 12:53:08,881][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:53:30,728][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:53:40,899][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:53:51,918][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:54:09,681][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:54:10,430][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:54:22,288][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:54:49,990][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:55:04,646][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:55:32,301][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:55:47,533][root][INFO] - Processing question number 60
[2025-03-06 12:55:47,537][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:55:55,872][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:56:03,379][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:56:16,260][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:56:42,574][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:57:09,415][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:57:23,686][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:57:44,277][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:58:03,180][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:58:09,821][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:58:18,737][root][INFO] - Processing question number 70
[2025-03-06 12:58:18,740][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:58:40,894][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:58:49,534][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:59:13,638][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:59:31,522][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:59:51,925][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:00:06,865][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:00:23,511][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:00:35,029][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:01:01,980][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:01:19,509][root][INFO] - Processing question number 80
[2025-03-06 13:01:19,539][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:01:40,703][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:02:07,752][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:02:19,817][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:02:36,442][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:02:50,344][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:03:16,959][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:03:41,867][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:03:54,320][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:04:07,413][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:04:18,042][root][INFO] - Processing question number 90
[2025-03-06 13:04:18,098][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:04:45,891][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:05:11,705][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:05:20,326][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:05:37,582][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:05:59,260][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:06:18,551][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:06:26,591][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:06:38,196][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:07:05,633][root][INFO] - Inference complete
[2025-03-06 13:07:05,633][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,639][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,640][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,641][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,641][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,641][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,641][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,641][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,642][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,642][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,642][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,642][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,642][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,643][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,643][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,643][root][WARNING] - |Q. 63||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,644][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,644][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,645][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,645][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,645][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,645][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,645][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,645][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,646][root][WARNING] - |Q. 84||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,646][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,646][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,646][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,646][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,648][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,648][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,648][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,649][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,649][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,649][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,649][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,649][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,649][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,650][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,650][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,651][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,651][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,651][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,651][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,652][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,652][root][WARNING] - |Q. 94||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,652][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,653][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,653][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,653][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,653][root][WARNING] - |Q. 41||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,653][root][WARNING] - |Q. 41||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,654][root][INFO] - |Q. 41||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,654][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,654][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,654][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,655][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,655][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,655][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,655][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,655][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,655][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,655][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,656][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,656][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,656][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,656][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,657][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,657][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,657][root][WARNING] - |Q. 40||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,658][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,658][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,658][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,658][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,659][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,659][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,659][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,660][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,660][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,660][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,661][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,661][root][WARNING] - |Q. 39||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,661][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,661][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,661][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,661][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,662][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,662][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,662][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,663][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,663][root][WARNING] - |Q. 97||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,663][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,664][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,665][root][WARNING] - |Q. 85||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:07:05,665][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,665][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:07:05,665][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:07:05,665][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:07:05,666][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,671][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,671][root][INFO] - Saved parsed outputs
[2025-03-06 13:07:05,671][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,681][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,681][root][INFO] - Saved parsing metadata
[2025-03-06 13:07:05,682][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,683][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:05,699][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:07:05,733][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 13:07:05,733][root][INFO] - Summary of metrics : {'label_accuracy': 0.1919191919191919, 'misclassification_rate': 0.8080808080808081, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 32, 'malformed_domain': 86, 'total_predictions': 99, 'correct_predictions': 19, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.050505050505050504, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.030303030303030304, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.04040404040404041, 'Civil_Procedure_confidence': 0.020202020202020204, 'correct_domain_wrong_label': 10, 'correct_label_wrong_domain': 16, 'both_wrong': 70}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 13:07:13,780][root][INFO] - Setting global seed to 206
[2025-03-06 13:07:13,788][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 13:07:13,788][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:07:13,790][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:07:13,791][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:07:13,793][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:07:13,793][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:07:13,946][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:07:14,222][root][INFO] - Full model selected, loading model
[2025-03-06 13:07:32,422][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:07:32,422][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:07:38,877][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:07:38,878][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:07:38,878][root][INFO] - Starting inference
[2025-03-06 13:07:39,068][root][INFO] - Processing question number 0
[2025-03-06 13:07:39,070][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:08:05,197][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:08:32,195][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:08:38,950][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:08:39,401][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:08:55,036][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:08:59,057][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:09:26,236][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:09:52,977][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:09:53,470][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:09:54,049][root][INFO] - Processing question number 10
[2025-03-06 13:09:54,051][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:10:22,373][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:10:34,211][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:11:00,907][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:11:01,602][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:11:26,675][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:11:35,424][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:11:51,906][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:12:16,471][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:12:43,106][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:13:09,538][root][INFO] - Processing question number 20
[2025-03-06 13:13:09,541][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:13:36,149][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:13:36,640][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:14:02,860][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:14:29,023][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:14:32,807][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:14:59,481][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:15:26,937][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:15:53,574][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:16:20,335][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:16:46,434][root][INFO] - Processing question number 30
[2025-03-06 13:16:46,441][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:17:13,414][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:17:40,632][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:18:07,384][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:18:07,953][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:18:13,459][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:18:29,477][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:18:37,626][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:19:04,717][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:19:31,460][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:19:58,929][root][INFO] - Processing question number 40
[2025-03-06 13:19:58,932][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:20:25,714][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:20:52,494][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:21:19,794][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:21:46,966][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:22:13,482][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:22:35,962][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:23:03,952][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:23:15,490][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:23:42,137][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:24:09,464][root][INFO] - Processing question number 50
[2025-03-06 13:24:09,467][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:24:36,965][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:24:41,084][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:25:07,194][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:25:07,882][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:25:24,334][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:25:50,198][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:26:17,682][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:26:23,530][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:26:50,868][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:27:18,927][root][INFO] - Processing question number 60
[2025-03-06 13:27:18,930][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:27:45,169][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:28:11,786][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:28:15,221][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:28:41,445][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:29:08,176][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:29:08,625][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:29:35,473][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:29:36,053][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:30:02,967][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:30:24,344][root][INFO] - Processing question number 70
[2025-03-06 13:30:24,349][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:30:50,927][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:31:17,553][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:31:44,067][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:32:11,132][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:32:35,887][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:33:02,245][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:33:02,701][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:33:21,673][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:33:23,138][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:33:49,908][root][INFO] - Processing question number 80
[2025-03-06 13:33:49,912][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:34:17,111][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:34:31,636][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:34:58,381][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:35:25,047][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:35:25,577][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:35:38,714][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:35:45,621][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:35:46,074][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:36:13,166][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:36:24,944][root][INFO] - Processing question number 90
[2025-03-06 13:36:24,948][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:36:29,933][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:36:55,700][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:37:22,331][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:37:48,221][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:37:51,985][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:38:18,202][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:38:28,239][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:38:55,099][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:39:22,427][root][INFO] - Inference complete
[2025-03-06 13:39:22,428][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,436][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,437][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,437][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,437][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,438][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,438][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,438][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,438][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,438][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,439][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,441][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,442][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,442][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,442][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,442][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,442][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,442][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,443][root][WARNING] - |Q. 9||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,443][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,447][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,447][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,448][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,450][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,451][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,451][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,451][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,451][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,451][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,452][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,452][root][WARNING] - |Q. 66||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,452][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,453][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,453][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,453][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,453][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,454][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,454][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,455][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,455][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,455][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,460][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,461][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,461][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,463][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,463][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,463][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,463][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,463][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,463][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,464][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,464][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,464][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,464][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,465][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,465][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,465][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,466][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,466][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,466][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,466][root][WARNING] - |Q. 61||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,466][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,468][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,468][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,468][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,469][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,469][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:22,469][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,470][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,470][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,470][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,470][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,470][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,470][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,471][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:22,471][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:22,471][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:22,473][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,477][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,478][root][INFO] - Saved parsed outputs
[2025-03-06 13:39:22,478][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,479][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,479][root][INFO] - Saved parsing metadata
[2025-03-06 13:39:22,480][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,482][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:39:22,483][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:39:22,500][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 13:39:22,500][root][INFO] - Summary of metrics : {'label_accuracy': 0.09090909090909091, 'misclassification_rate': 0.9090909090909091, 'combined_accuracy': 0.0, 'malformed_label': 70, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 9, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 9, 'both_wrong': 90}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 13:39:30,157][root][INFO] - Setting global seed to 989
[2025-03-06 13:39:30,163][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 13:39:30,164][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:39:30,165][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:39:30,189][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:39:30,191][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:39:30,191][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:39:30,343][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 13:39:30,641][root][INFO] - Full model selected, loading model
[2025-03-06 13:39:48,285][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:40:50,225][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:40:50,225][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:41:16,666][root][INFO] - Peft model loaded successfully
[2025-03-06 13:41:22,925][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:41:22,927][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:41:22,927][root][INFO] - Starting inference
[2025-03-06 13:41:23,139][root][INFO] - Processing question number 0
[2025-03-06 13:41:23,141][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:41:30,192][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:41:46,256][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:42:00,245][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:42:17,946][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:42:34,317][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:42:50,057][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:43:06,128][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:43:16,327][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:43:28,005][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:43:41,730][root][INFO] - Processing question number 10
[2025-03-06 13:43:41,732][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:44:05,170][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:44:15,030][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:44:32,417][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:44:59,645][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:45:11,012][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:45:30,210][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:45:53,844][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:46:01,911][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:46:11,768][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:46:33,304][root][INFO] - Processing question number 20
[2025-03-06 13:46:33,306][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:46:41,957][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:46:52,781][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:47:15,049][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:47:41,156][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:47:59,888][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:48:11,264][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:48:21,288][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:48:31,748][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:48:40,026][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:48:52,778][root][INFO] - Processing question number 30
[2025-03-06 13:48:52,780][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:49:19,389][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:49:36,799][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:49:45,674][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:50:02,144][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:50:15,918][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:50:28,409][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:50:39,828][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:50:58,357][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:51:15,851][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:51:31,529][root][INFO] - Processing question number 40
[2025-03-06 13:51:31,532][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:51:50,377][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:52:10,427][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:52:34,019][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:52:53,631][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:53:05,460][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:53:18,671][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:53:46,585][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:54:03,297][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:54:14,284][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:54:32,424][root][INFO] - Processing question number 50
[2025-03-06 13:54:32,427][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:54:47,020][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:55:00,196][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:55:15,144][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:55:30,796][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:55:42,558][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:55:52,595][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:56:06,982][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:56:14,578][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:56:41,850][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:57:00,855][root][INFO] - Processing question number 60
[2025-03-06 13:57:00,858][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:57:09,418][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:57:21,520][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:57:32,671][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:57:40,912][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:57:59,926][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:58:06,672][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:58:15,605][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:58:28,390][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:58:41,743][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:58:50,353][root][INFO] - Processing question number 70
[2025-03-06 13:58:50,356][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:59:03,869][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:59:11,846][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:59:25,361][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:59:49,197][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:00:08,078][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:00:21,791][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:00:43,040][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:00:54,538][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:01:18,612][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:01:33,263][root][INFO] - Processing question number 80
[2025-03-06 14:01:33,267][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:02:00,180][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:02:18,903][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:02:30,983][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:02:51,824][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:03:19,083][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:03:36,550][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:03:55,180][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:04:14,559][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:04:27,843][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:04:37,736][root][INFO] - Processing question number 90
[2025-03-06 14:04:37,740][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:04:52,486][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:05:03,305][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:05:14,793][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:05:22,673][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:05:40,117][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:06:06,261][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:06:19,152][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:06:40,517][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:06:49,870][root][INFO] - Inference complete
[2025-03-06 14:06:49,870][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,876][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,877][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,878][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:06:49,878][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,879][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,879][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:06:49,879][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,884][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,884][root][WARNING] - |Q. 24||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:06:49,884][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,885][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,886][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:06:49,886][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,889][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,889][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:06:49,889][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,890][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,890][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:06:49,890][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,891][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,891][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:06:49,891][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,891][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,891][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:06:49,891][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,892][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,892][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:06:49,892][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,893][root][WARNING] - |Q. 57||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,893][root][WARNING] - |Q. 57||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:06:49,893][root][INFO] - |Q. 57||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,893][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:06:49,894][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:06:49,894][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:06:49,895][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,900][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,900][root][INFO] - Saved parsed outputs
[2025-03-06 14:06:49,900][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,902][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,902][root][INFO] - Saved parsing metadata
[2025-03-06 14:06:49,903][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,904][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:06:49,905][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:06:49,936][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 14:06:49,936][root][INFO] - Summary of metrics : {'label_accuracy': 0.2727272727272727, 'misclassification_rate': 0.7272727272727273, 'combined_accuracy': 0.0, 'malformed_label': 13, 'malformed_domain': 98, 'total_predictions': 99, 'correct_predictions': 27, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.030303030303030304, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 27, 'both_wrong': 71}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 14:06:57,212][root][INFO] - Setting global seed to 989
[2025-03-06 14:06:57,220][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 14:06:57,220][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:06:57,221][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:06:57,223][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:06:57,226][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:06:57,226][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:06:57,399][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 14:06:57,817][root][INFO] - Full model selected, loading model
[2025-03-06 14:07:13,926][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:07:13,926][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:07:20,530][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:07:20,531][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:07:20,532][root][INFO] - Starting inference
[2025-03-06 14:07:20,722][root][INFO] - Processing question number 0
[2025-03-06 14:07:20,724][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:07:46,550][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:08:13,376][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:08:39,780][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:09:06,630][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:09:32,967][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:09:59,259][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:10:26,266][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:10:52,823][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:11:19,070][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:11:45,991][root][INFO] - Processing question number 10
[2025-03-06 14:11:45,993][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:12:14,352][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:12:40,567][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:13:07,228][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:13:34,584][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:14:01,710][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:14:27,998][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:14:42,325][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:15:08,802][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:15:35,258][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:16:01,500][root][INFO] - Processing question number 20
[2025-03-06 14:16:01,502][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:16:27,935][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:16:54,551][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:17:20,591][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 14:17:46,576][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 14:18:13,401][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 14:18:39,962][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 14:19:07,281][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 14:19:33,771][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 14:20:00,395][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 14:20:26,395][root][INFO] - Processing question number 30
[2025-03-06 14:20:26,398][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:20:53,236][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 14:21:20,316][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 14:21:46,933][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 14:22:13,403][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 14:22:39,765][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 14:23:06,787][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 14:23:33,215][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 14:24:00,053][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:24:26,653][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 14:24:53,983][root][INFO] - Processing question number 40
[2025-03-06 14:24:53,986][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:25:20,653][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 14:25:47,306][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 14:26:14,471][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 14:26:41,513][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 14:27:07,903][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:27:34,523][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 14:28:02,384][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:28:28,092][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 14:28:54,617][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 14:29:21,812][root][INFO] - Processing question number 50
[2025-03-06 14:29:21,816][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:29:49,177][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 14:30:15,943][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 14:30:41,917][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 14:31:09,630][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 14:31:36,369][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:32:02,100][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 14:32:29,446][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 14:32:55,587][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 14:33:16,277][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 14:33:44,191][root][INFO] - Processing question number 60
[2025-03-06 14:33:44,195][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:34:10,297][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:34:36,771][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 14:35:03,813][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 14:35:29,879][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 14:35:56,475][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 14:36:23,111][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 14:36:42,191][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 14:37:09,217][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:37:36,245][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 14:38:03,549][root][INFO] - Processing question number 70
[2025-03-06 14:38:03,553][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 14:38:29,996][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 14:38:56,475][root][INFO] - Domain : Property, Question : 6
[2025-03-06 14:39:22,855][root][INFO] - Domain : Property, Question : 13
[2025-03-06 14:39:49,778][root][INFO] - Domain : Property, Question : 20
[2025-03-06 14:40:16,656][root][INFO] - Domain : Property, Question : 33
[2025-03-06 14:40:42,851][root][INFO] - Domain : Property, Question : 39
[2025-03-06 14:41:09,839][root][INFO] - Domain : Property, Question : 48
[2025-03-06 14:41:36,664][root][INFO] - Domain : Property, Question : 54
[2025-03-06 14:42:03,638][root][INFO] - Domain : Property, Question : 61
[2025-03-06 14:42:30,081][root][INFO] - Processing question number 80
[2025-03-06 14:42:30,085][root][INFO] - Domain : Property, Question : 67
[2025-03-06 14:42:56,955][root][INFO] - Domain : Property, Question : 75
[2025-03-06 14:43:23,806][root][INFO] - Domain : Property, Question : 83
[2025-03-06 14:43:50,189][root][INFO] - Domain : Property, Question : 89
[2025-03-06 14:44:16,609][root][INFO] - Domain : Property, Question : 97
[2025-03-06 14:44:43,813][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:45:10,760][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 14:45:37,773][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:46:04,171][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 14:46:31,009][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 14:46:57,097][root][INFO] - Processing question number 90
[2025-03-06 14:46:57,102][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 14:47:24,626][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 14:47:50,254][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 14:48:16,777][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 14:48:42,544][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:49:09,551][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 14:49:35,636][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 14:50:02,086][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 14:50:28,834][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 14:50:56,041][root][INFO] - Inference complete
[2025-03-06 14:50:56,041][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,047][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,052][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,052][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,052][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,057][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,057][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,058][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,058][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,059][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,059][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,059][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,059][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,059][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,060][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,060][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,060][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,061][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,061][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,061][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,061][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,062][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,062][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,062][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,063][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,063][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,063][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,064][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,064][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,064][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,064][root][WARNING] - |Q. 27||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,064][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,065][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,065][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,065][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,066][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,066][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,066][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,067][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,067][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,067][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,068][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,068][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,068][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,068][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,069][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,069][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,069][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,070][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,070][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,070][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,071][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,071][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,073][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,073][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,073][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,076][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,076][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,076][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,077][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,077][root][WARNING] - |Q. 53||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,077][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,078][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,078][root][WARNING] - |Q. 59||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,078][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,081][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,081][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,081][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,082][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,082][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,082][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,083][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,083][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,083][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,084][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,084][root][WARNING] - |Q. 97||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,084][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,084][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,084][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,084][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,085][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,085][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,085][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,085][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,086][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:50:56,086][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,086][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,086][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,086][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,087][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,087][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,087][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,087][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,088][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,088][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,088][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,089][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,089][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,090][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:50:56,090][root][WARNING] - |Q. 92||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:50:56,090][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:50:56,091][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,097][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,097][root][INFO] - Saved parsed outputs
[2025-03-06 14:50:56,097][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,098][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,098][root][INFO] - Saved parsing metadata
[2025-03-06 14:50:56,099][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,100][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:50:56,102][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 14:50:56,139][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 14:50:56,139][root][INFO] - Summary of metrics : {'label_accuracy': 0.1919191919191919, 'misclassification_rate': 0.8080808080808081, 'combined_accuracy': 0.0, 'malformed_label': 42, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 19, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 19, 'both_wrong': 80}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 14:51:15,694][root][INFO] - Setting global seed to 989
[2025-03-06 14:51:15,756][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 14:51:15,756][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:51:15,758][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 14:51:15,759][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:51:15,789][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:51:15,789][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 14:51:15,981][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 14:51:16,321][root][INFO] - Full model selected, loading model
[2025-03-06 14:51:35,636][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:52:40,842][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:52:40,842][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:53:07,720][root][INFO] - Peft model loaded successfully
[2025-03-06 14:53:14,160][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:53:14,162][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 14:53:14,162][root][INFO] - Starting inference
[2025-03-06 14:53:14,416][root][INFO] - Processing question number 0
[2025-03-06 14:53:14,418][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 14:53:23,825][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 14:53:43,227][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 14:54:10,148][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 14:54:27,631][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 14:54:36,819][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 14:55:03,614][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 14:55:17,903][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 14:55:36,546][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 14:55:46,978][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 14:56:11,655][root][INFO] - Processing question number 10
[2025-03-06 14:56:11,657][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 14:56:29,722][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 14:56:39,462][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 14:56:57,805][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 14:57:25,255][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 14:57:52,687][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 14:58:09,634][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 14:58:35,956][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 14:58:44,102][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 14:58:54,175][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 14:59:20,737][root][INFO] - Processing question number 20
[2025-03-06 14:59:20,739][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 14:59:31,235][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 14:59:39,331][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 14:59:57,219][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:00:04,932][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:00:21,628][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 15:00:38,063][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 15:00:49,232][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 15:01:16,000][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 15:01:42,943][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 15:01:56,504][root][INFO] - Processing question number 30
[2025-03-06 15:01:56,506][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:02:06,211][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 15:02:29,094][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 15:02:56,034][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 15:03:06,304][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 15:03:19,885][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 15:03:37,726][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 15:04:04,440][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 15:04:23,304][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:04:47,745][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 15:05:03,469][root][INFO] - Processing question number 40
[2025-03-06 15:05:03,472][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:05:25,448][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 15:05:46,627][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 15:06:07,086][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 15:06:29,799][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 15:06:41,563][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:07:08,529][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:07:36,692][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:07:51,281][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:08:07,800][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:08:23,623][root][INFO] - Processing question number 50
[2025-03-06 15:08:23,626][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:08:41,974][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 15:08:55,057][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 15:09:17,850][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 15:09:33,741][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 15:09:55,219][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:10:06,202][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 15:10:20,224][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 15:10:46,730][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 15:11:05,165][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 15:11:31,847][root][INFO] - Processing question number 60
[2025-03-06 15:11:31,861][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:11:43,191][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:11:59,031][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 15:12:08,729][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 15:12:24,950][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 15:12:36,434][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 15:12:43,262][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 15:13:10,287][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 15:13:28,170][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:13:44,161][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 15:13:53,112][root][INFO] - Processing question number 70
[2025-03-06 15:13:53,115][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 15:14:05,274][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 15:14:13,199][root][INFO] - Domain : Property, Question : 6
[2025-03-06 15:14:39,878][root][INFO] - Domain : Property, Question : 13
[2025-03-06 15:15:07,115][root][INFO] - Domain : Property, Question : 20
[2025-03-06 15:15:21,278][root][INFO] - Domain : Property, Question : 33
[2025-03-06 15:15:42,271][root][INFO] - Domain : Property, Question : 39
[2025-03-06 15:15:57,208][root][INFO] - Domain : Property, Question : 48
[2025-03-06 15:16:10,822][root][INFO] - Domain : Property, Question : 54
[2025-03-06 15:16:29,825][root][INFO] - Domain : Property, Question : 61
[2025-03-06 15:16:42,900][root][INFO] - Processing question number 80
[2025-03-06 15:16:42,904][root][INFO] - Domain : Property, Question : 67
[2025-03-06 15:17:01,263][root][INFO] - Domain : Property, Question : 75
[2025-03-06 15:17:21,679][root][INFO] - Domain : Property, Question : 83
[2025-03-06 15:17:48,363][root][INFO] - Domain : Property, Question : 89
[2025-03-06 15:18:07,488][root][INFO] - Domain : Property, Question : 97
[2025-03-06 15:18:35,047][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:18:56,365][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:19:15,627][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:19:33,239][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 15:20:00,358][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 15:20:09,271][root][INFO] - Processing question number 90
[2025-03-06 15:20:09,276][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 15:20:37,172][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 15:20:45,530][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 15:20:52,436][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 15:21:06,362][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:21:25,199][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 15:21:50,014][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 15:22:06,172][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 15:22:33,195][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 15:22:43,977][root][INFO] - Inference complete
[2025-03-06 15:22:43,978][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:43,984][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:43,985][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,986][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:43,987][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,987][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,988][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:43,988][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,989][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,989][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:43,990][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,990][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,990][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:43,990][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,991][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,992][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:22:43,992][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,992][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,992][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:22:43,992][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,994][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,994][root][WARNING] - |Q. 46||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:22:43,994][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,995][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,996][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:43,996][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,996][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,996][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:43,997][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,998][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,998][root][WARNING] - |Q. 5||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:43,998][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:43,999][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:43,999][root][WARNING] - |Q. 12||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:22:43,999][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,000][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,000][root][WARNING] - |Q. 59||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:44,001][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,001][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,002][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:44,002][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,002][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,002][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:44,002][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,003][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,003][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:22:44,003][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,004][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,005][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:22:44,005][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,005][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,005][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:44,005][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,006][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,006][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:44,006][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,007][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,007][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:44,007][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,008][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:22:44,008][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:22:44,009][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:22:44,010][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:44,014][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:44,015][root][INFO] - Saved parsed outputs
[2025-03-06 15:22:44,015][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:44,016][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:44,016][root][INFO] - Saved parsing metadata
[2025-03-06 15:22:44,017][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:44,018][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:22:44,020][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 15:22:44,040][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 15:22:44,040][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.010101010101010102, 'malformed_label': 20, 'malformed_domain': 91, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.030303030303030304, 'Criminal_Law_confidence': 0.010101010101010102, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.030303030303030304, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 7, 'correct_label_wrong_domain': 25, 'both_wrong': 66}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 15:22:54,049][root][INFO] - Setting global seed to 989
[2025-03-06 15:22:54,098][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 15:22:54,099][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:22:54,100][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 15:22:54,102][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:22:54,104][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:22:54,104][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 15:22:54,258][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 15:22:54,540][root][INFO] - Full model selected, loading model
[2025-03-06 15:23:12,785][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:23:12,785][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:23:19,455][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:23:19,457][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 15:23:19,457][root][INFO] - Starting inference
[2025-03-06 15:23:19,658][root][INFO] - Processing question number 0
[2025-03-06 15:23:19,661][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 15:23:46,026][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 15:24:13,147][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 15:24:39,854][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 15:25:07,007][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 15:25:19,025][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 15:25:45,617][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 15:26:12,927][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 15:26:39,797][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 15:27:06,340][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 15:27:33,467][root][INFO] - Processing question number 10
[2025-03-06 15:27:33,482][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 15:27:55,945][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 15:28:13,423][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 15:28:40,207][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 15:29:07,575][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 15:29:34,875][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 15:30:01,207][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 15:30:27,507][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 15:30:54,363][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 15:31:21,119][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 15:31:47,971][root][INFO] - Processing question number 20
[2025-03-06 15:31:47,991][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 15:32:14,760][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 15:32:41,617][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 15:33:08,000][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 15:33:34,380][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 15:33:52,799][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 15:34:03,428][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 15:34:31,164][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 15:34:58,047][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 15:35:25,105][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 15:35:51,409][root][INFO] - Processing question number 30
[2025-03-06 15:35:51,412][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:36:18,694][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 15:36:46,097][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 15:37:13,002][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 15:37:39,744][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 15:38:06,388][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 15:38:33,683][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 15:39:00,394][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 15:39:27,491][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:39:54,388][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 15:40:21,994][root][INFO] - Processing question number 40
[2025-03-06 15:40:21,997][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:40:48,919][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 15:41:15,819][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 15:41:43,266][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 15:42:10,610][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 15:42:37,275][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:43:04,184][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 15:43:32,328][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:43:58,349][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 15:44:25,150][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 15:44:52,627][root][INFO] - Processing question number 50
[2025-03-06 15:44:52,631][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:45:20,272][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 15:45:47,297][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 15:46:13,562][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 15:46:41,552][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 15:47:08,587][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:47:34,564][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 15:48:02,176][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 15:48:28,563][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 15:48:56,038][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 15:49:24,237][root][INFO] - Processing question number 60
[2025-03-06 15:49:24,241][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:49:36,269][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:49:46,162][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 15:49:59,460][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 15:50:25,836][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 15:50:44,658][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 15:51:11,584][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 15:51:21,889][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 15:51:49,135][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:52:16,209][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 15:52:43,777][root][INFO] - Processing question number 70
[2025-03-06 15:52:43,796][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 15:53:10,510][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 15:53:37,287][root][INFO] - Domain : Property, Question : 6
[2025-03-06 15:54:03,955][root][INFO] - Domain : Property, Question : 13
[2025-03-06 15:54:31,179][root][INFO] - Domain : Property, Question : 20
[2025-03-06 15:54:51,377][root][INFO] - Domain : Property, Question : 33
[2025-03-06 15:55:00,924][root][INFO] - Domain : Property, Question : 39
[2025-03-06 15:55:28,179][root][INFO] - Domain : Property, Question : 48
[2025-03-06 15:55:55,288][root][INFO] - Domain : Property, Question : 54
[2025-03-06 15:56:22,532][root][INFO] - Domain : Property, Question : 61
[2025-03-06 15:56:49,271][root][INFO] - Processing question number 80
[2025-03-06 15:56:49,297][root][INFO] - Domain : Property, Question : 67
[2025-03-06 15:57:16,429][root][INFO] - Domain : Property, Question : 75
[2025-03-06 15:57:32,278][root][INFO] - Domain : Property, Question : 83
[2025-03-06 15:57:59,056][root][INFO] - Domain : Property, Question : 89
[2025-03-06 15:58:25,887][root][INFO] - Domain : Property, Question : 97
[2025-03-06 15:58:53,338][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:59:20,569][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 15:59:47,855][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:00:14,525][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 16:00:41,583][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 16:01:07,962][root][INFO] - Processing question number 90
[2025-03-06 16:01:07,967][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 16:01:35,758][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 16:02:01,668][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 16:02:28,456][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 16:02:54,477][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:03:17,413][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 16:03:43,777][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 16:04:10,489][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 16:04:37,491][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 16:04:54,252][root][INFO] - Inference complete
[2025-03-06 16:04:54,253][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,259][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,265][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,265][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,265][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,266][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,266][root][WARNING] - |Q. 70||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,266][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,269][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,269][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,270][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,270][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,270][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,271][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,271][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,271][root][WARNING] - |Q. 55||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,271][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,272][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,272][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,272][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,273][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,273][root][WARNING] - |Q. 93||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,273][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,273][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,274][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,274][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,274][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,274][root][WARNING] - |Q. 22||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,274][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,275][root][WARNING] - |Q. 27||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,275][root][WARNING] - |Q. 27||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,275][root][INFO] - |Q. 27||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,276][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,277][root][WARNING] - |Q. 81||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,277][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,277][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,278][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,278][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,278][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,278][root][WARNING] - |Q. 32||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,278][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,285][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,285][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,285][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,289][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,289][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,290][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,292][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,292][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,292][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,292][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,292][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,293][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,293][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,293][root][WARNING] - |Q. 89||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,294][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,294][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,294][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,294][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,295][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,295][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:04:54,295][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,295][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,295][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,295][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,296][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,296][root][WARNING] - |Q. 30||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,296][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,298][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,298][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,298][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,299][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,299][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,299][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,300][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:04:54,300][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:04:54,300][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:04:54,302][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,306][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,306][root][INFO] - Saved parsed outputs
[2025-03-06 16:04:54,306][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,308][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,308][root][INFO] - Saved parsing metadata
[2025-03-06 16:04:54,309][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,310][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:04:54,311][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 16:04:54,339][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 16:04:54,339][root][INFO] - Summary of metrics : {'label_accuracy': 0.21212121212121213, 'misclassification_rate': 0.7878787878787878, 'combined_accuracy': 0.0, 'malformed_label': 41, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 21, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 21, 'both_wrong': 78}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 16:05:02,640][root][INFO] - Setting global seed to 989
[2025-03-06 16:05:02,648][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 16:05:02,648][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:05:02,649][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 16:05:02,667][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:05:02,670][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:05:02,670][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 16:05:02,826][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 16:05:03,105][root][INFO] - Full model selected, loading model
[2025-03-06 16:05:22,408][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:06:25,739][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:06:25,739][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:06:52,888][root][INFO] - Peft model loaded successfully
[2025-03-06 16:06:59,130][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:06:59,132][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:06:59,132][root][INFO] - Starting inference
[2025-03-06 16:06:59,328][root][INFO] - Processing question number 0
[2025-03-06 16:06:59,330][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 16:07:11,879][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 16:07:39,065][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 16:07:49,013][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 16:08:06,686][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 16:08:14,231][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 16:08:22,925][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 16:08:35,202][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 16:08:42,908][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 16:08:58,396][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 16:09:18,321][root][INFO] - Processing question number 10
[2025-03-06 16:09:18,322][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 16:09:32,642][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 16:09:59,023][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 16:10:14,577][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 16:10:24,972][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 16:10:52,477][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 16:11:02,961][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 16:11:18,766][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 16:11:34,161][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 16:11:48,211][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 16:12:00,701][root][INFO] - Processing question number 20
[2025-03-06 16:12:00,703][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 16:12:09,296][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 16:12:36,487][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 16:12:46,337][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 16:12:53,430][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 16:13:12,143][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 16:13:37,835][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 16:13:49,815][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 16:13:59,578][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 16:14:08,090][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 16:14:22,792][root][INFO] - Processing question number 30
[2025-03-06 16:14:22,795][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:14:42,935][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 16:14:53,746][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 16:15:20,863][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 16:15:32,946][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 16:15:43,381][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 16:15:56,455][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 16:16:12,021][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 16:16:39,197][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:16:58,064][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 16:17:13,970][root][INFO] - Processing question number 40
[2025-03-06 16:17:13,973][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:17:30,340][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 16:17:54,790][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 16:18:20,210][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 16:18:47,672][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 16:19:02,630][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:19:24,592][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 16:19:52,813][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:20:14,336][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 16:20:26,230][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 16:20:47,567][root][INFO] - Processing question number 50
[2025-03-06 16:20:47,573][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:21:04,193][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 16:21:31,298][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 16:21:41,397][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 16:21:58,752][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 16:22:13,532][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:22:26,931][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 16:22:40,204][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 16:22:55,067][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 16:23:18,717][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 16:23:47,018][root][INFO] - Processing question number 60
[2025-03-06 16:23:47,022][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:23:55,825][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:24:06,137][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 16:24:22,306][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 16:24:39,563][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 16:25:00,523][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 16:25:10,286][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 16:25:23,003][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 16:25:45,389][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:26:01,262][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 16:26:28,881][root][INFO] - Processing question number 70
[2025-03-06 16:26:28,885][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 16:26:37,278][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 16:27:04,111][root][INFO] - Domain : Property, Question : 6
[2025-03-06 16:27:17,816][root][INFO] - Domain : Property, Question : 13
[2025-03-06 16:27:39,759][root][INFO] - Domain : Property, Question : 20
[2025-03-06 16:27:55,205][root][INFO] - Domain : Property, Question : 33
[2025-03-06 16:28:12,091][root][INFO] - Domain : Property, Question : 39
[2025-03-06 16:28:30,615][root][INFO] - Domain : Property, Question : 48
[2025-03-06 16:28:43,977][root][INFO] - Domain : Property, Question : 54
[2025-03-06 16:29:01,625][root][INFO] - Domain : Property, Question : 61
[2025-03-06 16:29:16,356][root][INFO] - Processing question number 80
[2025-03-06 16:29:16,360][root][INFO] - Domain : Property, Question : 67
[2025-03-06 16:29:43,559][root][INFO] - Domain : Property, Question : 75
[2025-03-06 16:30:10,405][root][INFO] - Domain : Property, Question : 83
[2025-03-06 16:30:25,452][root][INFO] - Domain : Property, Question : 89
[2025-03-06 16:30:47,513][root][INFO] - Domain : Property, Question : 97
[2025-03-06 16:31:08,839][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:31:19,357][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 16:31:28,775][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:31:44,342][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 16:32:06,439][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 16:32:14,768][root][INFO] - Processing question number 90
[2025-03-06 16:32:14,772][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 16:32:25,770][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 16:32:51,722][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 16:33:01,862][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 16:33:15,577][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:33:29,316][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 16:33:41,471][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 16:33:50,985][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 16:34:00,676][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 16:34:11,547][root][INFO] - Inference complete
[2025-03-06 16:34:11,548][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,553][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,554][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,554][root][WARNING] - |Q. 1||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,554][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,555][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,555][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,555][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,556][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,556][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,556][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,557][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,557][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,557][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,558][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,558][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,558][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,558][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,558][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,558][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,559][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,559][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,559][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,559][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,560][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,560][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,560][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,561][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,561][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,562][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,562][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,562][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,562][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,562][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,563][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,563][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,563][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,563][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,563][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,564][root][WARNING] - |Q. 16||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,564][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,565][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,565][root][WARNING] - |Q. 51||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,565][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,565][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,565][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,566][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,566][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,567][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,567][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,567][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,568][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,568][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,568][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,568][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,568][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,569][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,569][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,569][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,570][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,570][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,570][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,570][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,570][root][WARNING] - |Q. 90||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,570][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,571][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,571][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,571][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,571][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,571][root][WARNING] - |Q. 5||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,571][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,572][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,572][root][WARNING] - |Q. 18||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,572][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,573][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,573][root][WARNING] - |Q. 59||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,573][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,574][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,574][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,574][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,574][root][WARNING] - |Q. 78||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,575][root][WARNING] - |Q. 78||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,575][root][INFO] - |Q. 78||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,575][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,575][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,576][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,577][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,577][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,577][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,577][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,578][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,578][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,578][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,578][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,579][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,579][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,579][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,579][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,579][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,580][root][WARNING] - |Q. 15||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:34:11,580][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,580][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,580][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,580][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,581][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,581][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,581][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,581][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:34:11,582][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:34:11,582][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:34:11,583][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,588][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,588][root][INFO] - Saved parsed outputs
[2025-03-06 16:34:11,588][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,589][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,589][root][INFO] - Saved parsing metadata
[2025-03-06 16:34:11,590][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,591][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:11,592][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 16:34:11,621][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 16:34:11,622][root][INFO] - Summary of metrics : {'label_accuracy': 0.18181818181818182, 'misclassification_rate': 0.8181818181818181, 'combined_accuracy': 0.04040404040404041, 'malformed_label': 37, 'malformed_domain': 83, 'total_predictions': 99, 'correct_predictions': 18, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.030303030303030304, 'Contracts_confidence': 0.04040404040404041, 'Criminal_Law_confidence': 0.050505050505050504, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.030303030303030304, 'Civil_Procedure_confidence': 0.010101010101010102, 'correct_domain_wrong_label': 12, 'correct_label_wrong_domain': 14, 'both_wrong': 69}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 16:34:20,268][root][INFO] - Setting global seed to 989
[2025-03-06 16:34:20,275][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 16:34:20,276][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:34:20,277][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 16:34:20,279][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:34:20,281][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:34:20,282][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 16:34:20,451][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 16:34:20,711][root][INFO] - Full model selected, loading model
[2025-03-06 16:34:38,379][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:34:38,379][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:34:44,918][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:34:44,920][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 16:34:44,920][root][INFO] - Starting inference
[2025-03-06 16:34:45,144][root][INFO] - Processing question number 0
[2025-03-06 16:34:45,159][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 16:35:11,515][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 16:35:11,966][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 16:35:38,688][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 16:36:05,825][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 16:36:32,458][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 16:36:35,662][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 16:36:40,618][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 16:37:07,470][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 16:37:34,029][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 16:37:34,780][root][INFO] - Processing question number 10
[2025-03-06 16:37:34,782][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 16:38:03,376][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 16:38:29,684][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 16:38:56,493][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 16:38:59,847][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 16:39:27,176][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 16:39:53,510][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 16:40:19,791][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 16:40:20,360][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 16:40:47,121][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 16:41:13,651][root][INFO] - Processing question number 20
[2025-03-06 16:41:13,653][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 16:41:20,232][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 16:41:47,129][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 16:42:13,470][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 16:42:39,750][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 16:42:57,375][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 16:43:11,653][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 16:43:39,214][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 16:44:05,946][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 16:44:32,816][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 16:44:43,076][root][INFO] - Processing question number 30
[2025-03-06 16:44:43,078][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:45:10,162][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 16:45:37,487][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 16:46:04,365][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 16:46:08,542][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 16:46:18,044][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 16:46:33,195][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 16:46:59,870][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 16:47:24,449][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:47:51,308][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 16:48:18,880][root][INFO] - Processing question number 40
[2025-03-06 16:48:18,883][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:48:45,772][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 16:48:59,444][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 16:49:26,854][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 16:49:27,398][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 16:49:28,674][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:49:55,554][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 16:50:23,679][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:50:43,457][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 16:51:10,226][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 16:51:37,680][root][INFO] - Processing question number 50
[2025-03-06 16:51:37,684][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:51:52,328][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 16:51:52,904][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 16:52:19,129][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 16:52:47,103][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 16:53:14,219][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:53:40,334][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 16:53:58,257][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 16:54:06,321][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 16:54:15,622][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 16:54:43,944][root][INFO] - Processing question number 60
[2025-03-06 16:54:43,948][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:55:10,377][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:55:37,248][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 16:55:41,105][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 16:55:41,635][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 16:55:57,640][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 16:56:01,346][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 16:56:01,963][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 16:56:02,420][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:56:08,686][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 16:56:09,434][root][INFO] - Processing question number 70
[2025-03-06 16:56:09,437][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 16:56:36,133][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 16:57:02,862][root][INFO] - Domain : Property, Question : 6
[2025-03-06 16:57:18,786][root][INFO] - Domain : Property, Question : 13
[2025-03-06 16:57:34,375][root][INFO] - Domain : Property, Question : 20
[2025-03-06 16:58:01,500][root][INFO] - Domain : Property, Question : 33
[2025-03-06 16:58:27,962][root][INFO] - Domain : Property, Question : 39
[2025-03-06 16:58:28,753][root][INFO] - Domain : Property, Question : 48
[2025-03-06 16:58:55,822][root][INFO] - Domain : Property, Question : 54
[2025-03-06 16:59:10,318][root][INFO] - Domain : Property, Question : 61
[2025-03-06 16:59:37,016][root][INFO] - Processing question number 80
[2025-03-06 16:59:37,020][root][INFO] - Domain : Property, Question : 67
[2025-03-06 17:00:04,134][root][INFO] - Domain : Property, Question : 75
[2025-03-06 17:00:16,869][root][INFO] - Domain : Property, Question : 83
[2025-03-06 17:00:43,512][root][INFO] - Domain : Property, Question : 89
[2025-03-06 17:00:52,432][root][INFO] - Domain : Property, Question : 97
[2025-03-06 17:00:52,967][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:01:20,160][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 17:01:47,412][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:02:14,034][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 17:02:41,089][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 17:03:07,402][root][INFO] - Processing question number 90
[2025-03-06 17:03:07,406][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 17:03:35,101][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 17:04:00,894][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 17:04:04,565][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 17:04:15,503][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:04:25,003][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 17:04:51,250][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 17:05:06,663][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 17:05:26,252][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 17:05:26,797][root][INFO] - Inference complete
[2025-03-06 17:05:26,797][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,803][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,804][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,805][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,805][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,807][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,808][root][WARNING] - |Q. 70||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,808][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,808][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,808][root][WARNING] - |Q. 77||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,808][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,809][root][WARNING] - |Q. 84||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,809][root][WARNING] - |Q. 84||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,809][root][INFO] - |Q. 84||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,811][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,811][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,811][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,812][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,813][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,813][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,814][root][WARNING] - |Q. 16||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,814][root][WARNING] - |Q. 16||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:05:26,814][root][INFO] - |Q. 16||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,815][root][WARNING] - |Q. 66||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,815][root][WARNING] - |Q. 66||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,815][root][INFO] - |Q. 66||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,816][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,816][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,816][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,818][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,818][root][WARNING] - |Q. 90||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:05:26,818][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,819][root][WARNING] - |Q. 18||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,819][root][WARNING] - |Q. 18||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,819][root][INFO] - |Q. 18||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,820][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,820][root][WARNING] - |Q. 40||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,820][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,820][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,820][root][WARNING] - |Q. 59||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,820][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,823][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,823][root][WARNING] - |Q. 67||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:05:26,823][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,823][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,823][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:05:26,823][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,824][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,824][root][WARNING] - |Q. 100||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:05:26,824][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,824][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,825][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,825][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,825][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,826][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,826][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,826][root][WARNING] - |Q. 30||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,826][root][WARNING] - |Q. 30||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:05:26,826][root][INFO] - |Q. 30||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,826][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,826][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,827][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,827][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,827][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,827][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,829][root][WARNING] - |Q. 74||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:05:26,829][root][WARNING] - |Q. 74||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:05:26,829][root][INFO] - |Q. 74||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:05:26,830][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,835][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,835][root][INFO] - Saved parsed outputs
[2025-03-06 17:05:26,835][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,836][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,836][root][INFO] - Saved parsing metadata
[2025-03-06 17:05:26,837][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,838][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
[2025-03-06 17:05:26,840][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 17:05:26,859][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_1
[2025-03-06 17:05:26,859][root][INFO] - Summary of metrics : {'label_accuracy': 0.12121212121212122, 'misclassification_rate': 0.8787878787878788, 'combined_accuracy': 0.0, 'malformed_label': 59, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 12, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 12, 'both_wrong': 87}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 17:05:35,364][root][INFO] - Setting global seed to 206
[2025-03-06 17:05:35,374][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:05:35,375][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:05:35,376][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:05:35,378][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:05:35,382][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:05:35,383][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:05:35,566][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:05:35,855][root][INFO] - Full model selected, loading model
[2025-03-06 17:05:55,636][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:06:59,799][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:06:59,800][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:07:26,458][root][INFO] - Peft model loaded successfully
[2025-03-06 17:07:32,738][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:07:32,740][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:07:32,740][root][INFO] - Starting inference
[2025-03-06 17:07:32,962][root][INFO] - Processing question number 0
[2025-03-06 17:07:32,965][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:07:43,467][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:08:04,965][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:08:14,888][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:08:41,977][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:08:52,215][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:09:07,406][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:09:17,890][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:09:28,292][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:09:37,439][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:09:54,462][root][INFO] - Processing question number 10
[2025-03-06 17:09:54,464][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:10:04,571][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:10:21,787][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:10:37,294][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:10:48,365][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:11:00,935][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:11:20,921][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:11:33,703][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:11:46,028][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:11:54,952][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:12:04,910][root][INFO] - Processing question number 20
[2025-03-06 17:12:04,912][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:12:13,693][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:12:28,767][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:12:40,744][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:12:51,958][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:13:08,549][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:13:33,082][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:13:49,323][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:14:10,533][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:14:37,148][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:15:04,408][root][INFO] - Processing question number 30
[2025-03-06 17:15:04,411][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:15:16,522][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:15:30,490][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:15:42,739][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:15:58,708][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:16:10,475][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:16:18,749][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:16:39,804][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:17:07,206][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:17:25,825][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:17:40,903][root][INFO] - Processing question number 40
[2025-03-06 17:17:40,906][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:17:57,453][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:18:20,515][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:18:38,354][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:18:50,704][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:19:04,241][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:19:17,929][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:19:27,940][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:19:42,965][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:19:53,260][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:20:11,515][root][INFO] - Processing question number 50
[2025-03-06 17:20:11,518][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:20:34,351][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:20:50,065][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:21:01,711][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:21:09,367][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:21:30,957][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:21:43,888][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:22:11,326][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:22:24,781][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:22:34,721][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:22:52,632][root][INFO] - Processing question number 60
[2025-03-06 17:22:52,636][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:23:01,747][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:23:23,084][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:23:36,900][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:23:57,289][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:24:13,950][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:24:31,949][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:24:43,431][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:25:09,525][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:25:21,926][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:25:34,645][root][INFO] - Processing question number 70
[2025-03-06 17:25:34,648][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:25:47,391][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:26:10,168][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:26:37,185][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:27:04,692][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:27:21,658][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:27:45,221][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:28:13,160][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:28:26,102][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:28:39,273][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:28:50,281][root][INFO] - Processing question number 80
[2025-03-06 17:28:50,285][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:29:12,329][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:29:35,069][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:29:45,950][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:30:12,888][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:30:40,772][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:30:54,578][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:31:07,542][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:31:32,263][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:31:49,262][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:32:04,523][root][INFO] - Processing question number 90
[2025-03-06 17:32:04,527][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:32:31,414][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:32:48,137][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:33:09,593][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:33:19,901][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:33:41,614][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:34:03,584][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:34:17,952][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:34:36,108][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:34:46,884][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:34:57,297][root][INFO] - Inference complete
[2025-03-06 17:34:57,298][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,307][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,309][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,309][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,310][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,313][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,313][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:34:57,313][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,314][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,314][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,314][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,315][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,315][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,315][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,316][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,316][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,317][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,319][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,319][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,319][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,321][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,321][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:34:57,321][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,322][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,322][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,322][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,322][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,323][root][WARNING] - |Q. 36||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:34:57,323][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,323][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,323][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,323][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,324][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,325][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,325][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,325][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,325][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:34:57,325][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,326][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:34:57,327][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:34:57,327][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:34:57,329][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,334][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,334][root][INFO] - Saved parsed outputs
[2025-03-06 17:34:57,334][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,336][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,336][root][INFO] - Saved parsing metadata
[2025-03-06 17:34:57,337][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,339][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:34:57,340][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:34:57,413][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 17:34:57,413][root][INFO] - Summary of metrics : {'label_accuracy': 0.19, 'misclassification_rate': 0.81, 'combined_accuracy': 0.0, 'malformed_label': 14, 'malformed_domain': 98, 'total_predictions': 100, 'correct_predictions': 19, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 19, 'both_wrong': 79}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 17:35:19,223][root][INFO] - Setting global seed to 206
[2025-03-06 17:35:19,247][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:35:19,248][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:35:19,249][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:35:19,250][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:35:19,253][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:35:19,254][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:35:19,499][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 17:35:19,782][root][INFO] - Full model selected, loading model
[2025-03-06 17:35:38,010][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:35:38,010][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:35:44,566][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:35:44,567][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:35:44,567][root][INFO] - Starting inference
[2025-03-06 17:35:44,749][root][INFO] - Processing question number 0
[2025-03-06 17:35:44,751][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:36:11,609][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:36:39,025][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:37:06,578][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:37:33,622][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:38:00,126][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:38:26,089][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:38:52,564][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:39:19,275][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:39:45,305][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:40:11,931][root][INFO] - Processing question number 10
[2025-03-06 17:40:11,933][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:40:37,759][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:41:04,206][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:41:30,768][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:41:56,794][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:42:23,765][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:42:50,379][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:43:16,945][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:43:43,392][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:44:10,323][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:44:37,341][root][INFO] - Processing question number 20
[2025-03-06 17:44:37,343][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:45:03,275][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:45:29,988][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:45:56,256][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:46:22,709][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:46:49,229][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:47:16,238][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:47:42,810][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:48:09,580][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:48:36,168][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:49:03,302][root][INFO] - Processing question number 30
[2025-03-06 17:49:03,304][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:49:29,930][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:49:56,407][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:50:22,859][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:50:49,964][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:51:16,514][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:51:43,128][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:52:09,716][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:52:36,987][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:53:03,774][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:53:30,579][root][INFO] - Processing question number 40
[2025-03-06 17:53:30,583][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:53:57,323][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:54:23,858][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:54:50,872][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:55:16,820][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:55:44,107][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:56:10,811][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:56:37,396][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:57:04,232][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:57:31,684][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:57:58,647][root][INFO] - Processing question number 50
[2025-03-06 17:57:58,650][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:58:25,916][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:58:52,060][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:59:19,329][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:59:46,194][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:00:12,414][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:00:38,911][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:01:06,305][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:01:33,398][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:02:00,500][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:02:27,426][root][INFO] - Processing question number 60
[2025-03-06 18:02:27,430][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:02:54,110][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:03:20,880][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:03:48,312][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:04:15,271][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:04:42,151][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:05:08,564][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:05:34,765][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:06:00,827][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:06:27,228][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:06:53,500][root][INFO] - Processing question number 70
[2025-03-06 18:06:53,504][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:07:20,390][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:07:47,174][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:08:14,150][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:08:41,598][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:09:07,874][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:09:34,797][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:10:02,681][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:10:29,611][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:10:55,574][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:11:21,960][root][INFO] - Processing question number 80
[2025-03-06 18:11:21,964][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:11:49,235][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:12:16,551][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:12:43,789][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:13:10,690][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:13:38,546][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:14:05,166][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:14:32,607][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:15:00,275][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:15:27,095][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:15:44,058][root][INFO] - Processing question number 90
[2025-03-06 18:15:44,062][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:16:10,921][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:16:38,057][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:17:05,027][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:17:31,754][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:17:59,183][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:18:26,483][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:18:53,452][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:19:20,016][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:19:46,125][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:20:13,487][root][INFO] - Inference complete
[2025-03-06 18:20:13,488][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,495][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,496][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,497][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,498][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,499][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,499][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,499][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,499][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,500][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,500][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,500][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,500][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,500][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,501][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,501][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,502][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,502][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,502][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,503][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,503][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,504][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,504][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,505][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,505][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,505][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,508][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,508][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,508][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,508][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,508][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,509][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,509][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,509][root][WARNING] - |Q. 4||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,509][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,510][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,510][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,510][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,513][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,513][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,513][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,513][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,514][root][WARNING] - |Q. 98||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,514][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,516][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,516][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,516][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,518][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,519][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,519][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,519][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,519][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,520][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,520][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,520][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,521][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,521][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,522][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,522][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,522][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,522][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,522][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,523][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,523][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,523][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,525][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,525][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,526][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,527][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,527][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,527][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,528][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,528][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,528][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,531][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,532][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,532][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,532][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,533][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,533][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,533][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,533][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,533][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,534][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,534][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:20:13,534][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,534][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:20:13,535][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:20:13,535][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:20:13,536][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,541][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,541][root][INFO] - Saved parsed outputs
[2025-03-06 18:20:13,541][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,543][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,543][root][INFO] - Saved parsing metadata
[2025-03-06 18:20:13,544][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,545][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:20:13,546][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:20:13,700][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 18:20:13,700][root][INFO] - Summary of metrics : {'label_accuracy': 0.17, 'misclassification_rate': 0.83, 'combined_accuracy': 0.0, 'malformed_label': 38, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 17, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 17, 'both_wrong': 83}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 18:21:10,570][root][INFO] - Setting global seed to 206
[2025-03-06 18:21:10,602][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 18:21:10,602][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:21:10,604][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:21:10,606][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:21:10,613][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:21:10,614][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:21:10,778][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 18:21:11,122][root][INFO] - Full model selected, loading model
[2025-03-06 18:21:36,555][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 18:22:43,574][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 18:22:43,575][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 18:23:09,202][root][INFO] - Peft model loaded successfully
[2025-03-06 18:23:15,480][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:23:15,483][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:23:15,483][root][INFO] - Starting inference
[2025-03-06 18:23:15,836][root][INFO] - Processing question number 0
[2025-03-06 18:23:15,838][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:23:25,026][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:23:46,536][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:23:56,214][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:24:20,364][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:24:47,093][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:25:03,763][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:25:13,110][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:25:23,580][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:25:33,225][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:25:50,406][root][INFO] - Processing question number 10
[2025-03-06 18:25:50,407][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:26:00,200][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:26:21,543][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:26:36,448][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:26:46,525][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:26:55,737][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:27:15,011][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:27:23,502][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:27:34,440][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:27:43,775][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 18:27:53,558][root][INFO] - Processing question number 20
[2025-03-06 18:27:53,561][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 18:28:01,343][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 18:28:13,936][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 18:28:33,394][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 18:28:43,835][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 18:29:03,405][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 18:29:23,210][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 18:29:31,314][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 18:29:51,718][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 18:30:06,447][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 18:30:32,294][root][INFO] - Processing question number 30
[2025-03-06 18:30:32,298][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 18:30:41,496][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 18:30:55,720][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 18:31:09,792][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 18:31:24,266][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 18:31:37,291][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 18:31:47,662][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 18:32:06,994][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 18:32:31,388][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 18:32:50,239][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 18:33:00,980][root][INFO] - Processing question number 40
[2025-03-06 18:33:00,983][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 18:33:22,405][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 18:33:42,914][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 18:34:10,322][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 18:34:21,238][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 18:34:34,774][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 18:34:43,605][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 18:34:53,167][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 18:35:09,399][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 18:35:24,561][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 18:35:51,881][root][INFO] - Processing question number 50
[2025-03-06 18:35:51,885][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 18:36:13,519][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 18:36:22,688][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 18:36:34,775][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 18:36:50,663][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 18:37:01,342][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 18:37:12,443][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 18:37:37,157][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 18:37:49,495][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 18:37:58,518][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 18:38:18,042][root][INFO] - Processing question number 60
[2025-03-06 18:38:18,047][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 18:38:29,793][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 18:38:44,543][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 18:38:56,690][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 18:39:15,742][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 18:39:29,475][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 18:39:45,170][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 18:40:04,260][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 18:40:30,676][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 18:40:54,443][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 18:41:07,275][root][INFO] - Processing question number 70
[2025-03-06 18:41:07,279][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 18:41:18,802][root][INFO] - Domain : Property, Question : 9
[2025-03-06 18:41:45,948][root][INFO] - Domain : Property, Question : 17
[2025-03-06 18:42:13,292][root][INFO] - Domain : Property, Question : 25
[2025-03-06 18:42:41,112][root][INFO] - Domain : Property, Question : 30
[2025-03-06 18:42:54,074][root][INFO] - Domain : Property, Question : 36
[2025-03-06 18:43:10,648][root][INFO] - Domain : Property, Question : 46
[2025-03-06 18:43:32,601][root][INFO] - Domain : Property, Question : 53
[2025-03-06 18:43:56,824][root][INFO] - Domain : Property, Question : 59
[2025-03-06 18:44:23,135][root][INFO] - Domain : Property, Question : 66
[2025-03-06 18:44:35,107][root][INFO] - Processing question number 80
[2025-03-06 18:44:35,111][root][INFO] - Domain : Property, Question : 69
[2025-03-06 18:45:01,548][root][INFO] - Domain : Property, Question : 81
[2025-03-06 18:45:13,168][root][INFO] - Domain : Property, Question : 88
[2025-03-06 18:45:24,170][root][INFO] - Domain : Property, Question : 91
[2025-03-06 18:45:40,782][root][INFO] - Domain : Property, Question : 94
[2025-03-06 18:45:59,142][root][INFO] - Domain : Property, Question : 100
[2025-03-06 18:46:14,411][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 18:46:34,788][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 18:47:00,585][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 18:47:27,744][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 18:47:50,721][root][INFO] - Processing question number 90
[2025-03-06 18:47:50,726][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 18:48:17,480][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 18:48:33,741][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 18:48:57,353][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 18:49:07,099][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 18:49:34,855][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 18:50:02,509][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 18:50:26,546][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 18:50:44,571][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 18:50:54,673][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 18:51:05,105][root][INFO] - Inference complete
[2025-03-06 18:51:05,105][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,113][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,116][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,116][root][WARNING] - |Q. 64||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:51:05,116][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,118][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,118][root][WARNING] - |Q. 34||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:51:05,118][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,120][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,120][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:51:05,120][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,121][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,121][root][WARNING] - |Q. 43||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,122][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,122][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,123][root][WARNING] - |Q. 73||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,123][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,123][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,124][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,124][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,125][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,126][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:51:05,126][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,126][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,126][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,126][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,127][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,127][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,127][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,128][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,128][root][WARNING] - |Q. 59||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,128][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,129][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,129][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:51:05,129][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,129][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,130][root][WARNING] - |Q. 91||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:51:05,130][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,130][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,130][root][WARNING] - |Q. 94||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 18:51:05,130][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,131][root][WARNING] - |Q. 22||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,131][root][WARNING] - |Q. 22||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,131][root][INFO] - |Q. 22||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,132][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,133][root][WARNING] - |Q. 63||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,133][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,133][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 18:51:05,133][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 18:51:05,133][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 18:51:05,135][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,140][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,140][root][INFO] - Saved parsed outputs
[2025-03-06 18:51:05,140][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,141][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,141][root][INFO] - Saved parsing metadata
[2025-03-06 18:51:05,143][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,144][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:05,145][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 18:51:05,223][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 18:51:05,223][root][INFO] - Summary of metrics : {'label_accuracy': 0.21, 'misclassification_rate': 0.79, 'combined_accuracy': 0.02, 'malformed_label': 17, 'malformed_domain': 88, 'total_predictions': 100, 'correct_predictions': 21, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.03, 'Contracts_confidence': 0.02, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.04, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 10, 'correct_label_wrong_domain': 19, 'both_wrong': 69}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 18:51:24,834][root][INFO] - Setting global seed to 206
[2025-03-06 18:51:24,857][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 18:51:24,857][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 18:51:24,859][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 18:51:24,861][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 18:51:24,864][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 18:51:24,864][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 18:51:25,073][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 18:51:25,344][root][INFO] - Full model selected, loading model
[2025-03-06 18:51:45,667][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 18:51:45,667][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 18:51:52,418][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 18:51:52,420][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 18:51:52,420][root][INFO] - Starting inference
[2025-03-06 18:51:52,649][root][INFO] - Processing question number 0
[2025-03-06 18:51:52,651][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 18:52:20,214][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 18:52:47,929][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 18:53:15,782][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 18:53:43,120][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 18:54:09,915][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 18:54:36,166][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 18:55:02,931][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 18:55:29,927][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 18:55:39,006][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 18:56:05,927][root][INFO] - Processing question number 10
[2025-03-06 18:56:05,929][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 18:56:32,065][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 18:56:58,813][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 18:57:25,661][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 18:57:51,987][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 18:58:19,245][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 18:58:46,153][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 18:59:12,991][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 18:59:39,730][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 18:59:56,395][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:00:23,713][root][INFO] - Processing question number 20
[2025-03-06 19:00:23,715][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:00:49,943][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:01:16,968][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:01:43,528][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:02:10,298][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:02:37,122][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:02:54,542][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:03:21,427][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:03:48,521][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:04:15,398][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:04:42,842][root][INFO] - Processing question number 30
[2025-03-06 19:04:42,845][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:05:09,776][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:05:36,568][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:06:03,307][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:06:30,719][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:06:57,556][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:07:24,480][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:07:51,347][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:08:18,921][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:08:45,989][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:09:13,091][root][INFO] - Processing question number 40
[2025-03-06 19:09:13,095][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:09:40,103][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:10:06,194][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:10:33,499][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:10:59,752][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:11:27,330][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:11:41,734][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:12:08,588][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:12:35,605][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:13:02,525][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:13:14,940][root][INFO] - Processing question number 50
[2025-03-06 19:13:14,943][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:13:42,515][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:14:08,958][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:14:36,532][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:15:03,709][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:15:17,212][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:15:29,508][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:15:33,730][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:16:01,134][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:16:28,527][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:16:55,743][root][INFO] - Processing question number 60
[2025-03-06 19:16:55,747][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:17:22,722][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:17:49,799][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:18:17,534][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:18:44,800][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:19:11,977][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:19:23,466][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:19:49,961][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:20:16,331][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:20:25,560][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:20:52,163][root][INFO] - Processing question number 70
[2025-03-06 19:20:52,168][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:21:07,449][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:21:34,543][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:22:01,813][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:22:29,573][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:22:56,149][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:23:06,415][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:23:34,605][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:24:01,838][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:24:28,093][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:24:54,789][root][INFO] - Processing question number 80
[2025-03-06 19:24:54,794][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:25:22,369][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:25:49,996][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:26:17,522][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:26:44,733][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:27:12,884][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:27:39,707][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:28:03,485][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:28:31,384][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:28:49,654][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:29:16,780][root][INFO] - Processing question number 90
[2025-03-06 19:29:16,784][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:29:43,908][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:30:11,336][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:30:38,584][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:31:05,588][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 19:31:33,287][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 19:32:00,892][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 19:32:28,149][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 19:32:55,001][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 19:33:06,076][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 19:33:33,692][root][INFO] - Inference complete
[2025-03-06 19:33:33,692][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,699][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,699][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,700][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,701][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,704][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,704][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,704][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,705][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,705][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,705][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,706][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,706][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,706][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,706][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,707][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,707][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,707][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,707][root][WARNING] - |Q. 44||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,707][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,708][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,708][root][WARNING] - |Q. 71||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,709][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,709][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,709][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,709][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,710][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,710][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,710][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,711][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,712][root][WARNING] - |Q. 34||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,712][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,713][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,713][root][WARNING] - |Q. 87||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,713][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,715][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,715][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,715][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,717][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,717][root][WARNING] - |Q. 80||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,717][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,718][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,718][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,718][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,719][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,719][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,719][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,721][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,722][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,722][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,722][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,723][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,723][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,723][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,723][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,724][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,726][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,726][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,726][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,727][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,727][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,728][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,728][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,728][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 19:33:33,728][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,732][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,732][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,732][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,733][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 19:33:33,733][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 19:33:33,733][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 19:33:33,735][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,740][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,740][root][INFO] - Saved parsed outputs
[2025-03-06 19:33:33,740][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,741][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,741][root][INFO] - Saved parsing metadata
[2025-03-06 19:33:33,743][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,744][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:33:33,745][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 19:33:33,881][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 19:33:33,881][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.0, 'malformed_label': 40, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 85}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 19:33:43,318][root][INFO] - Setting global seed to 206
[2025-03-06 19:33:43,325][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 19:33:43,325][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 19:33:43,327][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 19:33:43,328][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:33:43,331][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:33:43,331][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 19:33:43,488][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 19:33:43,752][root][INFO] - Full model selected, loading model
[2025-03-06 19:34:03,495][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 19:35:07,296][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 19:35:07,296][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 19:35:34,875][root][INFO] - Peft model loaded successfully
[2025-03-06 19:35:41,190][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:35:41,193][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 19:35:41,193][root][INFO] - Starting inference
[2025-03-06 19:35:41,433][root][INFO] - Processing question number 0
[2025-03-06 19:35:41,435][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 19:35:56,410][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 19:36:24,194][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 19:36:34,005][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 19:36:48,233][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 19:36:57,248][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 19:37:08,029][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 19:37:14,672][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 19:37:25,286][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 19:37:34,002][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 19:37:47,588][root][INFO] - Processing question number 10
[2025-03-06 19:37:47,590][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 19:37:56,298][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 19:38:06,597][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 19:38:33,514][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 19:38:44,983][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 19:38:57,924][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 19:39:14,100][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 19:39:26,544][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 19:39:37,151][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 19:39:50,121][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 19:40:17,510][root][INFO] - Processing question number 20
[2025-03-06 19:40:17,513][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 19:40:27,037][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 19:40:41,077][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 19:40:50,561][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 19:41:02,340][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 19:41:10,892][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 19:41:22,207][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 19:41:49,148][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 19:42:03,017][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:42:22,430][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 19:42:41,496][root][INFO] - Processing question number 30
[2025-03-06 19:42:41,498][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 19:42:52,345][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 19:43:03,876][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 19:43:12,572][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 19:43:23,995][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 19:43:35,250][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 19:43:51,521][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:44:03,714][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 19:44:21,531][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:44:45,752][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 19:44:54,559][root][INFO] - Processing question number 40
[2025-03-06 19:44:54,562][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 19:45:02,407][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 19:45:14,625][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 19:45:42,015][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 19:45:50,915][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 19:46:18,574][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 19:46:45,693][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 19:46:54,825][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 19:47:19,163][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 19:47:26,980][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 19:47:53,935][root][INFO] - Processing question number 50
[2025-03-06 19:47:53,938][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 19:48:14,650][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 19:48:22,803][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 19:48:31,514][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 19:48:43,433][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 19:48:57,644][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 19:49:10,772][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 19:49:23,900][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 19:49:36,349][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 19:49:59,569][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 19:50:14,908][root][INFO] - Processing question number 60
[2025-03-06 19:50:14,911][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 19:50:24,388][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 19:50:44,745][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 19:50:54,121][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 19:51:21,454][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 19:51:35,782][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 19:51:46,907][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 19:51:55,511][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 19:52:12,257][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 19:52:30,777][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 19:52:42,781][root][INFO] - Processing question number 70
[2025-03-06 19:52:42,784][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 19:52:56,405][root][INFO] - Domain : Property, Question : 9
[2025-03-06 19:53:23,558][root][INFO] - Domain : Property, Question : 17
[2025-03-06 19:53:35,879][root][INFO] - Domain : Property, Question : 25
[2025-03-06 19:53:46,249][root][INFO] - Domain : Property, Question : 30
[2025-03-06 19:54:02,886][root][INFO] - Domain : Property, Question : 36
[2025-03-06 19:54:30,175][root][INFO] - Domain : Property, Question : 46
[2025-03-06 19:54:53,288][root][INFO] - Domain : Property, Question : 53
[2025-03-06 19:55:18,127][root][INFO] - Domain : Property, Question : 59
[2025-03-06 19:55:27,767][root][INFO] - Domain : Property, Question : 66
[2025-03-06 19:55:45,606][root][INFO] - Processing question number 80
[2025-03-06 19:55:45,610][root][INFO] - Domain : Property, Question : 69
[2025-03-06 19:56:01,521][root][INFO] - Domain : Property, Question : 81
[2025-03-06 19:56:21,610][root][INFO] - Domain : Property, Question : 88
[2025-03-06 19:56:29,340][root][INFO] - Domain : Property, Question : 91
[2025-03-06 19:56:48,566][root][INFO] - Domain : Property, Question : 94
[2025-03-06 19:57:13,388][root][INFO] - Domain : Property, Question : 100
[2025-03-06 19:57:38,078][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:57:56,806][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 19:58:18,928][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 19:58:28,219][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:58:37,734][root][INFO] - Processing question number 90
[2025-03-06 19:58:37,739][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 19:59:04,945][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 19:59:16,516][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:59:32,514][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 19:59:45,262][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:00:11,619][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:00:33,659][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:00:52,395][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:01:01,734][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:01:14,038][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:01:41,735][root][INFO] - Inference complete
[2025-03-06 20:01:41,735][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,742][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,743][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,744][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,745][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,746][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,746][root][WARNING] - |Q. 49||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,746][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,746][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,747][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,747][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,747][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,747][root][WARNING] - |Q. 2||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,747][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,748][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,748][root][WARNING] - |Q. 37||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,748][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,749][root][WARNING] - |Q. 44||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,749][root][WARNING] - |Q. 44||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,749][root][INFO] - |Q. 44||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,749][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,749][root][WARNING] - |Q. 71||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,749][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,750][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,750][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,750][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,751][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,751][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,751][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,751][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,752][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,752][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,752][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,752][root][WARNING] - |Q. 28||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,752][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,752][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,752][root][WARNING] - |Q. 34||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,753][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,753][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,753][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,753][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,754][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,754][root][WARNING] - |Q. 97||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,754][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,755][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,755][root][WARNING] - |Q. 10||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,755][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,756][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,757][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,757][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,757][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,757][root][WARNING] - |Q. 43||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,758][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,758][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,759][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,759][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,759][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,759][root][WARNING] - |Q. 12||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,759][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,760][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,760][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,760][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,760][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,760][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,760][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,761][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,761][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,761][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,762][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,762][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,762][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,763][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,763][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,763][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,763][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,764][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,764][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,764][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,765][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,765][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,765][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,765][root][WARNING] - |Q. 94||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,766][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,766][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,767][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,767][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,767][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,767][root][WARNING] - |Q. 57||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,767][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,768][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,768][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:01:41,768][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,769][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:01:41,769][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:01:41,769][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:01:41,770][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,775][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,775][root][INFO] - Saved parsed outputs
[2025-03-06 20:01:41,775][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,776][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,776][root][INFO] - Saved parsing metadata
[2025-03-06 20:01:41,778][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,779][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:01:41,781][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:01:41,850][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 20:01:41,850][root][INFO] - Summary of metrics : {'label_accuracy': 0.22, 'misclassification_rate': 0.78, 'combined_accuracy': 0.03, 'malformed_label': 31, 'malformed_domain': 84, 'total_predictions': 100, 'correct_predictions': 22, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.03, 'Contracts_confidence': 0.09, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.03, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.04, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 13, 'correct_label_wrong_domain': 19, 'both_wrong': 65}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 20:02:14,175][root][INFO] - Setting global seed to 206
[2025-03-06 20:02:14,276][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 20:02:14,276][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 20:02:14,278][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:02:14,279][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:02:14,284][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:02:14,284][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:02:14,444][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:02:14,740][root][INFO] - Full model selected, loading model
[2025-03-06 20:02:30,187][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 20:02:30,187][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 20:02:36,875][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:02:36,934][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:02:36,934][root][INFO] - Starting inference
[2025-03-06 20:02:37,122][root][INFO] - Processing question number 0
[2025-03-06 20:02:37,124][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:03:04,859][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:03:32,594][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:03:33,123][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:03:37,264][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:03:37,837][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:04:04,101][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:04:30,890][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:04:57,908][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:05:20,216][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:05:23,922][root][INFO] - Processing question number 10
[2025-03-06 20:05:23,924][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:05:50,058][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:06:16,828][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:06:43,714][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:06:55,590][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:07:00,234][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:07:27,165][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:07:45,572][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:07:46,195][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:07:50,026][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:07:50,611][root][INFO] - Processing question number 20
[2025-03-06 20:07:50,613][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:07:56,939][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:08:23,969][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:08:50,541][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:09:02,621][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:09:29,464][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 20:09:56,801][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 20:09:57,207][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 20:10:24,301][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:10:36,783][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 20:11:04,238][root][INFO] - Processing question number 30
[2025-03-06 20:11:04,240][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 20:11:22,527][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 20:11:29,855][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 20:11:43,243][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 20:12:10,670][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 20:12:37,547][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:13:04,488][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:13:31,391][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:13:42,607][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:13:55,341][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:14:22,461][root][INFO] - Processing question number 40
[2025-03-06 20:14:22,463][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:14:34,924][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:15:01,784][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:15:06,052][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:15:32,326][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:15:59,932][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:16:02,940][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:16:29,825][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:16:56,855][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:17:23,814][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:17:51,104][root][INFO] - Processing question number 50
[2025-03-06 20:17:51,107][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:18:18,695][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:18:19,062][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:18:22,963][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:18:42,486][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:19:09,039][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:19:35,854][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:19:36,393][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:19:49,775][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:20:17,193][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:20:18,740][root][INFO] - Processing question number 60
[2025-03-06 20:20:18,743][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:20:21,327][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:20:25,392][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:20:26,004][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:20:44,768][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:20:48,550][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:21:15,300][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:21:41,816][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:21:42,138][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:22:08,884][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:22:17,526][root][INFO] - Processing question number 70
[2025-03-06 20:22:17,530][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:22:44,743][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:22:49,066][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:23:07,760][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:23:08,286][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:23:08,808][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:23:13,365][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:23:41,598][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:23:45,387][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:24:11,699][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:24:12,240][root][INFO] - Processing question number 80
[2025-03-06 20:24:12,244][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:24:26,848][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:24:54,500][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:25:21,065][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:25:48,316][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:26:16,511][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:26:43,369][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:26:58,724][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:26:59,467][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:27:26,608][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:27:30,765][root][INFO] - Processing question number 90
[2025-03-06 20:27:30,769][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:27:57,920][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:28:25,359][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:28:52,626][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:29:19,637][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:29:23,948][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:29:51,567][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 20:30:18,848][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 20:30:45,721][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 20:30:54,068][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:31:07,161][root][INFO] - Inference complete
[2025-03-06 20:31:07,161][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,168][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,169][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,169][root][WARNING] - |Q. 1||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,169][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,170][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,170][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,170][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,170][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,171][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,171][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,172][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,172][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,172][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,173][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,173][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,173][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,174][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,174][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,174][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,176][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,176][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,177][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,177][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,177][root][WARNING] - |Q. 3||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,177][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,179][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,179][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,179][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,179][root][WARNING] - |Q. 14||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,180][root][WARNING] - |Q. 14||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,180][root][INFO] - |Q. 14||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,181][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,181][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,181][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,181][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,181][root][WARNING] - |Q. 84||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,181][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,182][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,182][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,182][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,182][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,182][root][WARNING] - |Q. 4||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,182][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,183][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,183][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,183][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,185][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,185][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,185][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,185][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,185][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,185][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,186][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,186][root][WARNING] - |Q. 85||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,186][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,187][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,187][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,187][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,187][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,187][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,187][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,188][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,188][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,188][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,189][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,189][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,189][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,190][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,190][root][WARNING] - |Q. 69||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,190][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,191][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,191][root][WARNING] - |Q. 81||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,191][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,193][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,193][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:31:07,193][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,193][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,193][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,194][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,196][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:31:07,197][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:31:07,197][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:31:07,198][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,203][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,203][root][INFO] - Saved parsed outputs
[2025-03-06 20:31:07,203][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,204][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,204][root][INFO] - Saved parsing metadata
[2025-03-06 20:31:07,205][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,207][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:31:07,209][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 20:31:07,257][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 20:31:07,257][root][INFO] - Summary of metrics : {'label_accuracy': 0.07, 'misclassification_rate': 0.9299999999999999, 'combined_accuracy': 0.0, 'malformed_label': 66, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 7, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 7, 'both_wrong': 93}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 20:31:13,885][root][INFO] - Setting global seed to 989
[2025-03-06 20:31:13,890][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 20:31:13,890][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 20:31:13,892][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 20:31:13,893][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:31:13,895][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:31:13,895][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 20:31:14,214][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 20:31:14,483][root][INFO] - Full model selected, loading model
[2025-03-06 20:31:26,519][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:32:32,978][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:32:32,979][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:33:00,125][root][INFO] - Peft model loaded successfully
[2025-03-06 20:33:06,567][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:33:06,570][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 20:33:06,570][root][INFO] - Starting inference
[2025-03-06 20:33:06,763][root][INFO] - Processing question number 0
[2025-03-06 20:33:06,765][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 20:33:17,086][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 20:33:38,739][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 20:33:48,729][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 20:34:16,003][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 20:34:26,312][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 20:34:41,604][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 20:34:52,160][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 20:35:02,634][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 20:35:11,849][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 20:35:28,984][root][INFO] - Processing question number 10
[2025-03-06 20:35:28,986][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 20:35:39,162][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 20:35:56,490][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 20:36:12,099][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 20:36:23,248][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 20:36:35,902][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 20:36:56,014][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:37:08,868][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 20:37:21,277][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 20:37:30,260][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 20:37:40,280][root][INFO] - Processing question number 20
[2025-03-06 20:37:40,282][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 20:37:49,112][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 20:38:04,284][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:38:16,338][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 20:38:27,628][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 20:38:44,328][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 20:39:09,004][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 20:39:25,337][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 20:39:46,675][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:40:13,465][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 20:40:40,888][root][INFO] - Processing question number 30
[2025-03-06 20:40:40,890][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 20:40:53,083][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 20:41:07,139][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 20:41:19,459][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 20:41:35,526][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 20:41:47,365][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 20:41:55,699][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:42:16,883][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 20:42:44,364][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:43:02,919][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 20:43:18,058][root][INFO] - Processing question number 40
[2025-03-06 20:43:18,061][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 20:43:34,708][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 20:43:57,924][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 20:44:15,876][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 20:44:28,310][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 20:44:41,917][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 20:44:55,695][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:45:05,763][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:45:20,882][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 20:45:31,240][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 20:45:49,613][root][INFO] - Processing question number 50
[2025-03-06 20:45:49,616][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 20:46:12,586][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 20:46:28,393][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 20:46:40,106][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:46:47,806][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 20:47:09,524][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 20:47:22,534][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 20:47:50,141][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 20:48:03,711][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 20:48:13,705][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 20:48:31,733][root][INFO] - Processing question number 60
[2025-03-06 20:48:31,737][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 20:48:40,902][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 20:49:02,377][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 20:49:16,274][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 20:49:36,788][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 20:49:53,560][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 20:50:11,689][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 20:50:23,255][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 20:50:49,547][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 20:51:02,037][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 20:51:14,849][root][INFO] - Processing question number 70
[2025-03-06 20:51:14,853][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 20:51:27,689][root][INFO] - Domain : Property, Question : 9
[2025-03-06 20:51:50,617][root][INFO] - Domain : Property, Question : 17
[2025-03-06 20:52:17,828][root][INFO] - Domain : Property, Question : 25
[2025-03-06 20:52:45,525][root][INFO] - Domain : Property, Question : 30
[2025-03-06 20:53:02,608][root][INFO] - Domain : Property, Question : 36
[2025-03-06 20:53:26,330][root][INFO] - Domain : Property, Question : 46
[2025-03-06 20:53:54,460][root][INFO] - Domain : Property, Question : 53
[2025-03-06 20:54:07,493][root][INFO] - Domain : Property, Question : 59
[2025-03-06 20:54:20,762][root][INFO] - Domain : Property, Question : 66
[2025-03-06 20:54:31,845][root][INFO] - Processing question number 80
[2025-03-06 20:54:31,849][root][INFO] - Domain : Property, Question : 69
[2025-03-06 20:54:54,041][root][INFO] - Domain : Property, Question : 81
[2025-03-06 20:55:16,913][root][INFO] - Domain : Property, Question : 88
[2025-03-06 20:55:27,860][root][INFO] - Domain : Property, Question : 91
[2025-03-06 20:55:54,985][root][INFO] - Domain : Property, Question : 94
[2025-03-06 20:56:23,062][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:56:36,982][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:56:50,029][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 20:57:14,914][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 20:57:32,037][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:57:47,404][root][INFO] - Processing question number 90
[2025-03-06 20:57:47,409][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 20:58:14,448][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 20:58:31,167][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:58:52,561][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 20:59:02,859][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 20:59:24,612][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 20:59:46,616][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 21:00:00,989][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 21:00:19,187][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 21:00:29,996][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:00:40,439][root][INFO] - Inference complete
[2025-03-06 21:00:40,439][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,446][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,448][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,449][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,449][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,452][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,452][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:00:40,452][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,453][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,453][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,453][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,454][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,454][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,454][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,455][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,456][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,456][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,458][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,458][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,458][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,460][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,461][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:00:40,461][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,461][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,461][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,461][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,462][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,462][root][WARNING] - |Q. 36||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:00:40,462][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,462][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,463][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,463][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,464][root][WARNING] - |Q. 91||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,464][root][WARNING] - |Q. 91||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,464][root][INFO] - |Q. 91||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,464][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,464][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:00:40,465][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,466][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:00:40,466][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:00:40,466][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:00:40,468][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,473][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,473][root][INFO] - Saved parsed outputs
[2025-03-06 21:00:40,473][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,475][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,475][root][INFO] - Saved parsing metadata
[2025-03-06 21:00:40,476][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,478][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:00:40,479][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 21:00:40,495][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 21:00:40,496][root][INFO] - Summary of metrics : {'label_accuracy': 0.19, 'misclassification_rate': 0.81, 'combined_accuracy': 0.0, 'malformed_label': 14, 'malformed_domain': 98, 'total_predictions': 100, 'correct_predictions': 19, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 19, 'both_wrong': 79}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 21:00:48,374][root][INFO] - Setting global seed to 989
[2025-03-06 21:00:48,380][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 21:00:48,380][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 21:00:48,381][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:00:48,386][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:00:48,388][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:00:48,388][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:00:48,608][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 21:00:48,872][root][INFO] - Full model selected, loading model
[2025-03-06 21:01:00,622][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 21:01:00,622][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 21:01:07,366][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:01:07,368][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:01:07,368][root][INFO] - Starting inference
[2025-03-06 21:01:07,571][root][INFO] - Processing question number 0
[2025-03-06 21:01:07,573][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 21:01:34,493][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 21:02:02,030][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 21:02:29,699][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 21:02:56,853][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 21:03:23,465][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 21:03:49,522][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 21:04:16,106][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 21:04:42,929][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 21:05:09,073][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 21:05:35,810][root][INFO] - Processing question number 10
[2025-03-06 21:05:35,823][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 21:06:01,764][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 21:06:28,324][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 21:06:54,998][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 21:07:21,140][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 21:07:48,226][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 21:08:14,947][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:08:41,609][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 21:09:08,155][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 21:09:35,203][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 21:10:02,346][root][INFO] - Processing question number 20
[2025-03-06 21:10:02,349][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 21:10:28,383][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 21:10:55,221][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:11:21,603][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 21:11:48,178][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 21:12:14,805][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:12:41,940][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:13:08,630][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:13:35,523][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:14:02,220][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:14:29,467][root][INFO] - Processing question number 30
[2025-03-06 21:14:29,471][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:14:56,211][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:15:22,809][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:15:49,369][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:16:16,591][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:16:43,255][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:17:10,007][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:17:36,729][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:18:04,133][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:18:31,052][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:18:58,007][root][INFO] - Processing question number 40
[2025-03-06 21:18:58,012][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:19:24,850][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:19:51,509][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:20:18,640][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:20:44,706][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:21:12,104][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:21:38,934][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:22:05,615][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:22:32,456][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:22:59,181][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:23:26,262][root][INFO] - Processing question number 50
[2025-03-06 21:23:26,266][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:23:53,641][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:24:19,890][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:24:47,266][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:25:14,244][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:25:40,577][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:26:07,175][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:26:34,669][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:27:01,873][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:27:29,073][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:27:56,090][root][INFO] - Processing question number 60
[2025-03-06 21:27:56,094][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:28:22,871][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:28:49,748][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:29:17,290][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 21:29:44,349][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 21:30:11,333][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 21:30:37,869][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 21:31:04,180][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 21:31:30,343][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 21:31:56,855][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 21:32:23,250][root][INFO] - Processing question number 70
[2025-03-06 21:32:23,255][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 21:32:50,246][root][INFO] - Domain : Property, Question : 9
[2025-03-06 21:33:17,147][root][INFO] - Domain : Property, Question : 17
[2025-03-06 21:33:44,221][root][INFO] - Domain : Property, Question : 25
[2025-03-06 21:34:11,777][root][INFO] - Domain : Property, Question : 30
[2025-03-06 21:34:38,159][root][INFO] - Domain : Property, Question : 36
[2025-03-06 21:35:05,183][root][INFO] - Domain : Property, Question : 46
[2025-03-06 21:35:33,168][root][INFO] - Domain : Property, Question : 53
[2025-03-06 21:36:00,211][root][INFO] - Domain : Property, Question : 59
[2025-03-06 21:36:26,484][root][INFO] - Domain : Property, Question : 66
[2025-03-06 21:36:53,089][root][INFO] - Processing question number 80
[2025-03-06 21:36:53,093][root][INFO] - Domain : Property, Question : 69
[2025-03-06 21:37:20,531][root][INFO] - Domain : Property, Question : 81
[2025-03-06 21:37:47,994][root][INFO] - Domain : Property, Question : 88
[2025-03-06 21:38:15,388][root][INFO] - Domain : Property, Question : 91
[2025-03-06 21:38:42,424][root][INFO] - Domain : Property, Question : 94
[2025-03-06 21:39:10,413][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:39:37,063][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:40:04,242][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 21:40:31,960][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 21:40:58,880][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:41:15,909][root][INFO] - Processing question number 90
[2025-03-06 21:41:15,934][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 21:41:42,870][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 21:42:10,115][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:42:37,176][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 21:43:04,026][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 21:43:31,539][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 21:43:58,943][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 21:44:26,019][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 21:44:52,664][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 21:45:18,848][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:45:46,277][root][INFO] - Inference complete
[2025-03-06 21:45:46,278][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,284][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,286][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,286][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,287][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,288][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,289][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,289][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,289][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,290][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,290][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,290][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,290][root][WARNING] - |Q. 86||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,290][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,291][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,291][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,292][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,292][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,292][root][WARNING] - |Q. 37||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,293][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,293][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,294][root][WARNING] - |Q. 76||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,294][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,295][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,295][root][WARNING] - |Q. 89||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,295][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,298][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,298][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,298][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,298][root][WARNING] - |Q. 97||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,299][root][WARNING] - |Q. 97||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,299][root][INFO] - |Q. 97||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,299][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,299][root][WARNING] - |Q. 4||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,299][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,300][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,301][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,301][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,303][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,304][root][WARNING] - |Q. 90||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,304][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,304][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,304][root][WARNING] - |Q. 98||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,304][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,306][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,307][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,307][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,309][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,309][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,309][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,310][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,310][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,310][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,310][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,311][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,311][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,312][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,312][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,312][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,313][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,313][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,313][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,313][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,314][root][WARNING] - |Q. 17||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,314][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,316][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,316][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,316][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,318][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,318][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,318][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,319][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,319][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,319][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,322][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,322][root][WARNING] - |Q. 39||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,323][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,323][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,324][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,324][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,324][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,324][root][WARNING] - |Q. 63||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,324][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,325][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,325][root][WARNING] - |Q. 67||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:45:46,325][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,325][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:45:46,326][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:45:46,326][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:45:46,327][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,426][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,426][root][INFO] - Saved parsed outputs
[2025-03-06 21:45:46,426][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,428][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,428][root][INFO] - Saved parsing metadata
[2025-03-06 21:45:46,429][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,431][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:45:46,432][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 21:45:46,482][root][INFO] - Evaluation completed for json_fact_first_zero_shot_structured, on test_set_2
[2025-03-06 21:45:46,482][root][INFO] - Summary of metrics : {'label_accuracy': 0.17, 'misclassification_rate': 0.83, 'combined_accuracy': 0.0, 'malformed_label': 38, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 17, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 17, 'both_wrong': 83}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 13 to status completed with exit code 0
Eval status update completed for job 13
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '13', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 13 to status running with exit code None
Eval status update completed for job 13
[2025-03-06 21:45:58,279][root][INFO] - Setting global seed to 989
[2025-03-06 21:45:58,287][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 21:45:58,288][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 21:45:58,289][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:45:58,290][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:45:58,296][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:45:58,296][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:45:58,489][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-03-06 21:45:58,776][root][INFO] - Full model selected, loading model
[2025-03-06 21:46:18,516][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-03-06 21:47:25,931][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 21:47:25,931][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 21:47:53,440][root][INFO] - Peft model loaded successfully
[2025-03-06 21:47:59,711][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:47:59,714][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_structured/test_set_2.json
[2025-03-06 21:47:59,714][root][INFO] - Starting inference
[2025-03-06 21:47:59,957][root][INFO] - Processing question number 0
[2025-03-06 21:47:59,959][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 21:48:13,869][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 21:48:36,318][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 21:49:04,305][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 21:49:26,643][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 21:49:37,175][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 21:49:45,739][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 21:49:55,442][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 21:50:03,571][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 21:50:13,223][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 21:50:27,245][root][INFO] - Processing question number 10
[2025-03-06 21:50:27,247][root][INFO] - Domain : Constitutional_law, Question : 70
