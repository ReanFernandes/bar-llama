Starting job 24 at Thu Mar  6 19:02:58 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_10_samples prompt=json_answer_first_zero_shot_unstructured train=json_answer_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '24', 'training']
Updating job 24 to status training with exit code None
Status update completed for job 24
[2025-03-06 19:03:13,307][root][INFO] - Global seed set to 314
[2025-03-06 19:03:13,308][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 19:03:13,308][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 19:03:13,308][root][INFO] - Running Fine-tuning on the all_domains_10_samples dataset
[2025-03-06 19:03:13,308][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 19:03:13,309][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-03-06 19:03:13,325][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:03:13,366][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 19:03:13,369][root][INFO] - Questions selected, dataset contains 70 questions with 10.0 questions per domain
[2025-03-06 19:03:13,373][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 19:03:14,144][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 19:03:37,992][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 19:04:08,547][root][INFO] - Model prepared for kbit training
[2025-03-06 19:04:08,548][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'v_proj', 'down_proj', 'up_proj', 'gate_proj', 'k_proj', 'q_proj', 'o_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 19:04:10,287][root][INFO] - Lora adapter added to model
[2025-03-06 19:04:10,290][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_10_samples/llama3_json_answer_first_zero_shot_unstructured
[2025-03-06 19:04:10,542][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 2.0397, 'grad_norm': 0.602130651473999, 'learning_rate': 2e-05, 'epoch': 0.3}
{'loss': 2.1288, 'grad_norm': 0.716541051864624, 'learning_rate': 4e-05, 'epoch': 0.6}
{'loss': 1.7495, 'grad_norm': 0.4190259277820587, 'learning_rate': 6e-05, 'epoch': 0.9}
{'loss': 1.6969, 'grad_norm': 0.46270886063575745, 'learning_rate': 8e-05, 'epoch': 1.2}
{'loss': 1.4107, 'grad_norm': 0.8887903690338135, 'learning_rate': 0.0001, 'epoch': 1.5}
{'loss': 1.244, 'grad_norm': 0.3868309259414673, 'learning_rate': 9.951340343707852e-05, 'epoch': 1.8}
{'loss': 1.2005, 'grad_norm': 0.34616610407829285, 'learning_rate': 9.806308479691595e-05, 'epoch': 2.1}
{'loss': 1.081, 'grad_norm': 0.42374828457832336, 'learning_rate': 9.567727288213005e-05, 'epoch': 2.4}
{'loss': 1.1273, 'grad_norm': 0.28637048602104187, 'learning_rate': 9.24024048078213e-05, 'epoch': 2.7}
{'loss': 1.1186, 'grad_norm': 0.4019010663032532, 'learning_rate': 8.83022221559489e-05, 'epoch': 3.0}
{'loss': 1.0635, 'grad_norm': 0.3532666265964508, 'learning_rate': 8.345653031794292e-05, 'epoch': 3.3}
{'loss': 0.9681, 'grad_norm': 0.50178462266922, 'learning_rate': 7.795964517353735e-05, 'epoch': 3.6}
{'loss': 0.9619, 'grad_norm': 0.3920118510723114, 'learning_rate': 7.191855733945387e-05, 'epoch': 3.9}
{'loss': 0.9616, 'grad_norm': 0.47085586190223694, 'learning_rate': 6.545084971874738e-05, 'epoch': 4.2}
{'loss': 0.7772, 'grad_norm': 0.4923543334007263, 'learning_rate': 5.868240888334653e-05, 'epoch': 4.5}
{'loss': 0.812, 'grad_norm': 0.47081199288368225, 'learning_rate': 5.174497483512506e-05, 'epoch': 4.8}
{'loss': 0.8406, 'grad_norm': 0.5188802480697632, 'learning_rate': 4.477357683661734e-05, 'epoch': 5.1}
{'loss': 0.6867, 'grad_norm': 0.581393301486969, 'learning_rate': 3.790390522001662e-05, 'epoch': 5.4}
{'loss': 0.6876, 'grad_norm': 0.7980597615242004, 'learning_rate': 3.12696703292044e-05, 'epoch': 5.7}
{'loss': 0.688, 'grad_norm': 0.6067256331443787, 'learning_rate': 2.500000000000001e-05, 'epoch': 6.0}
{'loss': 0.6683, 'grad_norm': 0.6659826636314392, 'learning_rate': 1.9216926233717085e-05, 'epoch': 6.3}
{'loss': 0.5041, 'grad_norm': 0.6178848147392273, 'learning_rate': 1.4033009983067452e-05, 'epoch': 6.6}
{'loss': 0.633, 'grad_norm': 0.8341742753982544, 'learning_rate': 9.549150281252633e-06, 'epoch': 6.9}
{'loss': 0.5504, 'grad_norm': 0.719393253326416, 'learning_rate': 5.852620357053651e-06, 'epoch': 7.2}
{'loss': 0.5583, 'grad_norm': 0.6249167323112488, 'learning_rate': 3.0153689607045845e-06, 'epoch': 7.5}
{'loss': 0.5829, 'grad_norm': 0.7010378241539001, 'learning_rate': 1.0926199633097157e-06, 'epoch': 7.8}
{'loss': 0.5942, 'grad_norm': 0.6251422762870789, 'learning_rate': 1.2179748700879012e-07, 'epoch': 8.1}
{'loss': 0.5063, 'grad_norm': 0.6417727470397949, 'learning_rate': 9.987820251299122e-05, 'epoch': 8.4}
{'loss': 0.5264, 'grad_norm': 0.8776624798774719, 'learning_rate': 9.890738003669029e-05, 'epoch': 8.7}
{'loss': 0.4062, 'grad_norm': 1.1335418224334717, 'learning_rate': 9.698463103929542e-05, 'epoch': 9.0}
{'loss': 0.3833, 'grad_norm': 1.5270771980285645, 'learning_rate': 9.414737964294636e-05, 'epoch': 9.3}
{'loss': 0.2868, 'grad_norm': 1.2956610918045044, 'learning_rate': 9.045084971874738e-05, 'epoch': 9.6}
{'loss': 0.3309, 'grad_norm': 1.402155876159668, 'learning_rate': 8.596699001693255e-05, 'epoch': 9.9}
{'loss': 0.1829, 'grad_norm': 0.7881399393081665, 'learning_rate': 8.07830737662829e-05, 'epoch': 10.2}
{'loss': 0.2255, 'grad_norm': 1.4871553182601929, 'learning_rate': 7.500000000000002e-05, 'epoch': 10.5}
{'loss': 0.1642, 'grad_norm': 1.1594749689102173, 'learning_rate': 6.873032967079561e-05, 'epoch': 10.8}
{'loss': 0.2322, 'grad_norm': 1.047223687171936, 'learning_rate': 6.209609477998338e-05, 'epoch': 11.1}
{'loss': 0.0889, 'grad_norm': 1.0293865203857422, 'learning_rate': 5.52264231633827e-05, 'epoch': 11.4}
{'loss': 0.1302, 'grad_norm': 0.8531416058540344, 'learning_rate': 4.825502516487497e-05, 'epoch': 11.7}
{'loss': 0.0849, 'grad_norm': 0.9406971335411072, 'learning_rate': 4.131759111665349e-05, 'epoch': 12.0}
{'loss': 0.0691, 'grad_norm': 0.798175573348999, 'learning_rate': 3.454915028125262e-05, 'epoch': 12.3}
{'loss': 0.0518, 'grad_norm': 0.6177067756652832, 'learning_rate': 2.8081442660546142e-05, 'epoch': 12.6}
{'loss': 0.0606, 'grad_norm': 0.6351093053817749, 'learning_rate': 2.2040354826462668e-05, 'epoch': 12.9}
{'loss': 0.0342, 'grad_norm': 0.1922827810049057, 'learning_rate': 1.654346968205709e-05, 'epoch': 13.2}
{'loss': 0.036, 'grad_norm': 0.4357302784919739, 'learning_rate': 1.1697777844051105e-05, 'epoch': 13.5}
{'loss': 0.0412, 'grad_norm': 0.5030375123023987, 'learning_rate': 7.597595192178702e-06, 'epoch': 13.8}
{'loss': 0.0278, 'grad_norm': 0.27381011843681335, 'learning_rate': 4.322727117869951e-06, 'epoch': 14.1}
{'loss': 0.0276, 'grad_norm': 0.23856022953987122, 'learning_rate': 1.93691520308405e-06, 'epoch': 14.4}
{'loss': 0.0291, 'grad_norm': 0.28810182213783264, 'learning_rate': 4.865965629214875e-07, 'epoch': 14.7}
{'loss': 0.0256, 'grad_norm': 0.2274428904056549, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 2506.3848, 'train_samples_per_second': 0.419, 'train_steps_per_second': 0.06, 'train_loss': 0.6257320754726727, 'epoch': 15.0}
[2025-03-06 19:46:04,608][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_10_samples/llama3_json_answer_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '24', 'trained', '0']
Updating job 24 to status trained with exit code 0
Status update completed for job 24
Starting evaluations for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 19:46:36,969][root][INFO] - Setting global seed to 206
[2025-03-06 19:46:37,047][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 19:46:37,047][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 19:46:37,048][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 19:46:37,063][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 19:46:37,105][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 19:46:37,105][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 19:46:37,294][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 19:46:37,830][root][INFO] - Full model selected, loading model
[2025-03-06 19:46:57,230][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 19:48:46,998][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 19:48:46,999][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 19:49:19,564][root][INFO] - Peft model loaded successfully
[2025-03-06 19:49:26,932][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 19:49:26,934][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 19:49:26,934][root][INFO] - Starting inference
[2025-03-06 19:49:27,292][root][INFO] - Processing question number 0
[2025-03-06 19:49:27,294][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 19:49:32,761][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 19:49:42,492][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 19:49:55,097][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 19:50:23,757][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 19:50:44,258][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 19:51:00,410][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 19:51:28,362][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 19:51:50,182][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 19:52:02,276][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 19:52:14,367][root][INFO] - Processing question number 10
[2025-03-06 19:52:14,369][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 19:52:30,381][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 19:52:37,960][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 19:53:02,918][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 19:53:16,635][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 19:53:38,960][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 19:54:06,500][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 19:54:16,991][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 19:54:21,526][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 19:54:25,479][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 19:54:29,959][root][INFO] - Processing question number 20
[2025-03-06 19:54:29,961][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 19:54:34,489][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 19:54:41,259][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 19:54:52,139][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 19:55:05,706][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 19:55:11,557][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 19:55:33,031][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 19:55:39,359][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 19:55:46,865][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 19:56:02,193][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 19:56:10,238][root][INFO] - Processing question number 30
[2025-03-06 19:56:10,240][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 19:56:21,336][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 19:56:28,745][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 19:56:37,487][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 19:56:44,672][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 19:56:49,694][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 19:57:00,947][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 19:57:12,007][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 19:57:30,884][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 19:57:38,057][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 19:57:41,939][root][INFO] - Processing question number 40
[2025-03-06 19:57:41,942][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 19:57:54,276][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 19:58:01,819][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 19:58:07,820][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 19:58:19,969][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 19:58:30,017][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 19:58:46,294][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 19:58:53,700][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 19:58:57,359][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 19:59:01,449][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 19:59:15,949][root][INFO] - Processing question number 50
[2025-03-06 19:59:15,952][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 19:59:25,993][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 19:59:40,611][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 19:59:47,668][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 19:59:58,009][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 20:00:03,183][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:00:15,089][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 20:00:25,689][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 20:00:31,388][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 20:00:43,251][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 20:01:00,249][root][INFO] - Processing question number 60
[2025-03-06 20:01:00,252][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:01:13,397][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:01:22,027][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 20:01:30,164][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 20:01:38,688][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 20:01:53,046][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 20:01:57,949][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 20:02:09,711][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 20:02:20,647][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:02:25,056][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 20:02:34,557][root][INFO] - Processing question number 70
[2025-03-06 20:02:34,561][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 20:02:42,332][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 20:02:52,064][root][INFO] - Domain : Property, Question : 6
[2025-03-06 20:03:01,698][root][INFO] - Domain : Property, Question : 13
[2025-03-06 20:03:11,153][root][INFO] - Domain : Property, Question : 20
[2025-03-06 20:03:22,813][root][INFO] - Domain : Property, Question : 33
[2025-03-06 20:03:29,859][root][INFO] - Domain : Property, Question : 39
[2025-03-06 20:03:35,504][root][INFO] - Domain : Property, Question : 48
[2025-03-06 20:03:59,539][root][INFO] - Domain : Property, Question : 54
[2025-03-06 20:04:06,172][root][INFO] - Domain : Property, Question : 61
[2025-03-06 20:04:19,034][root][INFO] - Processing question number 80
[2025-03-06 20:04:19,038][root][INFO] - Domain : Property, Question : 67
[2025-03-06 20:04:29,622][root][INFO] - Domain : Property, Question : 75
[2025-03-06 20:04:39,245][root][INFO] - Domain : Property, Question : 83
[2025-03-06 20:04:48,451][root][INFO] - Domain : Property, Question : 89
[2025-03-06 20:04:55,807][root][INFO] - Domain : Property, Question : 97
[2025-03-06 20:05:02,815][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:05:15,653][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 20:05:20,644][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:05:34,692][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 20:05:41,686][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 20:05:49,020][root][INFO] - Processing question number 90
[2025-03-06 20:05:49,024][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 20:05:55,667][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 20:06:13,446][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 20:06:22,283][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 20:06:24,462][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:06:29,051][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 20:06:34,565][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 20:06:40,657][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 20:06:50,970][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 20:07:01,186][root][INFO] - Inference complete
[2025-03-06 20:07:01,186][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,193][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,194][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,195][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,195][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,195][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,196][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:07:01,196][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,196][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:07:01,196][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,197][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:07:01,197][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,197][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:07:01,197][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,197][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:07:01,198][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,198][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:07:01,198][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,198][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,198][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,199][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,200][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,200][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,200][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,200][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,200][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,201][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,201][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,201][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,201][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,201][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,202][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,202][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,202][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,202][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,203][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,203][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,203][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,203][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,203][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,204][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,206][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,206][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,206][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,207][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,207][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,207][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,208][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,209][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,209][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,209][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,209][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,209][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,210][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,210][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,210][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,210][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,211][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,211][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,212][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:07:01,212][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:07:01,212][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:07:01,214][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,219][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,219][root][INFO] - Saved parsed outputs
[2025-03-06 20:07:01,219][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,220][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,220][root][INFO] - Saved parsing metadata
[2025-03-06 20:07:01,221][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,223][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:07:01,225][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 20:07:01,290][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 20:07:01,290][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 0, 'malformed_domain': 10, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.15151515151515152, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.16161616161616163, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 3, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 20:07:11,241][root][INFO] - Setting global seed to 206
[2025-03-06 20:07:11,262][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 20:07:11,262][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 20:07:11,263][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 20:07:11,265][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:07:11,268][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:07:11,268][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 20:07:11,451][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 20:07:11,994][root][INFO] - Full model selected, loading model
[2025-03-06 20:07:39,631][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:09:31,918][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:09:31,918][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:10:05,824][root][INFO] - Peft model loaded successfully
[2025-03-06 20:10:13,098][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:10:13,100][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:10:13,101][root][INFO] - Starting inference
[2025-03-06 20:10:13,214][root][INFO] - Processing question number 0
[2025-03-06 20:10:13,216][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 20:10:19,209][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 20:10:29,028][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 20:10:49,535][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 20:11:07,129][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 20:11:27,694][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 20:11:37,191][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 20:11:55,083][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 20:12:15,063][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 20:12:26,784][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 20:12:39,905][root][INFO] - Processing question number 10
[2025-03-06 20:12:39,906][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 20:12:45,600][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 20:12:52,638][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 20:13:13,523][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 20:13:23,712][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 20:13:33,686][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 20:14:01,828][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 20:14:12,184][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 20:14:16,812][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 20:14:23,811][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 20:14:29,519][root][INFO] - Processing question number 20
[2025-03-06 20:14:29,521][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 20:14:37,440][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 20:14:42,899][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 20:14:49,886][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 20:15:02,039][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 20:15:08,697][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 20:15:17,844][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 20:15:24,241][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 20:15:31,451][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 20:15:42,707][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 20:15:51,281][root][INFO] - Processing question number 30
[2025-03-06 20:15:51,283][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:16:01,842][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 20:16:09,188][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 20:16:19,044][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 20:16:29,182][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 20:16:35,698][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 20:16:50,995][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 20:17:05,494][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 20:17:21,334][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:17:29,033][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 20:17:32,950][root][INFO] - Processing question number 40
[2025-03-06 20:17:32,953][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:17:44,379][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 20:17:52,409][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 20:18:00,590][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 20:18:10,132][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 20:18:24,982][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:18:35,679][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 20:18:42,349][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:18:46,043][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 20:18:51,116][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 20:19:09,790][root][INFO] - Processing question number 50
[2025-03-06 20:19:09,793][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:19:25,179][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 20:19:41,606][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 20:19:46,489][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 20:19:56,926][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 20:20:01,785][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:20:13,812][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 20:20:23,849][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 20:20:30,777][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 20:20:40,733][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 20:20:52,356][root][INFO] - Processing question number 60
[2025-03-06 20:20:52,359][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:20:57,087][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:21:03,555][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 20:21:12,046][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 20:21:21,483][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 20:21:29,689][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 20:21:35,091][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 20:21:46,398][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 20:21:55,580][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:22:00,536][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 20:22:09,944][root][INFO] - Processing question number 70
[2025-03-06 20:22:09,948][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 20:22:17,796][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 20:22:33,360][root][INFO] - Domain : Property, Question : 6
[2025-03-06 20:22:46,338][root][INFO] - Domain : Property, Question : 13
[2025-03-06 20:22:54,399][root][INFO] - Domain : Property, Question : 20
[2025-03-06 20:23:06,262][root][INFO] - Domain : Property, Question : 33
[2025-03-06 20:23:09,784][root][INFO] - Domain : Property, Question : 39
[2025-03-06 20:23:16,817][root][INFO] - Domain : Property, Question : 48
[2025-03-06 20:23:34,060][root][INFO] - Domain : Property, Question : 54
[2025-03-06 20:23:43,256][root][INFO] - Domain : Property, Question : 61
[2025-03-06 20:23:53,918][root][INFO] - Processing question number 80
[2025-03-06 20:23:53,922][root][INFO] - Domain : Property, Question : 67
[2025-03-06 20:24:10,365][root][INFO] - Domain : Property, Question : 75
[2025-03-06 20:24:24,641][root][INFO] - Domain : Property, Question : 83
[2025-03-06 20:24:30,248][root][INFO] - Domain : Property, Question : 89
[2025-03-06 20:24:39,332][root][INFO] - Domain : Property, Question : 97
[2025-03-06 20:24:46,317][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:24:51,453][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 20:25:01,258][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:25:19,030][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 20:25:26,596][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 20:25:38,999][root][INFO] - Processing question number 90
[2025-03-06 20:25:39,003][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 20:25:45,794][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 20:25:59,478][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 20:26:08,443][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 20:26:10,644][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:26:16,469][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 20:26:23,479][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 20:26:32,103][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 20:26:40,207][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 20:26:58,371][root][INFO] - Inference complete
[2025-03-06 20:26:58,371][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,376][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,377][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,378][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,378][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,378][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,378][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,378][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,379][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,379][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,379][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,379][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,379][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:26:58,380][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,380][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:26:58,380][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,380][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,381][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,381][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,381][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,381][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,381][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,382][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,382][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,383][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,383][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:26:58,383][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,383][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:26:58,383][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,384][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:26:58,384][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,384][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:26:58,385][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,385][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,385][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,386][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,386][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:26:58,386][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,386][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:26:58,388][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,388][root][WARNING] - |Q. 4||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,388][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,389][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,389][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,389][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,389][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,389][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,389][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,390][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,390][root][WARNING] - |Q. 5||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,390][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,392][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,392][root][WARNING] - |Q. 96||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,392][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,392][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,393][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,393][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,393][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,394][root][WARNING] - |Q. 48||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,394][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,394][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,394][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,394][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,396][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:26:58,397][root][WARNING] - |Q. 92||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:26:58,397][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:26:58,397][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,402][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,402][root][INFO] - Saved parsed outputs
[2025-03-06 20:26:58,402][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,403][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,403][root][INFO] - Saved parsing metadata
[2025-03-06 20:26:58,404][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,405][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:26:58,406][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 20:26:58,439][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 20:26:58,439][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 0, 'malformed_domain': 9, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.16161616161616163, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 2, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 20:27:10,735][root][INFO] - Setting global seed to 206
[2025-03-06 20:27:10,815][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 20:27:10,815][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 20:27:10,817][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 20:27:10,818][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:27:10,822][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:27:10,822][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 20:27:10,992][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 20:27:11,642][root][INFO] - Full model selected, loading model
[2025-03-06 20:27:42,207][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:29:33,238][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:29:33,239][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:30:06,867][root][INFO] - Peft model loaded successfully
[2025-03-06 20:30:14,091][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:30:14,092][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:30:14,092][root][INFO] - Starting inference
[2025-03-06 20:30:14,217][root][INFO] - Processing question number 0
[2025-03-06 20:30:14,220][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 20:30:21,240][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 20:30:34,931][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 20:30:51,469][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 20:31:08,214][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 20:31:23,754][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 20:31:48,537][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 20:32:03,176][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 20:32:13,489][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 20:32:24,017][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 20:32:44,268][root][INFO] - Processing question number 10
[2025-03-06 20:32:44,270][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 20:32:56,793][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 20:33:04,607][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 20:33:19,168][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 20:33:30,969][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 20:33:37,890][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 20:34:02,032][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 20:34:09,261][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 20:34:13,482][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 20:34:20,290][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 20:34:27,853][root][INFO] - Processing question number 20
[2025-03-06 20:34:27,855][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 20:34:32,381][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 20:34:36,065][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 20:34:41,998][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 20:34:51,196][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 20:34:57,659][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 20:35:03,322][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 20:35:07,725][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 20:35:16,505][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 20:35:27,433][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 20:35:35,842][root][INFO] - Processing question number 30
[2025-03-06 20:35:35,844][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:35:46,126][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 20:35:57,116][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 20:36:15,383][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 20:36:23,191][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 20:36:30,256][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 20:36:39,749][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 20:36:53,409][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 20:37:07,697][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:37:18,690][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 20:37:25,352][root][INFO] - Processing question number 40
[2025-03-06 20:37:25,354][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:37:40,891][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 20:37:48,771][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 20:37:57,794][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 20:38:06,805][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 20:38:16,953][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:38:33,799][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 20:38:40,773][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:38:44,510][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 20:38:53,465][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 20:39:04,466][root][INFO] - Processing question number 50
[2025-03-06 20:39:04,469][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:39:13,994][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 20:39:28,048][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 20:39:36,853][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 20:39:50,503][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 20:39:54,886][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 20:40:02,222][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 20:40:10,314][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 20:40:17,824][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 20:40:27,838][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 20:40:40,593][root][INFO] - Processing question number 60
[2025-03-06 20:40:40,596][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 20:40:53,831][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 20:41:03,517][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 20:41:09,332][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 20:41:15,137][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 20:41:22,933][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 20:41:27,976][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 20:41:56,592][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 20:42:05,595][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 20:42:10,415][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 20:42:18,620][root][INFO] - Processing question number 70
[2025-03-06 20:42:18,624][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 20:42:26,746][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 20:42:32,145][root][INFO] - Domain : Property, Question : 6
[2025-03-06 20:42:39,216][root][INFO] - Domain : Property, Question : 13
[2025-03-06 20:42:48,393][root][INFO] - Domain : Property, Question : 20
[2025-03-06 20:42:56,528][root][INFO] - Domain : Property, Question : 33
[2025-03-06 20:43:05,296][root][INFO] - Domain : Property, Question : 39
[2025-03-06 20:43:15,219][root][INFO] - Domain : Property, Question : 48
[2025-03-06 20:43:25,805][root][INFO] - Domain : Property, Question : 54
[2025-03-06 20:43:30,525][root][INFO] - Domain : Property, Question : 61
[2025-03-06 20:43:35,417][root][INFO] - Processing question number 80
[2025-03-06 20:43:35,421][root][INFO] - Domain : Property, Question : 67
[2025-03-06 20:43:48,272][root][INFO] - Domain : Property, Question : 75
[2025-03-06 20:43:56,276][root][INFO] - Domain : Property, Question : 83
[2025-03-06 20:44:03,471][root][INFO] - Domain : Property, Question : 89
[2025-03-06 20:44:11,691][root][INFO] - Domain : Property, Question : 97
[2025-03-06 20:44:19,788][root][INFO] - Domain : Property, Question : 100
[2025-03-06 20:44:29,513][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 20:44:36,535][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 20:44:45,807][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 20:44:54,717][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 20:45:06,895][root][INFO] - Processing question number 90
[2025-03-06 20:45:06,898][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 20:45:20,020][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 20:45:31,965][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 20:45:40,568][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 20:45:45,114][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 20:45:50,207][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 20:45:56,861][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 20:46:10,166][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 20:46:16,256][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 20:46:35,880][root][INFO] - Inference complete
[2025-03-06 20:46:35,880][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,885][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,886][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,886][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,887][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,887][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,887][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,887][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,888][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,888][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,888][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,889][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,889][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,889][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,890][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,890][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,890][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,890][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,890][root][WARNING] - |Q. 2||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:46:35,891][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,891][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:46:35,892][root][WARNING] - |Q. 55||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,892][root][WARNING] - |Q. 55||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,892][root][INFO] - |Q. 55||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,895][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,895][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,895][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,897][root][WARNING] - |Q. 59||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,897][root][WARNING] - |Q. 59||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 20:46:35,897][root][INFO] - |Q. 59||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,897][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 20:46:35,898][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,898][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,898][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,899][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,899][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,900][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,901][root][WARNING] - |Q. 92||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 20:46:35,902][root][WARNING] - |Q. 92||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 20:46:35,902][root][INFO] - |Q. 92||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 20:46:35,903][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,907][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,907][root][INFO] - Saved parsed outputs
[2025-03-06 20:46:35,907][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,908][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,908][root][INFO] - Saved parsing metadata
[2025-03-06 20:46:35,909][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,910][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:46:35,911][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 20:46:35,946][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 20:46:35,946][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.43434343434343436, 'malformed_label': 0, 'malformed_domain': 10, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 43, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.42857142857142855, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.15151515151515152, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.16161616161616163, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 3, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 20:46:44,732][root][INFO] - Setting global seed to 989
[2025-03-06 20:46:44,741][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 20:46:44,741][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 20:46:44,742][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 20:46:44,744][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 20:46:44,746][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 20:46:44,746][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 20:46:44,920][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 20:46:45,477][root][INFO] - Full model selected, loading model
[2025-03-06 20:47:12,113][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 20:48:58,639][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 20:48:58,640][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 20:49:32,274][root][INFO] - Peft model loaded successfully
[2025-03-06 20:49:39,570][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 20:49:39,572][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 20:49:39,572][root][INFO] - Starting inference
[2025-03-06 20:49:39,676][root][INFO] - Processing question number 0
[2025-03-06 20:49:39,678][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 20:49:45,017][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 20:49:54,659][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 20:50:07,177][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 20:50:35,660][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 20:50:56,033][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 20:51:12,012][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 20:51:39,754][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 20:52:01,407][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 20:52:13,390][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 20:52:25,414][root][INFO] - Processing question number 10
[2025-03-06 20:52:25,415][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 20:52:41,362][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 20:52:48,873][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 20:53:13,612][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 20:53:27,316][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 20:53:49,478][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 20:54:16,853][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 20:54:27,350][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 20:54:31,891][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 20:54:35,848][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 20:54:40,329][root][INFO] - Processing question number 20
[2025-03-06 20:54:40,332][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 20:54:44,862][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 20:54:51,634][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 20:55:02,520][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 20:55:16,096][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 20:55:21,953][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 20:55:43,448][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 20:55:49,779][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 20:55:57,293][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 20:56:12,626][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 20:56:20,679][root][INFO] - Processing question number 30
[2025-03-06 20:56:20,681][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 20:56:31,784][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 20:56:39,201][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 20:56:47,947][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 20:56:55,141][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 20:57:00,166][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 20:57:11,428][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 20:57:22,497][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 20:57:41,388][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 20:57:48,560][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 20:57:52,446][root][INFO] - Processing question number 40
[2025-03-06 20:57:52,448][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 20:58:04,789][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 20:58:12,339][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 20:58:18,344][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 20:58:30,503][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 20:58:40,555][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 20:58:56,842][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 20:59:04,250][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 20:59:07,911][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 20:59:12,000][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 20:59:26,517][root][INFO] - Processing question number 50
[2025-03-06 20:59:26,520][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 20:59:36,567][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 20:59:51,199][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 20:59:58,261][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 21:00:08,612][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 21:00:13,791][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:00:25,705][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 21:00:36,313][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 21:00:42,022][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 21:00:53,903][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 21:01:10,960][root][INFO] - Processing question number 60
[2025-03-06 21:01:10,963][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:01:24,233][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:01:32,964][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 21:01:41,256][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 21:01:49,957][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 21:02:04,467][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 21:02:09,420][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 21:02:21,297][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 21:02:32,266][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:02:36,700][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 21:02:46,297][root][INFO] - Processing question number 70
[2025-03-06 21:02:46,301][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 21:02:54,154][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 21:03:03,987][root][INFO] - Domain : Property, Question : 6
[2025-03-06 21:03:13,725][root][INFO] - Domain : Property, Question : 13
[2025-03-06 21:03:23,211][root][INFO] - Domain : Property, Question : 20
[2025-03-06 21:03:34,913][root][INFO] - Domain : Property, Question : 33
[2025-03-06 21:03:41,998][root][INFO] - Domain : Property, Question : 39
[2025-03-06 21:03:47,700][root][INFO] - Domain : Property, Question : 48
[2025-03-06 21:04:11,979][root][INFO] - Domain : Property, Question : 54
[2025-03-06 21:04:18,625][root][INFO] - Domain : Property, Question : 61
[2025-03-06 21:04:31,501][root][INFO] - Processing question number 80
[2025-03-06 21:04:31,505][root][INFO] - Domain : Property, Question : 67
[2025-03-06 21:04:42,090][root][INFO] - Domain : Property, Question : 75
[2025-03-06 21:04:51,721][root][INFO] - Domain : Property, Question : 83
[2025-03-06 21:05:00,938][root][INFO] - Domain : Property, Question : 89
[2025-03-06 21:05:08,308][root][INFO] - Domain : Property, Question : 97
[2025-03-06 21:05:15,323][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:05:28,172][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 21:05:33,166][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:05:47,227][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 21:05:54,225][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 21:06:01,566][root][INFO] - Processing question number 90
[2025-03-06 21:06:01,570][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 21:06:08,216][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 21:06:26,024][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 21:06:34,869][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 21:06:37,051][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:06:41,646][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 21:06:47,164][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 21:06:53,261][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 21:07:03,605][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 21:07:13,893][root][INFO] - Inference complete
[2025-03-06 21:07:13,894][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,901][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,903][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,903][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,903][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,904][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,904][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:07:13,904][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,905][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:07:13,905][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,905][root][WARNING] - |Q. 28||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:07:13,905][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,905][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:07:13,906][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,906][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:07:13,906][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,906][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:07:13,906][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,907][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,907][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,908][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,908][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,908][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,909][root][WARNING] - |Q. 2||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,909][root][WARNING] - |Q. 2||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,909][root][INFO] - |Q. 2||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,910][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,910][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,910][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,910][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,911][root][WARNING] - |Q. 43||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,911][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,911][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,912][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,912][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,912][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,912][root][WARNING] - |Q. 79||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,912][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,912][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,913][root][WARNING] - |Q. 87||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,913][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,915][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,916][root][WARNING] - |Q. 47||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,916][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,916][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,916][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,916][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,918][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,918][root][WARNING] - |Q. 44||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,918][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,919][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,919][root][WARNING] - |Q. 68||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,919][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,920][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,920][root][WARNING] - |Q. 6||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,920][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,920][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,920][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,920][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,921][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:07:13,922][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:07:13,922][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:07:13,924][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,929][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,929][root][INFO] - Saved parsed outputs
[2025-03-06 21:07:13,929][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,930][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,930][root][INFO] - Saved parsing metadata
[2025-03-06 21:07:13,933][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,934][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:07:13,936][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 21:07:13,944][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 21:07:13,944][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 0, 'malformed_domain': 10, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.15151515151515152, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.16161616161616163, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 3, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 21:07:21,073][root][INFO] - Setting global seed to 989
[2025-03-06 21:07:21,079][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 21:07:21,079][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 21:07:21,080][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 21:07:21,082][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:07:21,084][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:07:21,084][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 21:07:21,236][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 21:07:21,859][root][INFO] - Full model selected, loading model
[2025-03-06 21:07:45,986][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 21:09:34,949][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 21:09:34,967][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 21:10:08,662][root][INFO] - Peft model loaded successfully
[2025-03-06 21:10:16,310][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:10:16,313][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:10:16,313][root][INFO] - Starting inference
[2025-03-06 21:10:16,435][root][INFO] - Processing question number 0
[2025-03-06 21:10:16,437][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 21:10:21,898][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 21:10:37,946][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 21:10:49,826][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 21:11:03,368][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 21:11:20,633][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 21:11:38,214][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 21:12:01,302][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 21:12:07,648][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 21:12:16,464][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 21:12:30,895][root][INFO] - Processing question number 10
[2025-03-06 21:12:30,896][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 21:12:44,521][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 21:12:51,555][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 21:13:15,970][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 21:13:23,315][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 21:13:34,601][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 21:14:02,701][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 21:14:12,055][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 21:14:19,824][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 21:14:25,074][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 21:14:30,134][root][INFO] - Processing question number 20
[2025-03-06 21:14:30,136][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 21:14:34,702][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 21:14:49,306][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 21:14:56,672][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 21:15:11,115][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 21:15:18,996][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 21:15:31,368][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 21:15:37,799][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 21:15:45,236][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 21:15:55,178][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 21:16:02,446][root][INFO] - Processing question number 30
[2025-03-06 21:16:02,448][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:16:13,650][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 21:16:19,329][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 21:16:28,146][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 21:16:36,495][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 21:16:41,196][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 21:16:51,802][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 21:17:01,582][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 21:17:22,857][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:17:28,718][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 21:17:36,894][root][INFO] - Processing question number 40
[2025-03-06 21:17:36,896][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:17:47,195][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 21:17:57,204][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 21:18:04,823][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 21:18:16,187][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 21:18:26,005][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:18:33,928][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 21:18:50,873][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:18:54,612][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 21:18:59,997][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 21:19:11,834][root][INFO] - Processing question number 50
[2025-03-06 21:19:11,837][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:19:21,314][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 21:19:29,799][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 21:19:34,858][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 21:19:45,625][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 21:19:51,668][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:19:59,287][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 21:20:08,519][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 21:20:14,451][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 21:20:41,027][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 21:20:58,328][root][INFO] - Processing question number 60
[2025-03-06 21:20:58,331][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:21:10,718][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:21:18,601][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 21:21:26,162][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 21:21:31,332][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 21:21:45,255][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 21:21:50,198][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 21:22:06,486][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 21:22:15,289][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:22:19,693][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 21:22:26,366][root][INFO] - Processing question number 70
[2025-03-06 21:22:26,370][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 21:22:32,427][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 21:22:37,859][root][INFO] - Domain : Property, Question : 6
[2025-03-06 21:22:45,608][root][INFO] - Domain : Property, Question : 13
[2025-03-06 21:23:00,270][root][INFO] - Domain : Property, Question : 20
[2025-03-06 21:23:08,903][root][INFO] - Domain : Property, Question : 33
[2025-03-06 21:23:16,289][root][INFO] - Domain : Property, Question : 39
[2025-03-06 21:23:22,484][root][INFO] - Domain : Property, Question : 48
[2025-03-06 21:23:37,522][root][INFO] - Domain : Property, Question : 54
[2025-03-06 21:23:44,210][root][INFO] - Domain : Property, Question : 61
[2025-03-06 21:23:55,049][root][INFO] - Processing question number 80
[2025-03-06 21:23:55,052][root][INFO] - Domain : Property, Question : 67
[2025-03-06 21:24:04,764][root][INFO] - Domain : Property, Question : 75
[2025-03-06 21:24:20,420][root][INFO] - Domain : Property, Question : 83
[2025-03-06 21:24:26,441][root][INFO] - Domain : Property, Question : 89
[2025-03-06 21:24:32,013][root][INFO] - Domain : Property, Question : 97
[2025-03-06 21:24:39,825][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:24:45,930][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 21:24:53,571][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:25:07,558][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 21:25:15,985][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 21:25:24,904][root][INFO] - Processing question number 90
[2025-03-06 21:25:24,908][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 21:25:32,957][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 21:25:52,699][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 21:26:05,497][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 21:26:07,807][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:26:12,444][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 21:26:20,869][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 21:26:33,691][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 21:26:36,356][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 21:26:42,079][root][INFO] - Inference complete
[2025-03-06 21:26:42,079][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,085][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,086][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,086][root][WARNING] - |Q. 7||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,087][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,087][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,087][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,087][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,088][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,088][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,088][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,089][root][WARNING] - |Q. 63||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,089][root][WARNING] - |Q. 63||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,089][root][INFO] - |Q. 63||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,090][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,090][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:26:42,091][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,091][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:26:42,092][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,092][root][WARNING] - |Q. 37||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,092][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,095][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,095][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,095][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,098][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,098][root][WARNING] - |Q. 13||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,098][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,098][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,099][root][WARNING] - |Q. 20||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,099][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,099][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,100][root][WARNING] - |Q. 75||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,100][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,101][root][WARNING] - |Q. 80||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:26:42,102][root][WARNING] - |Q. 80||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:26:42,102][root][INFO] - |Q. 80||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:26:42,103][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,107][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,108][root][INFO] - Saved parsed outputs
[2025-03-06 21:26:42,108][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,109][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,109][root][INFO] - Saved parsing metadata
[2025-03-06 21:26:42,110][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,112][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:26:42,113][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 21:26:42,132][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 21:26:42,132][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.42424242424242425, 'malformed_label': 0, 'malformed_domain': 10, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 42, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.15151515151515152, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.16161616161616163, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 47, 'correct_label_wrong_domain': 3, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 21:26:50,983][root][INFO] - Setting global seed to 989
[2025-03-06 21:26:50,991][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 21:26:50,991][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 21:26:50,993][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 21:26:50,994][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:26:50,997][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:26:50,997][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 21:26:51,172][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 21:26:51,824][root][INFO] - Full model selected, loading model
[2025-03-06 21:27:19,779][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 21:29:09,712][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 21:29:09,713][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 21:29:44,141][root][INFO] - Peft model loaded successfully
[2025-03-06 21:29:51,342][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:29:51,345][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:29:51,345][root][INFO] - Starting inference
[2025-03-06 21:29:51,456][root][INFO] - Processing question number 0
[2025-03-06 21:29:51,458][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 21:29:55,657][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 21:30:11,321][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 21:30:28,169][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 21:30:38,846][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 21:30:55,965][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 21:31:14,063][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 21:31:22,609][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 21:31:45,330][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 21:31:55,017][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 21:32:21,207][root][INFO] - Processing question number 10
[2025-03-06 21:32:21,209][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 21:32:33,957][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 21:32:41,399][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 21:32:57,073][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 21:33:11,407][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 21:33:23,533][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 21:33:42,524][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 21:33:50,693][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 21:33:54,322][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 21:34:02,543][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 21:34:06,840][root][INFO] - Processing question number 20
[2025-03-06 21:34:06,842][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 21:34:13,901][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 21:34:21,005][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 21:34:30,196][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 21:34:37,514][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 21:34:45,164][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 21:34:49,422][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 21:34:57,162][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 21:35:03,823][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 21:35:18,627][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 21:35:26,702][root][INFO] - Processing question number 30
[2025-03-06 21:35:26,704][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:35:37,534][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 21:35:48,978][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 21:35:55,128][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 21:36:04,999][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 21:36:09,209][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 21:36:20,940][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 21:36:36,554][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 21:36:46,781][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:36:53,283][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 21:37:02,257][root][INFO] - Processing question number 40
[2025-03-06 21:37:02,260][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:37:13,915][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 21:37:23,371][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 21:37:30,206][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 21:37:44,836][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 21:37:56,319][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 21:38:17,640][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 21:38:25,107][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 21:38:28,800][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 21:38:34,185][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 21:38:42,789][root][INFO] - Processing question number 50
[2025-03-06 21:38:42,792][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 21:38:51,093][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 21:39:06,325][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 21:39:13,493][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 21:39:20,815][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 21:39:25,992][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 21:39:38,612][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 21:39:48,879][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 21:40:00,841][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 21:40:09,476][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 21:40:16,975][root][INFO] - Processing question number 60
[2025-03-06 21:40:16,978][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:40:21,702][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:40:30,597][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 21:40:35,813][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 21:40:42,871][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 21:40:56,840][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 21:41:00,790][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 21:41:16,226][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 21:41:23,877][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:41:27,964][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 21:41:40,036][root][INFO] - Processing question number 70
[2025-03-06 21:41:40,039][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 21:41:49,717][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 21:41:59,260][root][INFO] - Domain : Property, Question : 6
[2025-03-06 21:42:04,958][root][INFO] - Domain : Property, Question : 13
[2025-03-06 21:42:13,659][root][INFO] - Domain : Property, Question : 20
[2025-03-06 21:42:22,618][root][INFO] - Domain : Property, Question : 33
[2025-03-06 21:42:31,923][root][INFO] - Domain : Property, Question : 39
[2025-03-06 21:42:43,946][root][INFO] - Domain : Property, Question : 48
[2025-03-06 21:43:07,466][root][INFO] - Domain : Property, Question : 54
[2025-03-06 21:43:15,399][root][INFO] - Domain : Property, Question : 61
[2025-03-06 21:43:27,817][root][INFO] - Processing question number 80
[2025-03-06 21:43:27,821][root][INFO] - Domain : Property, Question : 67
[2025-03-06 21:43:38,731][root][INFO] - Domain : Property, Question : 75
[2025-03-06 21:43:49,238][root][INFO] - Domain : Property, Question : 83
[2025-03-06 21:44:07,439][root][INFO] - Domain : Property, Question : 89
[2025-03-06 21:44:14,774][root][INFO] - Domain : Property, Question : 97
[2025-03-06 21:44:20,094][root][INFO] - Domain : Property, Question : 100
[2025-03-06 21:44:26,002][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 21:44:31,541][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:44:36,963][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 21:44:47,526][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 21:44:52,859][root][INFO] - Processing question number 90
[2025-03-06 21:44:52,863][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 21:45:04,967][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 21:45:23,098][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 21:45:34,694][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 21:45:37,419][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:45:42,183][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 21:45:49,190][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 21:45:56,386][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 21:46:08,897][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 21:46:13,099][root][INFO] - Inference complete
[2025-03-06 21:46:13,100][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,105][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,106][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,106][root][WARNING] - |Q. 14||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,107][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,107][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,107][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,107][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,107][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,107][root][WARNING] - |Q. 28||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,108][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,108][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,108][root][WARNING] - |Q. 35||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,108][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,108][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,109][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,109][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,109][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,109][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 21:46:13,110][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,110][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 21:46:13,110][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,110][root][WARNING] - |Q. 69||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,110][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,111][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,111][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,111][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,112][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,112][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,112][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,115][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,115][root][WARNING] - |Q. 11||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,115][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,116][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,116][root][WARNING] - |Q. 62||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,116][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,117][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,117][root][WARNING] - |Q. 5||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,117][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,118][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,118][root][WARNING] - |Q. 31||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,118][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,118][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,119][root][WARNING] - |Q. 40||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,119][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,121][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,121][root][WARNING] - |Q. 61||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,121][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,122][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 21:46:13,122][root][WARNING] - |Q. 26||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 21:46:13,122][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 21:46:13,124][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,128][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,128][root][INFO] - Saved parsed outputs
[2025-03-06 21:46:13,128][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,129][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,130][root][INFO] - Saved parsing metadata
[2025-03-06 21:46:13,130][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,132][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 21:46:13,133][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 21:46:13,164][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 21:46:13,164][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.45454545454545453, 'malformed_label': 0, 'malformed_domain': 8, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 45, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.5384615384615384, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.5, 'Torts_accuracy': 0.6153846153846154, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.12121212121212122, 'Criminal_Law_confidence': 0.1414141414141414, 'Evidence_confidence': 0.12121212121212122, 'Real_Property_confidence': 0.16161616161616163, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 1, 'both_wrong': 7}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 21:46:21,566][root][INFO] - Setting global seed to 206
[2025-03-06 21:46:21,573][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 21:46:21,573][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 21:46:21,574][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 21:46:21,589][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 21:46:21,592][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 21:46:21,592][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 21:46:21,749][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 21:46:22,472][root][INFO] - Full model selected, loading model
[2025-03-06 21:46:47,222][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 21:48:40,466][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 21:48:40,484][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 21:49:12,124][root][INFO] - Peft model loaded successfully
[2025-03-06 21:49:19,410][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 21:49:19,412][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 21:49:19,412][root][INFO] - Starting inference
[2025-03-06 21:49:19,525][root][INFO] - Processing question number 0
[2025-03-06 21:49:19,528][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 21:49:24,718][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 21:49:31,959][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 21:49:37,991][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 21:49:45,131][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 21:49:53,444][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 21:50:02,952][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 21:50:19,215][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 21:50:26,035][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 21:50:53,893][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 21:51:01,306][root][INFO] - Processing question number 10
[2025-03-06 21:51:01,308][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 21:51:07,482][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 21:51:19,952][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 21:51:26,868][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 21:51:41,024][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 21:51:54,347][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 21:52:03,365][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 21:52:13,152][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 21:52:19,472][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 21:52:38,661][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 21:53:03,760][root][INFO] - Processing question number 20
[2025-03-06 21:53:03,762][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 21:53:12,606][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 21:53:18,139][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 21:53:24,483][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 21:53:30,710][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 21:53:44,333][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 21:54:01,592][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 21:54:12,006][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 21:54:16,099][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 21:54:22,141][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 21:54:32,640][root][INFO] - Processing question number 30
[2025-03-06 21:54:32,642][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 21:54:37,862][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 21:54:45,594][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 21:54:59,883][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 21:55:10,550][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 21:55:15,885][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 21:55:22,320][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 21:55:37,208][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 21:55:42,888][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 21:55:47,293][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 21:55:53,975][root][INFO] - Processing question number 40
[2025-03-06 21:55:53,978][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 21:55:59,622][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 21:56:12,231][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 21:56:22,256][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 21:56:28,786][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 21:56:42,353][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 21:56:52,838][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 21:57:03,290][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 21:57:12,005][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 21:57:20,075][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 21:57:27,330][root][INFO] - Processing question number 50
[2025-03-06 21:57:27,333][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 21:57:32,286][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 21:57:46,887][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 21:57:56,380][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 21:58:02,323][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 21:58:13,637][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 21:58:25,736][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 21:58:34,958][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 21:58:49,191][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 21:59:08,965][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 21:59:23,290][root][INFO] - Processing question number 60
[2025-03-06 21:59:23,293][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 21:59:31,413][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 21:59:43,698][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 21:59:55,237][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:00:16,281][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 22:00:39,840][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 22:00:56,412][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 22:01:09,179][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 22:01:18,772][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 22:01:28,924][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 22:01:44,019][root][INFO] - Processing question number 70
[2025-03-06 22:01:44,022][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 22:02:01,089][root][INFO] - Domain : Property, Question : 9
[2025-03-06 22:02:08,527][root][INFO] - Domain : Property, Question : 17
[2025-03-06 22:02:16,467][root][INFO] - Domain : Property, Question : 25
[2025-03-06 22:02:25,706][root][INFO] - Domain : Property, Question : 30
[2025-03-06 22:02:34,578][root][INFO] - Domain : Property, Question : 36
[2025-03-06 22:02:43,343][root][INFO] - Domain : Property, Question : 46
[2025-03-06 22:02:50,321][root][INFO] - Domain : Property, Question : 53
[2025-03-06 22:03:03,571][root][INFO] - Domain : Property, Question : 59
[2025-03-06 22:03:09,367][root][INFO] - Domain : Property, Question : 66
[2025-03-06 22:03:12,522][root][INFO] - Processing question number 80
[2025-03-06 22:03:12,526][root][INFO] - Domain : Property, Question : 69
[2025-03-06 22:03:26,180][root][INFO] - Domain : Property, Question : 81
[2025-03-06 22:03:30,095][root][INFO] - Domain : Property, Question : 88
[2025-03-06 22:03:40,476][root][INFO] - Domain : Property, Question : 91
[2025-03-06 22:03:53,417][root][INFO] - Domain : Property, Question : 94
[2025-03-06 22:03:59,170][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:04:09,084][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:04:23,629][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 22:04:31,581][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:04:39,169][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:04:50,400][root][INFO] - Processing question number 90
[2025-03-06 22:04:50,404][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:04:57,847][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:05:05,884][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:05:11,148][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:05:16,656][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:05:35,565][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:05:46,908][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:05:52,721][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:06:00,137][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:06:07,695][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:06:15,088][root][INFO] - Inference complete
[2025-03-06 22:06:15,089][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,094][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,096][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,096][root][WARNING] - |Q. 41||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,096][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,097][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,097][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:06:15,097][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,098][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:06:15,098][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,098][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,098][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,098][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,099][root][WARNING] - |Q. 99||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,099][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,099][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,099][root][WARNING] - |Q. 2||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,099][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,100][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,100][root][WARNING] - |Q. 37||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,100][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,101][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,101][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,101][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,102][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,102][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,102][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,102][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,103][root][WARNING] - |Q. 24||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,103][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,103][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,103][root][WARNING] - |Q. 28||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,103][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,105][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,105][root][WARNING] - |Q. 16||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,105][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,105][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,106][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,106][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,107][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,107][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,107][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,107][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,107][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,107][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,108][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,108][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,108][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,109][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,109][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,109][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,110][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,110][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,110][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,110][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,110][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,110][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,111][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,111][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,111][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,111][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,111][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,111][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,112][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,112][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,112][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,112][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,112][root][WARNING] - |Q. 36||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,113][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,113][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,113][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,113][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,113][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:06:15,113][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:06:15,113][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:06:15,116][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,122][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,122][root][INFO] - Saved parsed outputs
[2025-03-06 22:06:15,122][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,124][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,124][root][INFO] - Saved parsing metadata
[2025-03-06 22:06:15,125][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,126][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:06:15,128][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:06:15,135][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 22:06:15,135][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.47, 'malformed_label': 0, 'malformed_domain': 11, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 47, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.16, 'Torts_confidence': 0.16, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 7, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 22:06:21,992][root][INFO] - Setting global seed to 206
[2025-03-06 22:06:21,997][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 22:06:21,998][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:06:21,999][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:06:22,000][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:06:22,002][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:06:22,003][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:06:22,150][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 22:06:22,765][root][INFO] - Full model selected, loading model
[2025-03-06 22:06:51,155][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:08:40,124][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:08:40,125][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:09:12,261][root][INFO] - Peft model loaded successfully
[2025-03-06 22:09:19,581][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:09:19,583][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:09:19,583][root][INFO] - Starting inference
[2025-03-06 22:09:19,701][root][INFO] - Processing question number 0
[2025-03-06 22:09:19,704][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:09:25,285][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:09:30,212][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:09:37,749][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:09:44,951][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:09:51,186][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:10:00,616][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:10:08,695][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:10:21,553][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:10:30,858][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:10:35,524][root][INFO] - Processing question number 10
[2025-03-06 22:10:35,526][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:10:40,022][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:10:47,226][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:10:54,646][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:11:02,391][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:11:31,352][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:11:40,334][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:11:48,972][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:11:55,374][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:12:00,284][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:12:11,530][root][INFO] - Processing question number 20
[2025-03-06 22:12:11,532][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:12:20,984][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:12:26,620][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:12:32,099][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:12:36,675][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:12:53,328][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:13:06,147][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:13:13,466][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:13:17,708][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:13:22,902][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:13:34,845][root][INFO] - Processing question number 30
[2025-03-06 22:13:34,847][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:13:40,359][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:13:54,986][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:14:02,391][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:14:10,187][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:14:17,175][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:14:25,745][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:14:44,868][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 22:14:51,528][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:14:57,296][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 22:15:03,452][root][INFO] - Processing question number 40
[2025-03-06 22:15:03,455][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 22:15:09,165][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 22:15:17,886][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 22:15:24,592][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 22:15:30,793][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 22:15:40,678][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 22:15:54,132][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:16:00,239][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:16:09,235][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 22:16:17,114][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 22:16:24,168][root][INFO] - Processing question number 50
[2025-03-06 22:16:24,171][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 22:16:29,177][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 22:16:40,326][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 22:16:48,885][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:16:57,141][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 22:17:06,652][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 22:17:19,348][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 22:17:27,358][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 22:17:43,260][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 22:17:59,736][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 22:18:16,441][root][INFO] - Processing question number 60
[2025-03-06 22:18:16,444][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 22:18:25,666][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 22:18:38,646][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 22:18:56,212][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:19:12,080][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 22:19:24,278][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 22:19:33,240][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 22:19:55,801][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 22:20:07,110][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 22:20:15,996][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 22:20:34,659][root][INFO] - Processing question number 70
[2025-03-06 22:20:34,663][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 22:21:03,390][root][INFO] - Domain : Property, Question : 9
[2025-03-06 22:21:10,449][root][INFO] - Domain : Property, Question : 17
[2025-03-06 22:21:18,059][root][INFO] - Domain : Property, Question : 25
[2025-03-06 22:21:27,442][root][INFO] - Domain : Property, Question : 30
[2025-03-06 22:21:33,462][root][INFO] - Domain : Property, Question : 36
[2025-03-06 22:21:58,852][root][INFO] - Domain : Property, Question : 46
[2025-03-06 22:22:07,082][root][INFO] - Domain : Property, Question : 53
[2025-03-06 22:22:15,681][root][INFO] - Domain : Property, Question : 59
[2025-03-06 22:22:21,544][root][INFO] - Domain : Property, Question : 66
[2025-03-06 22:22:25,857][root][INFO] - Processing question number 80
[2025-03-06 22:22:25,861][root][INFO] - Domain : Property, Question : 69
[2025-03-06 22:22:40,417][root][INFO] - Domain : Property, Question : 81
[2025-03-06 22:22:49,366][root][INFO] - Domain : Property, Question : 88
[2025-03-06 22:23:02,313][root][INFO] - Domain : Property, Question : 91
[2025-03-06 22:23:15,532][root][INFO] - Domain : Property, Question : 94
[2025-03-06 22:23:25,015][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:23:32,552][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:23:41,588][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 22:23:46,081][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:23:53,244][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:24:03,109][root][INFO] - Processing question number 90
[2025-03-06 22:24:03,113][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:24:17,312][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:24:34,556][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:24:43,946][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:24:48,576][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:25:11,310][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:25:23,002][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:25:28,917][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:25:36,430][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:25:47,930][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:25:59,301][root][INFO] - Inference complete
[2025-03-06 22:25:59,301][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,307][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,309][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,310][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,310][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,310][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,310][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,310][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,311][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,311][root][WARNING] - |Q. 2||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:25:59,312][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,312][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:25:59,312][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,313][root][WARNING] - |Q. 37||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,313][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,313][root][WARNING] - |Q. 71||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,313][root][WARNING] - |Q. 71||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,313][root][INFO] - |Q. 71||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,314][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,314][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,314][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,314][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,314][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,314][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,315][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,315][root][WARNING] - |Q. 24||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,315][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,316][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,316][root][WARNING] - |Q. 28||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,316][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,317][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,317][root][WARNING] - |Q. 16||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,318][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,318][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,318][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,318][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,319][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,319][root][WARNING] - |Q. 85||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,319][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,320][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,320][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,320][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,321][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,321][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,321][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,321][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,322][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,322][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,322][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,322][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,322][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,323][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,323][root][WARNING] - |Q. 68||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,323][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,323][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,324][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:25:59,324][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,324][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:25:59,324][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,324][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,325][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,325][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,325][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,325][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,325][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,325][root][WARNING] - |Q. 36||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,326][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,326][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,326][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,326][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,326][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,326][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,326][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,328][root][WARNING] - |Q. 39||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:25:59,328][root][WARNING] - |Q. 39||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:25:59,328][root][INFO] - |Q. 39||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:25:59,330][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,335][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,335][root][INFO] - Saved parsed outputs
[2025-03-06 22:25:59,335][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,337][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,337][root][INFO] - Saved parsing metadata
[2025-03-06 22:25:59,339][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,340][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:25:59,342][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:25:59,356][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 22:25:59,356][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.47, 'malformed_label': 0, 'malformed_domain': 10, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 47, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.17, 'Torts_confidence': 0.16, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 7, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 22:26:06,370][root][INFO] - Setting global seed to 206
[2025-03-06 22:26:06,376][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 22:26:06,376][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:26:06,377][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:26:06,378][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:26:06,381][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:26:06,381][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:26:06,534][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 22:26:07,196][root][INFO] - Full model selected, loading model
[2025-03-06 22:26:33,503][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:28:23,311][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:28:23,328][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:28:56,449][root][INFO] - Peft model loaded successfully
[2025-03-06 22:29:03,739][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:29:03,742][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:29:03,742][root][INFO] - Starting inference
[2025-03-06 22:29:03,843][root][INFO] - Processing question number 0
[2025-03-06 22:29:03,845][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:29:08,038][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:29:16,132][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:29:22,871][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:29:34,978][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:29:40,491][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:29:47,114][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:30:00,938][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:30:10,576][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:30:20,068][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:30:25,501][root][INFO] - Processing question number 10
[2025-03-06 22:30:25,503][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:30:35,301][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:30:43,656][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:30:50,509][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:30:57,988][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:31:19,299][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:31:25,426][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:31:35,088][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:31:47,646][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:31:56,895][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:32:08,393][root][INFO] - Processing question number 20
[2025-03-06 22:32:08,395][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:32:21,783][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:32:29,445][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:32:40,825][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:32:43,830][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:32:54,855][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:33:07,301][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:33:15,161][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:33:26,888][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:33:39,596][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:33:49,413][root][INFO] - Processing question number 30
[2025-03-06 22:33:49,415][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:33:54,418][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:34:04,304][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:34:18,484][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:34:32,631][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:34:38,530][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:34:45,802][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:35:00,478][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 22:35:06,865][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:35:17,261][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 22:35:40,774][root][INFO] - Processing question number 40
[2025-03-06 22:35:40,777][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 22:35:47,260][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 22:35:56,858][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 22:36:06,432][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 22:36:15,515][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 22:36:26,251][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 22:36:36,388][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:36:44,099][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:36:48,459][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 22:37:00,926][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 22:37:05,455][root][INFO] - Processing question number 50
[2025-03-06 22:37:05,458][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 22:37:10,326][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 22:37:23,691][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 22:37:52,669][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:38:03,298][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 22:38:14,694][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 22:38:27,813][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 22:38:38,258][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 22:38:47,255][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 22:39:09,343][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 22:39:25,765][root][INFO] - Processing question number 60
[2025-03-06 22:39:25,768][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 22:39:33,149][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 22:39:45,573][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 22:39:59,776][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:40:11,773][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 22:40:27,237][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 22:40:36,801][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 22:40:49,255][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 22:41:01,122][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 22:41:10,014][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 22:41:29,548][root][INFO] - Processing question number 70
[2025-03-06 22:41:29,552][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 22:41:40,844][root][INFO] - Domain : Property, Question : 9
[2025-03-06 22:41:51,795][root][INFO] - Domain : Property, Question : 17
[2025-03-06 22:41:59,041][root][INFO] - Domain : Property, Question : 25
[2025-03-06 22:42:08,853][root][INFO] - Domain : Property, Question : 30
[2025-03-06 22:42:17,282][root][INFO] - Domain : Property, Question : 36
[2025-03-06 22:42:30,648][root][INFO] - Domain : Property, Question : 46
[2025-03-06 22:42:37,328][root][INFO] - Domain : Property, Question : 53
[2025-03-06 22:42:45,929][root][INFO] - Domain : Property, Question : 59
[2025-03-06 22:42:57,666][root][INFO] - Domain : Property, Question : 66
[2025-03-06 22:43:03,970][root][INFO] - Processing question number 80
[2025-03-06 22:43:03,973][root][INFO] - Domain : Property, Question : 69
[2025-03-06 22:43:10,720][root][INFO] - Domain : Property, Question : 81
[2025-03-06 22:43:18,784][root][INFO] - Domain : Property, Question : 88
[2025-03-06 22:43:35,386][root][INFO] - Domain : Property, Question : 91
[2025-03-06 22:43:48,478][root][INFO] - Domain : Property, Question : 94
[2025-03-06 22:43:56,031][root][INFO] - Domain : Property, Question : 100
[2025-03-06 22:44:05,048][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 22:44:12,319][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 22:44:18,996][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 22:44:26,858][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 22:44:38,498][root][INFO] - Processing question number 90
[2025-03-06 22:44:38,502][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 22:44:49,180][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 22:44:58,998][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 22:45:10,632][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 22:45:14,661][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 22:45:21,889][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 22:45:34,299][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 22:45:39,902][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 22:45:47,310][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 22:45:59,224][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 22:46:05,832][root][INFO] - Inference complete
[2025-03-06 22:46:05,832][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,838][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,839][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,839][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,840][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,840][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,840][root][WARNING] - |Q. 56||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,841][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,841][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,841][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,841][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,842][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,842][root][WARNING] - |Q. 2||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,842][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,843][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,843][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,843][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,844][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,844][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,844][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,844][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,844][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,844][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,845][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,845][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,845][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,846][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,846][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,846][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,847][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,847][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,847][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,848][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,848][root][WARNING] - |Q. 4||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,848][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,848][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,848][root][WARNING] - |Q. 23||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,848][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,849][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,849][root][WARNING] - |Q. 51||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,849][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,850][root][WARNING] - |Q. 60||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,850][root][WARNING] - |Q. 60||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 22:46:05,851][root][INFO] - |Q. 60||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,851][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 22:46:05,851][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,851][root][WARNING] - |Q. 80||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,851][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,852][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,853][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,853][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,853][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,853][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,853][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,853][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,854][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,854][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,854][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,854][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,854][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,855][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,855][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,855][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,855][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,855][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,855][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,856][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,856][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,856][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,856][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,856][root][WARNING] - |Q. 9||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,856][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,856][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,857][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,857][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,857][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,857][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,857][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,857][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,858][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,858][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,858][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 22:46:05,859][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 22:46:05,859][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 22:46:05,861][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,866][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,866][root][INFO] - Saved parsed outputs
[2025-03-06 22:46:05,866][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,868][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,868][root][INFO] - Saved parsing metadata
[2025-03-06 22:46:05,869][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,870][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:46:05,872][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 22:46:05,880][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 22:46:05,880][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.48, 'malformed_label': 0, 'malformed_domain': 9, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 48, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.7142857142857143, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.17, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.17, 'Torts_confidence': 0.15, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 6, 'both_wrong': 3}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 22:46:12,809][root][INFO] - Setting global seed to 989
[2025-03-06 22:46:12,815][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 22:46:12,815][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 22:46:12,817][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 22:46:12,818][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 22:46:12,820][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 22:46:12,820][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 22:46:13,024][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 22:46:13,732][root][INFO] - Full model selected, loading model
[2025-03-06 22:46:35,941][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 22:48:23,714][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 22:48:23,737][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 22:48:53,009][root][INFO] - Peft model loaded successfully
[2025-03-06 22:49:00,222][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 22:49:00,224][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 22:49:00,224][root][INFO] - Starting inference
[2025-03-06 22:49:00,332][root][INFO] - Processing question number 0
[2025-03-06 22:49:00,348][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 22:49:05,457][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 22:49:12,644][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 22:49:18,633][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 22:49:25,766][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 22:49:34,064][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 22:49:43,543][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 22:49:59,662][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 22:50:06,418][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 22:50:34,239][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 22:50:41,650][root][INFO] - Processing question number 10
[2025-03-06 22:50:41,652][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 22:50:47,829][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 22:51:00,307][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 22:51:07,228][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 22:51:21,397][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 22:51:34,732][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 22:51:43,756][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 22:51:53,551][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 22:51:59,874][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 22:52:19,084][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 22:52:44,196][root][INFO] - Processing question number 20
[2025-03-06 22:52:44,198][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 22:52:53,053][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 22:52:58,593][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 22:53:04,949][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 22:53:11,183][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 22:53:24,822][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 22:53:42,091][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 22:53:52,519][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 22:53:56,619][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 22:54:02,671][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 22:54:13,183][root][INFO] - Processing question number 30
[2025-03-06 22:54:13,186][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 22:54:18,411][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 22:54:26,149][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 22:54:40,457][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 22:54:51,129][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 22:54:56,471][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 22:55:02,914][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 22:55:17,819][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 22:55:23,504][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 22:55:27,916][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 22:55:34,604][root][INFO] - Processing question number 40
[2025-03-06 22:55:34,606][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 22:55:40,258][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 22:55:52,875][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 22:56:02,913][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 22:56:09,448][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 22:56:23,030][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 22:56:33,526][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 22:56:43,991][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 22:56:52,715][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 22:57:00,794][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 22:57:08,053][root][INFO] - Processing question number 50
[2025-03-06 22:57:08,056][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 22:57:13,014][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 22:57:27,632][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 22:57:37,135][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 22:57:43,083][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 22:57:54,409][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 22:58:06,518][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 22:58:15,761][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 22:58:30,107][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 22:58:50,077][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 22:59:04,544][root][INFO] - Processing question number 60
[2025-03-06 22:59:04,547][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 22:59:12,754][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 22:59:25,167][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 22:59:36,762][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 22:59:57,972][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:00:21,782][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:00:38,410][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:00:51,271][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:01:00,978][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:01:11,247][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:01:26,401][root][INFO] - Processing question number 70
[2025-03-06 23:01:26,404][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:01:43,492][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:01:50,938][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:01:58,891][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:02:08,132][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:02:17,015][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:02:25,783][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:02:32,770][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:02:46,027][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:02:51,831][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:02:54,988][root][INFO] - Processing question number 80
[2025-03-06 23:02:54,993][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:03:08,665][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:03:12,585][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:03:22,985][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:03:35,943][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:03:41,701][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:03:51,622][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:04:06,257][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:04:14,294][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:04:21,954][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:04:33,287][root][INFO] - Processing question number 90
[2025-03-06 23:04:33,291][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:04:40,763][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:04:48,815][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:04:54,127][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:04:59,660][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:05:18,539][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:05:29,859][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:05:35,674][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:05:43,116][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:05:50,738][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:05:58,094][root][INFO] - Inference complete
[2025-03-06 23:05:58,095][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,100][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,102][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,102][root][WARNING] - |Q. 41||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,102][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,103][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,103][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:05:58,104][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,104][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:05:58,104][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,104][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,104][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,105][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,105][root][WARNING] - |Q. 99||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,105][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,105][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,105][root][WARNING] - |Q. 2||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,105][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,106][root][WARNING] - |Q. 37||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,106][root][WARNING] - |Q. 37||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,106][root][INFO] - |Q. 37||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,107][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,107][root][WARNING] - |Q. 83||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,107][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,108][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,108][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,108][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,108][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,109][root][WARNING] - |Q. 24||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,109][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,109][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,109][root][WARNING] - |Q. 28||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,109][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,111][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,111][root][WARNING] - |Q. 16||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,111][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,111][root][WARNING] - |Q. 50||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,112][root][WARNING] - |Q. 50||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,112][root][INFO] - |Q. 50||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,113][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,113][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,113][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,113][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,113][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,113][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,114][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,114][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,114][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,115][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,115][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,115][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,116][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,116][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,116][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,116][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,116][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,116][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,117][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,117][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,117][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,117][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,117][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,117][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,118][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,118][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,118][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,118][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,118][root][WARNING] - |Q. 36||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,119][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,119][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,119][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,119][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,119][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:05:58,119][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:05:58,119][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:05:58,122][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,127][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,127][root][INFO] - Saved parsed outputs
[2025-03-06 23:05:58,127][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,128][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,128][root][INFO] - Saved parsing metadata
[2025-03-06 23:05:58,129][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,130][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:05:58,132][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:05:58,139][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 23:05:58,139][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.47, 'malformed_label': 0, 'malformed_domain': 11, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 47, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.16, 'Torts_confidence': 0.16, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 7, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 23:06:04,695][root][INFO] - Setting global seed to 989
[2025-03-06 23:06:04,700][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 23:06:04,701][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 23:06:04,702][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 23:06:04,703][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:06:04,705][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:06:04,705][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 23:06:04,995][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 23:06:05,586][root][INFO] - Full model selected, loading model
[2025-03-06 23:06:30,339][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 23:08:19,582][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 23:08:19,582][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 23:08:53,372][root][INFO] - Peft model loaded successfully
[2025-03-06 23:09:00,672][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:09:00,675][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:09:00,675][root][INFO] - Starting inference
[2025-03-06 23:09:00,790][root][INFO] - Processing question number 0
[2025-03-06 23:09:00,793][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 23:09:06,235][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 23:09:17,803][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 23:09:24,211][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 23:09:36,025][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 23:09:42,980][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 23:09:51,128][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 23:09:57,229][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 23:10:05,609][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 23:10:20,060][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 23:10:24,944][root][INFO] - Processing question number 10
[2025-03-06 23:10:24,946][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 23:10:30,107][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 23:10:38,496][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 23:10:53,320][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 23:10:56,629][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:11:14,731][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:11:27,408][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:11:37,932][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:11:44,675][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:12:07,049][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:12:16,843][root][INFO] - Processing question number 20
[2025-03-06 23:12:16,845][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:12:24,335][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:12:29,785][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:12:35,925][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 23:12:41,578][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 23:12:51,524][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 23:12:58,778][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 23:13:16,942][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 23:13:21,073][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 23:13:27,587][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 23:13:49,090][root][INFO] - Processing question number 30
[2025-03-06 23:13:49,092][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 23:13:54,359][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 23:14:02,897][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 23:14:14,151][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 23:14:22,677][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 23:14:32,505][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 23:14:49,388][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 23:15:04,417][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 23:15:10,152][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:15:20,928][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 23:15:28,040][root][INFO] - Processing question number 40
[2025-03-06 23:15:28,042][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 23:15:34,291][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 23:15:45,396][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 23:15:53,245][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 23:16:01,098][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 23:16:09,665][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 23:16:30,530][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:16:36,906][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:16:56,551][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 23:17:02,587][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 23:17:08,531][root][INFO] - Processing question number 50
[2025-03-06 23:17:08,535][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 23:17:13,396][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 23:17:22,836][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 23:17:35,804][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:17:47,310][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 23:17:56,674][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 23:18:06,811][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 23:18:19,554][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 23:18:33,923][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 23:18:51,344][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 23:19:02,468][root][INFO] - Processing question number 60
[2025-03-06 23:19:02,472][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 23:19:10,668][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 23:19:26,124][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 23:19:34,990][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 23:20:03,703][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:20:22,163][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:20:32,720][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:20:44,544][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:20:59,266][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:21:08,296][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:21:21,063][root][INFO] - Processing question number 70
[2025-03-06 23:21:21,066][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:21:32,475][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:21:38,876][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:21:47,088][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:21:57,305][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:22:06,724][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:22:14,108][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:22:22,897][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:22:32,052][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:22:36,870][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:22:40,086][root][INFO] - Processing question number 80
[2025-03-06 23:22:40,090][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:22:54,101][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:22:58,087][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:23:16,385][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:23:28,589][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:23:41,478][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:23:48,446][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:24:02,031][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:24:07,872][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:24:15,837][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:24:29,269][root][INFO] - Processing question number 90
[2025-03-06 23:24:29,273][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:24:36,724][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:24:45,190][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:24:50,547][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:24:54,164][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:25:04,923][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:25:21,842][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:25:26,466][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:25:34,994][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:25:44,157][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:25:54,224][root][INFO] - Inference complete
[2025-03-06 23:25:54,225][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,230][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,231][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,231][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,231][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,232][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,232][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,233][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,233][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,233][root][WARNING] - |Q. 78||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,233][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,233][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,234][root][WARNING] - |Q. 2||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,234][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,235][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,235][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,236][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,237][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,237][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,237][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,238][root][WARNING] - |Q. 10||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,238][root][WARNING] - |Q. 10||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:25:54,239][root][INFO] - |Q. 10||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,239][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:25:54,239][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,239][root][WARNING] - |Q. 16||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,239][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,240][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,240][root][WARNING] - |Q. 51||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,240][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,241][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,241][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,241][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,242][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,242][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,242][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,243][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,243][root][WARNING] - |Q. 40||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:25:54,243][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,243][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:25:54,243][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,244][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,244][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,244][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,244][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,244][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,245][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,245][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,245][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,245][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,245][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,245][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,246][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,246][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,246][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,247][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,247][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:25:54,247][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,249][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:25:54,249][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:25:54,249][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:25:54,249][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:25:54,250][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,254][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,255][root][INFO] - Saved parsed outputs
[2025-03-06 23:25:54,255][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,256][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,256][root][INFO] - Saved parsing metadata
[2025-03-06 23:25:54,256][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,258][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:25:54,259][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:25:54,282][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 23:25:54,282][root][INFO] - Summary of metrics : {'label_accuracy': 0.54, 'misclassification_rate': 0.45999999999999996, 'combined_accuracy': 0.47, 'malformed_label': 0, 'malformed_domain': 11, 'total_predictions': 100, 'correct_predictions': 54, 'correct_label_and_domain': 47, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.5384615384615384, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.16, 'Torts_confidence': 0.16, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 7, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-03-06 23:26:01,232][root][INFO] - Setting global seed to 989
[2025-03-06 23:26:01,237][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 23:26:01,237][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 23:26:01,238][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 23:26:01,240][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 23:26:01,243][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 23:26:01,243][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 23:26:01,397][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 23:26:01,974][root][INFO] - Full model selected, loading model
[2025-03-06 23:26:26,610][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 23:28:17,001][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 23:28:17,027][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 23:28:50,886][root][INFO] - Peft model loaded successfully
[2025-03-06 23:28:58,149][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 23:28:58,150][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:28:58,150][root][INFO] - Starting inference
[2025-03-06 23:28:58,265][root][INFO] - Processing question number 0
[2025-03-06 23:28:58,267][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 23:29:05,332][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 23:29:10,263][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 23:29:17,047][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 23:29:22,768][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 23:29:30,413][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 23:29:41,397][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 23:30:09,862][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 23:30:23,278][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 23:30:29,367][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 23:30:34,663][root][INFO] - Processing question number 10
[2025-03-06 23:30:34,665][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 23:30:39,651][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 23:30:49,196][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 23:31:07,500][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 23:31:12,775][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 23:31:24,676][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 23:31:37,551][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 23:31:47,256][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 23:31:54,830][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 23:32:01,259][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 23:32:07,135][root][INFO] - Processing question number 20
[2025-03-06 23:32:07,137][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 23:32:09,996][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 23:32:17,332][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 23:32:22,171][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 23:32:25,937][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 23:32:36,538][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 23:32:48,604][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 23:32:58,672][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 23:33:10,720][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 23:33:15,702][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 23:33:32,240][root][INFO] - Processing question number 30
[2025-03-06 23:33:32,243][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 23:33:37,973][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 23:33:52,415][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 23:34:05,212][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 23:34:12,082][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 23:34:19,116][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 23:34:26,028][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 23:34:37,466][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 23:34:44,080][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 23:34:51,129][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 23:35:02,202][root][INFO] - Processing question number 40
[2025-03-06 23:35:02,205][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 23:35:11,821][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 23:35:17,943][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 23:35:35,458][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 23:35:41,607][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 23:35:49,199][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 23:35:59,103][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 23:36:09,195][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 23:36:15,927][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 23:36:20,782][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 23:36:30,846][root][INFO] - Processing question number 50
[2025-03-06 23:36:30,849][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 23:36:45,578][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 23:36:55,159][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 23:37:03,715][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 23:37:17,530][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 23:37:38,739][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 23:37:57,165][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 23:38:04,016][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 23:38:14,216][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 23:38:38,657][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 23:38:52,438][root][INFO] - Processing question number 60
[2025-03-06 23:38:52,441][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 23:39:01,663][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 23:39:19,564][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 23:39:42,977][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 23:40:01,442][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 23:40:24,445][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 23:40:50,463][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 23:41:06,599][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 23:41:16,849][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 23:41:23,541][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 23:41:32,680][root][INFO] - Processing question number 70
[2025-03-06 23:41:32,684][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 23:41:39,749][root][INFO] - Domain : Property, Question : 9
[2025-03-06 23:42:00,084][root][INFO] - Domain : Property, Question : 17
[2025-03-06 23:42:15,928][root][INFO] - Domain : Property, Question : 25
[2025-03-06 23:42:24,188][root][INFO] - Domain : Property, Question : 30
[2025-03-06 23:42:30,799][root][INFO] - Domain : Property, Question : 36
[2025-03-06 23:42:39,838][root][INFO] - Domain : Property, Question : 46
[2025-03-06 23:42:45,436][root][INFO] - Domain : Property, Question : 53
[2025-03-06 23:43:07,112][root][INFO] - Domain : Property, Question : 59
[2025-03-06 23:43:19,857][root][INFO] - Domain : Property, Question : 66
[2025-03-06 23:43:22,914][root][INFO] - Processing question number 80
[2025-03-06 23:43:22,918][root][INFO] - Domain : Property, Question : 69
[2025-03-06 23:43:33,330][root][INFO] - Domain : Property, Question : 81
[2025-03-06 23:43:37,286][root][INFO] - Domain : Property, Question : 88
[2025-03-06 23:43:46,700][root][INFO] - Domain : Property, Question : 91
[2025-03-06 23:43:55,343][root][INFO] - Domain : Property, Question : 94
[2025-03-06 23:44:07,452][root][INFO] - Domain : Property, Question : 100
[2025-03-06 23:44:16,416][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 23:44:21,573][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 23:44:31,125][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 23:44:38,943][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 23:44:48,308][root][INFO] - Processing question number 90
[2025-03-06 23:44:48,315][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 23:45:10,085][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 23:45:17,298][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 23:45:23,274][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 23:45:28,223][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 23:45:57,595][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 23:46:08,996][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 23:46:23,621][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 23:46:33,734][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 23:46:41,758][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 23:46:49,604][root][INFO] - Inference complete
[2025-03-06 23:46:49,604][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,610][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,611][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,612][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:46:49,612][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,612][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:46:49,613][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,613][root][WARNING] - |Q. 70||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,613][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,613][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,613][root][WARNING] - |Q. 78||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,614][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,614][root][WARNING] - |Q. 2||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,614][root][WARNING] - |Q. 2||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,614][root][INFO] - |Q. 2||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,615][root][WARNING] - |Q. 76||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,616][root][WARNING] - |Q. 76||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,616][root][INFO] - |Q. 76||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,616][root][WARNING] - |Q. 89||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,616][root][WARNING] - |Q. 89||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,616][root][INFO] - |Q. 89||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,616][root][WARNING] - |Q. 96||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,617][root][WARNING] - |Q. 96||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,617][root][INFO] - |Q. 96||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,617][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,618][root][WARNING] - |Q. 28||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,618][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,618][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,619][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,619][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,619][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,620][root][WARNING] - |Q. 16||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,620][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,620][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,620][root][WARNING] - |Q. 23||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,620][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,621][root][WARNING] - |Q. 73||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,621][root][WARNING] - |Q. 73||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,621][root][INFO] - |Q. 73||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,622][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,622][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,623][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,623][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,623][root][WARNING] - |Q. 12||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,623][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,624][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,624][root][WARNING] - |Q. 26||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,624][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,624][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,624][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,624][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,625][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,625][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,625][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,625][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,625][root][WARNING] - |Q. 47||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,626][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,626][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,626][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,626][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,626][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,627][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,627][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,627][root][WARNING] - |Q. 82||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,627][root][WARNING] - |Q. 82||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,627][root][INFO] - |Q. 82||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,628][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,628][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,628][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,628][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,628][root][WARNING] - |Q. 30||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,628][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,629][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,629][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,629][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,631][root][WARNING] - |Q. 63||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,631][root][WARNING] - |Q. 63||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 23:46:49,632][root][INFO] - |Q. 63||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,632][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 23:46:49,632][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 23:46:49,632][root][WARNING] - |Q. 95||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 23:46:49,632][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 23:46:49,633][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,638][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,638][root][INFO] - Saved parsed outputs
[2025-03-06 23:46:49,638][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,639][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,639][root][INFO] - Saved parsing metadata
[2025-03-06 23:46:49,640][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,641][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 23:46:49,642][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_10_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 23:46:49,657][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 23:46:49,657][root][INFO] - Summary of metrics : {'label_accuracy': 0.53, 'misclassification_rate': 0.47, 'combined_accuracy': 0.46, 'malformed_label': 0, 'malformed_domain': 11, 'total_predictions': 100, 'correct_predictions': 53, 'correct_label_and_domain': 46, 'Constitutional_Law_accuracy': 0.5714285714285714, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.6428571428571429, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.4666666666666667, 'Torts_accuracy': 0.5714285714285714, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.12, 'Criminal_Law_confidence': 0.16, 'Evidence_confidence': 0.11, 'Real_Property_confidence': 0.16, 'Torts_confidence': 0.15, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 7, 'both_wrong': 4}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_10_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Job 24 completed at Thu Mar  6 23:46:51 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n516
Job ID: 25358399
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 04:39:38
CPU Efficiency: 9.83% of 1-23:24:20 core-walltime
Job Wall-clock time: 04:44:26
Memory Utilized: 35.48 GB
Memory Efficiency: 98.57% of 36.00 GB
