Starting job 24 at Thu Feb 20 23:37:31 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=markdown_answer_first_zero_shot_unstructured train=markdown_answer_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '24', 'training']
Updating job 24 to status training with exit code None
Status update completed for job 24
[2025-02-20 23:37:47,658][root][INFO] - Global seed set to 314
[2025-02-20 23:37:47,659][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 23:37:47,659][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 23:37:47,659][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 23:37:47,659][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:37:47,659][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 23:37:47,676][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:37:47,680][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 23:37:47,681][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 23:37:47,684][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 23:37:48,395][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 23:38:13,665][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-02-20 23:38:41,048][root][INFO] - Model prepared for kbit training
[2025-02-20 23:38:41,049][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'o_proj', 'v_proj', 'q_proj', 'k_proj', 'down_proj', 'up_proj', 'gate_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 23:38:42,735][root][INFO] - Lora adapter added to model
[2025-02-20 23:38:42,738][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_answer_first_zero_shot_unstructured
[2025-02-20 23:38:42,959][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 2.0712, 'grad_norm': 0.5853596925735474, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.6953, 'grad_norm': 3.858105421066284, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.4959, 'grad_norm': 0.4648415148258209, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.3232, 'grad_norm': 0.44969865679740906, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0528, 'grad_norm': 0.47096848487854004, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 318.0114, 'train_samples_per_second': 0.33, 'train_steps_per_second': 0.047, 'train_loss': 1.5276780764261881, 'epoch': 15.0}
[2025-02-20 23:44:08,454][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_markdown_answer_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '24', 'trained', '0']
Updating job 24 to status trained with exit code 0
Status update completed for job 24
Starting evaluations for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-20 23:44:17,477][root][INFO] - Setting global seed to 206
[2025-02-20 23:44:17,483][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 23:44:17,483][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-20 23:44:17,484][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:44:17,486][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:44:17,487][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:44:17,488][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:44:17,635][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-20 23:44:18,185][root][INFO] - Full model selected, loading model
[2025-02-20 23:44:39,474][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-20 23:46:27,494][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 23:46:27,510][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 23:46:59,559][root][INFO] - Peft model loaded successfully
[2025-02-20 23:47:08,249][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:47:08,251][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-20 23:47:08,251][root][INFO] - Starting inference
[2025-02-20 23:47:08,402][root][INFO] - Processing question number 0
[2025-02-20 23:47:08,464][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:47:13,854][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:47:22,987][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:47:28,017][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:47:32,605][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:47:37,095][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:47:44,218][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:47:52,097][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:47:56,902][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:48:02,104][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:48:13,973][root][INFO] - Processing question number 10
[2025-02-20 23:48:13,979][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:48:19,722][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:48:29,828][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:48:35,330][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:48:43,808][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:48:48,404][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:49:01,502][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:49:05,796][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:49:15,572][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:49:20,291][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:49:28,489][root][INFO] - Processing question number 20
[2025-02-20 23:49:28,491][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:49:34,711][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:49:44,370][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:49:48,592][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:49:54,097][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:50:00,418][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:50:05,730][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:50:16,210][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:50:44,595][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:50:53,836][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:50:57,424][root][INFO] - Processing question number 30
[2025-02-20 23:50:57,426][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:51:11,645][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:51:17,348][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:51:26,601][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:51:30,248][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:51:34,205][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:51:51,827][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:51:56,512][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:52:02,691][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:52:12,948][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:52:18,289][root][INFO] - Processing question number 40
[2025-02-20 23:52:18,291][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:52:24,423][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:52:34,780][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:52:43,866][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:53:12,705][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:53:24,645][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:53:53,137][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:53:56,879][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:54:00,525][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:54:06,920][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:54:10,993][root][INFO] - Processing question number 50
[2025-02-20 23:54:10,996][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:54:18,585][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:54:27,014][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:54:29,315][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:54:58,690][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:55:08,308][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:55:36,109][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:55:39,475][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:55:44,492][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:55:51,028][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:55:55,918][root][INFO] - Processing question number 60
[2025-02-20 23:55:55,921][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:56:00,679][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:56:29,010][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:56:39,836][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:56:45,257][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:56:51,489][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:56:59,674][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:57:06,529][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:57:16,439][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:57:22,344][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:57:32,456][root][INFO] - Processing question number 70
[2025-02-20 23:57:32,460][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:57:40,225][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:57:42,977][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:57:48,516][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:58:04,419][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:58:12,356][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:58:16,263][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:58:22,208][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:58:32,403][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:58:36,736][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:58:43,690][root][INFO] - Processing question number 80
[2025-02-20 23:58:43,694][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:58:52,643][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:59:04,851][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:59:14,835][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:59:20,513][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:59:27,656][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:59:33,042][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:59:37,374][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:59:48,383][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:59:58,045][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:00:26,072][root][INFO] - Processing question number 90
[2025-02-21 00:00:26,076][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:00:32,217][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:00:37,037][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:00:49,645][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:00:52,944][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:00:59,750][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:01:04,772][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:01:33,077][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:02:01,646][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:02:22,472][root][INFO] - Inference complete
[2025-02-21 00:02:22,472][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,478][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,479][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:02:22,479][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:02:22,479][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 00:02:22,479][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:02:22,480][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 00:02:22,480][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:02:22,480][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:02:22,480][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:02:22,480][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:02:22,480][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:02:22,480][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:02:22,481][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:02:22,481][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:02:22,481][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:02:22,481][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:02:22,481][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:02:22,481][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:02:22,481][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:02:22,481][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:02:22,482][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:02:22,482][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:02:22,482][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:02:22,483][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:02:22,483][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:02:22,483][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:02:22,483][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:02:22,483][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:02:22,483][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:02:22,483][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:02:22,483][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:02:22,484][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:02:22,485][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:02:22,485][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:02:22,485][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:02:22,485][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:02:22,485][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:02:22,485][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:02:22,486][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:02:22,486][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:02:22,487][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:02:22,487][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 00:02:22,487][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:02:22,487][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:02:22,487][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 00:02:22,487][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:02:22,487][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:02:22,487][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:02:22,488][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:02:22,489][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:02:22,490][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:02:22,490][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:02:22,490][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:02:22,490][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:02:22,490][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:02:22,490][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:02:22,490][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:02:22,491][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:02:22,492][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:02:22,492][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:02:22,492][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:02:22,492][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:02:22,492][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:02:22,492][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:02:22,492][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:02:22,492][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 00:02:22,493][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:02:22,493][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:02:22,493][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:02:22,493][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 00:02:22,494][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,524][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,524][root][INFO] - Saved parsed outputs
[2025-02-21 00:02:22,524][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,572][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,572][root][INFO] - Saved parsing metadata
[2025-02-21 00:02:22,573][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,576][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:02:22,608][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:02:22,655][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 00:02:22,655][root][INFO] - Summary of metrics : {'label_accuracy': 0.13131313131313133, 'misclassification_rate': 0.8686868686868687, 'combined_accuracy': 0.0, 'malformed_label': 77, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 13, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 13, 'both_wrong': 86}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 00:02:35,683][root][INFO] - Setting global seed to 206
[2025-02-21 00:02:35,693][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:02:35,693][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:02:35,695][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:02:35,697][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:02:35,702][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:02:35,702][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:02:35,850][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:02:36,409][root][INFO] - Full model selected, loading model
[2025-02-21 00:03:00,781][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:03:00,782][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:03:09,187][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:03:09,189][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:03:09,189][root][INFO] - Starting inference
[2025-02-21 00:03:09,379][root][INFO] - Processing question number 0
[2025-02-21 00:03:09,406][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:03:19,891][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:03:27,443][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:03:41,820][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:03:55,409][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:04:07,172][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:04:23,013][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:04:30,651][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:04:37,807][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:04:48,491][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:04:57,645][root][INFO] - Processing question number 10
[2025-02-21 00:04:57,647][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:05:07,001][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:05:23,555][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:05:29,708][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:05:39,201][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:05:47,829][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:05:56,114][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:06:07,449][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:06:14,150][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:06:26,458][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:06:43,624][root][INFO] - Processing question number 20
[2025-02-21 00:06:43,626][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:06:53,200][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:07:06,330][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:07:17,509][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:07:26,396][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:07:43,714][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:07:58,299][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:08:09,544][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:08:18,583][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:08:35,900][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:08:52,087][root][INFO] - Processing question number 30
[2025-02-21 00:08:52,089][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:09:00,861][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:09:10,342][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:09:24,004][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:09:32,717][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:09:41,741][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:09:48,583][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:10:05,488][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:10:15,118][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:10:28,287][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:10:34,773][root][INFO] - Processing question number 40
[2025-02-21 00:10:34,775][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:10:41,443][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:10:50,579][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:10:59,698][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:11:07,845][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:11:17,144][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:11:28,386][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:11:36,592][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:11:46,482][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:11:56,933][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:12:02,917][root][INFO] - Processing question number 50
[2025-02-21 00:12:02,920][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:12:26,109][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:12:37,115][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:12:49,078][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:13:12,619][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:13:22,455][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:13:38,463][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:13:49,778][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:14:04,644][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:14:25,441][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:14:34,562][root][INFO] - Processing question number 60
[2025-02-21 00:14:34,566][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:14:44,008][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:14:53,122][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:15:08,504][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:15:15,800][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:15:25,542][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:15:38,246][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:15:50,800][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:16:00,462][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:16:14,528][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:16:24,024][root][INFO] - Processing question number 70
[2025-02-21 00:16:24,028][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:16:33,970][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:16:40,211][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:16:53,712][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:17:07,078][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:17:20,305][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:17:35,556][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:17:55,358][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:18:08,558][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:18:17,710][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:18:28,957][root][INFO] - Processing question number 80
[2025-02-21 00:18:28,961][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:18:38,123][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:18:47,058][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:18:56,527][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:19:05,052][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:19:13,391][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:19:21,104][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:19:32,679][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:19:43,994][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:20:01,949][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:20:08,069][root][INFO] - Processing question number 90
[2025-02-21 00:20:08,073][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:20:21,142][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:20:30,765][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:20:45,463][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:20:49,112][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:20:59,815][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:21:09,699][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:21:17,306][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:21:37,324][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:21:58,974][root][INFO] - Inference complete
[2025-02-21 00:21:58,974][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:58,982][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:58,982][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:21:58,982][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,983][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:21:58,983][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,983][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 00:21:58,983][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:21:58,983][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 00:21:58,983][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,983][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:21:58,984][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:21:58,984][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,984][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:21:58,984][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,984][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:21:58,984][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:21:58,984][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,984][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:21:58,984][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,984][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:21:58,985][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:21:58,985][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,985][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:21:58,985][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,985][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:21:58,985][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,985][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:21:58,985][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:21:58,985][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:21:58,985][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:21:58,985][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:21:58,986][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:21:58,986][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 00:21:58,986][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:21:58,986][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:21:58,986][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:21:58,986][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:21:58,986][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:21:58,986][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:21:58,987][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:21:58,987][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:21:58,987][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:21:58,987][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:21:58,987][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:21:58,987][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:21:58,987][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:21:58,987][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:21:58,988][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,988][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:21:58,988][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,988][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:21:58,988][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 00:21:58,988][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,988][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:21:58,988][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:21:58,988][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,988][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:21:58,989][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:21:58,989][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,989][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:21:58,989][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:21:58,989][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,989][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:21:58,989][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,989][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:21:58,989][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,989][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:21:58,989][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,990][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:21:58,990][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:21:58,990][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:21:58,990][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 00:21:58,990][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:21:58,990][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:21:58,990][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 00:21:58,990][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:21:58,990][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:21:58,991][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:21:58,991][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 00:21:58,991][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:21:58,991][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:21:58,991][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 00:21:58,991][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:21:58,991][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:21:58,991][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:21:58,991][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 00:21:58,992][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:21:58,992][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:21:58,992][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 00:21:58,992][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:21:58,992][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:21:58,992][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:21:58,992][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:21:58,992][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 00:21:58,992][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:21:58,993][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:21:58,993][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:21:58,993][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:21:58,993][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 00:21:58,993][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:21:58,993][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:21:58,993][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:21:58,993][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:21:58,993][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:21:58,994][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:21:58,994][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:21:58,994][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:21:58,994][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:21:58,994][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:21:58,994][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:21:58,994][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:21:58,994][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:21:58,994][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:21:58,994][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,995][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:21:58,995][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,995][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:21:58,995][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:21:58,995][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:21:58,995][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:21:58,995][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,995][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:21:58,995][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,996][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:21:58,996][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,996][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:21:58,996][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,996][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:21:58,996][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,996][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:21:58,996][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,996][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:21:58,996][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,996][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:21:58,996][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 00:21:58,997][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:21:58,997][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,997][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:21:58,997][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,997][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:21:58,997][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:21:58,997][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,997][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:21:58,997][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,997][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:21:58,997][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,998][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:21:58,998][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:21:58,998][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,998][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:21:58,998][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,998][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:21:58,998][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 00:21:58,998][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:21:58,998][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:21:58,999][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 00:21:58,999][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:59,023][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:59,023][root][INFO] - Saved parsed outputs
[2025-02-21 00:21:59,023][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:59,060][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:59,060][root][INFO] - Saved parsing metadata
[2025-02-21 00:21:59,061][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:59,063][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:21:59,079][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:21:59,110][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 00:21:59,110][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 99, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 99}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 00:22:08,454][root][INFO] - Setting global seed to 206
[2025-02-21 00:22:08,460][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:22:08,460][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:22:08,461][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:22:08,464][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:22:08,469][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:22:08,469][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:22:08,613][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:22:09,185][root][INFO] - Full model selected, loading model
[2025-02-21 00:22:24,457][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:24:06,603][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:24:06,613][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:24:37,162][root][INFO] - Peft model loaded successfully
[2025-02-21 00:24:45,038][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:24:45,040][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:24:45,040][root][INFO] - Starting inference
[2025-02-21 00:24:45,250][root][INFO] - Processing question number 0
[2025-02-21 00:24:45,257][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:24:51,206][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:24:56,104][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:25:01,178][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:25:08,191][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:25:12,674][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:25:22,941][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:25:28,461][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:25:33,944][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:25:41,556][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:25:48,889][root][INFO] - Processing question number 10
[2025-02-21 00:25:48,891][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:26:00,841][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:26:10,706][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:26:16,708][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:26:25,675][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:26:34,796][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:26:46,559][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:26:50,756][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:26:54,329][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:26:59,722][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:27:05,932][root][INFO] - Processing question number 20
[2025-02-21 00:27:05,934][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:27:12,882][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:27:19,929][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:27:24,273][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:27:37,021][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:27:40,502][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:27:48,331][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:27:55,645][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:28:06,069][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:28:13,859][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:28:42,098][root][INFO] - Processing question number 30
[2025-02-21 00:28:42,100][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:28:57,174][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:29:05,638][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:29:16,166][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:29:22,992][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:29:27,656][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:29:37,556][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:29:42,549][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:30:01,700][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:30:06,583][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:30:12,897][root][INFO] - Processing question number 40
[2025-02-21 00:30:12,900][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:30:18,253][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:30:32,846][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:30:39,017][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:30:45,397][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:31:08,626][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:31:14,583][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:31:44,208][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:31:50,477][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:31:57,746][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:32:01,665][root][INFO] - Processing question number 50
[2025-02-21 00:32:01,669][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:32:12,321][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:32:21,888][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:32:24,341][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:32:32,605][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:32:41,186][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:32:47,043][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:32:50,429][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:32:55,500][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:33:15,274][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:33:24,244][root][INFO] - Processing question number 60
[2025-02-21 00:33:24,248][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:33:29,491][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:33:40,309][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:34:09,323][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:34:15,326][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:34:23,030][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:34:35,659][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:34:41,643][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:34:57,825][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:35:04,090][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:35:09,861][root][INFO] - Processing question number 70
[2025-02-21 00:35:09,865][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:35:17,964][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:35:20,735][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:35:24,819][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:35:36,465][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:35:50,710][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:35:58,089][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:36:04,172][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:36:10,958][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:36:20,750][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:36:29,319][root][INFO] - Processing question number 80
[2025-02-21 00:36:29,323][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:36:34,913][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:36:49,252][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:36:53,195][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:36:58,595][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:37:03,891][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:37:09,177][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:37:13,540][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:37:20,715][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:37:49,554][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:37:58,198][root][INFO] - Processing question number 90
[2025-02-21 00:37:58,202][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:38:12,123][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:38:15,967][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:38:23,310][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:38:29,103][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:38:34,809][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:38:40,229][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:38:45,387][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:38:59,663][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:39:11,006][root][INFO] - Inference complete
[2025-02-21 00:39:11,006][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,012][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,013][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:39:11,013][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:39:11,013][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 00:39:11,013][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:39:11,013][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 00:39:11,014][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:39:11,014][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:39:11,014][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:39:11,014][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:39:11,014][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:39:11,014][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:39:11,014][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:39:11,015][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:39:11,015][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:39:11,015][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:39:11,015][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:39:11,015][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:39:11,015][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:39:11,015][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:39:11,016][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:39:11,016][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:39:11,017][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:39:11,017][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:39:11,017][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:39:11,017][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:39:11,017][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:39:11,017][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:39:11,017][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:39:11,018][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 00:39:11,018][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:39:11,018][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:39:11,018][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:39:11,018][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:39:11,018][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:39:11,018][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:39:11,019][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:39:11,019][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:39:11,019][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:39:11,019][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:39:11,019][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:39:11,019][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:39:11,019][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:39:11,020][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 00:39:11,020][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:39:11,020][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:39:11,020][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:39:11,020][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:39:11,020][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:39:11,020][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:39:11,020][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:39:11,021][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:39:11,021][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:39:11,021][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:39:11,021][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:39:11,021][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:39:11,021][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:39:11,021][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 00:39:11,022][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:39:11,022][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:39:11,022][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:39:11,022][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 00:39:11,022][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:39:11,022][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:39:11,022][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:39:11,022][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:39:11,023][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:39:11,023][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:39:11,023][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:39:11,023][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:39:11,023][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:39:11,023][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:39:11,023][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:39:11,024][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:39:11,025][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:39:11,026][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 00:39:11,027][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,031][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,031][root][INFO] - Saved parsed outputs
[2025-02-21 00:39:11,032][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,033][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,033][root][INFO] - Saved parsing metadata
[2025-02-21 00:39:11,034][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,035][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:11,037][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:39:11,050][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 00:39:11,050][root][INFO] - Summary of metrics : {'label_accuracy': 0.12121212121212122, 'misclassification_rate': 0.8787878787878788, 'combined_accuracy': 0.0, 'malformed_label': 77, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 12, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 12, 'both_wrong': 87}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 00:39:17,254][root][INFO] - Setting global seed to 206
[2025-02-21 00:39:17,259][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 00:39:17,259][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:39:17,260][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:39:17,262][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:39:17,263][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:39:17,264][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:39:17,411][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:39:17,947][root][INFO] - Full model selected, loading model
[2025-02-21 00:39:39,750][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 00:39:39,751][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 00:39:47,436][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:39:47,438][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:39:47,438][root][INFO] - Starting inference
[2025-02-21 00:39:47,655][root][INFO] - Processing question number 0
[2025-02-21 00:39:47,658][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:40:00,127][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:40:08,079][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:40:16,306][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:40:29,405][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:40:48,801][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:41:05,205][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:41:23,083][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:41:31,871][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:41:44,051][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:41:53,104][root][INFO] - Processing question number 10
[2025-02-21 00:41:53,105][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:42:08,538][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:42:18,822][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:42:33,077][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:42:41,015][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:42:47,810][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:42:58,517][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:43:11,300][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:43:18,155][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:43:26,665][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:43:42,764][root][INFO] - Processing question number 20
[2025-02-21 00:43:42,766][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:43:49,850][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:43:59,068][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:44:10,438][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:44:19,135][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:44:28,606][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:44:41,689][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:44:51,067][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:45:07,185][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:45:20,900][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:45:31,556][root][INFO] - Processing question number 30
[2025-02-21 00:45:31,559][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:45:40,273][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:46:01,196][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:46:16,457][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:46:26,823][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:46:42,148][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:46:57,462][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:47:11,210][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:47:22,949][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:47:31,692][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:47:43,366][root][INFO] - Processing question number 40
[2025-02-21 00:47:43,369][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:47:48,397][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:48:00,289][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:48:08,788][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:48:17,990][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:48:30,912][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:48:40,152][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:48:58,879][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:49:06,955][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:49:15,558][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:49:29,789][root][INFO] - Processing question number 50
[2025-02-21 00:49:29,792][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:49:51,800][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:50:06,594][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:50:34,822][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:50:56,332][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:51:10,532][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:51:30,142][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:51:43,372][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:52:04,852][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:52:19,497][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:52:28,086][root][INFO] - Processing question number 60
[2025-02-21 00:52:28,090][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:52:39,928][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:52:54,221][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:53:01,525][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:53:12,937][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:53:22,630][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:53:31,663][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:53:44,948][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:53:52,926][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:54:04,062][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:54:11,730][root][INFO] - Processing question number 70
[2025-02-21 00:54:11,734][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:54:20,475][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:54:27,600][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:54:39,495][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:54:50,776][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:55:00,124][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:55:11,089][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:55:23,926][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:55:38,337][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:55:50,962][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:55:58,841][root][INFO] - Processing question number 80
[2025-02-21 00:55:58,845][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:56:06,735][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:56:16,969][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:56:34,779][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:56:42,417][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:56:51,671][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:57:01,896][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:57:11,040][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:57:25,091][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:57:34,027][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:57:40,435][root][INFO] - Processing question number 90
[2025-02-21 00:57:40,440][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:57:52,665][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:58:03,529][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:58:23,716][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:58:28,869][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:58:40,514][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:58:53,181][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:59:02,745][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:59:14,052][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:59:30,312][root][INFO] - Inference complete
[2025-02-21 00:59:30,312][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,318][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,318][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 00:59:30,319][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 00:59:30,319][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,319][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 00:59:30,319][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,319][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 00:59:30,319][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,319][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 00:59:30,319][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 00:59:30,320][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 00:59:30,320][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 00:59:30,320][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,320][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 00:59:30,320][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 00:59:30,320][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,320][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 00:59:30,320][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 00:59:30,320][root][ERROR] - |Q. 70||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,321][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 00:59:30,321][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 00:59:30,321][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,321][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 00:59:30,321][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,321][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 00:59:30,321][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 00:59:30,321][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 00:59:30,321][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 00:59:30,321][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:59:30,322][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 00:59:30,322][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 00:59:30,322][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 00:59:30,322][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:59:30,322][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 00:59:30,322][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:59:30,322][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 00:59:30,322][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 00:59:30,322][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 00:59:30,323][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:59:30,323][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 00:59:30,323][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 00:59:30,323][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:59:30,323][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 00:59:30,323][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 00:59:30,323][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 00:59:30,323][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 00:59:30,323][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 00:59:30,324][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:59:30,324][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 00:59:30,324][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 00:59:30,324][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 00:59:30,324][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 00:59:30,324][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 00:59:30,324][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 00:59:30,324][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 00:59:30,325][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:59:30,325][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 00:59:30,325][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:59:30,325][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 00:59:30,325][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 00:59:30,325][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:59:30,325][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 00:59:30,325][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:59:30,325][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 00:59:30,325][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:59:30,326][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 00:59:30,326][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 00:59:30,326][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 00:59:30,326][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 00:59:30,326][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 00:59:30,326][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 00:59:30,326][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 00:59:30,326][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 00:59:30,326][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 00:59:30,327][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 00:59:30,327][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 00:59:30,327][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 00:59:30,327][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 00:59:30,327][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 00:59:30,327][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 00:59:30,327][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 00:59:30,328][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 00:59:30,328][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 00:59:30,328][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 00:59:30,328][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 00:59:30,328][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 00:59:30,328][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 00:59:30,328][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,328][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 00:59:30,329][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 00:59:30,329][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 00:59:30,329][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,329][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 00:59:30,329][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 00:59:30,329][root][ERROR] - |Q. 44||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,329][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 00:59:30,329][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,329][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 00:59:30,329][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 00:59:30,330][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,330][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 00:59:30,330][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,330][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 00:59:30,330][root][ERROR] - |Q. 78||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,330][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 00:59:30,330][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,330][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 00:59:30,330][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 00:59:30,330][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 00:59:30,331][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 00:59:30,331][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,331][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 00:59:30,331][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,331][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 00:59:30,331][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 00:59:30,331][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 00:59:30,331][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 00:59:30,331][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 00:59:30,331][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,332][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 00:59:30,332][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,332][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 00:59:30,332][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,332][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 00:59:30,332][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 00:59:30,332][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,332][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 00:59:30,332][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,332][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 00:59:30,332][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 00:59:30,333][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 00:59:30,333][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,333][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 00:59:30,333][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 00:59:30,333][root][ERROR] - |Q. 26||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,333][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 00:59:30,333][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,333][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 00:59:30,333][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,333][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 00:59:30,334][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 00:59:30,334][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 00:59:30,334][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,334][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 00:59:30,334][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,334][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 00:59:30,334][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 00:59:30,334][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,334][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 00:59:30,334][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 00:59:30,335][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 00:59:30,335][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,340][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,340][root][INFO] - Saved parsed outputs
[2025-02-21 00:59:30,340][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,341][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,341][root][INFO] - Saved parsing metadata
[2025-02-21 00:59:30,342][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,344][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 00:59:30,348][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:59:30,362][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 00:59:30,362][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 99, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 99}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 00:59:36,532][root][INFO] - Setting global seed to 206
[2025-02-21 00:59:36,537][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:59:36,538][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 00:59:36,539][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:59:36,541][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:59:36,543][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:59:36,543][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:59:36,687][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 00:59:37,260][root][INFO] - Full model selected, loading model
[2025-02-21 00:59:54,585][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:01:35,039][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:01:35,056][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:02:05,306][root][INFO] - Peft model loaded successfully
[2025-02-21 01:02:12,672][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:02:12,674][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:02:12,674][root][INFO] - Starting inference
[2025-02-21 01:02:12,844][root][INFO] - Processing question number 0
[2025-02-21 01:02:12,846][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:02:18,455][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:02:47,553][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:02:55,593][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:03:04,103][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:03:13,816][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:03:27,027][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:03:32,938][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:03:36,796][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:03:42,733][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:03:54,480][root][INFO] - Processing question number 10
[2025-02-21 01:03:54,483][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:04:01,112][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:04:09,439][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:04:17,242][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:04:21,619][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:04:26,576][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:04:34,629][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:04:41,858][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:04:50,473][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:04:54,957][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:05:00,124][root][INFO] - Processing question number 20
[2025-02-21 01:05:00,126][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:05:05,479][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:05:16,630][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:05:27,874][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:05:34,519][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:05:40,985][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:05:51,599][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:06:02,458][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:06:13,646][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:06:20,476][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:06:24,097][root][INFO] - Processing question number 30
[2025-02-21 01:06:24,100][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:06:48,604][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:06:52,928][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:07:03,866][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:07:09,182][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:07:16,002][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:07:26,482][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:07:35,339][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:07:49,699][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:07:54,180][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:08:01,064][root][INFO] - Processing question number 40
[2025-02-21 01:08:01,067][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:08:10,594][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:08:25,582][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:08:35,645][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:08:51,861][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:09:05,419][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:09:15,038][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:09:21,862][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:09:28,366][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:09:32,768][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:09:45,173][root][INFO] - Processing question number 50
[2025-02-21 01:09:45,176][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:09:50,729][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:10:01,694][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:10:08,201][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:10:13,660][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:10:26,092][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:10:44,139][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:10:51,898][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:10:57,641][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:11:26,199][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:11:36,851][root][INFO] - Processing question number 60
[2025-02-21 01:11:36,854][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:11:41,921][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:11:51,644][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:12:04,412][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:12:09,294][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:12:17,471][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:12:21,787][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:12:25,031][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:12:48,280][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:12:54,694][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:13:00,616][root][INFO] - Processing question number 70
[2025-02-21 01:13:00,620][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:13:13,808][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:13:24,500][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:13:31,925][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:13:48,309][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:13:54,328][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:13:58,407][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:14:05,942][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:14:16,700][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:14:27,170][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:14:33,135][root][INFO] - Processing question number 80
[2025-02-21 01:14:33,139][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:15:02,115][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:15:10,257][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:15:15,337][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:15:23,128][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:15:38,192][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:15:44,274][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:15:54,134][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:16:00,405][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:16:09,457][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:16:12,190][root][INFO] - Processing question number 90
[2025-02-21 01:16:12,195][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:16:24,439][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:16:27,881][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:16:34,203][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:16:37,087][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:16:41,883][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:16:48,448][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:16:52,360][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:17:22,663][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:17:44,087][root][INFO] - Inference complete
[2025-02-21 01:17:44,087][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,094][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,094][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:17:44,095][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:17:44,095][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 01:17:44,095][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:17:44,095][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:17:44,095][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:17:44,095][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:17:44,096][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:17:44,096][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 01:17:44,096][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:17:44,096][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:17:44,096][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:17:44,096][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:17:44,096][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:17:44,097][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:17:44,098][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:17:44,098][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:17:44,098][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:17:44,098][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:17:44,098][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:17:44,098][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:17:44,098][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:17:44,099][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 01:17:44,099][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:17:44,099][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:17:44,099][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:17:44,099][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 01:17:44,099][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:17:44,099][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:17:44,100][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:17:44,100][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:17:44,100][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:17:44,100][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:17:44,100][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:17:44,100][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 01:17:44,100][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:17:44,100][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:17:44,101][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:17:44,101][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:17:44,101][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:17:44,101][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:17:44,101][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:17:44,101][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 01:17:44,101][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:17:44,101][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 01:17:44,102][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:17:44,102][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:17:44,102][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:17:44,102][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 01:17:44,102][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:17:44,102][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:17:44,102][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:17:44,103][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 01:17:44,103][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:17:44,103][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:17:44,103][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 01:17:44,103][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:17:44,103][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:17:44,103][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 01:17:44,104][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:17:44,104][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:17:44,104][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 01:17:44,104][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:17:44,104][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 01:17:44,104][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:17:44,104][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:17:44,105][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:17:44,106][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:17:44,106][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:17:44,106][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:17:44,106][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:17:44,106][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 01:17:44,106][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:17:44,106][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:17:44,107][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 01:17:44,107][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:17:44,108][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 01:17:44,108][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:17:44,108][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 01:17:44,108][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 01:17:44,108][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:17:44,108][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:17:44,108][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 01:17:44,109][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,113][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,114][root][INFO] - Saved parsed outputs
[2025-02-21 01:17:44,114][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,115][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,115][root][INFO] - Saved parsing metadata
[2025-02-21 01:17:44,116][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,118][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:17:44,120][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:17:44,159][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 01:17:44,159][root][INFO] - Summary of metrics : {'label_accuracy': 0.13131313131313133, 'misclassification_rate': 0.8686868686868687, 'combined_accuracy': 0.0, 'malformed_label': 73, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 13, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 13, 'both_wrong': 86}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 01:17:55,011][root][INFO] - Setting global seed to 206
[2025-02-21 01:17:55,020][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:17:55,020][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:17:55,021][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:17:55,024][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:17:55,029][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:17:55,029][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:17:55,173][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:17:55,741][root][INFO] - Full model selected, loading model
[2025-02-21 01:18:17,856][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:18:17,857][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:18:25,987][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:18:25,989][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:18:25,989][root][INFO] - Starting inference
[2025-02-21 01:18:26,210][root][INFO] - Processing question number 0
[2025-02-21 01:18:26,212][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:18:40,743][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:18:51,605][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:19:05,897][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:19:26,032][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:19:36,475][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:19:53,564][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:20:05,837][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:20:22,777][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:20:29,801][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:20:41,587][root][INFO] - Processing question number 10
[2025-02-21 01:20:41,589][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:20:54,874][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:21:06,178][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:21:16,733][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:21:39,172][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:21:54,514][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:22:08,950][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:22:26,021][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:22:43,439][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:22:52,051][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:23:04,121][root][INFO] - Processing question number 20
[2025-02-21 01:23:04,124][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:23:13,749][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:23:37,030][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:23:50,509][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:24:07,644][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:24:16,045][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:24:31,692][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:24:45,861][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:24:55,830][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:25:11,212][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:25:24,524][root][INFO] - Processing question number 30
[2025-02-21 01:25:24,526][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:25:37,791][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:25:51,530][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:26:06,091][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:26:13,973][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:26:27,429][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:26:49,172][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:27:07,019][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:27:19,906][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:27:37,739][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:28:00,067][root][INFO] - Processing question number 40
[2025-02-21 01:28:00,070][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:28:10,619][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:28:22,997][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:28:33,523][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:28:41,380][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:28:50,589][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:29:08,015][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:29:20,318][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:29:32,247][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:29:38,375][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:29:55,726][root][INFO] - Processing question number 50
[2025-02-21 01:29:55,729][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:30:05,751][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:30:13,350][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:30:26,541][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:30:37,838][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:30:52,110][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:31:04,309][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:31:14,528][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:31:33,819][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:31:55,779][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:32:03,717][root][INFO] - Processing question number 60
[2025-02-21 01:32:03,721][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:32:11,010][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:32:21,191][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:32:32,682][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:32:47,511][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:32:58,292][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:33:07,982][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:33:20,148][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:33:32,542][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:33:43,314][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:33:59,024][root][INFO] - Processing question number 70
[2025-02-21 01:33:59,028][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:34:16,716][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:34:23,030][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:34:30,358][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:34:48,327][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:34:59,328][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:35:13,379][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:35:30,360][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:35:43,888][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:35:52,149][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:36:03,423][root][INFO] - Processing question number 80
[2025-02-21 01:36:03,427][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:36:11,003][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:36:22,615][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:36:45,692][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:36:53,844][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:37:04,520][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:37:14,336][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:37:33,222][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:37:44,892][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:37:59,860][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:38:09,892][root][INFO] - Processing question number 90
[2025-02-21 01:38:09,897][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:38:22,468][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:38:32,387][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:38:47,797][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:39:05,393][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:39:16,862][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:39:29,212][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:39:46,582][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:40:03,486][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:40:22,308][root][INFO] - Inference complete
[2025-02-21 01:40:22,308][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,314][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,315][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:40:22,315][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:40:22,315][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:40:22,315][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 01:40:22,316][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:40:22,316][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:40:22,316][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:40:22,316][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:40:22,316][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:40:22,316][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:40:22,316][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 01:40:22,316][root][ERROR] - |Q. 56||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:40:22,317][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:40:22,317][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:40:22,317][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:40:22,317][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:40:22,317][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:40:22,317][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 01:40:22,317][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:40:22,317][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:40:22,318][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:40:22,318][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 01:40:22,318][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:40:22,318][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 01:40:22,318][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:40:22,318][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 01:40:22,318][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:40:22,318][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:40:22,319][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:40:22,319][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:40:22,319][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:40:22,319][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:40:22,319][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:40:22,319][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:40:22,319][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:40:22,319][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:40:22,319][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:40:22,320][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:40:22,320][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 01:40:22,320][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:40:22,320][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:40:22,320][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:40:22,320][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 01:40:22,320][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:40:22,320][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:40:22,321][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:40:22,321][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:40:22,321][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:40:22,321][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:40:22,321][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:40:22,321][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 01:40:22,321][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:40:22,322][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:40:22,322][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:40:22,322][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:40:22,322][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:40:22,322][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:40:22,322][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:40:22,322][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 01:40:22,322][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:40:22,322][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:40:22,322][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:40:22,323][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 01:40:22,323][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 01:40:22,323][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:40:22,323][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:40:22,323][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 01:40:22,323][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:40:22,323][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 01:40:22,323][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:40:22,323][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 01:40:22,324][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 01:40:22,324][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:40:22,324][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:40:22,324][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 01:40:22,324][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:40:22,324][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 01:40:22,324][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 01:40:22,324][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:40:22,325][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:40:22,325][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:40:22,325][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 01:40:22,325][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:40:22,325][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:40:22,325][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:40:22,325][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:40:22,325][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 01:40:22,325][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:40:22,325][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:40:22,326][root][ERROR] - |Q. 53||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:40:22,326][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 01:40:22,326][root][ERROR] - |Q. 59||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:40:22,326][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:40:22,326][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 01:40:22,326][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:40:22,326][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 01:40:22,326][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:40:22,327][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 01:40:22,327][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:40:22,327][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,327][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:40:22,327][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:40:22,327][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,327][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:40:22,327][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:40:22,327][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:40:22,328][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:40:22,328][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,328][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:40:22,328][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,328][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:40:22,328][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,328][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:40:22,328][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,328][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:40:22,328][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 01:40:22,329][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,329][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:40:22,329][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,329][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 01:40:22,329][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 01:40:22,329][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:40:22,329][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:40:22,329][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:40:22,329][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 01:40:22,329][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:40:22,330][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:40:22,330][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:40:22,330][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 01:40:22,330][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:40:22,330][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 01:40:22,330][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:40:22,330][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 01:40:22,330][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 01:40:22,331][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:40:22,331][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 01:40:22,332][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,336][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,336][root][INFO] - Saved parsed outputs
[2025-02-21 01:40:22,336][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,337][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,338][root][INFO] - Saved parsing metadata
[2025-02-21 01:40:22,338][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,340][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:40:22,342][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:40:22,373][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 01:40:22,373][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 98, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 99}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 01:40:32,815][root][INFO] - Setting global seed to 989
[2025-02-21 01:40:32,823][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 01:40:32,823][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:40:32,824][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:40:32,827][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:40:32,832][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:40:32,832][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:40:32,979][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:40:33,590][root][INFO] - Full model selected, loading model
[2025-02-21 01:40:55,927][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 01:42:39,360][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 01:42:39,361][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 01:43:10,835][root][INFO] - Peft model loaded successfully
[2025-02-21 01:43:18,295][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:43:18,296][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:43:18,296][root][INFO] - Starting inference
[2025-02-21 01:43:18,482][root][INFO] - Processing question number 0
[2025-02-21 01:43:18,486][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:43:23,526][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:43:32,652][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:43:37,678][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:43:42,262][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:43:46,748][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:43:53,863][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:44:01,730][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:44:06,533][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:44:11,729][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:44:23,581][root][INFO] - Processing question number 10
[2025-02-21 01:44:23,583][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:44:29,318][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:44:39,413][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:44:44,909][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:44:53,378][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:44:57,967][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:45:11,047][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:45:15,338][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:45:25,100][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:45:29,809][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:45:37,998][root][INFO] - Processing question number 20
[2025-02-21 01:45:38,000][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:45:44,205][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:45:53,846][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:45:58,059][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:46:03,557][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:46:09,870][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:46:15,179][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:46:25,650][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:46:53,997][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:47:03,220][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:47:06,806][root][INFO] - Processing question number 30
[2025-02-21 01:47:06,808][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:47:21,010][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:47:26,705][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:47:35,948][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:47:39,592][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:47:43,545][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:48:01,148][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:48:05,824][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:48:11,999][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:48:22,235][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:48:27,568][root][INFO] - Processing question number 40
[2025-02-21 01:48:27,571][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:48:33,699][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:48:44,045][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:48:53,118][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:49:21,926][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:49:33,852][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:50:02,316][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:50:06,053][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:50:09,696][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:50:16,082][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:50:20,152][root][INFO] - Processing question number 50
[2025-02-21 01:50:20,155][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:50:27,728][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:50:36,144][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:50:38,443][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:51:07,771][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:51:17,369][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:51:45,131][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:51:48,490][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:51:53,504][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:52:00,029][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:52:04,912][root][INFO] - Processing question number 60
[2025-02-21 01:52:04,915][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:52:09,671][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:52:38,008][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:52:48,814][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:52:54,226][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:53:00,449][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:53:08,623][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:53:15,461][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:53:25,359][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:53:31,251][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:53:41,349][root][INFO] - Processing question number 70
[2025-02-21 01:53:41,353][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:53:49,102][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:53:51,849][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:53:57,380][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:54:13,262][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:54:21,182][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:54:25,083][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:54:31,019][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:54:41,194][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:54:45,522][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:54:52,467][root][INFO] - Processing question number 80
[2025-02-21 01:54:52,470][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:55:01,404][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:55:13,594][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:55:23,561][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:55:29,229][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:55:36,359][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:55:41,737][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:55:46,063][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:55:57,060][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:56:06,701][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:56:34,691][root][INFO] - Processing question number 90
[2025-02-21 01:56:34,694][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:56:40,822][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:56:45,637][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:56:58,228][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:57:01,522][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:57:08,318][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:57:13,332][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:57:41,589][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:58:10,115][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:58:30,891][root][INFO] - Inference complete
[2025-02-21 01:58:30,891][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,896][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,897][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 01:58:30,897][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 01:58:30,897][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 01:58:30,898][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 01:58:30,898][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 01:58:30,898][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 01:58:30,898][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 01:58:30,898][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 01:58:30,898][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 01:58:30,898][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 01:58:30,899][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 01:58:30,899][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 01:58:30,899][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 01:58:30,899][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 01:58:30,899][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 01:58:30,899][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 01:58:30,899][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 01:58:30,899][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:58:30,900][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 01:58:30,900][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 01:58:30,900][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 01:58:30,900][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 01:58:30,900][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 01:58:30,900][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 01:58:30,900][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:58:30,900][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 01:58:30,900][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:58:30,901][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 01:58:30,901][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 01:58:30,901][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 01:58:30,901][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 01:58:30,901][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:58:30,901][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 01:58:30,901][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 01:58:30,901][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 01:58:30,902][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 01:58:30,903][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 01:58:30,903][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 01:58:30,903][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 01:58:30,903][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 01:58:30,903][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 01:58:30,903][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 01:58:30,903][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 01:58:30,904][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 01:58:30,904][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 01:58:30,904][root][ERROR] - |Q. 11||D: Torts| Failed to extract explanation: 
[2025-02-21 01:58:30,904][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 01:58:30,904][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 01:58:30,904][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 01:58:30,904][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 01:58:30,904][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 01:58:30,905][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 01:58:30,905][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 01:58:30,905][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 01:58:30,905][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 01:58:30,905][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 01:58:30,905][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 01:58:30,905][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 01:58:30,905][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 01:58:30,906][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 01:58:30,906][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 01:58:30,906][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 01:58:30,906][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 01:58:30,906][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 01:58:30,906][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 01:58:30,906][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 01:58:30,907][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 01:58:30,908][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 01:58:30,909][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 01:58:30,910][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 01:58:30,910][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 01:58:30,910][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:58:30,910][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 01:58:30,910][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 01:58:30,910][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 01:58:30,910][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 01:58:30,910][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 01:58:30,911][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 01:58:30,911][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 01:58:30,911][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:58:30,911][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 01:58:30,911][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 01:58:30,911][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 01:58:30,912][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,916][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,916][root][INFO] - Saved parsed outputs
[2025-02-21 01:58:30,916][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,918][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,918][root][INFO] - Saved parsing metadata
[2025-02-21 01:58:30,918][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,920][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:58:30,921][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:58:30,946][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 01:58:30,946][root][INFO] - Summary of metrics : {'label_accuracy': 0.13131313131313133, 'misclassification_rate': 0.8686868686868687, 'combined_accuracy': 0.0, 'malformed_label': 77, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 13, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 13, 'both_wrong': 86}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 01:58:37,509][root][INFO] - Setting global seed to 989
[2025-02-21 01:58:37,514][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:58:37,514][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 01:58:37,515][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:58:37,517][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:58:37,520][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:58:37,520][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:58:37,675][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 01:58:38,250][root][INFO] - Full model selected, loading model
[2025-02-21 01:59:01,635][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:59:01,644][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:59:09,482][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:59:09,484][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 01:59:09,484][root][INFO] - Starting inference
[2025-02-21 01:59:09,694][root][INFO] - Processing question number 0
[2025-02-21 01:59:09,703][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:59:20,014][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:59:27,581][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:59:41,982][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:59:55,595][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:00:07,379][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:00:23,240][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:00:30,888][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:00:38,064][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:00:48,769][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:00:57,939][root][INFO] - Processing question number 10
[2025-02-21 02:00:57,941][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:01:07,313][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:01:23,897][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:01:30,059][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:01:39,569][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:01:48,206][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:01:56,504][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:02:07,852][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:02:14,566][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:02:26,892][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:02:44,088][root][INFO] - Processing question number 20
[2025-02-21 02:02:44,090][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:02:53,678][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:03:06,825][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:03:18,009][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:03:26,906][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:03:44,247][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:03:57,554][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:04:08,794][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:04:17,848][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:04:35,191][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:04:51,402][root][INFO] - Processing question number 30
[2025-02-21 02:04:51,405][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:05:00,190][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:05:09,685][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:05:23,367][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:05:32,095][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:05:41,129][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:05:47,982][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:06:04,912][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:06:14,557][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:06:27,743][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:06:34,239][root][INFO] - Processing question number 40
[2025-02-21 02:06:34,241][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:06:40,920][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:06:50,106][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:06:59,295][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:07:07,524][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:07:16,915][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:07:28,277][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:07:36,505][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:07:46,455][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:07:57,004][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:08:03,023][root][INFO] - Processing question number 50
[2025-02-21 02:08:03,026][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:08:26,368][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:08:37,489][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:08:49,506][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:09:13,077][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:09:22,929][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:09:38,965][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:09:50,293][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:10:05,185][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:10:26,010][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:10:35,144][root][INFO] - Processing question number 60
[2025-02-21 02:10:35,147][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:10:44,605][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:10:53,736][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:11:09,137][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:11:16,446][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:11:26,205][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:11:38,926][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:11:51,501][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:12:01,183][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:12:15,275][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:12:24,791][root][INFO] - Processing question number 70
[2025-02-21 02:12:24,795][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:12:34,773][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:12:41,048][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:12:54,582][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:13:07,977][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:13:21,229][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:13:36,512][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:13:56,351][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:14:09,585][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:14:18,758][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:14:30,028][root][INFO] - Processing question number 80
[2025-02-21 02:14:30,031][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:14:39,211][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:14:48,170][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:14:57,655][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:15:06,193][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:15:14,543][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:15:22,277][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:15:33,869][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:15:45,205][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:16:03,185][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:16:09,318][root][INFO] - Processing question number 90
[2025-02-21 02:16:09,322][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:16:22,408][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:16:32,049][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:16:46,765][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:16:50,415][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:17:01,132][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:17:11,036][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:17:18,656][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:17:38,711][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:18:00,391][root][INFO] - Inference complete
[2025-02-21 02:18:00,392][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,397][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,398][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:18:00,398][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,398][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:18:00,398][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,398][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 02:18:00,399][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 02:18:00,399][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 02:18:00,399][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,399][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:18:00,399][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:18:00,399][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,399][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:18:00,399][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,399][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:18:00,400][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:18:00,400][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,400][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:18:00,400][root][ERROR] - |Q. 69||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,400][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:18:00,400][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:18:00,400][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,400][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:18:00,400][root][ERROR] - |Q. 84||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,400][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:18:00,401][root][ERROR] - |Q. 91||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,401][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:18:00,401][root][ERROR] - |Q. 98||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:18:00,401][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:18:00,401][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:18:00,401][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:18:00,401][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:18:00,401][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:18:00,401][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:18:00,402][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:18:00,402][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:18:00,402][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:18:00,402][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:18:00,402][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:18:00,402][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:18:00,402][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:18:00,402][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:18:00,403][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:18:00,403][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:18:00,403][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:18:00,403][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:18:00,403][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:18:00,403][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,403][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:18:00,403][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,403][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:18:00,404][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 02:18:00,404][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,404][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:18:00,404][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:18:00,404][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,404][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:18:00,404][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:18:00,404][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,404][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:18:00,404][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:18:00,405][root][ERROR] - |Q. 66||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,405][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:18:00,405][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,405][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:18:00,405][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,405][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:18:00,405][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,405][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:18:00,405][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:18:00,405][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:18:00,405][root][ERROR] - |Q. 4||D: Torts| Failed to extract explanation: 
[2025-02-21 02:18:00,406][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:18:00,406][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:18:00,406][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 02:18:00,406][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:18:00,406][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:18:00,406][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:18:00,406][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 02:18:00,406][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:18:00,406][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:18:00,407][root][ERROR] - |Q. 62||D: Torts| Failed to extract explanation: 
[2025-02-21 02:18:00,407][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:18:00,407][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:18:00,407][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:18:00,407][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 02:18:00,407][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:18:00,407][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:18:00,407][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 02:18:00,408][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:18:00,408][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:18:00,408][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:18:00,408][root][ERROR] - |Q. 18||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:18:00,408][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 02:18:00,408][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:18:00,408][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:18:00,408][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:18:00,408][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:18:00,408][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 02:18:00,409][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:18:00,409][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:18:00,409][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:18:00,409][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:18:00,409][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:18:00,409][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:18:00,409][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:18:00,409][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:18:00,410][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:18:00,410][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:18:00,410][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:18:00,410][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:18:00,410][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:18:00,410][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:18:00,410][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,410][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:18:00,410][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,410][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:18:00,411][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:18:00,411][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:18:00,411][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:18:00,411][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,411][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:18:00,411][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,411][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:18:00,411][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,411][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:18:00,412][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,412][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:18:00,412][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,412][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 02:18:00,412][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,412][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:18:00,412][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,412][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:18:00,412][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 02:18:00,412][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:18:00,412][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,413][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:18:00,413][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,413][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:18:00,413][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:18:00,413][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,413][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:18:00,413][root][ERROR] - |Q. 36||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,413][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:18:00,413][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,413][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:18:00,414][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:18:00,414][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,414][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:18:00,414][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,414][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:18:00,414][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:18:00,414][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:18:00,414][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:18:00,414][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 02:18:00,415][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,419][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,419][root][INFO] - Saved parsed outputs
[2025-02-21 02:18:00,420][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,421][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,421][root][INFO] - Saved parsing metadata
[2025-02-21 02:18:00,422][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,423][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:18:00,425][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:18:00,453][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 02:18:00,453][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 99, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 99}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 02:18:07,821][root][INFO] - Setting global seed to 989
[2025-02-21 02:18:07,829][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:18:07,829][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:18:07,830][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:18:07,831][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:18:07,834][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:18:07,834][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:18:07,984][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:18:08,547][root][INFO] - Full model selected, loading model
[2025-02-21 02:18:27,569][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:20:09,494][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:20:09,504][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:20:40,388][root][INFO] - Peft model loaded successfully
[2025-02-21 02:20:47,847][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:20:47,848][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:20:47,848][root][INFO] - Starting inference
[2025-02-21 02:20:48,050][root][INFO] - Processing question number 0
[2025-02-21 02:20:48,052][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:20:54,264][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:21:23,270][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:21:28,391][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:21:57,347][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:22:03,923][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:22:12,582][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:22:19,125][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:22:25,578][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:22:32,281][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:22:37,230][root][INFO] - Processing question number 10
[2025-02-21 02:22:37,232][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:22:43,641][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:22:49,412][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:22:57,488][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:23:07,636][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:23:10,849][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:23:19,313][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:23:47,715][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:23:55,277][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:23:59,375][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:24:05,549][root][INFO] - Processing question number 20
[2025-02-21 02:24:05,551][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:24:14,575][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:24:19,423][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:24:23,681][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:24:31,142][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:24:40,190][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:24:46,885][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:24:58,462][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:25:06,182][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:25:14,406][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:25:19,106][root][INFO] - Processing question number 30
[2025-02-21 02:25:19,108][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:25:47,857][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:26:11,456][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:26:22,857][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:26:29,368][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:26:36,145][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:26:42,693][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:26:48,207][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:26:54,952][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:27:06,156][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:27:10,779][root][INFO] - Processing question number 40
[2025-02-21 02:27:10,781][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:27:21,689][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:27:35,595][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:27:49,916][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:28:07,133][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:28:19,270][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:28:26,841][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:28:33,757][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:28:39,678][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:28:48,105][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:28:52,486][root][INFO] - Processing question number 50
[2025-02-21 02:28:52,489][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:28:59,473][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:29:08,630][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:29:13,863][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:29:26,727][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:29:34,714][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:29:40,710][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:29:51,710][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:29:55,826][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:30:07,763][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:30:12,927][root][INFO] - Processing question number 60
[2025-02-21 02:30:12,930][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:30:18,311][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:30:46,904][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:30:55,056][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:30:58,278][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:31:04,564][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:31:15,051][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:31:19,985][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:31:28,956][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:31:34,998][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:31:41,149][root][INFO] - Processing question number 70
[2025-02-21 02:31:41,153][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:31:50,225][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:31:54,123][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:32:01,865][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:32:15,510][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:32:23,421][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:32:32,184][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:32:56,458][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:33:02,793][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:33:07,391][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:33:17,261][root][INFO] - Processing question number 80
[2025-02-21 02:33:17,265][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:33:26,099][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:33:34,377][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:33:37,651][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:33:44,841][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:33:50,512][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:33:54,287][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:34:07,205][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:34:17,848][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:34:46,724][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:34:52,687][root][INFO] - Processing question number 90
[2025-02-21 02:34:52,692][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:35:01,789][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:35:06,252][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:35:15,518][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:35:21,351][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:35:26,831][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:35:32,618][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:35:37,382][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:35:47,062][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:36:04,684][root][INFO] - Inference complete
[2025-02-21 02:36:04,684][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,689][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,689][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:36:04,690][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:36:04,690][root][ERROR] - |Q. 7||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:36:04,690][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 02:36:04,690][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 02:36:04,690][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:36:04,690][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 02:36:04,691][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:36:04,691][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:36:04,691][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:36:04,691][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:36:04,691][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:36:04,691][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:36:04,691][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:36:04,692][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:36:04,692][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:36:04,692][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:36:04,692][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:36:04,692][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:36:04,692][root][ERROR] - |Q. 2||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:36:04,692][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:36:04,692][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:36:04,693][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:36:04,693][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:36:04,693][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:36:04,693][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:36:04,693][root][ERROR] - |Q. 43||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:36:04,693][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:36:04,693][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:36:04,693][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:36:04,694][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:36:04,694][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:36:04,694][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:36:04,694][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:36:04,694][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:36:04,694][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:36:04,694][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:36:04,695][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:36:04,695][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 02:36:04,695][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:36:04,695][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:36:04,695][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:36:04,695][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:36:04,695][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:36:04,696][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:36:04,696][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:36:04,696][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:36:04,696][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:36:04,696][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:36:04,696][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:36:04,696][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:36:04,697][root][ERROR] - |Q. 47||D: Torts| Failed to extract explanation: 
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:36:04,697][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:36:04,698][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:36:04,698][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:36:04,698][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:36:04,698][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:36:04,698][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:36:04,698][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:36:04,698][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 02:36:04,699][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:36:04,699][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:36:04,699][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:36:04,699][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 02:36:04,699][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:36:04,699][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:36:04,699][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:36:04,699][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:36:04,700][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:36:04,700][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:36:04,700][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:36:04,700][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:36:04,700][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:36:04,700][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:36:04,700][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:36:04,701][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:36:04,701][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:36:04,702][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 02:36:04,702][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:36:04,702][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:36:04,702][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:36:04,702][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:36:04,702][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:36:04,702][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:36:04,703][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:36:04,704][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 02:36:04,704][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,708][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,709][root][INFO] - Saved parsed outputs
[2025-02-21 02:36:04,709][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,711][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,711][root][INFO] - Saved parsing metadata
[2025-02-21 02:36:04,711][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,713][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:04,714][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:36:04,731][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 02:36:04,731][root][INFO] - Summary of metrics : {'label_accuracy': 0.15151515151515152, 'misclassification_rate': 0.8484848484848485, 'combined_accuracy': 0.0, 'malformed_label': 75, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 84}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 02:36:10,997][root][INFO] - Setting global seed to 989
[2025-02-21 02:36:11,002][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 02:36:11,002][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:36:11,003][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:36:11,005][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:36:11,007][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:36:11,007][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:36:11,179][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:36:11,710][root][INFO] - Full model selected, loading model
[2025-02-21 02:36:33,990][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 02:36:33,990][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 02:36:41,745][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:36:41,747][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:36:41,747][root][INFO] - Starting inference
[2025-02-21 02:36:41,932][root][INFO] - Processing question number 0
[2025-02-21 02:36:41,934][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:36:54,766][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:37:15,931][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:37:23,288][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:37:45,498][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:37:52,815][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:38:14,022][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:38:25,956][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:38:37,545][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:38:48,478][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:38:57,407][root][INFO] - Processing question number 10
[2025-02-21 02:38:57,408][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:39:13,976][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:39:26,867][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:39:37,787][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:39:55,421][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:40:13,875][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:40:34,595][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:40:48,080][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:40:55,258][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:41:01,744][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:41:15,073][root][INFO] - Processing question number 20
[2025-02-21 02:41:15,075][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:41:22,847][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:41:36,001][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:41:53,364][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:42:02,517][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:42:16,735][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:42:31,841][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:42:40,890][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:42:56,911][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:43:13,440][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:43:24,981][root][INFO] - Processing question number 30
[2025-02-21 02:43:24,985][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:43:39,373][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:43:46,000][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:44:02,412][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:44:11,443][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:44:22,267][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:44:30,295][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:44:39,418][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:44:53,049][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:45:02,354][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:45:18,165][root][INFO] - Processing question number 40
[2025-02-21 02:45:18,168][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:45:30,402][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:45:38,558][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:45:47,953][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:45:55,708][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:46:08,601][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:46:20,830][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:46:30,133][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:46:37,781][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:47:03,357][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:47:14,386][root][INFO] - Processing question number 50
[2025-02-21 02:47:14,388][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:47:33,465][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:47:57,573][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:48:08,323][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:48:27,077][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:48:41,194][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:48:55,615][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:49:05,991][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:49:18,396][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:49:39,880][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:49:47,994][root][INFO] - Processing question number 60
[2025-02-21 02:49:47,998][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:49:59,000][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:50:09,452][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:50:22,778][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:50:32,534][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:50:48,733][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:51:00,950][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:51:13,344][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:51:23,431][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:51:39,825][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:51:50,447][root][INFO] - Processing question number 70
[2025-02-21 02:51:50,450][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:51:59,011][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:52:06,463][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:52:17,801][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:52:25,565][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:52:39,012][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:52:56,446][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:53:07,068][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:53:21,729][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:53:36,746][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:53:47,825][root][INFO] - Processing question number 80
[2025-02-21 02:53:47,829][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:53:58,720][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:54:08,022][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:54:15,194][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:54:21,598][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:54:30,572][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:54:41,274][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:54:49,858][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:55:04,624][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:55:26,528][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:55:37,800][root][INFO] - Processing question number 90
[2025-02-21 02:55:37,805][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:55:53,933][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:56:01,256][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:56:11,768][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:56:17,821][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:56:35,936][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:56:52,835][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:57:01,713][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:57:20,244][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:57:31,546][root][INFO] - Inference complete
[2025-02-21 02:57:31,546][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,552][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,553][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 02:57:31,553][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 02:57:31,554][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 02:57:31,554][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:57:31,554][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 02:57:31,554][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 02:57:31,554][root][ERROR] - |Q. 28||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:57:31,554][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 02:57:31,554][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 02:57:31,554][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:57:31,555][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 02:57:31,555][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:57:31,555][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 02:57:31,555][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 02:57:31,555][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:57:31,555][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 02:57:31,555][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 02:57:31,555][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 02:57:31,555][root][ERROR] - |Q. 77||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 02:57:31,556][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 02:57:31,556][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 02:57:31,556][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 02:57:31,556][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 02:57:31,556][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 02:57:31,556][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:57:31,556][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 02:57:31,556][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:57:31,557][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 02:57:31,557][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 02:57:31,557][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:57:31,557][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 02:57:31,557][root][ERROR] - |Q. 37||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:57:31,557][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 02:57:31,557][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 02:57:31,557][root][ERROR] - |Q. 55||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:57:31,557][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 02:57:31,558][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 02:57:31,558][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 02:57:31,558][root][ERROR] - |Q. 71||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 02:57:31,558][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 02:57:31,558][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 02:57:31,558][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 02:57:31,558][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 02:57:31,558][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,558][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 02:57:31,559][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,559][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 02:57:31,559][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 02:57:31,559][root][ERROR] - |Q. 22||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,559][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 02:57:31,559][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 02:57:31,559][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,559][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 02:57:31,559][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 02:57:31,560][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,560][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 02:57:31,560][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,560][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 02:57:31,560][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 02:57:31,560][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 02:57:31,560][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,560][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 02:57:31,560][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,560][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 02:57:31,561][root][ERROR] - |Q. 94||D: Contracts| Failed to extract explanation: 
[2025-02-21 02:57:31,561][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 02:57:31,561][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 02:57:31,561][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 02:57:31,561][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 02:57:31,561][root][ERROR] - |Q. 32||D: Torts| Failed to extract explanation: 
[2025-02-21 02:57:31,561][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 02:57:31,561][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 02:57:31,562][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 02:57:31,562][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 02:57:31,562][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 02:57:31,562][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 02:57:31,562][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 02:57:31,562][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 02:57:31,562][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 02:57:31,563][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 02:57:31,563][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 02:57:31,563][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 02:57:31,563][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 02:57:31,563][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 02:57:31,563][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 02:57:31,563][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:57:31,563][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 02:57:31,563][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:57:31,564][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 02:57:31,564][root][ERROR] - |Q. 40||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:57:31,564][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 02:57:31,564][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 02:57:31,564][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 02:57:31,564][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 02:57:31,564][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:57:31,564][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 02:57:31,564][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 02:57:31,565][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 02:57:31,565][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:57:31,565][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 02:57:31,565][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 02:57:31,565][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 02:57:31,565][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 02:57:31,565][root][ERROR] - |Q. 13||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,565][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 02:57:31,565][root][ERROR] - |Q. 20||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,565][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 02:57:31,566][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 02:57:31,566][root][ERROR] - |Q. 39||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,566][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 02:57:31,566][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 02:57:31,566][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 02:57:31,566][root][ERROR] - |Q. 61||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,566][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 02:57:31,566][root][ERROR] - |Q. 67||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,566][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 02:57:31,567][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,567][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 02:57:31,567][root][ERROR] - |Q. 83||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,567][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 02:57:31,567][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,567][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 02:57:31,567][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,567][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 02:57:31,567][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 02:57:31,567][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 02:57:31,567][root][ERROR] - |Q. 10||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:57:31,568][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 02:57:31,568][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 02:57:31,568][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 02:57:31,568][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 02:57:31,568][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 02:57:31,568][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:57:31,568][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 02:57:31,568][root][ERROR] - |Q. 50||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:57:31,568][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 02:57:31,569][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:57:31,569][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 02:57:31,569][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 02:57:31,569][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 02:57:31,569][root][ERROR] - |Q. 80||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:57:31,569][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 02:57:31,569][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 02:57:31,569][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 02:57:31,570][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,574][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,574][root][INFO] - Saved parsed outputs
[2025-02-21 02:57:31,574][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,576][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,576][root][INFO] - Saved parsing metadata
[2025-02-21 02:57:31,576][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,578][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 02:57:31,579][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:57:31,616][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 02:57:31,616][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 99, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 99}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 02:57:41,830][root][INFO] - Setting global seed to 989
[2025-02-21 02:57:41,838][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:57:41,839][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 02:57:41,840][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:57:41,842][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:57:41,846][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:57:41,847][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:57:41,997][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 02:57:42,532][root][INFO] - Full model selected, loading model
[2025-02-21 02:58:02,819][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:59:45,402][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:59:45,403][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:00:16,534][root][INFO] - Peft model loaded successfully
[2025-02-21 03:00:23,943][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:00:23,944][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:00:23,945][root][INFO] - Starting inference
[2025-02-21 03:00:24,159][root][INFO] - Processing question number 0
[2025-02-21 03:00:24,161][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:00:28,605][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:00:39,555][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:00:49,080][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:01:07,327][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:01:15,524][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:01:26,929][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:01:33,525][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:01:42,100][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:01:46,494][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:01:51,816][root][INFO] - Processing question number 10
[2025-02-21 03:01:51,817][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:01:57,560][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:02:19,537][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:02:26,975][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:02:35,063][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:02:45,757][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:02:51,855][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:03:00,731][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:03:05,584][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:03:13,787][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:03:22,758][root][INFO] - Processing question number 20
[2025-02-21 03:03:22,760][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:03:45,612][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:03:50,692][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:04:05,760][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:04:11,996][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:04:16,672][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:04:21,215][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:04:29,944][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:04:35,127][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:04:48,808][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:04:52,430][root][INFO] - Processing question number 30
[2025-02-21 03:04:52,432][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:05:03,539][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:05:08,509][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:05:15,802][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:05:19,843][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:05:23,114][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:05:29,240][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:05:35,476][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:05:59,587][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:06:06,406][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:06:13,240][root][INFO] - Processing question number 40
[2025-02-21 03:06:13,242][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:06:22,297][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:06:31,303][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:06:37,898][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:06:54,582][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:07:13,351][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:07:18,401][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:07:26,310][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:07:31,154][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:07:34,460][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:07:46,037][root][INFO] - Processing question number 50
[2025-02-21 03:07:46,039][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:07:52,934][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:08:05,516][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:08:10,388][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:08:17,250][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:08:26,026][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:08:34,411][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:08:40,112][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:08:46,446][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:09:00,386][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:09:16,589][root][INFO] - Processing question number 60
[2025-02-21 03:09:16,592][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:09:30,264][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:09:34,530][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:09:56,866][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:10:07,042][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:10:18,619][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:10:25,083][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:10:29,700][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:10:39,512][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:10:46,753][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:11:03,802][root][INFO] - Processing question number 70
[2025-02-21 03:11:03,805][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:11:09,756][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:11:12,800][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:11:20,637][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:11:37,305][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:11:45,495][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:12:06,483][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:12:21,252][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:12:31,441][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:12:40,263][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:12:46,320][root][INFO] - Processing question number 80
[2025-02-21 03:12:46,324][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:12:51,878][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:13:05,519][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:13:13,387][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:13:22,048][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:13:30,046][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:13:38,453][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:13:51,575][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:14:02,699][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:14:14,047][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:14:20,695][root][INFO] - Processing question number 90
[2025-02-21 03:14:20,699][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:14:43,164][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:14:47,140][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:14:56,963][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:14:59,534][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:15:06,541][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:15:11,925][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:15:16,784][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:15:45,846][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:15:59,576][root][INFO] - Inference complete
[2025-02-21 03:15:59,576][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,581][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,582][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:15:59,582][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:15:59,583][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 03:15:59,583][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:15:59,583][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:15:59,583][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:15:59,583][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:15:59,583][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:15:59,583][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:15:59,584][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 03:15:59,584][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 03:15:59,584][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:15:59,584][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:15:59,584][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 03:15:59,584][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 03:15:59,584][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:15:59,585][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:15:59,585][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:15:59,585][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:15:59,585][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:15:59,585][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 03:15:59,585][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:15:59,585][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:15:59,585][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:15:59,586][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:15:59,587][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:15:59,588][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:15:59,588][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:15:59,588][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:15:59,588][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:15:59,588][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:15:59,588][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:15:59,588][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 03:15:59,589][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 03:15:59,590][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:15:59,590][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:15:59,590][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:15:59,590][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:15:59,590][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 03:15:59,590][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:15:59,590][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:15:59,590][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:15:59,591][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 03:15:59,591][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:15:59,591][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:15:59,591][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 03:15:59,591][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:15:59,591][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:15:59,591][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:15:59,592][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:15:59,592][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:15:59,592][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 03:15:59,592][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:15:59,592][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 03:15:59,592][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:15:59,592][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:15:59,593][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:15:59,593][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:15:59,593][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:15:59,593][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:15:59,593][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:15:59,593][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:15:59,593][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:15:59,594][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:15:59,595][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:15:59,595][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 03:15:59,595][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:15:59,595][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:15:59,595][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:15:59,595][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:15:59,595][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:15:59,595][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:15:59,596][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 03:15:59,596][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:15:59,596][root][ERROR] - |Q. 85||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:15:59,596][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 03:15:59,597][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,601][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,601][root][INFO] - Saved parsed outputs
[2025-02-21 03:15:59,601][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,602][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,602][root][INFO] - Saved parsing metadata
[2025-02-21 03:15:59,603][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,604][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:15:59,606][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:15:59,619][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 03:15:59,619][root][INFO] - Summary of metrics : {'label_accuracy': 0.1111111111111111, 'misclassification_rate': 0.8888888888888888, 'combined_accuracy': 0.0, 'malformed_label': 79, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 11, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 11, 'both_wrong': 88}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 03:16:05,906][root][INFO] - Setting global seed to 989
[2025-02-21 03:16:05,911][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:16:05,911][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:16:05,913][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:16:05,914][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:16:05,916][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:16:05,916][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:16:06,066][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:16:06,598][root][INFO] - Full model selected, loading model
[2025-02-21 03:16:25,300][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:16:25,300][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:16:33,068][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:16:33,069][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:16:33,069][root][INFO] - Starting inference
[2025-02-21 03:16:33,256][root][INFO] - Processing question number 0
[2025-02-21 03:16:33,258][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:16:42,405][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:16:54,894][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:17:03,083][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:17:09,662][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:17:28,181][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:17:42,039][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:17:52,940][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:18:00,787][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:18:11,418][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:18:21,485][root][INFO] - Processing question number 10
[2025-02-21 03:18:21,486][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:18:32,763][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:18:43,462][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:18:54,646][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:19:16,608][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:19:28,292][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:19:42,410][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:19:54,286][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:20:06,166][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:20:13,536][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:20:31,658][root][INFO] - Processing question number 20
[2025-02-21 03:20:31,660][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:20:41,292][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:20:56,934][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:21:07,078][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:21:18,919][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:21:27,891][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:21:39,023][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:21:55,279][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:22:06,049][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:22:20,831][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:22:28,017][root][INFO] - Processing question number 30
[2025-02-21 03:22:28,019][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:22:38,098][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:22:48,763][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:23:03,522][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:23:14,936][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:23:28,073][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:23:35,319][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:23:46,505][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:23:57,273][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:24:12,005][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:24:31,639][root][INFO] - Processing question number 40
[2025-02-21 03:24:31,642][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:24:46,590][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:24:58,456][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:25:07,860][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:25:24,850][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:25:41,428][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:25:57,087][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:26:07,908][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:26:20,214][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:26:26,346][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:26:38,924][root][INFO] - Processing question number 50
[2025-02-21 03:26:38,926][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:26:48,997][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:27:07,734][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:27:16,938][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:27:26,737][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:27:40,586][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:27:53,119][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:28:08,109][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:28:26,083][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:28:37,137][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:28:45,504][root][INFO] - Processing question number 60
[2025-02-21 03:28:45,507][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:28:52,259][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:29:01,528][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:29:10,393][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:29:23,033][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:29:37,502][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:29:53,046][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:30:10,221][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:30:19,104][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:30:29,466][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:30:44,857][root][INFO] - Processing question number 70
[2025-02-21 03:30:44,861][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:30:55,991][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:31:01,895][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:31:11,115][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:31:37,344][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:31:55,804][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:32:08,602][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:32:27,201][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:32:36,739][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:32:43,188][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:32:53,023][root][INFO] - Processing question number 80
[2025-02-21 03:32:53,028][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:33:12,932][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:33:21,499][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:33:40,115][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:33:48,495][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:33:58,132][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:34:09,284][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:34:23,916][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:34:38,916][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:34:52,467][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:35:00,086][root][INFO] - Processing question number 90
[2025-02-21 03:35:00,090][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:35:21,433][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:35:32,465][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:35:47,478][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:35:53,988][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:36:04,290][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:36:15,078][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:36:24,155][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:36:48,315][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:36:59,587][root][INFO] - Inference complete
[2025-02-21 03:36:59,587][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,592][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,592][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:36:59,593][root][ERROR] - |Q. 1||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:36:59,593][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 03:36:59,593][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:36:59,593][root][ERROR] - |Q. 14||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:36:59,593][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:36:59,593][root][ERROR] - |Q. 21||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:36:59,593][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:36:59,593][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:36:59,594][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:36:59,594][root][ERROR] - |Q. 42||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:36:59,594][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:36:59,594][root][ERROR] - |Q. 49||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:36:59,594][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 03:36:59,594][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 03:36:59,594][root][ERROR] - |Q. 63||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:36:59,594][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:36:59,594][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:36:59,595][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 03:36:59,595][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 03:36:59,595][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:36:59,595][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:36:59,595][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:36:59,595][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:36:59,595][root][ERROR] - |Q. 9||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:36:59,596][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 03:36:59,596][root][ERROR] - |Q. 17||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:36:59,596][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:36:59,596][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:36:59,596][root][ERROR] - |Q. 29||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:36:59,596][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:36:59,596][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:36:59,596][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:36:59,597][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:36:59,597][root][ERROR] - |Q. 60||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:36:59,597][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:36:59,597][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:36:59,597][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:36:59,597][root][ERROR] - |Q. 79||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:36:59,597][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:36:59,597][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:36:59,597][root][ERROR] - |Q. 93||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:36:59,598][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:36:59,598][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:36:59,598][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:36:59,598][root][ERROR] - |Q. 8||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:36:59,598][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:36:59,598][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 03:36:59,598][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:36:59,598][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:36:59,598][root][ERROR] - |Q. 38||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:36:59,599][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:36:59,599][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:36:59,599][root][ERROR] - |Q. 51||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:36:59,599][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:36:59,599][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:36:59,599][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:36:59,599][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:36:59,599][root][ERROR] - |Q. 81||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:36:59,599][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:36:59,600][root][ERROR] - |Q. 88||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:36:59,600][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:36:59,600][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 03:36:59,600][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:36:59,600][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:36:59,600][root][ERROR] - |Q. 24||D: Torts| Failed to extract explanation: 
[2025-02-21 03:36:59,600][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:36:59,600][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:36:59,601][root][ERROR] - |Q. 41||D: Torts| Failed to extract explanation: 
[2025-02-21 03:36:59,601][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:36:59,601][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:36:59,601][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 03:36:59,601][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 03:36:59,601][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 03:36:59,601][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:36:59,601][root][ERROR] - |Q. 82||D: Torts| Failed to extract explanation: 
[2025-02-21 03:36:59,601][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:36:59,602][root][ERROR] - |Q. 90||D: Torts| Failed to extract explanation: 
[2025-02-21 03:36:59,602][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:36:59,602][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 03:36:59,602][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:36:59,602][root][ERROR] - |Q. 99||D: Torts| Failed to extract explanation: 
[2025-02-21 03:36:59,602][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:36:59,602][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:36:59,602][root][ERROR] - |Q. 12||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,602][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:36:59,603][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 03:36:59,603][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,603][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:36:59,603][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,603][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:36:59,603][root][ERROR] - |Q. 34||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,603][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 03:36:59,603][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:36:59,603][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:36:59,604][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:36:59,604][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:36:59,604][root][ERROR] - |Q. 68||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,604][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:36:59,604][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,604][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 03:36:59,604][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:36:59,604][root][ERROR] - |Q. 86||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,604][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 03:36:59,605][root][ERROR] - |Q. 96||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:36:59,605][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:36:59,605][root][ERROR] - |Q. 6||D: Property| Failed to extract explanation: 
[2025-02-21 03:36:59,605][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:36:59,605][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:36:59,605][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:36:59,605][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:36:59,605][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:36:59,606][root][ERROR] - |Q. 48||D: Property| Failed to extract explanation: 
[2025-02-21 03:36:59,606][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:36:59,606][root][ERROR] - |Q. 54||D: Property| Failed to extract explanation: 
[2025-02-21 03:36:59,606][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:36:59,606][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:36:59,606][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:36:59,606][root][ERROR] - |Q. 75||D: Property| Failed to extract explanation: 
[2025-02-21 03:36:59,606][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:36:59,606][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:36:59,606][root][ERROR] - |Q. 89||D: Property| Failed to extract explanation: 
[2025-02-21 03:36:59,607][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:36:59,607][root][ERROR] - |Q. 97||D: Property| Failed to extract explanation: 
[2025-02-21 03:36:59,607][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 03:36:59,607][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 03:36:59,607][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:36:59,607][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:36:59,607][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:36:59,607][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:36:59,607][root][ERROR] - |Q. 30||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:36:59,608][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 03:36:59,608][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:36:59,608][root][ERROR] - |Q. 45||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:36:59,608][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:36:59,608][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:36:59,608][root][ERROR] - |Q. 57||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:36:59,608][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:36:59,608][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:36:59,608][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:36:59,609][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 03:36:59,609][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:36:59,609][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 03:36:59,609][root][ERROR] - |Q. 92||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 03:36:59,610][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,614][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,614][root][INFO] - Saved parsed outputs
[2025-02-21 03:36:59,614][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,615][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,615][root][INFO] - Saved parsing metadata
[2025-02-21 03:36:59,616][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,617][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
[2025-02-21 03:36:59,619][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:36:59,629][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_1
[2025-02-21 03:36:59,629][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 99, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 99}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 03:37:06,393][root][INFO] - Setting global seed to 206
[2025-02-21 03:37:06,398][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 03:37:06,398][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:37:06,400][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:37:06,402][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:37:06,404][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:37:06,404][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:37:06,549][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:37:07,126][root][INFO] - Full model selected, loading model
[2025-02-21 03:37:28,022][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:39:09,896][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:39:09,897][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:39:43,059][root][INFO] - Peft model loaded successfully
[2025-02-21 03:39:50,830][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:39:50,832][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:39:50,832][root][INFO] - Starting inference
[2025-02-21 03:39:51,010][root][INFO] - Processing question number 0
[2025-02-21 03:39:51,012][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:39:59,253][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:40:03,572][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:40:11,822][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:40:40,600][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:40:47,521][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:40:53,447][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 03:41:21,761][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 03:41:27,324][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 03:41:33,705][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 03:41:39,066][root][INFO] - Processing question number 10
[2025-02-21 03:41:39,067][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 03:41:43,102][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 03:42:11,404][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 03:42:19,538][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 03:42:24,839][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 03:42:33,943][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 03:42:42,522][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:42:52,241][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 03:42:57,003][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 03:43:04,420][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 03:43:12,025][root][INFO] - Processing question number 20
[2025-02-21 03:43:12,030][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 03:43:17,842][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 03:43:22,974][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:43:30,757][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 03:43:34,050][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 03:43:44,266][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 03:43:59,530][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 03:44:06,145][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 03:44:14,963][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:44:20,675][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 03:44:29,972][root][INFO] - Processing question number 30
[2025-02-21 03:44:29,974][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 03:44:35,927][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 03:45:04,225][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 03:45:11,622][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 03:45:16,805][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 03:45:22,890][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 03:45:30,841][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:45:40,885][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 03:45:45,542][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:45:50,628][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 03:45:58,536][root][INFO] - Processing question number 40
[2025-02-21 03:45:58,538][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 03:46:03,541][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 03:46:10,564][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 03:46:17,209][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 03:46:22,627][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 03:46:42,722][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 03:46:50,673][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:46:55,481][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:47:00,641][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 03:47:15,167][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 03:47:20,574][root][INFO] - Processing question number 50
[2025-02-21 03:47:20,577][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 03:47:28,598][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 03:47:32,225][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 03:47:58,025][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:48:06,444][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 03:48:13,928][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 03:48:20,184][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 03:48:29,090][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 03:48:57,730][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 03:49:02,817][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 03:49:19,537][root][INFO] - Processing question number 60
[2025-02-21 03:49:19,541][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 03:49:27,130][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 03:49:45,629][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 03:50:14,731][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 03:50:24,956][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 03:50:41,176][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 03:50:50,775][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 03:51:03,304][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 03:51:07,876][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 03:51:18,127][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 03:51:23,196][root][INFO] - Processing question number 70
[2025-02-21 03:51:23,200][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 03:51:51,873][root][INFO] - Domain : Property, Question : 9
[2025-02-21 03:52:02,412][root][INFO] - Domain : Property, Question : 17
[2025-02-21 03:52:31,176][root][INFO] - Domain : Property, Question : 25
[2025-02-21 03:52:39,166][root][INFO] - Domain : Property, Question : 30
[2025-02-21 03:53:07,215][root][INFO] - Domain : Property, Question : 36
[2025-02-21 03:53:12,631][root][INFO] - Domain : Property, Question : 46
[2025-02-21 03:53:21,867][root][INFO] - Domain : Property, Question : 53
[2025-02-21 03:53:50,659][root][INFO] - Domain : Property, Question : 59
[2025-02-21 03:53:58,017][root][INFO] - Domain : Property, Question : 66
[2025-02-21 03:54:04,048][root][INFO] - Processing question number 80
[2025-02-21 03:54:04,053][root][INFO] - Domain : Property, Question : 69
[2025-02-21 03:54:13,433][root][INFO] - Domain : Property, Question : 81
[2025-02-21 03:54:17,878][root][INFO] - Domain : Property, Question : 88
[2025-02-21 03:54:23,653][root][INFO] - Domain : Property, Question : 91
[2025-02-21 03:54:31,336][root][INFO] - Domain : Property, Question : 94
[2025-02-21 03:54:36,963][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:55:05,302][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:55:16,722][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 03:55:24,811][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 03:55:29,572][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:55:42,332][root][INFO] - Processing question number 90
[2025-02-21 03:55:42,336][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 03:55:51,305][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 03:56:20,295][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:56:25,945][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 03:56:33,654][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 03:56:47,129][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 03:56:55,086][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 03:57:06,991][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 03:57:13,114][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 03:57:41,101][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:57:51,036][root][INFO] - Inference complete
[2025-02-21 03:57:51,036][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,041][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,042][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 03:57:51,042][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 03:57:51,043][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:57:51,043][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 03:57:51,043][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 03:57:51,043][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:57:51,043][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 03:57:51,043][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:57:51,043][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 03:57:51,043][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 03:57:51,044][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:57:51,044][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 03:57:51,044][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 03:57:51,044][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 03:57:51,044][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 03:57:51,044][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:57:51,044][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 03:57:51,044][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 03:57:51,045][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 03:57:51,046][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 03:57:51,046][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 03:57:51,046][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 03:57:51,046][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 03:57:51,046][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 03:57:51,046][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 03:57:51,046][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 03:57:51,047][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 03:57:51,047][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 03:57:51,047][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 03:57:51,047][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 03:57:51,047][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 03:57:51,047][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 03:57:51,047][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 03:57:51,047][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 03:57:51,048][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 03:57:51,049][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 03:57:51,049][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 03:57:51,049][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:57:51,049][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 03:57:51,049][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 03:57:51,049][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 03:57:51,049][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 03:57:51,049][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 03:57:51,050][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 03:57:51,050][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 03:57:51,050][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 03:57:51,050][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 03:57:51,050][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 03:57:51,050][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 03:57:51,050][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 03:57:51,051][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 03:57:51,051][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 03:57:51,051][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 03:57:51,051][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 03:57:51,051][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 03:57:51,051][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 03:57:51,051][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 03:57:51,052][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 03:57:51,052][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:57:51,052][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 03:57:51,052][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 03:57:51,052][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 03:57:51,052][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 03:57:51,052][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 03:57:51,053][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 03:57:51,053][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 03:57:51,053][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 03:57:51,053][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 03:57:51,053][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 03:57:51,053][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 03:57:51,053][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 03:57:51,054][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 03:57:51,054][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 03:57:51,054][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 03:57:51,054][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 03:57:51,054][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 03:57:51,054][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 03:57:51,054][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 03:57:51,054][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 03:57:51,055][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 03:57:51,055][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 03:57:51,055][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 03:57:51,055][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 03:57:51,055][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 03:57:51,055][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 03:57:51,055][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 03:57:51,055][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 03:57:51,056][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 03:57:51,056][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 03:57:51,056][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 03:57:51,056][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 03:57:51,056][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 03:57:51,056][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 03:57:51,056][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 03:57:51,057][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 03:57:51,057][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 03:57:51,057][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 03:57:51,057][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 03:57:51,057][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 03:57:51,057][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 03:57:51,057][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 03:57:51,058][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 03:57:51,058][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,062][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,063][root][INFO] - Saved parsed outputs
[2025-02-21 03:57:51,063][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,064][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,064][root][INFO] - Saved parsing metadata
[2025-02-21 03:57:51,065][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,066][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:57:51,068][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 03:57:51,081][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 03:57:51,081][root][INFO] - Summary of metrics : {'label_accuracy': 0.16, 'misclassification_rate': 0.84, 'combined_accuracy': 0.0, 'malformed_label': 72, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 16, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 16, 'both_wrong': 84}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 03:57:57,390][root][INFO] - Setting global seed to 206
[2025-02-21 03:57:57,395][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 03:57:57,395][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 03:57:57,396][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 03:57:57,398][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:57:57,400][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:57:57,400][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 03:57:57,561][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 03:57:58,135][root][INFO] - Full model selected, loading model
[2025-02-21 03:58:12,726][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:58:12,726][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:58:20,562][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:58:20,563][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 03:58:20,564][root][INFO] - Starting inference
[2025-02-21 03:58:20,754][root][INFO] - Processing question number 0
[2025-02-21 03:58:20,757][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 03:58:49,568][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 03:59:09,343][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 03:59:25,695][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 03:59:35,402][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 03:59:48,322][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 03:59:57,488][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:00:13,857][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:00:26,971][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:00:43,100][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:00:54,213][root][INFO] - Processing question number 10
[2025-02-21 04:00:54,215][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:01:07,522][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:01:19,820][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:01:31,436][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:01:47,304][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:01:56,034][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:02:05,894][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:02:15,981][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:02:24,502][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:02:40,048][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:02:55,593][root][INFO] - Processing question number 20
[2025-02-21 04:02:55,595][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:03:03,592][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:03:13,904][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:03:24,012][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:03:37,466][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:03:45,628][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:03:54,756][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:04:08,360][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:04:26,300][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:04:37,129][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:04:48,155][root][INFO] - Processing question number 30
[2025-02-21 04:04:48,158][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:04:56,361][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:05:09,955][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:05:24,742][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:05:43,032][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:05:57,781][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:06:13,156][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:06:25,741][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:06:45,007][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:06:54,190][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:07:09,506][root][INFO] - Processing question number 40
[2025-02-21 04:07:09,509][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:07:18,236][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:07:27,258][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:07:39,362][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:07:55,743][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:08:11,415][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:08:22,584][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:08:32,944][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:08:41,657][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:08:48,486][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:08:57,540][root][INFO] - Processing question number 50
[2025-02-21 04:08:57,544][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:09:06,835][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:09:15,779][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:09:28,652][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:09:36,239][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:09:43,447][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:09:54,211][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:10:02,515][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:10:22,368][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:10:29,100][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:10:42,795][root][INFO] - Processing question number 60
[2025-02-21 04:10:42,798][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:10:51,576][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:11:06,004][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:11:21,044][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:11:35,289][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:11:58,193][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:12:05,394][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:12:14,060][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:12:23,721][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:12:31,093][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:12:42,456][root][INFO] - Processing question number 70
[2025-02-21 04:12:42,460][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:12:53,660][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:12:59,264][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:13:14,983][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:13:26,675][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:13:38,765][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:13:53,316][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:14:02,365][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:14:14,648][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:14:24,136][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:14:38,479][root][INFO] - Processing question number 80
[2025-02-21 04:14:38,483][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:14:48,190][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:14:54,738][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:15:04,594][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:15:21,906][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:15:30,383][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:15:41,123][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:16:00,666][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:16:10,028][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:16:19,884][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:16:37,375][root][INFO] - Processing question number 90
[2025-02-21 04:16:37,379][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:16:45,663][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:17:05,711][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:17:20,747][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:17:27,086][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:17:40,394][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:17:58,970][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:18:05,789][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:18:22,585][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:18:35,263][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:18:51,283][root][INFO] - Inference complete
[2025-02-21 04:18:51,283][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,288][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,289][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:18:51,289][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:18:51,289][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:18:51,290][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:18:51,290][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:18:51,290][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:18:51,290][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:18:51,290][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:18:51,290][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:18:51,290][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:18:51,291][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:18:51,291][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:18:51,291][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:18:51,291][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:18:51,291][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:18:51,291][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:18:51,291][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:18:51,291][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:18:51,291][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:18:51,292][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:18:51,292][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,292][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:18:51,292][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:18:51,292][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,292][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:18:51,292][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,292][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:18:51,292][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:18:51,293][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:18:51,293][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,293][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:18:51,293][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,293][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:18:51,293][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,293][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:18:51,293][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:18:51,293][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,293][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:18:51,294][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,294][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:18:51,294][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:18:51,294][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:18:51,294][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:18:51,294][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:18:51,294][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:18:51,294][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:18:51,294][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:18:51,295][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:18:51,295][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:18:51,295][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:18:51,295][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:18:51,295][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:18:51,295][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:18:51,295][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:18:51,296][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:18:51,296][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:18:51,296][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:18:51,296][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:18:51,296][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:18:51,296][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:18:51,296][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:18:51,296][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:18:51,296][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:18:51,296][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:18:51,297][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:18:51,297][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:18:51,297][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,297][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:18:51,297][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,297][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:18:51,297][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,297][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:18:51,297][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,298][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:18:51,298][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,298][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:18:51,298][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,298][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:18:51,298][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,298][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:18:51,298][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,298][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:18:51,298][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,298][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:18:51,299][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,299][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:18:51,299][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,299][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:18:51,299][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:18:51,299][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 04:18:51,299][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:18:51,299][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:18:51,299][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:18:51,299][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:18:51,300][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:18:51,300][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:18:51,300][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:18:51,300][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:18:51,300][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:18:51,300][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:18:51,300][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:18:51,300][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:18:51,301][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:18:51,301][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:18:51,301][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:18:51,301][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:18:51,301][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:18:51,301][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:18:51,301][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:18:51,301][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:18:51,301][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,301][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:18:51,302][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:18:51,302][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:18:51,302][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,302][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:18:51,302][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:18:51,302][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,302][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:18:51,302][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,302][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:18:51,303][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:18:51,303][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:18:51,303][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,303][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:18:51,303][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,303][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:18:51,303][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,303][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:18:51,303][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:18:51,303][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,304][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:18:51,304][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 04:18:51,304][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:18:51,304][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:18:51,304][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 04:18:51,304][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:18:51,304][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 04:18:51,304][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:18:51,304][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:18:51,305][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 04:18:51,305][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:18:51,305][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:18:51,305][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:18:51,305][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 04:18:51,305][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:18:51,305][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:18:51,305][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:18:51,305][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 04:18:51,306][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:18:51,306][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:18:51,306][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 04:18:51,306][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 04:18:51,307][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,311][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,311][root][INFO] - Saved parsed outputs
[2025-02-21 04:18:51,311][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,326][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,326][root][INFO] - Saved parsing metadata
[2025-02-21 04:18:51,327][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,328][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:18:51,331][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:18:51,344][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 04:18:51,344][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 100, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 100}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 04:18:58,433][root][INFO] - Setting global seed to 206
[2025-02-21 04:18:58,439][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:18:58,439][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:18:58,441][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:18:58,442][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:18:58,444][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:18:58,444][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:18:58,585][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:18:59,152][root][INFO] - Full model selected, loading model
[2025-02-21 04:19:19,057][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 04:21:01,712][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 04:21:01,736][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 04:21:33,031][root][INFO] - Peft model loaded successfully
[2025-02-21 04:21:40,724][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:21:40,727][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:21:40,727][root][INFO] - Starting inference
[2025-02-21 04:21:40,917][root][INFO] - Processing question number 0
[2025-02-21 04:21:40,924][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:21:53,794][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:21:58,197][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:22:03,763][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:22:12,899][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:22:19,748][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:22:26,583][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:22:35,602][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:22:41,628][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:22:46,001][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:22:53,881][root][INFO] - Processing question number 10
[2025-02-21 04:22:53,883][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:22:58,538][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:23:06,592][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:23:20,966][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:23:26,630][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:23:33,363][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:23:37,118][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:23:44,346][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:23:49,063][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:23:56,454][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:24:03,064][root][INFO] - Processing question number 20
[2025-02-21 04:24:03,066][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:24:11,187][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:24:18,203][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:24:26,887][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:24:33,843][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:25:02,385][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:25:09,127][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:25:16,446][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:25:22,175][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:25:27,713][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:25:41,112][root][INFO] - Processing question number 30
[2025-02-21 04:25:41,115][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:25:46,985][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:26:15,549][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:26:20,907][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:26:35,994][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:26:39,944][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:26:53,335][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:27:08,564][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:27:13,576][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:27:24,191][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:27:28,569][root][INFO] - Processing question number 40
[2025-02-21 04:27:28,572][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:27:33,698][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:27:41,772][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:27:48,720][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:27:57,504][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:28:22,746][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:28:30,295][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:28:35,371][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:28:39,195][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:28:54,974][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:29:01,977][root][INFO] - Processing question number 50
[2025-02-21 04:29:01,980][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:29:11,620][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:29:15,277][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:29:28,739][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:29:34,421][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:29:40,563][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:29:46,649][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:29:53,761][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:30:03,141][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:30:09,931][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:30:18,874][root][INFO] - Processing question number 60
[2025-02-21 04:30:18,877][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:30:25,344][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:30:30,016][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:30:38,175][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:30:45,381][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:30:54,315][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:30:59,991][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:31:05,323][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:31:10,430][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:31:38,933][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:31:48,893][root][INFO] - Processing question number 70
[2025-02-21 04:31:48,897][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:32:00,864][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:32:13,753][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:32:23,634][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:32:32,965][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:33:01,263][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:33:10,567][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:33:18,608][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:33:47,667][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:33:54,146][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:34:22,699][root][INFO] - Processing question number 80
[2025-02-21 04:34:22,703][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:34:28,447][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:34:57,649][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:35:04,498][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:35:11,557][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:35:17,797][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:35:46,401][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:35:54,542][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:35:59,099][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:36:04,961][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:36:14,978][root][INFO] - Processing question number 90
[2025-02-21 04:36:14,982][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:36:20,939][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:36:29,631][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:36:34,876][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:36:38,530][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:36:49,369][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:37:03,658][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:37:17,563][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:37:21,518][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:37:27,830][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:37:39,174][root][INFO] - Inference complete
[2025-02-21 04:37:39,174][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,180][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,181][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:37:39,181][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:37:39,181][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:37:39,181][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:37:39,181][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:37:39,182][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:37:39,182][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:37:39,182][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:37:39,182][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:37:39,182][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:37:39,182][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:37:39,182][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:37:39,182][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:37:39,182][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:37:39,183][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:37:39,183][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:37:39,183][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:37:39,183][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:37:39,183][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:37:39,183][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:37:39,183][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:37:39,183][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:37:39,184][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:37:39,184][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:37:39,184][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:37:39,184][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:37:39,184][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:37:39,184][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:37:39,184][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:37:39,185][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:37:39,185][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:37:39,185][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:37:39,185][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:37:39,185][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:37:39,185][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:37:39,185][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:37:39,185][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:37:39,186][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:37:39,186][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:37:39,186][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:37:39,186][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:37:39,186][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:37:39,186][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:37:39,186][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:37:39,187][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:37:39,187][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:37:39,187][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:37:39,187][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:37:39,187][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:37:39,187][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:37:39,187][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:37:39,188][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:37:39,189][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:37:39,189][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:37:39,189][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:37:39,189][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:37:39,189][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 04:37:39,189][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:37:39,189][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:37:39,190][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:37:39,191][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:37:39,191][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:37:39,191][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:37:39,191][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:37:39,191][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:37:39,191][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:37:39,191][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:37:39,192][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:37:39,192][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 04:37:39,192][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:37:39,192][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:37:39,192][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:37:39,192][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 04:37:39,192][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:37:39,193][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:37:39,193][root][ERROR] - |Q. 66||D: Property| Failed to extract explanation: 
[2025-02-21 04:37:39,193][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:37:39,193][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:37:39,193][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 04:37:39,193][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:37:39,193][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:37:39,193][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:37:39,194][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:37:39,194][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:37:39,195][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:37:39,195][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:37:39,195][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:37:39,195][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:37:39,195][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:37:39,195][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:37:39,195][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 04:37:39,196][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,201][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,201][root][INFO] - Saved parsed outputs
[2025-02-21 04:37:39,201][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,203][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,203][root][INFO] - Saved parsing metadata
[2025-02-21 04:37:39,203][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,205][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:37:39,207][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:37:39,235][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 04:37:39,235][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.0, 'malformed_label': 72, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 85}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 04:37:46,266][root][INFO] - Setting global seed to 206
[2025-02-21 04:37:46,272][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 04:37:46,273][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:37:46,274][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:37:46,276][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:37:46,278][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:37:46,279][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:37:46,433][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:37:47,023][root][INFO] - Full model selected, loading model
[2025-02-21 04:38:09,436][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:38:09,446][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:38:17,203][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:38:17,205][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:38:17,205][root][INFO] - Starting inference
[2025-02-21 04:38:17,430][root][INFO] - Processing question number 0
[2025-02-21 04:38:17,447][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 04:38:35,457][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 04:38:47,548][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 04:39:04,875][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 04:39:12,771][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 04:39:20,050][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 04:39:37,815][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 04:39:54,418][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 04:40:06,178][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 04:40:15,373][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 04:40:27,240][root][INFO] - Processing question number 10
[2025-02-21 04:40:27,242][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 04:40:38,956][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 04:41:07,705][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 04:41:22,517][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 04:41:37,208][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 04:41:47,678][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 04:41:56,260][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:42:06,462][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 04:42:20,824][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 04:42:29,677][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 04:42:38,015][root][INFO] - Processing question number 20
[2025-02-21 04:42:38,018][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 04:42:54,153][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 04:43:03,973][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:43:13,780][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 04:43:25,187][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 04:43:34,872][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 04:43:44,148][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 04:43:55,975][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 04:44:16,776][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:44:28,520][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 04:44:43,624][root][INFO] - Processing question number 30
[2025-02-21 04:44:43,627][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 04:44:53,173][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 04:45:00,825][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 04:45:20,322][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 04:45:38,238][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 04:45:53,534][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 04:46:08,415][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:46:26,844][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 04:46:43,123][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:46:57,775][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 04:47:16,778][root][INFO] - Processing question number 40
[2025-02-21 04:47:16,781][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 04:47:26,256][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 04:47:41,283][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 04:47:58,664][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 04:48:10,383][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 04:48:39,664][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 04:48:48,025][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:49:05,970][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:49:14,921][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 04:49:27,022][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 04:49:39,605][root][INFO] - Processing question number 50
[2025-02-21 04:49:39,608][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 04:49:48,560][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 04:49:59,098][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 04:50:12,447][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:50:24,573][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 04:50:37,822][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 04:50:45,660][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 04:50:55,888][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 04:51:07,117][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 04:51:15,271][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 04:51:29,357][root][INFO] - Processing question number 60
[2025-02-21 04:51:29,362][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 04:51:37,682][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 04:51:51,375][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 04:52:02,823][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 04:52:14,013][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 04:52:35,645][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 04:52:54,586][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 04:53:06,584][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 04:53:20,399][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 04:53:29,972][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 04:53:38,928][root][INFO] - Processing question number 70
[2025-02-21 04:53:38,932][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 04:53:49,649][root][INFO] - Domain : Property, Question : 9
[2025-02-21 04:53:57,293][root][INFO] - Domain : Property, Question : 17
[2025-02-21 04:54:06,254][root][INFO] - Domain : Property, Question : 25
[2025-02-21 04:54:14,893][root][INFO] - Domain : Property, Question : 30
[2025-02-21 04:54:25,732][root][INFO] - Domain : Property, Question : 36
[2025-02-21 04:54:44,161][root][INFO] - Domain : Property, Question : 46
[2025-02-21 04:54:53,164][root][INFO] - Domain : Property, Question : 53
[2025-02-21 04:55:02,752][root][INFO] - Domain : Property, Question : 59
[2025-02-21 04:55:12,991][root][INFO] - Domain : Property, Question : 66
[2025-02-21 04:55:23,883][root][INFO] - Processing question number 80
[2025-02-21 04:55:23,887][root][INFO] - Domain : Property, Question : 69
[2025-02-21 04:55:35,306][root][INFO] - Domain : Property, Question : 81
[2025-02-21 04:55:42,539][root][INFO] - Domain : Property, Question : 88
[2025-02-21 04:55:58,854][root][INFO] - Domain : Property, Question : 91
[2025-02-21 04:56:07,081][root][INFO] - Domain : Property, Question : 94
[2025-02-21 04:56:19,086][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:56:30,605][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:56:47,580][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 04:56:57,503][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 04:57:07,361][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:57:21,207][root][INFO] - Processing question number 90
[2025-02-21 04:57:21,211][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 04:57:30,422][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 04:57:40,451][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:57:51,739][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 04:58:01,244][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 04:58:18,794][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 04:58:35,521][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 04:58:43,942][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 04:58:51,915][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 04:59:04,581][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:59:21,783][root][INFO] - Inference complete
[2025-02-21 04:59:21,783][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,789][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,791][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 04:59:21,791][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 04:59:21,791][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 04:59:21,791][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 04:59:21,791][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:59:21,792][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 04:59:21,792][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:59:21,792][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 04:59:21,792][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 04:59:21,792][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 04:59:21,792][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 04:59:21,792][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:59:21,793][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 04:59:21,793][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:59:21,793][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 04:59:21,793][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 04:59:21,793][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 04:59:21,793][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 04:59:21,793][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 04:59:21,793][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 04:59:21,794][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,794][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 04:59:21,794][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,794][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 04:59:21,794][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,794][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 04:59:21,794][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,794][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 04:59:21,794][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,794][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 04:59:21,794][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,795][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 04:59:21,795][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 04:59:21,795][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,795][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 04:59:21,795][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,795][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 04:59:21,795][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 04:59:21,795][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,795][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 04:59:21,795][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,796][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 04:59:21,796][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 04:59:21,796][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 04:59:21,796][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 04:59:21,796][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 04:59:21,796][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 04:59:21,796][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:59:21,796][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 04:59:21,796][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:59:21,797][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 04:59:21,797][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 04:59:21,797][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 04:59:21,797][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 04:59:21,797][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 04:59:21,797][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 04:59:21,798][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 04:59:21,798][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 04:59:21,798][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 04:59:21,798][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 04:59:21,798][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 04:59:21,798][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 04:59:21,798][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 04:59:21,799][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 04:59:21,799][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 04:59:21,799][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,799][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 04:59:21,799][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 04:59:21,799][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,799][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 04:59:21,799][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 04:59:21,800][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,800][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 04:59:21,800][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,800][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 04:59:21,800][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,800][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 04:59:21,800][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 04:59:21,800][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 04:59:21,801][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 04:59:21,801][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,801][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 04:59:21,801][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,801][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 04:59:21,801][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 04:59:21,801][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 04:59:21,801][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,801][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 04:59:21,801][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 04:59:21,801][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,802][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 04:59:21,802][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 04:59:21,802][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,802][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 04:59:21,802][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,802][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 04:59:21,802][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 04:59:21,802][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 04:59:21,802][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,803][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 04:59:21,803][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,803][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 04:59:21,803][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,803][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 04:59:21,803][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,803][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 04:59:21,803][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 04:59:21,803][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 04:59:21,803][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,804][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 04:59:21,804][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,804][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 04:59:21,804][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,804][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 04:59:21,804][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,804][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 04:59:21,804][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 04:59:21,804][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,804][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 04:59:21,804][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,805][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 04:59:21,805][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 04:59:21,805][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 04:59:21,805][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,805][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 04:59:21,805][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,805][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 04:59:21,805][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 04:59:21,805][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,806][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 04:59:21,806][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,806][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 04:59:21,806][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 04:59:21,806][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 04:59:21,806][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 04:59:21,806][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 04:59:21,806][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 04:59:21,806][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 04:59:21,806][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 04:59:21,807][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 04:59:21,807][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 04:59:21,807][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 04:59:21,807][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 04:59:21,807][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 04:59:21,807][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 04:59:21,807][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 04:59:21,807][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 04:59:21,807][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 04:59:21,808][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 04:59:21,808][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 04:59:21,808][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 04:59:21,808][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 04:59:21,808][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 04:59:21,808][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 04:59:21,809][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,813][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,813][root][INFO] - Saved parsed outputs
[2025-02-21 04:59:21,813][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,815][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,815][root][INFO] - Saved parsing metadata
[2025-02-21 04:59:21,816][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,818][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 04:59:21,820][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 04:59:21,850][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 04:59:21,850][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 100, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 100}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 04:59:29,272][root][INFO] - Setting global seed to 206
[2025-02-21 04:59:29,278][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 04:59:29,278][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 04:59:29,279][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 04:59:29,280][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:59:29,283][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:59:29,284][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 04:59:29,439][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 04:59:29,996][root][INFO] - Full model selected, loading model
[2025-02-21 04:59:52,515][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:01:35,130][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:01:35,133][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:02:13,623][root][INFO] - Peft model loaded successfully
[2025-02-21 05:02:21,461][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:02:21,462][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:02:21,462][root][INFO] - Starting inference
[2025-02-21 05:02:21,645][root][INFO] - Processing question number 0
[2025-02-21 05:02:21,667][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:02:39,379][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:02:45,086][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:02:53,710][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:03:00,243][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:03:06,869][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:03:12,001][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:03:20,662][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:03:26,605][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:03:33,471][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:03:38,439][root][INFO] - Processing question number 10
[2025-02-21 05:03:38,441][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:03:42,624][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:03:50,029][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:03:54,691][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:04:00,595][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:04:10,434][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:04:16,088][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:04:19,857][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:04:29,655][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:04:38,516][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:04:44,352][root][INFO] - Processing question number 20
[2025-02-21 05:04:44,353][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:04:48,898][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:04:56,597][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:05:09,786][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:05:13,301][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:05:26,223][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:05:32,098][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:05:37,603][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:05:55,979][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:06:01,821][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:06:12,465][root][INFO] - Processing question number 30
[2025-02-21 05:06:12,467][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:06:22,792][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:06:29,111][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:06:37,093][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:06:47,880][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:06:55,500][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:06:59,172][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:07:12,075][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:07:17,885][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:07:29,455][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:07:36,241][root][INFO] - Processing question number 40
[2025-02-21 05:07:36,243][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:07:42,347][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:07:49,397][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:08:01,721][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:08:12,193][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:08:27,105][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:08:30,687][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:08:33,738][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:08:38,126][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:08:45,333][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:08:52,784][root][INFO] - Processing question number 50
[2025-02-21 05:08:52,787][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:08:58,277][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:09:05,732][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:09:10,526][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:09:23,255][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:09:36,070][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:09:47,839][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:09:52,365][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:09:58,973][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:10:05,400][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:10:34,295][root][INFO] - Processing question number 60
[2025-02-21 05:10:34,298][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:10:44,520][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:10:55,667][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:11:02,004][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:11:08,944][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:11:14,365][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:11:25,957][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:11:39,817][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:11:44,166][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:11:58,449][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:12:07,175][root][INFO] - Processing question number 70
[2025-02-21 05:12:07,179][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:12:19,253][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:12:33,430][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:12:51,907][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:12:58,192][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:13:09,532][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:13:25,726][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:13:44,515][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:13:54,142][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:13:58,335][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:14:03,514][root][INFO] - Processing question number 80
[2025-02-21 05:14:03,519][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:14:19,453][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:14:26,632][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:14:31,929][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:14:40,994][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:14:55,932][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:15:17,107][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:15:32,133][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:15:53,875][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:15:58,686][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:16:12,472][root][INFO] - Processing question number 90
[2025-02-21 05:16:12,476][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:16:21,682][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:16:29,724][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:16:58,819][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:17:06,373][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:17:14,809][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:17:27,288][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:17:39,932][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:17:45,344][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:17:50,175][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:17:58,335][root][INFO] - Inference complete
[2025-02-21 05:17:58,336][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,342][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,343][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 05:17:58,343][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 05:17:58,343][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 05:17:58,343][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 05:17:58,343][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 05:17:58,344][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:17:58,344][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 05:17:58,344][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 05:17:58,344][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 05:17:58,344][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:17:58,344][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 05:17:58,344][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 05:17:58,344][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 05:17:58,344][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:17:58,345][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 05:17:58,345][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:17:58,345][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 05:17:58,345][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:17:58,345][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 05:17:58,345][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 05:17:58,345][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 05:17:58,345][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 05:17:58,345][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 05:17:58,346][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 05:17:58,346][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 05:17:58,346][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 05:17:58,346][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:17:58,346][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 05:17:58,346][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 05:17:58,346][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:17:58,346][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 05:17:58,347][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 05:17:58,347][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 05:17:58,347][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 05:17:58,347][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 05:17:58,347][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 05:17:58,347][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 05:17:58,347][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 05:17:58,348][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 05:17:58,348][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 05:17:58,348][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 05:17:58,348][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 05:17:58,348][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 05:17:58,348][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 05:17:58,348][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:17:58,348][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 05:17:58,349][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 05:17:58,350][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 05:17:58,350][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 05:17:58,350][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 05:17:58,350][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 05:17:58,350][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 05:17:58,350][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 05:17:58,350][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 05:17:58,351][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 05:17:58,352][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 05:17:58,352][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 05:17:58,352][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 05:17:58,352][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 05:17:58,352][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 05:17:58,352][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 05:17:58,352][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 05:17:58,353][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 05:17:58,353][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 05:17:58,353][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 05:17:58,353][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 05:17:58,353][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 05:17:58,353][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 05:17:58,353][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 05:17:58,354][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 05:17:58,355][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 05:17:58,355][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 05:17:58,355][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 05:17:58,355][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 05:17:58,355][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 05:17:58,355][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 05:17:58,356][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 05:17:58,356][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 05:17:58,356][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 05:17:58,356][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 05:17:58,356][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 05:17:58,356][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 05:17:58,356][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 05:17:58,356][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 05:17:58,357][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 05:17:58,357][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 05:17:58,357][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 05:17:58,357][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 05:17:58,358][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,369][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,369][root][INFO] - Saved parsed outputs
[2025-02-21 05:17:58,369][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,372][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,372][root][INFO] - Saved parsing metadata
[2025-02-21 05:17:58,373][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,375][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:17:58,376][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:17:58,403][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 05:17:58,403][root][INFO] - Summary of metrics : {'label_accuracy': 0.15, 'misclassification_rate': 0.85, 'combined_accuracy': 0.0, 'malformed_label': 72, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 15, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 15, 'both_wrong': 85}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 05:18:06,986][root][INFO] - Setting global seed to 206
[2025-02-21 05:18:06,994][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 05:18:06,995][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:18:06,996][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:18:06,998][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:18:07,073][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:18:07,073][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:18:07,240][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:18:07,767][root][INFO] - Full model selected, loading model
[2025-02-21 05:18:30,016][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 05:18:30,017][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 05:18:37,993][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:18:37,995][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:18:37,995][root][INFO] - Starting inference
[2025-02-21 05:18:38,239][root][INFO] - Processing question number 0
[2025-02-21 05:18:38,299][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:18:57,155][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:19:22,681][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:19:38,909][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:19:51,547][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:20:03,524][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:20:17,090][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:20:30,139][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:20:41,327][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:20:55,800][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:21:03,372][root][INFO] - Processing question number 10
[2025-02-21 05:21:03,375][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:21:21,376][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:21:38,030][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:21:52,937][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:22:05,993][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:22:16,885][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:22:26,300][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:22:34,876][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:22:48,685][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:23:03,414][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:23:14,239][root][INFO] - Processing question number 20
[2025-02-21 05:23:14,241][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:23:24,849][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:23:40,389][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:23:54,111][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:24:05,978][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:24:17,329][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:24:28,627][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:24:42,470][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:25:01,374][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:25:12,599][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:25:24,176][root][INFO] - Processing question number 30
[2025-02-21 05:25:24,179][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:25:34,053][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:25:42,714][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:25:55,788][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:26:07,431][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:26:16,303][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:26:32,607][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:26:43,179][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:27:03,879][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:27:16,166][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:27:34,005][root][INFO] - Processing question number 40
[2025-02-21 05:27:34,008][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:27:44,036][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:27:57,359][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:28:13,750][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:28:25,012][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:28:40,175][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:28:50,301][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:28:59,892][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:29:08,610][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:29:25,785][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:29:36,667][root][INFO] - Processing question number 50
[2025-02-21 05:29:36,670][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:29:44,870][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:29:53,750][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:30:04,955][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:30:13,977][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:30:23,157][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:30:34,462][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:30:48,687][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:31:00,429][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:31:13,237][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:31:24,066][root][INFO] - Processing question number 60
[2025-02-21 05:31:24,069][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:31:33,128][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:31:49,856][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:32:05,635][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:32:13,772][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:32:29,681][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:32:46,359][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:32:54,571][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:33:00,723][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:33:15,814][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:33:24,542][root][INFO] - Processing question number 70
[2025-02-21 05:33:24,546][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:33:39,085][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:33:50,126][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:34:01,057][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:34:23,744][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:34:41,951][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:34:59,555][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:35:09,894][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:35:21,128][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:35:33,120][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:35:42,710][root][INFO] - Processing question number 80
[2025-02-21 05:35:42,718][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:35:53,048][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:35:59,576][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:36:20,965][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:36:28,955][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:36:47,134][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:36:59,732][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:37:21,341][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:37:31,971][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:37:40,890][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:37:58,704][root][INFO] - Processing question number 90
[2025-02-21 05:37:58,708][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:38:05,186][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:38:12,439][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:38:25,194][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:38:33,676][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:38:48,371][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 05:39:00,050][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 05:39:24,211][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 05:39:31,448][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 05:39:54,182][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:40:06,674][root][INFO] - Inference complete
[2025-02-21 05:40:06,674][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,680][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,680][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 05:40:06,681][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 05:40:06,681][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 05:40:06,681][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 05:40:06,681][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:40:06,681][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 05:40:06,682][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:40:06,682][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 05:40:06,682][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 05:40:06,682][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 05:40:06,682][root][ERROR] - |Q. 49||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:40:06,682][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 05:40:06,682][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 05:40:06,682][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 05:40:06,683][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 05:40:06,683][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 05:40:06,683][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 05:40:06,683][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 05:40:06,683][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 05:40:06,683][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,683][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 05:40:06,683][root][ERROR] - |Q. 8||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,684][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 05:40:06,684][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,684][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 05:40:06,684][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,684][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 05:40:06,684][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 05:40:06,684][root][ERROR] - |Q. 37||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,684][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 05:40:06,684][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,684][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 05:40:06,685][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 05:40:06,685][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 05:40:06,685][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 05:40:06,685][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 05:40:06,685][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,685][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 05:40:06,685][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 05:40:06,685][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 05:40:06,686][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 05:40:06,686][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 05:40:06,686][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:40:06,686][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 05:40:06,686][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:40:06,686][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 05:40:06,686][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 05:40:06,686][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 05:40:06,686][root][ERROR] - |Q. 34||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:40:06,687][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 05:40:06,687][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 05:40:06,687][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 05:40:06,687][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 05:40:06,687][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 05:40:06,687][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:40:06,687][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 05:40:06,687][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 05:40:06,688][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 05:40:06,688][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 05:40:06,688][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 05:40:06,688][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 05:40:06,688][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 05:40:06,688][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 05:40:06,688][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,688][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 05:40:06,689][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 05:40:06,689][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,689][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 05:40:06,689][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 05:40:06,689][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 05:40:06,689][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,689][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 05:40:06,689][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,689][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 05:40:06,689][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,690][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 05:40:06,690][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,690][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 05:40:06,690][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,690][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 05:40:06,690][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 05:40:06,690][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 05:40:06,690][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 05:40:06,690][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 05:40:06,691][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 05:40:06,691][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 05:40:06,691][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:40:06,691][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 05:40:06,691][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 05:40:06,691][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 05:40:06,691][root][ERROR] - |Q. 40||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:40:06,691][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 05:40:06,692][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 05:40:06,692][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 05:40:06,692][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:40:06,692][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 05:40:06,692][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:40:06,692][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 05:40:06,692][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 05:40:06,692][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 05:40:06,692][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 05:40:06,692][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 05:40:06,693][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 05:40:06,693][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 05:40:06,693][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 05:40:06,693][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 05:40:06,693][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 05:40:06,693][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 05:40:06,693][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 05:40:06,693][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 05:40:06,694][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 05:40:06,694][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 05:40:06,694][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 05:40:06,694][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 05:40:06,694][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 05:40:06,694][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 05:40:06,694][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 05:40:06,694][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 05:40:06,694][root][ERROR] - |Q. 91||D: Property| Failed to extract explanation: 
[2025-02-21 05:40:06,695][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 05:40:06,695][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 05:40:06,695][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 05:40:06,695][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 05:40:06,695][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,695][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 05:40:06,695][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,695][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 05:40:06,695][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 05:40:06,695][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,696][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 05:40:06,696][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,696][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 05:40:06,696][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 05:40:06,696][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,696][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 05:40:06,696][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 05:40:06,696][root][ERROR] - |Q. 67||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,696][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 05:40:06,697][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 05:40:06,697][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,697][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 05:40:06,697][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 05:40:06,697][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 05:40:06,698][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,709][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,709][root][INFO] - Saved parsed outputs
[2025-02-21 05:40:06,709][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,719][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,719][root][INFO] - Saved parsing metadata
[2025-02-21 05:40:06,720][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,721][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:40:06,722][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 05:40:06,748][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 05:40:06,748][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 100, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 100}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 05:40:13,918][root][INFO] - Setting global seed to 989
[2025-02-21 05:40:13,924][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 05:40:13,925][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 05:40:13,926][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 05:40:13,927][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:40:13,930][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:40:13,930][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 05:40:14,081][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 05:40:14,658][root][INFO] - Full model selected, loading model
[2025-02-21 05:40:34,099][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:42:16,872][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:42:16,872][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:42:48,607][root][INFO] - Peft model loaded successfully
[2025-02-21 05:42:55,996][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:42:55,998][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 05:42:55,999][root][INFO] - Starting inference
[2025-02-21 05:42:56,214][root][INFO] - Processing question number 0
[2025-02-21 05:42:56,228][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 05:43:04,549][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 05:43:08,865][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 05:43:17,116][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 05:43:45,886][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 05:43:52,805][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 05:43:58,728][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 05:44:27,051][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 05:44:32,611][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 05:44:38,991][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 05:44:44,349][root][INFO] - Processing question number 10
[2025-02-21 05:44:44,351][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 05:44:48,386][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 05:45:16,680][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 05:45:24,813][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 05:45:30,113][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 05:45:39,217][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 05:45:47,796][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:45:57,516][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 05:46:02,277][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 05:46:09,693][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 05:46:17,293][root][INFO] - Processing question number 20
[2025-02-21 05:46:17,295][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 05:46:23,108][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 05:46:28,238][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:46:36,022][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 05:46:39,314][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 05:46:49,531][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 05:47:04,794][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 05:47:11,409][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 05:47:20,224][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:47:25,935][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 05:47:35,233][root][INFO] - Processing question number 30
[2025-02-21 05:47:35,236][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 05:47:41,189][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 05:48:09,487][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 05:48:16,889][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 05:48:22,072][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 05:48:28,157][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 05:48:36,107][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:48:46,149][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 05:48:50,808][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:48:55,897][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 05:49:03,804][root][INFO] - Processing question number 40
[2025-02-21 05:49:03,807][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 05:49:08,810][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 05:49:15,835][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 05:49:22,486][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 05:49:27,910][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 05:49:48,010][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 05:49:55,961][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:50:00,770][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:50:05,931][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 05:50:20,461][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 05:50:25,870][root][INFO] - Processing question number 50
[2025-02-21 05:50:25,873][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 05:50:33,893][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 05:50:37,519][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 05:51:03,324][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:51:11,740][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 05:51:19,223][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 05:51:25,480][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 05:51:34,385][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 05:52:03,019][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 05:52:08,102][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 05:52:24,820][root][INFO] - Processing question number 60
[2025-02-21 05:52:24,824][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 05:52:32,418][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 05:52:50,914][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 05:53:20,028][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 05:53:30,255][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 05:53:46,498][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 05:53:56,162][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 05:54:08,752][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 05:54:13,324][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 05:54:23,576][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 05:54:28,640][root][INFO] - Processing question number 70
[2025-02-21 05:54:28,644][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 05:54:57,321][root][INFO] - Domain : Property, Question : 9
[2025-02-21 05:55:07,873][root][INFO] - Domain : Property, Question : 17
[2025-02-21 05:55:36,685][root][INFO] - Domain : Property, Question : 25
[2025-02-21 05:55:44,674][root][INFO] - Domain : Property, Question : 30
[2025-02-21 05:56:12,734][root][INFO] - Domain : Property, Question : 36
[2025-02-21 05:56:18,138][root][INFO] - Domain : Property, Question : 46
[2025-02-21 05:56:27,382][root][INFO] - Domain : Property, Question : 53
[2025-02-21 05:56:56,189][root][INFO] - Domain : Property, Question : 59
[2025-02-21 05:57:03,547][root][INFO] - Domain : Property, Question : 66
[2025-02-21 05:57:09,578][root][INFO] - Processing question number 80
[2025-02-21 05:57:09,582][root][INFO] - Domain : Property, Question : 69
[2025-02-21 05:57:18,966][root][INFO] - Domain : Property, Question : 81
[2025-02-21 05:57:23,415][root][INFO] - Domain : Property, Question : 88
[2025-02-21 05:57:29,195][root][INFO] - Domain : Property, Question : 91
[2025-02-21 05:57:36,881][root][INFO] - Domain : Property, Question : 94
[2025-02-21 05:57:42,513][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:58:10,919][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:58:22,425][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 05:58:30,546][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 05:58:35,305][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:58:48,061][root][INFO] - Processing question number 90
[2025-02-21 05:58:48,066][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 05:58:57,039][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 05:59:26,023][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:59:31,673][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 05:59:39,378][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 05:59:52,850][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:00:00,805][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:00:12,705][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:00:18,827][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:00:46,814][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:00:56,749][root][INFO] - Inference complete
[2025-02-21 06:00:56,750][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,755][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,756][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 06:00:56,756][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:00:56,756][root][ERROR] - |Q. 6||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:00:56,757][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:00:56,757][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 06:00:56,757][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:00:56,757][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:00:56,757][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:00:56,757][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:00:56,757][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 06:00:56,757][root][ERROR] - |Q. 41||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:00:56,758][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 06:00:56,758][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:00:56,758][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 06:00:56,758][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:00:56,758][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:00:56,758][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 06:00:56,758][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:00:56,758][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 06:00:56,759][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:00:56,760][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:00:56,761][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 06:00:56,761][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 06:00:56,761][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:00:56,761][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:00:56,761][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 06:00:56,761][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:00:56,761][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 06:00:56,762][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:00:56,763][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:00:56,763][root][ERROR] - |Q. 4||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:00:56,763][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:00:56,763][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:00:56,763][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:00:56,763][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 06:00:56,763][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 06:00:56,763][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:00:56,764][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:00:56,764][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 06:00:56,764][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:00:56,764][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:00:56,764][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 06:00:56,764][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 06:00:56,764][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 06:00:56,765][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:00:56,765][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:00:56,765][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:00:56,765][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 06:00:56,765][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:00:56,765][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:00:56,765][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 06:00:56,766][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:00:56,766][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:00:56,766][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 06:00:56,766][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:00:56,766][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 06:00:56,766][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:00:56,766][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:00:56,766][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 06:00:56,767][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:00:56,767][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:00:56,767][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:00:56,767][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:00:56,767][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 06:00:56,767][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:00:56,767][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:00:56,768][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 06:00:56,768][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:00:56,768][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 06:00:56,768][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:00:56,768][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 06:00:56,768][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 06:00:56,768][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:00:56,768][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:00:56,768][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:00:56,769][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:00:56,769][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 06:00:56,769][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:00:56,769][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:00:56,769][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 06:00:56,769][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 06:00:56,769][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:00:56,769][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:00:56,770][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:00:56,770][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 06:00:56,770][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:00:56,770][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 06:00:56,770][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:00:56,770][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:00:56,770][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 06:00:56,771][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:00:56,771][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 06:00:56,771][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:00:56,771][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 06:00:56,771][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:00:56,772][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,777][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,777][root][INFO] - Saved parsed outputs
[2025-02-21 06:00:56,777][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,778][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,778][root][INFO] - Saved parsing metadata
[2025-02-21 06:00:56,779][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,780][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:00:56,782][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:00:56,794][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 06:00:56,795][root][INFO] - Summary of metrics : {'label_accuracy': 0.16, 'misclassification_rate': 0.84, 'combined_accuracy': 0.0, 'malformed_label': 72, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 16, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 16, 'both_wrong': 84}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 06:01:02,983][root][INFO] - Setting global seed to 989
[2025-02-21 06:01:02,989][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:01:02,989][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:01:02,990][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:01:02,991][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:01:02,993][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:01:02,993][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:01:03,148][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:01:03,684][root][INFO] - Full model selected, loading model
[2025-02-21 06:01:26,306][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:01:26,314][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:01:34,189][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:01:34,191][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:01:34,191][root][INFO] - Starting inference
[2025-02-21 06:01:34,385][root][INFO] - Processing question number 0
[2025-02-21 06:01:34,393][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:02:03,391][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:02:23,157][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:02:39,506][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:02:49,209][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:03:02,124][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:03:11,283][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:03:27,649][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:03:40,754][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:03:56,876][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:04:07,983][root][INFO] - Processing question number 10
[2025-02-21 06:04:07,985][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:04:21,284][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:04:33,575][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:04:45,189][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:05:01,046][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:05:09,775][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:05:19,630][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:05:29,714][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:05:38,230][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:05:53,770][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:06:09,306][root][INFO] - Processing question number 20
[2025-02-21 06:06:09,309][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:06:17,301][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:06:27,608][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:06:37,711][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:06:51,156][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:06:59,314][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:07:08,433][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:07:22,032][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:07:39,959][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:07:50,780][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:08:01,797][root][INFO] - Processing question number 30
[2025-02-21 06:08:01,800][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:08:10,002][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:08:23,588][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:08:38,369][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:08:56,646][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:09:11,391][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:09:26,752][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:09:39,333][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:09:58,588][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:10:07,771][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:10:23,077][root][INFO] - Processing question number 40
[2025-02-21 06:10:23,080][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:10:31,805][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:10:40,822][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:10:52,924][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:11:09,293][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:11:24,957][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:11:36,125][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:11:46,478][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:11:55,183][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:12:01,987][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:12:10,977][root][INFO] - Processing question number 50
[2025-02-21 06:12:10,981][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:12:20,205][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:12:29,112][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:12:41,979][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:12:49,562][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:12:56,768][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:13:07,521][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:13:15,819][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:13:35,658][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:13:42,387][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:13:56,073][root][INFO] - Processing question number 60
[2025-02-21 06:13:56,076][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:14:04,850][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:14:19,266][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:14:34,298][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:14:48,536][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:15:11,434][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:15:18,629][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:15:27,294][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:15:36,947][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:15:44,314][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:15:55,670][root][INFO] - Processing question number 70
[2025-02-21 06:15:55,674][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:16:06,869][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:16:12,470][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:16:28,178][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:16:39,865][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:16:51,948][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:17:06,495][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:17:15,539][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:17:27,814][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:17:37,299][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:17:51,629][root][INFO] - Processing question number 80
[2025-02-21 06:17:51,633][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:18:01,333][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:18:07,877][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:18:17,725][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:18:35,015][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:18:43,481][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:18:54,207][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:19:13,727][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:19:23,064][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:19:32,897][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:19:50,343][root][INFO] - Processing question number 90
[2025-02-21 06:19:50,347][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:19:58,621][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:20:18,631][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:20:33,650][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:20:39,984][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:20:53,321][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:21:11,871][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:21:18,685][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:21:35,444][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:21:48,094][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:22:04,084][root][INFO] - Inference complete
[2025-02-21 06:22:04,085][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,091][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,092][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 06:22:04,092][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:22:04,092][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:22:04,092][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 06:22:04,092][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:22:04,092][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:22:04,093][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:22:04,093][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:22:04,093][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 06:22:04,093][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 06:22:04,093][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:22:04,093][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 06:22:04,093][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:22:04,093][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:22:04,094][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 06:22:04,094][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:22:04,094][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 06:22:04,094][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:22:04,094][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:22:04,094][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:22:04,094][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,094][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:22:04,094][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:22:04,095][root][ERROR] - |Q. 15||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,095][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:22:04,095][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,095][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:22:04,095][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 06:22:04,095][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 06:22:04,095][root][ERROR] - |Q. 44||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,095][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:22:04,095][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,095][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:22:04,096][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,096][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 06:22:04,096][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 06:22:04,096][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,096][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:22:04,096][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,096][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:22:04,096][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:22:04,096][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:22:04,096][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:22:04,097][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 06:22:04,097][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:22:04,097][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 06:22:04,097][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:22:04,097][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:22:04,097][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 06:22:04,097][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:22:04,097][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:22:04,098][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:22:04,098][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:22:04,098][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:22:04,098][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 06:22:04,098][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:22:04,098][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:22:04,098][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 06:22:04,098][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:22:04,098][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 06:22:04,098][root][ERROR] - |Q. 87||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:22:04,099][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:22:04,099][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:22:04,099][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:22:04,099][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:22:04,099][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:22:04,099][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,099][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:22:04,099][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,099][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 06:22:04,100][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,100][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 06:22:04,100][root][ERROR] - |Q. 38||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,100][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:22:04,100][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,100][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:22:04,100][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,100][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 06:22:04,100][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,100][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:22:04,100][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,101][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:22:04,101][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,101][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 06:22:04,101][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,101][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 06:22:04,101][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,101][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 06:22:04,101][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 06:22:04,101][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:22:04,101][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:22:04,101][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:22:04,102][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 06:22:04,102][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:22:04,102][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:22:04,102][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:22:04,102][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 06:22:04,102][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:22:04,102][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 06:22:04,102][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:22:04,103][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:22:04,103][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 06:22:04,103][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:22:04,103][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:22:04,103][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:22:04,103][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:22:04,103][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 06:22:04,103][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:22:04,103][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:22:04,103][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:22:04,103][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,104][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:22:04,104][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:22:04,104][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:22:04,104][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,104][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:22:04,104][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 06:22:04,104][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,104][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:22:04,104][root][ERROR] - |Q. 53||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,105][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 06:22:04,105][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:22:04,105][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:22:04,105][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,105][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:22:04,105][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,105][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:22:04,105][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,105][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 06:22:04,106][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:22:04,106][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,106][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:22:04,106][root][ERROR] - |Q. 100||D: Property| Failed to extract explanation: 
[2025-02-21 06:22:04,106][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 06:22:04,106][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:22:04,106][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 06:22:04,106][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:22:04,106][root][ERROR] - |Q. 22||D: Torts| Failed to extract explanation: 
[2025-02-21 06:22:04,106][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:22:04,107][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 06:22:04,107][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 06:22:04,107][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:22:04,107][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:22:04,107][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:22:04,107][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 06:22:04,107][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 06:22:04,107][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:22:04,107][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 06:22:04,108][root][ERROR] - |Q. 74||D: Torts| Failed to extract explanation: 
[2025-02-21 06:22:04,108][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:22:04,108][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 06:22:04,108][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 06:22:04,108][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:22:04,109][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,120][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,120][root][INFO] - Saved parsed outputs
[2025-02-21 06:22:04,120][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,122][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,122][root][INFO] - Saved parsing metadata
[2025-02-21 06:22:04,122][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,123][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:22:04,125][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:22:04,138][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 06:22:04,138][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 100, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 100}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 06:22:10,332][root][INFO] - Setting global seed to 989
[2025-02-21 06:22:10,337][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 06:22:10,337][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:22:10,338][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:22:10,340][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:22:10,341][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:22:10,342][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:22:10,489][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:22:11,084][root][INFO] - Full model selected, loading model
[2025-02-21 06:22:26,221][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 06:24:07,160][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 06:24:07,178][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 06:24:41,985][root][INFO] - Peft model loaded successfully
[2025-02-21 06:24:49,393][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:24:49,396][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:24:49,396][root][INFO] - Starting inference
[2025-02-21 06:24:49,617][root][INFO] - Processing question number 0
[2025-02-21 06:24:49,619][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:25:03,854][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:25:09,506][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:25:19,858][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:25:48,876][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:25:59,488][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:26:05,508][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:26:11,038][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:26:15,506][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:26:20,772][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:26:28,786][root][INFO] - Processing question number 10
[2025-02-21 06:26:28,787][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:26:32,860][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:26:48,888][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:26:54,022][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:26:58,694][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:27:27,572][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:27:31,056][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:27:34,855][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:27:39,346][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:27:47,615][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:27:53,532][root][INFO] - Processing question number 20
[2025-02-21 06:27:53,535][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:27:59,265][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:28:04,762][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:28:11,655][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:28:14,796][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:28:25,704][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:28:33,881][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:28:44,048][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:28:51,609][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:28:57,830][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:29:09,984][root][INFO] - Processing question number 30
[2025-02-21 06:29:09,986][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:29:17,696][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:29:23,544][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:29:33,496][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:29:38,172][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:29:50,653][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:29:56,972][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:30:02,827][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:30:31,948][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:30:37,492][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:30:49,252][root][INFO] - Processing question number 40
[2025-02-21 06:30:49,255][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:30:56,359][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:31:03,946][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:31:16,864][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:31:20,678][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:31:38,022][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:31:43,789][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:31:49,869][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:31:53,338][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:32:01,404][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:32:04,614][root][INFO] - Processing question number 50
[2025-02-21 06:32:04,617][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:32:09,824][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:32:15,950][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:32:23,796][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:32:32,009][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:32:40,152][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:33:07,444][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:33:18,072][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:33:24,670][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:33:30,858][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:33:39,576][root][INFO] - Processing question number 60
[2025-02-21 06:33:39,580][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:33:48,124][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:33:58,598][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:34:27,960][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:34:39,875][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:34:53,882][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:35:03,176][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:35:10,641][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:35:18,464][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:35:46,944][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:35:51,605][root][INFO] - Processing question number 70
[2025-02-21 06:35:51,609][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:36:01,973][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:36:09,032][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:36:20,179][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:36:30,827][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:36:40,212][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:36:48,950][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:37:01,381][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:37:17,063][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:37:24,033][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:37:29,521][root][INFO] - Processing question number 80
[2025-02-21 06:37:29,525][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:37:34,161][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:37:38,137][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:37:44,280][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:37:52,345][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:38:21,921][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:38:25,055][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:38:39,962][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:38:46,241][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 06:38:58,751][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:39:10,211][root][INFO] - Processing question number 90
[2025-02-21 06:39:10,215][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 06:39:17,184][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 06:39:32,575][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:39:41,998][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 06:39:47,199][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 06:39:53,656][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 06:40:05,259][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 06:40:13,476][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 06:40:20,019][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 06:40:26,733][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:40:55,804][root][INFO] - Inference complete
[2025-02-21 06:40:55,804][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,809][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,810][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 06:40:55,810][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 06:40:55,810][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 06:40:55,811][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 06:40:55,811][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:40:55,811][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 06:40:55,811][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 06:40:55,811][root][ERROR] - |Q. 35||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:40:55,811][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 06:40:55,811][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 06:40:55,811][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 06:40:55,812][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:40:55,812][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 06:40:55,812][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 06:40:55,812][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 06:40:55,812][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 06:40:55,812][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 06:40:55,812][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 06:40:55,812][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 06:40:55,813][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 06:40:55,813][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 06:40:55,813][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 06:40:55,813][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 06:40:55,813][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 06:40:55,813][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 06:40:55,813][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 06:40:55,813][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 06:40:55,814][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 06:40:55,815][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:40:55,815][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 06:40:55,815][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 06:40:55,815][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 06:40:55,815][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 06:40:55,815][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 06:40:55,815][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 06:40:55,815][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 06:40:55,816][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 06:40:55,816][root][ERROR] - |Q. 65||D: Contracts| Failed to extract explanation: 
[2025-02-21 06:40:55,816][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 06:40:55,816][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 06:40:55,816][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 06:40:55,816][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 06:40:55,816][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 06:40:55,816][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 06:40:55,817][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 06:40:55,818][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 06:40:55,818][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 06:40:55,818][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 06:40:55,818][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 06:40:55,818][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 06:40:55,818][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 06:40:55,818][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 06:40:55,819][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 06:40:55,819][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 06:40:55,819][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 06:40:55,819][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 06:40:55,819][root][ERROR] - |Q. 33||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:40:55,819][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 06:40:55,819][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 06:40:55,820][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 06:40:55,820][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 06:40:55,820][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 06:40:55,820][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 06:40:55,820][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 06:40:55,820][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 06:40:55,820][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 06:40:55,821][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 06:40:55,821][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 06:40:55,821][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 06:40:55,821][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 06:40:55,821][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 06:40:55,821][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 06:40:55,821][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 06:40:55,822][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 06:40:55,822][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 06:40:55,823][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 06:40:55,823][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 06:40:55,823][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 06:40:55,823][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 06:40:55,823][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 06:40:55,823][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 06:40:55,823][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 06:40:55,824][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 06:40:55,824][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 06:40:55,824][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 06:40:55,824][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 06:40:55,824][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 06:40:55,824][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 06:40:55,824][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 06:40:55,824][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 06:40:55,825][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,829][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,830][root][INFO] - Saved parsed outputs
[2025-02-21 06:40:55,830][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,831][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,831][root][INFO] - Saved parsing metadata
[2025-02-21 06:40:55,832][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,834][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:40:55,836][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 06:40:55,865][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 06:40:55,865][root][INFO] - Summary of metrics : {'label_accuracy': 0.13, 'misclassification_rate': 0.87, 'combined_accuracy': 0.0, 'malformed_label': 75, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 13, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 13, 'both_wrong': 87}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 06:41:03,655][root][INFO] - Setting global seed to 989
[2025-02-21 06:41:03,662][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 06:41:03,663][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 06:41:03,664][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 06:41:03,666][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:41:03,668][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:41:03,668][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 06:41:03,871][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 06:41:04,401][root][INFO] - Full model selected, loading model
[2025-02-21 06:41:25,930][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:41:25,931][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:41:33,774][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:41:33,775][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 06:41:33,775][root][INFO] - Starting inference
[2025-02-21 06:41:33,957][root][INFO] - Processing question number 0
[2025-02-21 06:41:33,960][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 06:42:00,550][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 06:42:12,659][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 06:42:32,372][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 06:42:39,825][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 06:42:59,643][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 06:43:17,219][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 06:43:31,094][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 06:43:42,075][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 06:43:58,918][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 06:44:10,605][root][INFO] - Processing question number 10
[2025-02-21 06:44:10,609][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 06:44:24,733][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 06:44:35,183][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 06:44:46,715][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 06:45:01,983][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 06:45:13,674][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 06:45:27,174][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:45:37,546][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 06:45:49,941][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 06:46:05,037][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 06:46:21,533][root][INFO] - Processing question number 20
[2025-02-21 06:46:21,536][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 06:46:35,741][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 06:46:46,323][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:46:57,114][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 06:47:08,901][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 06:47:22,457][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 06:47:32,901][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 06:47:42,533][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 06:47:59,396][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:48:10,387][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 06:48:20,763][root][INFO] - Processing question number 30
[2025-02-21 06:48:20,765][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 06:48:35,318][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 06:48:41,841][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 06:48:55,826][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 06:49:10,030][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 06:49:20,018][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 06:49:33,986][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:49:41,705][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 06:50:07,999][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:50:21,487][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 06:50:30,625][root][INFO] - Processing question number 40
[2025-02-21 06:50:30,627][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 06:50:39,204][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 06:50:53,116][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 06:51:04,909][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 06:51:17,343][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 06:51:37,527][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 06:51:43,936][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:51:56,359][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:52:04,459][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 06:52:21,219][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 06:52:34,016][root][INFO] - Processing question number 50
[2025-02-21 06:52:34,019][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 06:52:42,108][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 06:52:52,164][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 06:53:07,400][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:53:19,078][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 06:53:29,244][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 06:53:39,785][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 06:53:50,747][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 06:54:02,988][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 06:54:11,871][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 06:54:20,999][root][INFO] - Processing question number 60
[2025-02-21 06:54:21,003][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 06:54:32,057][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 06:54:43,517][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 06:54:57,966][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 06:55:17,488][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 06:55:33,514][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 06:55:46,914][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 06:55:53,654][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 06:56:03,005][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 06:56:14,177][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 06:56:25,839][root][INFO] - Processing question number 70
[2025-02-21 06:56:25,843][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 06:56:34,151][root][INFO] - Domain : Property, Question : 9
[2025-02-21 06:56:43,866][root][INFO] - Domain : Property, Question : 17
[2025-02-21 06:56:52,716][root][INFO] - Domain : Property, Question : 25
[2025-02-21 06:57:09,714][root][INFO] - Domain : Property, Question : 30
[2025-02-21 06:57:19,845][root][INFO] - Domain : Property, Question : 36
[2025-02-21 06:57:35,734][root][INFO] - Domain : Property, Question : 46
[2025-02-21 06:57:43,157][root][INFO] - Domain : Property, Question : 53
[2025-02-21 06:58:01,741][root][INFO] - Domain : Property, Question : 59
[2025-02-21 06:58:10,309][root][INFO] - Domain : Property, Question : 66
[2025-02-21 06:58:21,973][root][INFO] - Processing question number 80
[2025-02-21 06:58:21,977][root][INFO] - Domain : Property, Question : 69
[2025-02-21 06:58:30,131][root][INFO] - Domain : Property, Question : 81
[2025-02-21 06:58:37,113][root][INFO] - Domain : Property, Question : 88
[2025-02-21 06:58:46,584][root][INFO] - Domain : Property, Question : 91
[2025-02-21 06:59:02,282][root][INFO] - Domain : Property, Question : 94
[2025-02-21 06:59:11,204][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:59:26,220][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:59:50,148][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 06:59:58,068][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:00:12,608][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:00:25,997][root][INFO] - Processing question number 90
[2025-02-21 07:00:26,004][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:00:35,568][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:00:43,878][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:00:55,893][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:01:02,099][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:01:10,807][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:01:29,730][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:01:43,534][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:01:52,543][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:02:02,874][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:02:16,149][root][INFO] - Inference complete
[2025-02-21 07:02:16,150][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,156][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,157][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:02:16,157][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:02:16,157][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:02:16,157][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 07:02:16,157][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:02:16,158][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:02:16,158][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:02:16,158][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:02:16,158][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:02:16,158][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:02:16,158][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:02:16,158][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:02:16,159][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:02:16,159][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:02:16,159][root][ERROR] - |Q. 78||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:02:16,159][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:02:16,159][root][ERROR] - |Q. 86||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:02:16,159][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:02:16,159][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:02:16,159][root][ERROR] - |Q. 2||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:02:16,159][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:02:16,160][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:02:16,160][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:02:16,160][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:02:16,160][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:02:16,160][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:02:16,160][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:02:16,160][root][ERROR] - |Q. 55||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:02:16,160][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:02:16,160][root][ERROR] - |Q. 64||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:02:16,161][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:02:16,161][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:02:16,161][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:02:16,161][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:02:16,161][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:02:16,161][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:02:16,161][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:02:16,161][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:02:16,161][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:02:16,162][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:02:16,162][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:02:16,162][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:02:16,162][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:02:16,162][root][ERROR] - |Q. 24||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:02:16,162][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:02:16,162][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:02:16,162][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:02:16,162][root][ERROR] - |Q. 42||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:02:16,163][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:02:16,163][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:02:16,163][root][ERROR] - |Q. 58||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:02:16,163][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:02:16,163][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:02:16,163][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:02:16,163][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:02:16,163][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:02:16,163][root][ERROR] - |Q. 84||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:02:16,164][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:02:16,164][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:02:16,164][root][ERROR] - |Q. 97||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:02:16,164][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:02:16,164][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:02:16,164][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:02:16,164][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,164][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:02:16,164][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:02:16,165][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,165][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:02:16,165][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:02:16,165][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,165][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:02:16,165][root][ERROR] - |Q. 50||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,165][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:02:16,165][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,165][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:02:16,166][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 07:02:16,166][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,166][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:02:16,166][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,166][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:02:16,166][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,166][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:02:16,166][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,166][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:02:16,166][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:02:16,166][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:02:16,167][root][ERROR] - |Q. 5||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,167][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:02:16,167][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,167][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:02:16,167][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,167][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:02:16,167][root][ERROR] - |Q. 26||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,167][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:02:16,167][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:02:16,168][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:02:16,168][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:02:16,168][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:02:16,168][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,168][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:02:16,168][root][ERROR] - |Q. 68||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,168][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:02:16,168][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,168][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:02:16,168][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:02:16,169][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:02:16,169][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:02:16,169][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,169][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:02:16,169][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,169][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:02:16,169][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:02:16,169][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,169][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:02:16,169][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:02:16,170][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,170][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:02:16,170][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:02:16,170][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:02:16,170][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:02:16,170][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,170][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:02:16,170][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,170][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:02:16,170][root][ERROR] - |Q. 88||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,171][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:02:16,171][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:02:16,171][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 07:02:16,171][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:02:16,171][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:02:16,171][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:02:16,171][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,171][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:02:16,172][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:02:16,172][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 07:02:16,172][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,172][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:02:16,172][root][ERROR] - |Q. 45||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,172][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:02:16,172][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,172][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:02:16,172][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,172][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:02:16,172][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,173][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:02:16,173][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:02:16,173][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:02:16,173][root][ERROR] - |Q. 79||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,173][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:02:16,173][root][ERROR] - |Q. 92||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,173][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:02:16,173][root][ERROR] - |Q. 95||D: Torts| Failed to extract explanation: 
[2025-02-21 07:02:16,174][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,178][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,178][root][INFO] - Saved parsed outputs
[2025-02-21 07:02:16,178][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,179][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,179][root][INFO] - Saved parsing metadata
[2025-02-21 07:02:16,180][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,182][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:02:16,187][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:02:16,216][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 07:02:16,216][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 100, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 100}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 07:02:22,990][root][INFO] - Setting global seed to 989
[2025-02-21 07:02:22,997][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 07:02:22,997][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:02:22,998][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:02:23,000][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:02:23,003][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:02:23,003][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:02:23,137][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:02:23,714][root][INFO] - Full model selected, loading model
[2025-02-21 07:02:38,115][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:04:19,397][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:04:19,420][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:04:51,719][root][INFO] - Peft model loaded successfully
[2025-02-21 07:04:59,106][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:04:59,108][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:04:59,108][root][INFO] - Starting inference
[2025-02-21 07:04:59,327][root][INFO] - Processing question number 0
[2025-02-21 07:04:59,329][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:05:16,251][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:05:26,519][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:05:38,937][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:05:45,564][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:05:51,319][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:06:07,740][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:06:15,300][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:06:20,051][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:06:23,041][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:06:27,857][root][INFO] - Processing question number 10
[2025-02-21 07:06:27,859][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:06:33,862][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:06:45,542][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:06:49,091][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:06:56,158][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:07:03,776][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:07:07,265][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:07:15,101][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:07:23,072][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:07:52,068][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:08:01,013][root][INFO] - Processing question number 20
[2025-02-21 07:08:01,016][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:08:07,480][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:08:11,477][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:08:16,422][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:08:23,658][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:08:33,287][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:08:40,963][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:08:51,150][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:09:00,575][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:09:06,348][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:09:15,600][root][INFO] - Processing question number 30
[2025-02-21 07:09:15,603][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:09:23,372][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:09:29,185][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:09:38,966][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:09:45,494][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:09:57,341][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:10:03,257][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:10:14,481][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:10:21,920][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:10:29,127][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:10:34,905][root][INFO] - Processing question number 40
[2025-02-21 07:10:34,908][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:10:40,189][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:10:48,347][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:11:00,956][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:11:12,712][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:11:31,740][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:11:35,554][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:11:41,828][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:11:54,573][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:12:09,920][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:12:15,201][root][INFO] - Processing question number 50
[2025-02-21 07:12:15,204][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:12:19,129][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:12:22,837][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:12:31,867][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:12:42,011][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:13:01,622][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:13:08,860][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:13:18,661][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:13:27,211][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:13:33,779][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:13:50,095][root][INFO] - Processing question number 60
[2025-02-21 07:13:50,098][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:14:00,370][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:14:03,866][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:14:19,056][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:14:24,751][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:14:37,504][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:14:44,426][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:14:57,259][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:15:02,913][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:15:15,971][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:15:25,709][root][INFO] - Processing question number 70
[2025-02-21 07:15:25,712][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:15:31,815][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:15:42,227][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:15:57,426][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:16:08,141][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:16:17,407][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:16:26,112][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:16:34,729][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:16:51,111][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:16:56,111][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:17:01,337][root][INFO] - Processing question number 80
[2025-02-21 07:17:01,341][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:17:05,529][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:17:19,805][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:17:27,366][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:17:33,972][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:17:48,138][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:17:51,414][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:18:04,714][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:18:08,858][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:18:13,669][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:18:18,445][root][INFO] - Processing question number 90
[2025-02-21 07:18:18,449][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:18:28,127][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:18:39,198][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:18:52,008][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:18:58,486][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:19:06,776][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:19:11,759][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:19:24,226][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:19:28,793][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:19:36,359][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:19:45,466][root][INFO] - Inference complete
[2025-02-21 07:19:45,467][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,472][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,473][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:19:45,474][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:19:45,474][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:19:45,474][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 07:19:45,474][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:19:45,474][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:45,474][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:19:45,475][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:19:45,475][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:19:45,475][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:19:45,475][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:45,475][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:19:45,475][root][ERROR] - |Q. 62||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:45,475][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:19:45,475][root][ERROR] - |Q. 70||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:19:45,475][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:19:45,476][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:19:45,476][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:19:45,476][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:19:45,476][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:19:45,476][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:19:45,476][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:19:45,476][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:19:45,477][root][ERROR] - |Q. 29||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:45,477][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:19:45,477][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:19:45,477][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:19:45,477][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:19:45,477][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:19:45,477][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:19:45,477][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:19:45,478][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:19:45,478][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:19:45,478][root][ERROR] - |Q. 96||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:19:45,478][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:19:45,478][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:45,478][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:19:45,478][root][ERROR] - |Q. 7||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:45,478][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:19:45,478][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:19:45,479][root][ERROR] - |Q. 48||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:19:45,479][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:19:45,480][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:19:45,480][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:19:45,480][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:19:45,480][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:19:45,480][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:19:45,480][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:19:45,480][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:19:45,481][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:19:45,481][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:19:45,481][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:19:45,481][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:19:45,481][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:19:45,481][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:19:45,481][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 07:19:45,482][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:19:45,482][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:19:45,482][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:19:45,482][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:19:45,482][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:19:45,482][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:19:45,482][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:19:45,483][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:19:45,483][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:19:45,483][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:19:45,483][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:19:45,483][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:19:45,483][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:19:45,483][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:19:45,484][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:19:45,485][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:19:45,485][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:19:45,485][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:19:45,485][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:19:45,485][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:19:45,485][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:19:45,485][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:19:45,486][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:19:45,487][root][ERROR] - |Q. 57||D: Torts| Failed to extract explanation: 
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:19:45,487][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:19:45,488][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:19:45,488][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,493][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,493][root][INFO] - Saved parsed outputs
[2025-02-21 07:19:45,493][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,503][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,503][root][INFO] - Saved parsing metadata
[2025-02-21 07:19:45,504][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,505][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:19:45,506][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:19:45,523][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 07:19:45,523][root][INFO] - Summary of metrics : {'label_accuracy': 0.16, 'misclassification_rate': 0.84, 'combined_accuracy': 0.0, 'malformed_label': 71, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 16, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 16, 'both_wrong': 84}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 24 to status running with exit code None
Eval status update completed for job 24
[2025-02-21 07:19:52,146][root][INFO] - Setting global seed to 989
[2025-02-21 07:19:52,151][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 07:19:52,151][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : markdown 
[2025-02-21 07:19:52,152][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 07:19:52,154][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:19:52,156][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:19:52,156][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 07:19:52,342][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-02-21 07:19:53,117][root][INFO] - Full model selected, loading model
[2025-02-21 07:20:08,238][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 07:20:08,238][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 07:20:14,429][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'markdown', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:20:14,431][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:20:14,431][root][INFO] - Starting inference
[2025-02-21 07:20:14,621][root][INFO] - Processing question number 0
[2025-02-21 07:20:14,634][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 07:20:26,512][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 07:20:43,885][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 07:21:04,452][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 07:21:13,178][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 07:21:25,148][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 07:21:44,733][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 07:21:56,319][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 07:22:14,961][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 07:22:24,922][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 07:22:41,288][root][INFO] - Processing question number 10
[2025-02-21 07:22:41,290][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 07:23:00,926][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 07:23:18,456][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 07:23:39,285][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 07:23:50,107][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 07:24:05,917][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 07:24:20,290][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:24:36,268][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 07:24:45,522][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 07:25:01,169][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 07:25:16,149][root][INFO] - Processing question number 20
[2025-02-21 07:25:16,151][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 07:25:33,676][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 07:25:51,025][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:26:05,960][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 07:26:19,175][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 07:26:26,591][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 07:26:36,419][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 07:26:46,459][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 07:27:04,963][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:27:12,567][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 07:27:29,050][root][INFO] - Processing question number 30
[2025-02-21 07:27:29,052][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 07:27:37,751][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 07:27:53,659][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 07:28:08,215][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 07:28:27,219][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 07:28:42,969][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 07:29:00,122][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:29:14,481][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 07:29:33,837][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:29:45,073][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 07:29:55,915][root][INFO] - Processing question number 40
[2025-02-21 07:29:55,918][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 07:30:06,698][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 07:30:25,037][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 07:30:45,077][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 07:31:00,217][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 07:31:15,889][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 07:31:27,920][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:31:37,273][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:31:47,803][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 07:31:58,101][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 07:32:08,732][root][INFO] - Processing question number 50
[2025-02-21 07:32:08,735][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 07:32:22,359][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 07:32:28,355][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 07:32:36,959][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:32:47,517][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 07:32:57,090][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 07:33:06,620][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 07:33:14,064][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 07:33:20,526][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 07:33:31,626][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 07:33:39,321][root][INFO] - Processing question number 60
[2025-02-21 07:33:39,324][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 07:33:53,249][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 07:34:00,491][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 07:34:18,585][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 07:34:29,805][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 07:34:44,517][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 07:34:52,994][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 07:35:00,060][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 07:35:14,007][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 07:35:22,196][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 07:35:31,794][root][INFO] - Processing question number 70
[2025-02-21 07:35:31,798][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 07:35:46,616][root][INFO] - Domain : Property, Question : 9
[2025-02-21 07:35:56,106][root][INFO] - Domain : Property, Question : 17
[2025-02-21 07:36:09,072][root][INFO] - Domain : Property, Question : 25
[2025-02-21 07:36:18,604][root][INFO] - Domain : Property, Question : 30
[2025-02-21 07:36:27,828][root][INFO] - Domain : Property, Question : 36
[2025-02-21 07:36:38,219][root][INFO] - Domain : Property, Question : 46
[2025-02-21 07:36:51,394][root][INFO] - Domain : Property, Question : 53
[2025-02-21 07:37:04,764][root][INFO] - Domain : Property, Question : 59
[2025-02-21 07:37:14,999][root][INFO] - Domain : Property, Question : 66
[2025-02-21 07:37:28,268][root][INFO] - Processing question number 80
[2025-02-21 07:37:28,273][root][INFO] - Domain : Property, Question : 69
[2025-02-21 07:37:36,948][root][INFO] - Domain : Property, Question : 81
[2025-02-21 07:37:45,198][root][INFO] - Domain : Property, Question : 88
[2025-02-21 07:38:04,992][root][INFO] - Domain : Property, Question : 91
[2025-02-21 07:38:20,460][root][INFO] - Domain : Property, Question : 94
[2025-02-21 07:38:28,491][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:38:42,974][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:39:00,041][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 07:39:09,337][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 07:39:26,192][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:39:44,846][root][INFO] - Processing question number 90
[2025-02-21 07:39:44,851][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 07:39:53,395][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 07:40:06,783][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:40:18,150][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 07:40:27,272][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 07:40:35,986][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 07:40:50,619][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 07:41:09,475][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 07:41:22,740][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 07:41:33,726][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:41:47,250][root][INFO] - Inference complete
[2025-02-21 07:41:47,250][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,256][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,257][root][ERROR] - Failed to extract domain:  for response: 1
[2025-02-21 07:41:47,257][root][ERROR] - Failed to extract domain:  for response: 2
[2025-02-21 07:41:47,257][root][ERROR] - Failed to extract domain:  for response: 3
[2025-02-21 07:41:47,257][root][ERROR] - Failed to extract domain:  for response: 4
[2025-02-21 07:41:47,258][root][ERROR] - |Q. 20||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:41:47,258][root][ERROR] - Failed to extract domain:  for response: 5
[2025-02-21 07:41:47,258][root][ERROR] - |Q. 27||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:41:47,258][root][ERROR] - Failed to extract domain:  for response: 6
[2025-02-21 07:41:47,258][root][ERROR] - Failed to extract domain:  for response: 7
[2025-02-21 07:41:47,258][root][ERROR] - Failed to extract domain:  for response: 8
[2025-02-21 07:41:47,258][root][ERROR] - Failed to extract domain:  for response: 9
[2025-02-21 07:41:47,258][root][ERROR] - |Q. 56||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:41:47,259][root][ERROR] - Failed to extract domain:  for response: 10
[2025-02-21 07:41:47,259][root][ERROR] - Failed to extract domain:  for response: 11
[2025-02-21 07:41:47,259][root][ERROR] - Failed to extract domain:  for response: 12
[2025-02-21 07:41:47,259][root][ERROR] - Failed to extract domain:  for response: 13
[2025-02-21 07:41:47,259][root][ERROR] - Failed to extract domain:  for response: 14
[2025-02-21 07:41:47,259][root][ERROR] - |Q. 99||D: Constitutional_law| Failed to extract explanation: 
[2025-02-21 07:41:47,259][root][ERROR] - Failed to extract domain:  for response: 15
[2025-02-21 07:41:47,260][root][ERROR] - Failed to extract domain:  for response: 16
[2025-02-21 07:41:47,260][root][ERROR] - Failed to extract domain:  for response: 17
[2025-02-21 07:41:47,260][root][ERROR] - Failed to extract domain:  for response: 18
[2025-02-21 07:41:47,260][root][ERROR] - |Q. 21||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:41:47,260][root][ERROR] - Failed to extract domain:  for response: 19
[2025-02-21 07:41:47,260][root][ERROR] - Failed to extract domain:  for response: 20
[2025-02-21 07:41:47,260][root][ERROR] - Failed to extract domain:  for response: 21
[2025-02-21 07:41:47,260][root][ERROR] - Failed to extract domain:  for response: 22
[2025-02-21 07:41:47,261][root][ERROR] - Failed to extract domain:  for response: 23
[2025-02-21 07:41:47,261][root][ERROR] - Failed to extract domain:  for response: 24
[2025-02-21 07:41:47,261][root][ERROR] - Failed to extract domain:  for response: 25
[2025-02-21 07:41:47,261][root][ERROR] - |Q. 76||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:41:47,261][root][ERROR] - Failed to extract domain:  for response: 26
[2025-02-21 07:41:47,261][root][ERROR] - |Q. 83||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:41:47,261][root][ERROR] - Failed to extract domain:  for response: 27
[2025-02-21 07:41:47,261][root][ERROR] - |Q. 89||D: Criminal_law| Failed to extract explanation: 
[2025-02-21 07:41:47,262][root][ERROR] - Failed to extract domain:  for response: 28
[2025-02-21 07:41:47,262][root][ERROR] - Failed to extract domain:  for response: 29
[2025-02-21 07:41:47,262][root][ERROR] - |Q. 3||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:41:47,262][root][ERROR] - Failed to extract domain:  for response: 30
[2025-02-21 07:41:47,262][root][ERROR] - Failed to extract domain:  for response: 31
[2025-02-21 07:41:47,262][root][ERROR] - |Q. 14||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:41:47,262][root][ERROR] - Failed to extract domain:  for response: 32
[2025-02-21 07:41:47,262][root][ERROR] - Failed to extract domain:  for response: 33
[2025-02-21 07:41:47,262][root][ERROR] - Failed to extract domain:  for response: 34
[2025-02-21 07:41:47,263][root][ERROR] - Failed to extract domain:  for response: 35
[2025-02-21 07:41:47,263][root][ERROR] - Failed to extract domain:  for response: 36
[2025-02-21 07:41:47,263][root][ERROR] - Failed to extract domain:  for response: 37
[2025-02-21 07:41:47,263][root][ERROR] - Failed to extract domain:  for response: 38
[2025-02-21 07:41:47,263][root][ERROR] - Failed to extract domain:  for response: 39
[2025-02-21 07:41:47,263][root][ERROR] - |Q. 72||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:41:47,263][root][ERROR] - Failed to extract domain:  for response: 40
[2025-02-21 07:41:47,263][root][ERROR] - |Q. 77||D: Contracts| Failed to extract explanation: 
[2025-02-21 07:41:47,264][root][ERROR] - Failed to extract domain:  for response: 41
[2025-02-21 07:41:47,264][root][ERROR] - Failed to extract domain:  for response: 42
[2025-02-21 07:41:47,264][root][ERROR] - Failed to extract domain:  for response: 43
[2025-02-21 07:41:47,264][root][ERROR] - Failed to extract domain:  for response: 44
[2025-02-21 07:41:47,264][root][ERROR] - Failed to extract domain:  for response: 45
[2025-02-21 07:41:47,264][root][ERROR] - Failed to extract domain:  for response: 46
[2025-02-21 07:41:47,264][root][ERROR] - |Q. 16||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,264][root][ERROR] - Failed to extract domain:  for response: 47
[2025-02-21 07:41:47,265][root][ERROR] - |Q. 23||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,265][root][ERROR] - Failed to extract domain:  for response: 48
[2025-02-21 07:41:47,265][root][ERROR] - |Q. 31||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,265][root][ERROR] - Failed to extract domain:  for response: 49
[2025-02-21 07:41:47,265][root][ERROR] - Failed to extract domain:  for response: 50
[2025-02-21 07:41:47,265][root][ERROR] - |Q. 43||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,265][root][ERROR] - Failed to extract domain:  for response: 51
[2025-02-21 07:41:47,265][root][ERROR] - Failed to extract domain:  for response: 52
[2025-02-21 07:41:47,265][root][ERROR] - |Q. 51||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,265][root][ERROR] - Failed to extract domain:  for response: 53
[2025-02-21 07:41:47,266][root][ERROR] - |Q. 60||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,266][root][ERROR] - Failed to extract domain:  for response: 54
[2025-02-21 07:41:47,266][root][ERROR] - |Q. 73||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,266][root][ERROR] - Failed to extract domain:  for response: 55
[2025-02-21 07:41:47,266][root][ERROR] - |Q. 80||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,266][root][ERROR] - Failed to extract domain:  for response: 56
[2025-02-21 07:41:47,266][root][ERROR] - |Q. 85||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,266][root][ERROR] - Failed to extract domain:  for response: 57
[2025-02-21 07:41:47,266][root][ERROR] - |Q. 90||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,266][root][ERROR] - Failed to extract domain:  for response: 58
[2025-02-21 07:41:47,266][root][ERROR] - |Q. 98||D: Evidence| Failed to extract explanation: 
[2025-02-21 07:41:47,267][root][ERROR] - Failed to extract domain:  for response: 59
[2025-02-21 07:41:47,267][root][ERROR] - Failed to extract domain:  for response: 60
[2025-02-21 07:41:47,267][root][ERROR] - |Q. 12||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:41:47,267][root][ERROR] - Failed to extract domain:  for response: 61
[2025-02-21 07:41:47,267][root][ERROR] - |Q. 19||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:41:47,267][root][ERROR] - Failed to extract domain:  for response: 62
[2025-02-21 07:41:47,267][root][ERROR] - Failed to extract domain:  for response: 63
[2025-02-21 07:41:47,267][root][ERROR] - Failed to extract domain:  for response: 64
[2025-02-21 07:41:47,268][root][ERROR] - Failed to extract domain:  for response: 65
[2025-02-21 07:41:47,268][root][ERROR] - Failed to extract domain:  for response: 66
[2025-02-21 07:41:47,268][root][ERROR] - |Q. 54||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:41:47,268][root][ERROR] - Failed to extract domain:  for response: 67
[2025-02-21 07:41:47,268][root][ERROR] - |Q. 61||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:41:47,268][root][ERROR] - Failed to extract domain:  for response: 68
[2025-02-21 07:41:47,268][root][ERROR] - Failed to extract domain:  for response: 69
[2025-02-21 07:41:47,268][root][ERROR] - |Q. 75||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:41:47,268][root][ERROR] - Failed to extract domain:  for response: 70
[2025-02-21 07:41:47,268][root][ERROR] - |Q. 82||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:41:47,269][root][ERROR] - Failed to extract domain:  for response: 71
[2025-02-21 07:41:47,269][root][ERROR] - |Q. 93||D: Civil_procedure| Failed to extract explanation: 
[2025-02-21 07:41:47,269][root][ERROR] - Failed to extract domain:  for response: 72
[2025-02-21 07:41:47,269][root][ERROR] - |Q. 9||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,269][root][ERROR] - Failed to extract domain:  for response: 73
[2025-02-21 07:41:47,269][root][ERROR] - |Q. 17||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,269][root][ERROR] - Failed to extract domain:  for response: 74
[2025-02-21 07:41:47,269][root][ERROR] - |Q. 25||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,269][root][ERROR] - Failed to extract domain:  for response: 75
[2025-02-21 07:41:47,269][root][ERROR] - |Q. 30||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,270][root][ERROR] - Failed to extract domain:  for response: 76
[2025-02-21 07:41:47,270][root][ERROR] - Failed to extract domain:  for response: 77
[2025-02-21 07:41:47,270][root][ERROR] - |Q. 46||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,270][root][ERROR] - Failed to extract domain:  for response: 78
[2025-02-21 07:41:47,270][root][ERROR] - Failed to extract domain:  for response: 79
[2025-02-21 07:41:47,270][root][ERROR] - Failed to extract domain:  for response: 80
[2025-02-21 07:41:47,270][root][ERROR] - Failed to extract domain:  for response: 81
[2025-02-21 07:41:47,270][root][ERROR] - |Q. 69||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,270][root][ERROR] - Failed to extract domain:  for response: 82
[2025-02-21 07:41:47,270][root][ERROR] - |Q. 81||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,271][root][ERROR] - Failed to extract domain:  for response: 83
[2025-02-21 07:41:47,271][root][ERROR] - Failed to extract domain:  for response: 84
[2025-02-21 07:41:47,271][root][ERROR] - Failed to extract domain:  for response: 85
[2025-02-21 07:41:47,271][root][ERROR] - |Q. 94||D: Property| Failed to extract explanation: 
[2025-02-21 07:41:47,271][root][ERROR] - Failed to extract domain:  for response: 86
[2025-02-21 07:41:47,271][root][ERROR] - Failed to extract domain:  for response: 87
[2025-02-21 07:41:47,271][root][ERROR] - Failed to extract domain:  for response: 88
[2025-02-21 07:41:47,271][root][ERROR] - |Q. 18||D: Torts| Failed to extract explanation: 
[2025-02-21 07:41:47,272][root][ERROR] - Failed to extract domain:  for response: 89
[2025-02-21 07:41:47,272][root][ERROR] - Failed to extract domain:  for response: 90
[2025-02-21 07:41:47,272][root][ERROR] - Failed to extract domain:  for response: 91
[2025-02-21 07:41:47,272][root][ERROR] - |Q. 39||D: Torts| Failed to extract explanation: 
[2025-02-21 07:41:47,272][root][ERROR] - Failed to extract domain:  for response: 92
[2025-02-21 07:41:47,272][root][ERROR] - Failed to extract domain:  for response: 93
[2025-02-21 07:41:47,272][root][ERROR] - |Q. 52||D: Torts| Failed to extract explanation: 
[2025-02-21 07:41:47,272][root][ERROR] - Failed to extract domain:  for response: 94
[2025-02-21 07:41:47,272][root][ERROR] - Failed to extract domain:  for response: 95
[2025-02-21 07:41:47,273][root][ERROR] - |Q. 63||D: Torts| Failed to extract explanation: 
[2025-02-21 07:41:47,273][root][ERROR] - Failed to extract domain:  for response: 96
[2025-02-21 07:41:47,273][root][ERROR] - Failed to extract domain:  for response: 97
[2025-02-21 07:41:47,273][root][ERROR] - Failed to extract domain:  for response: 98
[2025-02-21 07:41:47,273][root][ERROR] - Failed to extract domain:  for response: 99
[2025-02-21 07:41:47,273][root][ERROR] - Failed to extract domain:  for response: 100
[2025-02-21 07:41:47,274][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,278][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,278][root][INFO] - Saved parsed outputs
[2025-02-21 07:41:47,278][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,280][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,280][root][INFO] - Saved parsing metadata
[2025-02-21 07:41:47,280][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,282][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
[2025-02-21 07:41:47,283][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/markdown_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 07:41:47,299][root][INFO] - Evaluation completed for markdown_answer_first_zero_shot_unstructured, on test_set_2
[2025-02-21 07:41:47,299][root][INFO] - Summary of metrics : {'label_accuracy': 0.0, 'misclassification_rate': 1.0, 'combined_accuracy': 0.0, 'malformed_label': 100, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 0, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 0, 'both_wrong': 100}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '24', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=markdown_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 24 to status completed with exit code 0
Eval status update completed for job 24
Job 24 completed at Fri Feb 21 07:41:48 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n514
Job ID: 25309359
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 07:59:49
CPU Efficiency: 9.90% of 3-08:48:30 core-walltime
Job Wall-clock time: 08:04:51
Memory Utilized: 35.38 GB
Memory Efficiency: 98.27% of 36.00 GB
