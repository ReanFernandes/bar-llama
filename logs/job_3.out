Starting job 3 at Thu Feb 20 22:40:45 CET 2025
Configuration: model=llama2 tokenizer=llama2 dataset=all_domains_1_samples prompt=number_list_answer_first_few_shot_unstructured train=number_list_answer_first_few_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '3', 'training']
Updating job 3 to status training with exit code None
Status update completed for job 3
[2025-02-20 22:40:59,992][root][INFO] - Global seed set to 314
[2025-02-20 22:40:59,994][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-02-20 22:40:59,994][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-02-20 22:40:59,994][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-02-20 22:40:59,994][root][INFO] - Current training config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 22:40:59,995][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-02-20 22:41:00,055][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:41:00,069][root][INFO] - Indexing complete, sampling of questions set to True
[2025-02-20 22:41:00,072][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-02-20 22:41:00,115][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-02-20 22:41:00,635][root][INFO] - Tokenizer meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:41:17,384][root][INFO] - Quantised model meta-llama/Llama-2-7b-hf loaded successfully
[2025-02-20 22:41:45,860][root][INFO] - Model prepared for kbit training
[2025-02-20 22:41:45,861][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'k_proj', 'up_proj', 'v_proj', 'down_proj', 'o_proj', 'gate_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-02-20 22:41:47,665][root][INFO] - Lora adapter added to model
[2025-02-20 22:41:47,668][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_answer_first_few_shot_unstructured
[2025-02-20 22:41:47,783][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.551, 'grad_norm': 0.13677367568016052, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.4012, 'grad_norm': 0.16971053183078766, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.2834, 'grad_norm': 0.17387238144874573, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.1846, 'grad_norm': 0.23025567829608917, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0029, 'grad_norm': 0.2548576593399048, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 379.557, 'train_samples_per_second': 0.277, 'train_steps_per_second': 0.04, 'train_loss': 1.2846200307210287, 'epoch': 15.0}
[2025-02-20 22:48:10,464][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama2/all_domains_1_samples/llama2_number_list_answer_first_few_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '3', 'trained', '0']
Updating job 3 to status trained with exit code 0
Status update completed for job 3
Starting evaluations for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-20 22:48:30,599][root][INFO] - Setting global seed to 206
[2025-02-20 22:48:30,608][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-20 22:48:30,608][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 22:48:30,609][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 22:48:30,612][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 22:48:30,619][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 22:48:30,619][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 22:48:30,775][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 22:48:31,609][root][INFO] - Full model selected, loading model
[2025-02-20 22:48:52,895][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-20 22:49:53,377][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-20 22:49:53,378][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-20 22:50:23,937][root][INFO] - Peft model loaded successfully
[2025-02-20 22:50:30,616][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 22:50:30,618][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 22:50:30,618][root][INFO] - Starting inference
[2025-02-20 22:50:30,814][root][INFO] - Processing question number 0
[2025-02-20 22:50:30,835][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 22:51:00,313][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 22:51:30,543][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 22:52:00,358][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 22:52:30,659][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 22:53:00,345][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 22:53:29,999][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 22:54:00,444][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 22:54:30,432][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 22:55:00,027][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 22:55:30,236][root][INFO] - Processing question number 10
[2025-02-20 22:55:30,238][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 22:56:01,794][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 22:56:31,145][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 22:57:01,010][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 22:57:31,430][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 22:58:01,827][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 22:58:31,239][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 22:59:00,584][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 22:59:30,411][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:00:00,260][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:00:29,891][root][INFO] - Processing question number 20
[2025-02-20 23:00:29,893][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:00:59,748][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:01:29,765][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:01:59,227][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:02:28,769][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:02:58,938][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:03:28,805][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:03:59,434][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:04:29,291][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:04:59,203][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:05:28,386][root][INFO] - Processing question number 30
[2025-02-20 23:05:28,389][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:05:58,511][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:06:28,893][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:06:58,803][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:07:28,555][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:07:58,166][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:08:28,502][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:08:58,221][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:09:28,327][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:09:58,217][root][INFO] - Domain : Contracts, Question : 66
[2025-02-20 23:10:28,845][root][INFO] - Processing question number 40
[2025-02-20 23:10:28,849][root][INFO] - Domain : Contracts, Question : 72
[2025-02-20 23:10:58,795][root][INFO] - Domain : Contracts, Question : 81
[2025-02-20 23:11:28,745][root][INFO] - Domain : Contracts, Question : 88
[2025-02-20 23:11:59,158][root][INFO] - Domain : Contracts, Question : 94
[2025-02-20 23:12:29,522][root][INFO] - Domain : Torts, Question : 4
[2025-02-20 23:12:59,161][root][INFO] - Domain : Torts, Question : 11
[2025-02-20 23:13:29,094][root][INFO] - Domain : Torts, Question : 24
[2025-02-20 23:14:00,308][root][INFO] - Domain : Torts, Question : 32
[2025-02-20 23:14:29,311][root][INFO] - Domain : Torts, Question : 41
[2025-02-20 23:14:59,125][root][INFO] - Domain : Torts, Question : 47
[2025-02-20 23:15:29,591][root][INFO] - Processing question number 50
[2025-02-20 23:15:29,595][root][INFO] - Domain : Torts, Question : 52
[2025-02-20 23:16:00,262][root][INFO] - Domain : Torts, Question : 62
[2025-02-20 23:16:30,286][root][INFO] - Domain : Torts, Question : 76
[2025-02-20 23:16:59,576][root][INFO] - Domain : Torts, Question : 82
[2025-02-20 23:17:30,533][root][INFO] - Domain : Torts, Question : 90
[2025-02-20 23:18:00,543][root][INFO] - Domain : Torts, Question : 95
[2025-02-20 23:18:29,560][root][INFO] - Domain : Torts, Question : 99
[2025-02-20 23:19:00,215][root][INFO] - Domain : Evidence, Question : 5
[2025-02-20 23:19:29,657][root][INFO] - Domain : Evidence, Question : 12
[2025-02-20 23:20:00,106][root][INFO] - Domain : Evidence, Question : 18
[2025-02-20 23:20:31,381][root][INFO] - Processing question number 60
[2025-02-20 23:20:31,386][root][INFO] - Domain : Evidence, Question : 23
[2025-02-20 23:21:00,816][root][INFO] - Domain : Evidence, Question : 31
[2025-02-20 23:21:30,592][root][INFO] - Domain : Evidence, Question : 34
[2025-02-20 23:22:00,955][root][INFO] - Domain : Evidence, Question : 40
[2025-02-20 23:22:30,349][root][INFO] - Domain : Evidence, Question : 44
[2025-02-20 23:23:00,236][root][INFO] - Domain : Evidence, Question : 53
[2025-02-20 23:23:30,168][root][INFO] - Domain : Evidence, Question : 59
[2025-02-20 23:24:00,143][root][INFO] - Domain : Evidence, Question : 68
[2025-02-20 23:24:30,437][root][INFO] - Domain : Evidence, Question : 73
[2025-02-20 23:25:00,490][root][INFO] - Domain : Evidence, Question : 78
[2025-02-20 23:25:31,023][root][INFO] - Processing question number 70
[2025-02-20 23:25:31,028][root][INFO] - Domain : Evidence, Question : 86
[2025-02-20 23:26:00,766][root][INFO] - Domain : Evidence, Question : 96
[2025-02-20 23:26:30,558][root][INFO] - Domain : Property, Question : 6
[2025-02-20 23:27:00,172][root][INFO] - Domain : Property, Question : 13
[2025-02-20 23:27:30,418][root][INFO] - Domain : Property, Question : 20
[2025-02-20 23:28:00,619][root][INFO] - Domain : Property, Question : 33
[2025-02-20 23:28:30,129][root][INFO] - Domain : Property, Question : 39
[2025-02-20 23:29:00,435][root][INFO] - Domain : Property, Question : 48
[2025-02-20 23:29:30,549][root][INFO] - Domain : Property, Question : 54
[2025-02-20 23:30:00,855][root][INFO] - Domain : Property, Question : 61
[2025-02-20 23:30:30,594][root][INFO] - Processing question number 80
[2025-02-20 23:30:30,599][root][INFO] - Domain : Property, Question : 67
[2025-02-20 23:31:00,773][root][INFO] - Domain : Property, Question : 75
[2025-02-20 23:31:30,954][root][INFO] - Domain : Property, Question : 83
[2025-02-20 23:32:00,584][root][INFO] - Domain : Property, Question : 89
[2025-02-20 23:32:30,248][root][INFO] - Domain : Property, Question : 97
[2025-02-20 23:33:00,678][root][INFO] - Domain : Property, Question : 100
[2025-02-20 23:33:30,942][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-20 23:34:01,239][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-20 23:34:30,862][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-20 23:35:00,943][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-20 23:35:30,323][root][INFO] - Processing question number 90
[2025-02-20 23:35:30,329][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-20 23:36:01,161][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-20 23:36:30,065][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-20 23:36:59,854][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-20 23:37:28,889][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-20 23:37:59,209][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-20 23:38:28,598][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-20 23:38:58,318][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-20 23:39:28,306][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-20 23:39:58,758][root][INFO] - Inference complete
[2025-02-20 23:39:58,758][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,766][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,782][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,795][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,795][root][INFO] - Saved parsed outputs
[2025-02-20 23:39:58,795][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,812][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,812][root][INFO] - Saved parsing metadata
[2025-02-20 23:39:58,812][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,815][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:39:58,862][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-20 23:39:58,879][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-20 23:39:58,879][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.31313131313131315, 'malformed_label': 0, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.5714285714285714, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 9, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-20 23:40:05,005][root][INFO] - Setting global seed to 206
[2025-02-20 23:40:05,010][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-20 23:40:05,010][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-20 23:40:05,011][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-20 23:40:05,013][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-20 23:40:05,015][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-20 23:40:05,015][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-20 23:40:05,197][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-20 23:40:05,458][root][INFO] - Full model selected, loading model
[2025-02-20 23:40:16,720][root][INFO] - Baseline model selected, no adapter needed
[2025-02-20 23:40:16,720][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-20 23:40:22,934][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-20 23:40:22,936][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-20 23:40:22,936][root][INFO] - Starting inference
[2025-02-20 23:40:23,132][root][INFO] - Processing question number 0
[2025-02-20 23:40:23,162][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-20 23:40:52,217][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-20 23:41:22,296][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-20 23:41:52,002][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-20 23:42:22,180][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-20 23:42:51,783][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-20 23:43:21,302][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-20 23:43:51,620][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-20 23:44:21,466][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-20 23:44:50,949][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-20 23:45:21,073][root][INFO] - Processing question number 10
[2025-02-20 23:45:21,075][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-20 23:45:52,574][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-20 23:46:21,789][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-20 23:46:51,599][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-20 23:47:21,960][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-20 23:47:52,298][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-20 23:48:21,656][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-20 23:48:50,858][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-20 23:49:20,580][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-20 23:49:50,282][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-20 23:50:19,754][root][INFO] - Processing question number 20
[2025-02-20 23:50:19,757][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-20 23:50:49,435][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-20 23:51:19,343][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-20 23:51:48,711][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-20 23:52:17,926][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-20 23:52:47,920][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-20 23:53:17,700][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-20 23:53:48,216][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-20 23:54:17,913][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-20 23:54:47,785][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-20 23:55:16,923][root][INFO] - Processing question number 30
[2025-02-20 23:55:16,928][root][INFO] - Domain : Contracts, Question : 3
[2025-02-20 23:55:46,992][root][INFO] - Domain : Contracts, Question : 8
[2025-02-20 23:56:17,342][root][INFO] - Domain : Contracts, Question : 16
[2025-02-20 23:56:47,201][root][INFO] - Domain : Contracts, Question : 22
[2025-02-20 23:57:16,864][root][INFO] - Domain : Contracts, Question : 27
[2025-02-20 23:57:46,421][root][INFO] - Domain : Contracts, Question : 38
[2025-02-20 23:58:16,714][root][INFO] - Domain : Contracts, Question : 46
[2025-02-20 23:58:46,345][root][INFO] - Domain : Contracts, Question : 51
[2025-02-20 23:59:16,391][root][INFO] - Domain : Contracts, Question : 58
[2025-02-20 23:59:46,240][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:00:16,771][root][INFO] - Processing question number 40
[2025-02-21 00:00:16,774][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:00:46,689][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:01:16,581][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:01:46,941][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:02:17,249][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:02:46,833][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:03:16,696][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:03:47,873][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:04:16,820][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:04:46,544][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:05:16,947][root][INFO] - Processing question number 50
[2025-02-21 00:05:16,951][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:05:47,536][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:06:17,516][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:06:46,675][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:07:17,590][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:07:47,544][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 00:08:16,517][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 00:08:47,068][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 00:09:16,519][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 00:09:46,984][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 00:10:18,347][root][INFO] - Processing question number 60
[2025-02-21 00:10:18,351][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 00:10:47,867][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 00:11:17,668][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 00:11:48,096][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 00:12:17,531][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 00:12:47,465][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 00:13:17,543][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 00:13:47,548][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 00:14:17,867][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 00:14:47,946][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 00:15:18,499][root][INFO] - Processing question number 70
[2025-02-21 00:15:18,503][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 00:15:48,243][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 00:16:17,947][root][INFO] - Domain : Property, Question : 6
[2025-02-21 00:16:47,572][root][INFO] - Domain : Property, Question : 13
[2025-02-21 00:17:17,791][root][INFO] - Domain : Property, Question : 20
[2025-02-21 00:17:47,989][root][INFO] - Domain : Property, Question : 33
[2025-02-21 00:18:17,450][root][INFO] - Domain : Property, Question : 39
[2025-02-21 00:18:47,760][root][INFO] - Domain : Property, Question : 48
[2025-02-21 00:19:17,894][root][INFO] - Domain : Property, Question : 54
[2025-02-21 00:19:48,269][root][INFO] - Domain : Property, Question : 61
[2025-02-21 00:20:18,033][root][INFO] - Processing question number 80
[2025-02-21 00:20:18,038][root][INFO] - Domain : Property, Question : 67
[2025-02-21 00:20:48,257][root][INFO] - Domain : Property, Question : 75
[2025-02-21 00:21:18,492][root][INFO] - Domain : Property, Question : 83
[2025-02-21 00:21:48,262][root][INFO] - Domain : Property, Question : 89
[2025-02-21 00:22:18,015][root][INFO] - Domain : Property, Question : 97
[2025-02-21 00:22:48,572][root][INFO] - Domain : Property, Question : 100
[2025-02-21 00:23:18,885][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 00:23:49,303][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 00:24:19,043][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 00:24:49,222][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 00:25:18,724][root][INFO] - Processing question number 90
[2025-02-21 00:25:18,729][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 00:25:49,709][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 00:26:18,690][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 00:26:48,515][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 00:27:17,657][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 00:27:48,081][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 00:28:17,588][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 00:28:47,348][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 00:29:17,446][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 00:29:48,021][root][INFO] - Inference complete
[2025-02-21 00:29:48,022][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,030][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,047][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,104][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,104][root][INFO] - Saved parsed outputs
[2025-02-21 00:29:48,104][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,128][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,128][root][INFO] - Saved parsing metadata
[2025-02-21 00:29:48,129][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,131][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:29:48,169][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 00:29:48,232][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 00:29:48,232][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 0, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.20202020202020202, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 9, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 00:29:57,745][root][INFO] - Setting global seed to 206
[2025-02-21 00:29:57,753][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 00:29:57,754][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 00:29:57,755][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 00:29:57,757][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 00:29:57,763][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 00:29:57,763][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 00:29:57,920][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 00:29:58,234][root][INFO] - Full model selected, loading model
[2025-02-21 00:30:15,998][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 00:31:16,149][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 00:31:16,149][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 00:31:52,285][root][INFO] - Peft model loaded successfully
[2025-02-21 00:31:58,286][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 00:31:58,287][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 00:31:58,288][root][INFO] - Starting inference
[2025-02-21 00:31:58,520][root][INFO] - Processing question number 0
[2025-02-21 00:31:58,522][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 00:32:28,672][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 00:32:59,253][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 00:33:29,405][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 00:33:59,952][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 00:34:29,967][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 00:34:59,894][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 00:35:30,639][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 00:36:00,894][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 00:36:30,797][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 00:37:01,421][root][INFO] - Processing question number 10
[2025-02-21 00:37:01,423][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 00:37:33,387][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 00:38:03,087][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 00:38:33,289][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 00:39:04,075][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 00:39:34,829][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 00:40:04,597][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 00:40:34,321][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 00:41:04,555][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 00:41:34,691][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 00:42:04,583][root][INFO] - Processing question number 20
[2025-02-21 00:42:04,585][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 00:42:34,704][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 00:43:05,031][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 00:43:34,809][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 00:44:04,524][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 00:44:34,990][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 00:45:05,203][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 00:45:36,187][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 00:46:06,319][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 00:46:36,603][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 00:47:06,164][root][INFO] - Processing question number 30
[2025-02-21 00:47:06,168][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 00:47:36,631][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 00:48:07,413][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 00:48:37,742][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 00:49:07,817][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 00:49:37,795][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 00:50:08,498][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 00:50:38,583][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 00:51:09,041][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 00:51:39,330][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 00:52:10,419][root][INFO] - Processing question number 40
[2025-02-21 00:52:10,423][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 00:52:40,727][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 00:53:11,044][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 00:53:41,822][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 00:54:12,550][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 00:54:42,553][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 00:55:12,808][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 00:55:44,425][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 00:56:13,803][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 00:56:43,965][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 00:57:14,742][root][INFO] - Processing question number 50
[2025-02-21 00:57:14,746][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 00:57:45,780][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 00:58:16,156][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 00:58:45,794][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 00:59:17,107][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 00:59:47,497][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:00:16,852][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:00:47,842][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:01:17,638][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:01:48,448][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:02:20,055][root][INFO] - Processing question number 60
[2025-02-21 01:02:20,059][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:02:49,839][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:03:19,992][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:03:50,673][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:04:20,425][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:04:50,641][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:05:20,932][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:05:51,246][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:06:21,843][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:06:52,259][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:07:23,160][root][INFO] - Processing question number 70
[2025-02-21 01:07:23,165][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:07:53,222][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:08:23,331][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:08:53,294][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:09:23,867][root][INFO] - Domain : Property, Question : 20
[2025-02-21 01:09:54,405][root][INFO] - Domain : Property, Question : 33
[2025-02-21 01:10:24,234][root][INFO] - Domain : Property, Question : 39
[2025-02-21 01:10:54,913][root][INFO] - Domain : Property, Question : 48
[2025-02-21 01:11:25,329][root][INFO] - Domain : Property, Question : 54
[2025-02-21 01:11:55,960][root][INFO] - Domain : Property, Question : 61
[2025-02-21 01:12:26,043][root][INFO] - Processing question number 80
[2025-02-21 01:12:26,049][root][INFO] - Domain : Property, Question : 67
[2025-02-21 01:12:56,578][root][INFO] - Domain : Property, Question : 75
[2025-02-21 01:13:27,058][root][INFO] - Domain : Property, Question : 83
[2025-02-21 01:13:57,040][root][INFO] - Domain : Property, Question : 89
[2025-02-21 01:14:27,078][root][INFO] - Domain : Property, Question : 97
[2025-02-21 01:14:57,832][root][INFO] - Domain : Property, Question : 100
[2025-02-21 01:15:28,422][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 01:15:59,082][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 01:16:29,056][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 01:16:59,471][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 01:17:29,201][root][INFO] - Processing question number 90
[2025-02-21 01:17:29,206][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 01:18:00,411][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 01:18:29,677][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 01:18:59,789][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 01:19:29,136][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 01:19:59,798][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 01:20:29,536][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 01:20:59,592][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 01:21:29,927][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 01:22:00,767][root][INFO] - Inference complete
[2025-02-21 01:22:00,767][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,774][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,790][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,796][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,796][root][INFO] - Saved parsed outputs
[2025-02-21 01:22:00,796][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,797][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,797][root][INFO] - Saved parsing metadata
[2025-02-21 01:22:00,798][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,800][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:00,802][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 01:22:00,831][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 01:22:00,832][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.24242424242424243, 'malformed_label': 0, 'malformed_domain': 22, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 24, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.35714285714285715, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.18181818181818182, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 53, 'correct_label_wrong_domain': 6, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 01:22:08,986][root][INFO] - Setting global seed to 206
[2025-02-21 01:22:08,994][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 01:22:08,994][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 01:22:08,995][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 01:22:08,997][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 01:22:09,000][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 01:22:09,000][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 01:22:09,151][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 01:22:09,427][root][INFO] - Full model selected, loading model
[2025-02-21 01:22:22,777][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 01:22:22,777][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 01:22:29,030][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 01:22:29,031][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 01:22:29,031][root][INFO] - Starting inference
[2025-02-21 01:22:29,225][root][INFO] - Processing question number 0
[2025-02-21 01:22:29,227][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 01:22:58,757][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 01:23:29,129][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 01:23:59,089][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 01:24:29,499][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 01:24:59,352][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 01:25:29,211][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 01:25:59,846][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 01:26:29,983][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 01:26:59,748][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 01:27:30,175][root][INFO] - Processing question number 10
[2025-02-21 01:27:30,177][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 01:28:01,973][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 01:28:31,486][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 01:29:01,600][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 01:29:32,307][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 01:30:02,917][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 01:30:32,578][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 01:31:02,073][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 01:31:32,103][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 01:32:02,087][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 01:32:31,855][root][INFO] - Processing question number 20
[2025-02-21 01:32:31,858][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 01:33:01,874][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 01:33:32,080][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 01:34:01,717][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 01:34:31,229][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 01:35:01,522][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 01:35:31,598][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 01:36:02,394][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 01:36:32,410][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 01:37:02,618][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 01:37:32,024][root][INFO] - Processing question number 30
[2025-02-21 01:37:32,027][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 01:38:02,361][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 01:38:33,021][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 01:39:03,187][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 01:39:33,121][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 01:40:02,985][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 01:40:33,609][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 01:41:03,519][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 01:41:33,877][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 01:42:04,005][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 01:42:34,821][root][INFO] - Processing question number 40
[2025-02-21 01:42:34,824][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 01:43:05,044][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 01:43:35,291][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 01:44:06,747][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 01:44:37,377][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 01:45:07,241][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 01:45:37,400][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 01:46:08,905][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 01:46:38,203][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 01:47:20,917][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 01:47:51,647][root][INFO] - Processing question number 50
[2025-02-21 01:47:51,652][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 01:48:22,517][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 01:48:52,831][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 01:49:22,323][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 01:49:53,518][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 01:50:23,790][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 01:50:53,072][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 01:51:23,913][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 01:51:53,571][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 01:52:24,264][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 01:52:55,792][root][INFO] - Processing question number 60
[2025-02-21 01:52:55,796][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 01:53:25,443][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 01:53:55,408][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 01:54:26,028][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 01:54:55,723][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 01:55:25,803][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 01:55:55,992][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 01:56:26,218][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 01:56:56,740][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 01:57:27,000][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 01:57:57,792][root][INFO] - Processing question number 70
[2025-02-21 01:57:57,797][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 01:58:27,739][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 01:58:57,722][root][INFO] - Domain : Property, Question : 6
[2025-02-21 01:59:27,663][root][INFO] - Domain : Property, Question : 13
[2025-02-21 01:59:58,107][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:00:28,500][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:00:58,220][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:01:28,750][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:01:59,121][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:02:29,699][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:02:59,609][root][INFO] - Processing question number 80
[2025-02-21 02:02:59,615][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:03:29,982][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:04:00,344][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:04:30,233][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:05:00,125][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:05:30,813][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:06:01,317][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:06:31,835][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:07:01,687][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:07:32,001][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:08:01,647][root][INFO] - Processing question number 90
[2025-02-21 02:08:01,652][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 02:08:32,700][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 02:09:01,805][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 02:09:31,845][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 02:10:01,175][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 02:10:31,701][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 02:11:01,316][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 02:11:31,230][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 02:12:01,462][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 02:12:32,118][root][INFO] - Inference complete
[2025-02-21 02:12:32,118][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,125][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,144][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,149][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,149][root][INFO] - Saved parsed outputs
[2025-02-21 02:12:32,149][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,151][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,151][root][INFO] - Saved parsing metadata
[2025-02-21 02:12:32,152][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,155][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:12:32,156][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 02:12:32,174][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 02:12:32,174][root][INFO] - Summary of metrics : {'label_accuracy': 0.25252525252525254, 'misclassification_rate': 0.7474747474747474, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 0, 'malformed_domain': 19, 'total_predictions': 99, 'correct_predictions': 25, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.16161616161616163, 'correct_domain_wrong_label': 58, 'correct_label_wrong_domain': 3, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 02:12:39,374][root][INFO] - Setting global seed to 206
[2025-02-21 02:12:39,379][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 02:12:39,379][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 02:12:39,381][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 02:12:39,383][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 02:12:39,385][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 02:12:39,385][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 02:12:39,536][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 02:12:39,810][root][INFO] - Full model selected, loading model
[2025-02-21 02:12:55,747][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 02:13:56,314][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 02:13:56,316][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 02:14:21,617][root][INFO] - Peft model loaded successfully
[2025-02-21 02:14:27,697][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 02:14:27,699][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 02:14:27,699][root][INFO] - Starting inference
[2025-02-21 02:14:27,927][root][INFO] - Processing question number 0
[2025-02-21 02:14:27,930][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 02:14:57,817][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 02:15:28,346][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 02:15:58,444][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 02:16:28,978][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 02:16:58,975][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 02:17:28,935][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 02:17:59,611][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 02:18:29,859][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 02:18:59,729][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 02:19:30,300][root][INFO] - Processing question number 10
[2025-02-21 02:19:30,301][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 02:20:02,191][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 02:20:31,905][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 02:21:02,135][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 02:21:33,336][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 02:22:04,073][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 02:22:33,820][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 02:23:03,508][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 02:23:33,653][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 02:24:03,777][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 02:24:33,685][root][INFO] - Processing question number 20
[2025-02-21 02:24:33,689][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 02:25:03,832][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 02:25:34,114][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 02:26:03,860][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 02:26:33,557][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 02:27:03,949][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 02:27:34,089][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 02:28:05,091][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 02:28:35,269][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 02:29:05,481][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 02:29:35,019][root][INFO] - Processing question number 30
[2025-02-21 02:29:35,022][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 02:30:05,470][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 02:30:36,222][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 02:31:06,488][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 02:31:36,573][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 02:32:06,561][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 02:32:37,286][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 02:33:07,327][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 02:33:37,786][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 02:34:08,033][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 02:34:39,018][root][INFO] - Processing question number 40
[2025-02-21 02:34:39,021][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 02:35:09,304][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 02:35:39,617][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 02:36:10,419][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 02:36:41,116][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 02:37:11,111][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 02:37:41,365][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 02:38:12,935][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 02:38:42,267][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 02:39:12,405][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 02:39:43,216][root][INFO] - Processing question number 50
[2025-02-21 02:39:43,220][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 02:40:14,288][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 02:40:44,623][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 02:41:14,272][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 02:41:45,570][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 02:42:15,921][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 02:42:45,273][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 02:43:16,281][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 02:43:46,119][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 02:44:16,892][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 02:44:48,514][root][INFO] - Processing question number 60
[2025-02-21 02:44:48,518][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 02:45:18,287][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 02:45:48,405][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 02:46:19,098][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 02:46:48,839][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 02:47:19,073][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 02:47:49,422][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 02:48:19,710][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 02:48:50,336][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 02:49:20,728][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 02:49:51,613][root][INFO] - Processing question number 70
[2025-02-21 02:49:51,618][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 02:50:21,680][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 02:50:51,827][root][INFO] - Domain : Property, Question : 6
[2025-02-21 02:51:21,829][root][INFO] - Domain : Property, Question : 13
[2025-02-21 02:51:52,433][root][INFO] - Domain : Property, Question : 20
[2025-02-21 02:52:22,948][root][INFO] - Domain : Property, Question : 33
[2025-02-21 02:52:52,800][root][INFO] - Domain : Property, Question : 39
[2025-02-21 02:53:23,453][root][INFO] - Domain : Property, Question : 48
[2025-02-21 02:53:53,911][root][INFO] - Domain : Property, Question : 54
[2025-02-21 02:54:24,545][root][INFO] - Domain : Property, Question : 61
[2025-02-21 02:54:54,652][root][INFO] - Processing question number 80
[2025-02-21 02:54:54,658][root][INFO] - Domain : Property, Question : 67
[2025-02-21 02:55:25,227][root][INFO] - Domain : Property, Question : 75
[2025-02-21 02:55:55,692][root][INFO] - Domain : Property, Question : 83
[2025-02-21 02:56:25,684][root][INFO] - Domain : Property, Question : 89
[2025-02-21 02:56:55,698][root][INFO] - Domain : Property, Question : 97
[2025-02-21 02:57:26,475][root][INFO] - Domain : Property, Question : 100
[2025-02-21 02:57:57,056][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 02:58:27,726][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 02:58:37,225][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 02:59:07,707][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 02:59:37,450][root][INFO] - Processing question number 90
[2025-02-21 02:59:37,456][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:00:08,662][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:00:37,927][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:01:08,076][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:01:37,445][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:02:08,118][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:02:37,887][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:03:07,927][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:03:38,260][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:04:09,068][root][INFO] - Inference complete
[2025-02-21 03:04:09,068][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,075][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,091][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,096][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,096][root][INFO] - Saved parsed outputs
[2025-02-21 03:04:09,096][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,097][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,097][root][INFO] - Saved parsing metadata
[2025-02-21 03:04:09,098][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,100][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:09,101][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:04:09,121][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:04:09,121][root][INFO] - Summary of metrics : {'label_accuracy': 0.24242424242424243, 'misclassification_rate': 0.7575757575757576, 'combined_accuracy': 0.1717171717171717, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 24, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.18181818181818182, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.050505050505050504, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 56, 'correct_label_wrong_domain': 7, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 03:04:17,009][root][INFO] - Setting global seed to 206
[2025-02-21 03:04:17,017][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 03:04:17,017][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:04:17,018][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:04:17,021][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:04:17,022][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:04:17,023][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:04:17,170][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:04:17,418][root][INFO] - Full model selected, loading model
[2025-02-21 03:04:37,584][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 03:04:37,598][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 03:04:44,612][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:04:44,614][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:04:44,614][root][INFO] - Starting inference
[2025-02-21 03:04:44,834][root][INFO] - Processing question number 0
[2025-02-21 03:04:44,836][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:05:14,793][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:05:45,256][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:06:15,197][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:06:45,649][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:07:15,544][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:07:45,400][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 03:08:16,029][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 03:08:46,221][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 03:09:16,070][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 03:09:46,495][root][INFO] - Processing question number 10
[2025-02-21 03:09:46,497][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 03:10:18,320][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 03:10:47,861][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 03:11:18,000][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 03:11:48,686][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 03:12:19,356][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 03:12:49,067][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 03:13:18,589][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 03:13:48,639][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 03:14:18,676][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 03:14:48,479][root][INFO] - Processing question number 20
[2025-02-21 03:14:48,481][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 03:15:18,478][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 03:15:48,694][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 03:16:18,394][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 03:16:47,990][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 03:17:18,254][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 03:17:48,368][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 03:18:19,215][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 03:18:49,249][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 03:19:19,416][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 03:19:48,880][root][INFO] - Processing question number 30
[2025-02-21 03:19:48,883][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 03:20:19,296][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 03:20:49,953][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 03:21:20,154][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 03:21:50,124][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 03:22:20,013][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 03:22:50,632][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 03:23:20,571][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 03:23:50,970][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 03:24:21,194][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 03:24:52,155][root][INFO] - Processing question number 40
[2025-02-21 03:24:52,158][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 03:25:22,399][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 03:25:52,643][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 03:26:23,353][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 03:26:53,985][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 03:27:23,909][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 03:27:54,151][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 03:28:25,638][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 03:28:54,899][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 03:29:24,957][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 03:29:55,704][root][INFO] - Processing question number 50
[2025-02-21 03:29:55,708][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 03:30:26,618][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 03:30:56,943][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 03:31:26,472][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 03:31:57,709][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 03:32:27,986][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 03:32:57,304][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 03:33:28,195][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 03:33:57,907][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 03:34:28,655][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 03:35:00,274][root][INFO] - Processing question number 60
[2025-02-21 03:35:00,278][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 03:35:29,945][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 03:35:59,970][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 03:36:30,612][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 03:37:00,303][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 03:37:30,463][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 03:38:00,687][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 03:38:30,978][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 03:39:01,547][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 03:39:31,861][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 03:40:02,689][root][INFO] - Processing question number 70
[2025-02-21 03:40:02,694][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 03:40:32,679][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 03:41:02,699][root][INFO] - Domain : Property, Question : 6
[2025-02-21 03:41:32,586][root][INFO] - Domain : Property, Question : 13
[2025-02-21 03:42:03,095][root][INFO] - Domain : Property, Question : 20
[2025-02-21 03:42:33,578][root][INFO] - Domain : Property, Question : 33
[2025-02-21 03:43:03,334][root][INFO] - Domain : Property, Question : 39
[2025-02-21 03:43:33,907][root][INFO] - Domain : Property, Question : 48
[2025-02-21 03:44:04,300][root][INFO] - Domain : Property, Question : 54
[2025-02-21 03:44:34,901][root][INFO] - Domain : Property, Question : 61
[2025-02-21 03:45:04,878][root][INFO] - Processing question number 80
[2025-02-21 03:45:04,883][root][INFO] - Domain : Property, Question : 67
[2025-02-21 03:45:35,307][root][INFO] - Domain : Property, Question : 75
[2025-02-21 03:46:05,758][root][INFO] - Domain : Property, Question : 83
[2025-02-21 03:46:35,635][root][INFO] - Domain : Property, Question : 89
[2025-02-21 03:47:05,577][root][INFO] - Domain : Property, Question : 97
[2025-02-21 03:47:36,310][root][INFO] - Domain : Property, Question : 100
[2025-02-21 03:48:06,827][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 03:48:37,411][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 03:49:07,321][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 03:49:37,724][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 03:50:07,374][root][INFO] - Processing question number 90
[2025-02-21 03:50:07,379][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 03:50:38,495][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 03:51:07,664][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 03:51:37,713][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 03:52:07,033][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 03:52:37,648][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 03:53:07,367][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 03:53:37,303][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 03:54:07,609][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 03:54:38,334][root][INFO] - Inference complete
[2025-02-21 03:54:38,335][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,342][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,359][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,364][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,364][root][INFO] - Saved parsed outputs
[2025-02-21 03:54:38,364][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,366][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,366][root][INFO] - Saved parsing metadata
[2025-02-21 03:54:38,366][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,368][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:54:38,369][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 03:54:38,387][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 03:54:38,388][root][INFO] - Summary of metrics : {'label_accuracy': 0.18181818181818182, 'misclassification_rate': 0.8181818181818181, 'combined_accuracy': 0.1414141414141414, 'malformed_label': 0, 'malformed_domain': 28, 'total_predictions': 99, 'correct_predictions': 18, 'correct_label_and_domain': 14, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.15384615384615385, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.15151515151515152, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.13131313131313133, 'Civil_Procedure_confidence': 0.15151515151515152, 'correct_domain_wrong_label': 57, 'correct_label_wrong_domain': 4, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 03:54:46,631][root][INFO] - Setting global seed to 989
[2025-02-21 03:54:46,639][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 03:54:46,639][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 03:54:46,640][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 03:54:46,642][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 03:54:46,644][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 03:54:46,644][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 03:54:46,789][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 03:54:47,051][root][INFO] - Full model selected, loading model
[2025-02-21 03:55:06,273][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 03:56:09,193][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 03:56:09,195][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 03:56:38,420][root][INFO] - Peft model loaded successfully
[2025-02-21 03:56:45,075][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 03:56:45,076][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 03:56:45,076][root][INFO] - Starting inference
[2025-02-21 03:56:45,292][root][INFO] - Processing question number 0
[2025-02-21 03:56:45,295][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 03:57:14,740][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 03:57:45,090][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 03:58:15,010][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 03:58:45,431][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 03:59:15,238][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 03:59:45,000][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:00:15,560][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:00:45,673][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:01:15,367][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:01:45,763][root][INFO] - Processing question number 10
[2025-02-21 04:01:45,765][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:02:17,520][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:02:47,058][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:03:17,095][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:03:47,702][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:04:18,336][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:04:47,910][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:05:17,422][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:05:47,431][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:06:17,414][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:06:47,107][root][INFO] - Processing question number 20
[2025-02-21 04:06:47,109][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:07:17,081][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:07:47,286][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:08:16,834][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:08:46,371][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:09:16,580][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 04:09:46,612][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 04:10:17,434][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 04:10:47,413][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 04:11:17,549][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 04:11:46,942][root][INFO] - Processing question number 30
[2025-02-21 04:11:46,945][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 04:12:17,223][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 04:12:47,816][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 04:13:17,928][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 04:13:47,868][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 04:14:17,651][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 04:14:48,188][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 04:15:18,135][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 04:15:48,395][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 04:16:18,463][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 04:16:49,297][root][INFO] - Processing question number 40
[2025-02-21 04:16:49,301][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 04:17:19,441][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 04:17:49,574][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 04:18:20,169][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 04:18:50,753][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 04:19:20,621][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 04:19:50,727][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 04:20:22,157][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 04:20:51,370][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 04:21:21,357][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 04:21:52,004][root][INFO] - Processing question number 50
[2025-02-21 04:21:52,007][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 04:22:22,903][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 04:22:53,086][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 04:23:22,565][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 04:23:53,688][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 04:24:23,871][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 04:24:53,099][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 04:25:23,942][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 04:25:53,554][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 04:26:24,185][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 04:26:55,645][root][INFO] - Processing question number 60
[2025-02-21 04:26:55,649][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 04:27:25,251][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 04:27:55,185][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 04:28:25,738][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 04:28:55,337][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 04:29:25,376][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 04:29:55,506][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 04:30:25,660][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 04:30:56,114][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 04:31:26,324][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 04:31:57,058][root][INFO] - Processing question number 70
[2025-02-21 04:31:57,065][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 04:32:27,007][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 04:32:56,936][root][INFO] - Domain : Property, Question : 6
[2025-02-21 04:33:26,726][root][INFO] - Domain : Property, Question : 13
[2025-02-21 04:33:57,156][root][INFO] - Domain : Property, Question : 20
[2025-02-21 04:34:27,533][root][INFO] - Domain : Property, Question : 33
[2025-02-21 04:34:57,239][root][INFO] - Domain : Property, Question : 39
[2025-02-21 04:35:27,697][root][INFO] - Domain : Property, Question : 48
[2025-02-21 04:35:57,986][root][INFO] - Domain : Property, Question : 54
[2025-02-21 04:36:28,524][root][INFO] - Domain : Property, Question : 61
[2025-02-21 04:36:58,411][root][INFO] - Processing question number 80
[2025-02-21 04:36:58,417][root][INFO] - Domain : Property, Question : 67
[2025-02-21 04:37:28,766][root][INFO] - Domain : Property, Question : 75
[2025-02-21 04:37:59,098][root][INFO] - Domain : Property, Question : 83
[2025-02-21 04:38:28,904][root][INFO] - Domain : Property, Question : 89
[2025-02-21 04:38:58,731][root][INFO] - Domain : Property, Question : 97
[2025-02-21 04:39:29,343][root][INFO] - Domain : Property, Question : 100
[2025-02-21 04:39:59,778][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 04:40:30,227][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 04:41:00,039][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 04:41:30,287][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 04:41:59,855][root][INFO] - Processing question number 90
[2025-02-21 04:41:59,860][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 04:42:30,888][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 04:42:59,939][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 04:43:29,913][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 04:44:03,244][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 04:44:33,679][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 04:45:03,190][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 04:45:33,086][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 04:46:03,243][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 04:46:33,904][root][INFO] - Inference complete
[2025-02-21 04:46:33,904][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,911][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,928][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,933][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,933][root][INFO] - Saved parsed outputs
[2025-02-21 04:46:33,933][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,935][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,935][root][INFO] - Saved parsing metadata
[2025-02-21 04:46:33,935][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,938][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:46:33,949][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 04:46:33,997][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 04:46:33,997][root][INFO] - Summary of metrics : {'label_accuracy': 0.40404040404040403, 'misclassification_rate': 0.595959595959596, 'combined_accuracy': 0.31313131313131315, 'malformed_label': 0, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 40, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.5714285714285714, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.12121212121212122, 'Contracts_confidence': 0.1919191919191919, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 9, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 04:46:46,331][root][INFO] - Setting global seed to 989
[2025-02-21 04:46:46,339][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 04:46:46,339][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 04:46:46,341][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 04:46:46,344][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 04:46:46,349][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 04:46:46,350][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 04:46:46,502][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 04:46:46,757][root][INFO] - Full model selected, loading model
[2025-02-21 04:47:10,904][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 04:47:10,905][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 04:47:19,158][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 04:47:19,160][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 04:47:19,160][root][INFO] - Starting inference
[2025-02-21 04:47:19,377][root][INFO] - Processing question number 0
[2025-02-21 04:47:19,385][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 04:47:48,861][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 04:48:19,108][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 04:48:48,853][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 04:49:19,209][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 04:49:48,922][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 04:50:18,584][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 04:50:49,040][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 04:51:19,011][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 04:51:48,622][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 04:52:18,900][root][INFO] - Processing question number 10
[2025-02-21 04:52:18,902][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 04:52:50,485][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 04:53:19,824][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 04:53:49,762][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 04:54:20,251][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 04:54:50,705][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 04:55:20,207][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 04:55:49,559][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 04:56:19,417][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 04:56:49,201][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 04:57:18,806][root][INFO] - Processing question number 20
[2025-02-21 04:57:18,808][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 04:57:48,619][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 04:58:18,650][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 04:58:48,112][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 04:59:17,428][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 04:59:47,570][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:00:17,475][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:00:48,074][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:01:17,882][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:01:47,864][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:02:17,108][root][INFO] - Processing question number 30
[2025-02-21 05:02:17,114][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:02:47,281][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:03:17,750][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 05:03:47,749][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 05:04:17,465][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 05:04:47,137][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 05:05:17,538][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 05:05:47,274][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 05:06:17,422][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:06:47,358][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 05:07:18,025][root][INFO] - Processing question number 40
[2025-02-21 05:07:18,029][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:07:48,053][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 05:08:18,046][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 05:08:48,498][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 05:09:18,903][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 05:09:48,592][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 05:10:18,548][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 05:10:49,824][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 05:11:18,895][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 05:11:48,670][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 05:12:19,179][root][INFO] - Processing question number 50
[2025-02-21 05:12:19,182][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 05:12:49,867][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 05:13:19,954][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 05:13:49,190][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 05:14:20,221][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 05:14:50,285][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 05:15:19,386][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 05:15:49,997][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 05:16:19,498][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 05:16:49,997][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 05:17:21,336][root][INFO] - Processing question number 60
[2025-02-21 05:17:21,341][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 05:17:50,809][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 05:18:20,598][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 05:18:51,054][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 05:19:20,461][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 05:19:50,404][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 05:20:20,401][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 05:20:50,429][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 05:21:20,748][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 05:21:50,834][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 05:22:21,417][root][INFO] - Processing question number 70
[2025-02-21 05:22:21,422][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 05:22:51,195][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 05:23:20,947][root][INFO] - Domain : Property, Question : 6
[2025-02-21 05:23:50,619][root][INFO] - Domain : Property, Question : 13
[2025-02-21 05:24:20,882][root][INFO] - Domain : Property, Question : 20
[2025-02-21 05:24:51,085][root][INFO] - Domain : Property, Question : 33
[2025-02-21 05:25:20,624][root][INFO] - Domain : Property, Question : 39
[2025-02-21 05:25:50,971][root][INFO] - Domain : Property, Question : 48
[2025-02-21 05:26:21,159][root][INFO] - Domain : Property, Question : 54
[2025-02-21 05:26:51,462][root][INFO] - Domain : Property, Question : 61
[2025-02-21 05:27:21,230][root][INFO] - Processing question number 80
[2025-02-21 05:27:21,234][root][INFO] - Domain : Property, Question : 67
[2025-02-21 05:27:51,408][root][INFO] - Domain : Property, Question : 75
[2025-02-21 05:28:21,581][root][INFO] - Domain : Property, Question : 83
[2025-02-21 05:28:51,255][root][INFO] - Domain : Property, Question : 89
[2025-02-21 05:29:20,960][root][INFO] - Domain : Property, Question : 97
[2025-02-21 05:29:51,469][root][INFO] - Domain : Property, Question : 100
[2025-02-21 05:30:21,747][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 05:30:52,104][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 05:31:21,784][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 05:31:51,901][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 05:32:21,360][root][INFO] - Processing question number 90
[2025-02-21 05:32:21,366][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 05:32:52,225][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 05:33:21,153][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 05:33:50,972][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 05:34:20,023][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 05:34:50,393][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 05:35:19,856][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 05:35:49,594][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 05:36:19,626][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 05:36:50,123][root][INFO] - Inference complete
[2025-02-21 05:36:50,123][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,131][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,148][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,153][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,153][root][INFO] - Saved parsed outputs
[2025-02-21 05:36:50,153][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,162][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,162][root][INFO] - Saved parsing metadata
[2025-02-21 05:36:50,164][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,167][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:36:50,169][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 05:36:50,189][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 05:36:50,189][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 0, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.20202020202020202, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.050505050505050504, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 9, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 05:36:59,062][root][INFO] - Setting global seed to 989
[2025-02-21 05:36:59,069][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 05:36:59,070][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 05:36:59,071][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 05:36:59,073][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 05:36:59,075][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 05:36:59,075][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 05:36:59,259][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 05:36:59,556][root][INFO] - Full model selected, loading model
[2025-02-21 05:37:17,642][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 05:38:20,506][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 05:38:20,542][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 05:39:09,425][root][INFO] - Peft model loaded successfully
[2025-02-21 05:39:15,688][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 05:39:15,691][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 05:39:15,691][root][INFO] - Starting inference
[2025-02-21 05:39:15,993][root][INFO] - Processing question number 0
[2025-02-21 05:39:15,996][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 05:39:46,183][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 05:40:16,691][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 05:40:46,755][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 05:41:17,253][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 05:41:47,222][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 05:42:17,125][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 05:42:47,806][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 05:43:18,031][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 05:43:47,901][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 05:44:18,561][root][INFO] - Processing question number 10
[2025-02-21 05:44:18,563][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 05:44:50,455][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 05:45:20,125][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 05:45:50,337][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 05:46:21,068][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 05:46:51,770][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 05:47:21,486][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 05:47:51,134][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 05:48:21,272][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 05:48:51,446][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 05:49:21,288][root][INFO] - Processing question number 20
[2025-02-21 05:49:21,290][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 05:49:51,379][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 05:50:21,649][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 05:50:51,382][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 05:51:21,053][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 05:51:51,434][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 05:52:21,608][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 05:52:52,550][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 05:53:22,643][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 05:53:52,888][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 05:54:22,395][root][INFO] - Processing question number 30
[2025-02-21 05:54:22,398][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 05:54:52,819][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 05:55:23,547][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 05:55:53,794][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 05:56:23,938][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 05:56:53,843][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 05:57:24,475][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 05:57:54,522][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 05:58:24,948][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 05:58:55,172][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 05:59:26,124][root][INFO] - Processing question number 40
[2025-02-21 05:59:26,128][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 05:59:56,424][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:00:26,721][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:00:57,390][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:01:28,079][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:01:58,031][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:02:28,270][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:02:59,803][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:03:29,112][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 06:03:59,245][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 06:04:30,037][root][INFO] - Processing question number 50
[2025-02-21 06:04:30,040][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:05:00,987][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 06:05:31,332][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 06:06:00,942][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 06:06:32,218][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 06:07:02,515][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:07:31,847][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 06:08:02,834][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 06:08:32,568][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 06:09:03,367][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 06:09:34,969][root][INFO] - Processing question number 60
[2025-02-21 06:09:34,974][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 06:10:04,711][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 06:10:34,808][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 06:11:05,473][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 06:11:35,205][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 06:12:05,425][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 06:12:35,664][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 06:13:05,950][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 06:13:36,541][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 06:14:06,909][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 06:14:37,752][root][INFO] - Processing question number 70
[2025-02-21 06:14:37,756][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 06:15:07,823][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 06:15:37,942][root][INFO] - Domain : Property, Question : 6
[2025-02-21 06:16:07,838][root][INFO] - Domain : Property, Question : 13
[2025-02-21 06:16:38,389][root][INFO] - Domain : Property, Question : 20
[2025-02-21 06:17:08,906][root][INFO] - Domain : Property, Question : 33
[2025-02-21 06:17:38,726][root][INFO] - Domain : Property, Question : 39
[2025-02-21 06:18:09,322][root][INFO] - Domain : Property, Question : 48
[2025-02-21 06:18:39,747][root][INFO] - Domain : Property, Question : 54
[2025-02-21 06:19:10,396][root][INFO] - Domain : Property, Question : 61
[2025-02-21 06:19:40,410][root][INFO] - Processing question number 80
[2025-02-21 06:19:40,414][root][INFO] - Domain : Property, Question : 67
[2025-02-21 06:20:10,909][root][INFO] - Domain : Property, Question : 75
[2025-02-21 06:20:41,395][root][INFO] - Domain : Property, Question : 83
[2025-02-21 06:21:11,346][root][INFO] - Domain : Property, Question : 89
[2025-02-21 06:21:41,327][root][INFO] - Domain : Property, Question : 97
[2025-02-21 06:22:12,051][root][INFO] - Domain : Property, Question : 100
[2025-02-21 06:22:42,662][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 06:23:13,315][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 06:23:43,232][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 06:24:13,621][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 06:24:43,334][root][INFO] - Processing question number 90
[2025-02-21 06:24:43,339][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 06:25:14,489][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 06:25:43,683][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 06:26:13,789][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 06:26:43,171][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 06:27:13,767][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 06:27:43,476][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 06:28:13,509][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 06:28:43,817][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 06:29:14,592][root][INFO] - Inference complete
[2025-02-21 06:29:14,592][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,600][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,619][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,625][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,625][root][INFO] - Saved parsed outputs
[2025-02-21 06:29:14,625][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,631][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,631][root][INFO] - Saved parsing metadata
[2025-02-21 06:29:14,633][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,636][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:14,638][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 06:29:14,760][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 06:29:14,761][root][INFO] - Summary of metrics : {'label_accuracy': 0.36363636363636365, 'misclassification_rate': 0.6363636363636364, 'combined_accuracy': 0.2727272727272727, 'malformed_label': 0, 'malformed_domain': 27, 'total_predictions': 99, 'correct_predictions': 36, 'correct_label_and_domain': 27, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.375, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.21212121212121213, 'Criminal_Law_confidence': 0.20202020202020202, 'Evidence_confidence': 0.0707070707070707, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.15151515151515152, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 45, 'correct_label_wrong_domain': 9, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 06:29:24,911][root][INFO] - Setting global seed to 989
[2025-02-21 06:29:24,939][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 06:29:24,939][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 06:29:24,941][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 06:29:24,943][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 06:29:24,945][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 06:29:24,945][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 06:29:25,096][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 06:29:25,348][root][INFO] - Full model selected, loading model
[2025-02-21 06:29:43,614][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 06:29:43,615][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 06:29:50,564][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 06:29:50,566][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 06:29:50,566][root][INFO] - Starting inference
[2025-02-21 06:29:50,788][root][INFO] - Processing question number 0
[2025-02-21 06:29:50,799][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 06:30:20,552][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 06:30:50,930][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 06:31:20,923][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 06:31:51,353][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 06:32:21,248][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 06:32:51,092][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 06:33:21,713][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 06:33:51,913][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 06:34:21,737][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 06:34:52,163][root][INFO] - Processing question number 10
[2025-02-21 06:34:52,165][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 06:35:23,980][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 06:35:53,523][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 06:36:23,650][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 06:36:54,332][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 06:37:25,013][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 06:37:54,740][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 06:38:24,276][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 06:38:54,318][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 06:39:24,361][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 06:39:54,177][root][INFO] - Processing question number 20
[2025-02-21 06:39:54,179][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 06:40:24,167][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 06:40:54,397][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 06:41:24,108][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 06:41:53,610][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 06:42:23,898][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 06:42:53,996][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 06:43:24,832][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 06:43:54,816][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 06:44:24,994][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 06:44:54,474][root][INFO] - Processing question number 30
[2025-02-21 06:44:54,478][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 06:45:24,803][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 06:45:55,468][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 06:46:25,618][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 06:46:55,588][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 06:47:25,435][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 06:47:56,025][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 06:48:25,987][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 06:48:56,328][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 06:49:26,471][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 06:49:57,308][root][INFO] - Processing question number 40
[2025-02-21 06:49:57,311][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 06:50:27,522][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 06:50:57,707][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 06:51:28,358][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 06:51:58,998][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 06:52:28,891][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 06:52:59,040][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 06:53:30,503][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 06:53:59,756][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 06:54:29,777][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 06:55:00,464][root][INFO] - Processing question number 50
[2025-02-21 06:55:00,468][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 06:55:31,346][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 06:56:01,669][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 06:56:31,096][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 06:57:02,301][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 06:57:32,558][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 06:58:01,841][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 06:58:32,671][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 06:59:02,370][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 06:59:33,091][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:00:04,607][root][INFO] - Processing question number 60
[2025-02-21 07:00:04,611][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:00:34,272][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:01:04,258][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:01:34,877][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:02:04,509][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:02:34,650][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:03:04,887][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:03:35,067][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 07:04:05,592][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:04:35,886][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 07:05:06,674][root][INFO] - Processing question number 70
[2025-02-21 07:05:06,679][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 07:05:36,602][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 07:06:06,588][root][INFO] - Domain : Property, Question : 6
[2025-02-21 07:06:36,483][root][INFO] - Domain : Property, Question : 13
[2025-02-21 07:07:06,915][root][INFO] - Domain : Property, Question : 20
[2025-02-21 07:07:37,324][root][INFO] - Domain : Property, Question : 33
[2025-02-21 07:08:07,076][root][INFO] - Domain : Property, Question : 39
[2025-02-21 07:08:37,605][root][INFO] - Domain : Property, Question : 48
[2025-02-21 07:09:07,981][root][INFO] - Domain : Property, Question : 54
[2025-02-21 07:09:38,577][root][INFO] - Domain : Property, Question : 61
[2025-02-21 07:10:08,494][root][INFO] - Processing question number 80
[2025-02-21 07:10:08,498][root][INFO] - Domain : Property, Question : 67
[2025-02-21 07:10:38,883][root][INFO] - Domain : Property, Question : 75
[2025-02-21 07:11:09,247][root][INFO] - Domain : Property, Question : 83
[2025-02-21 07:11:39,122][root][INFO] - Domain : Property, Question : 89
[2025-02-21 07:12:09,032][root][INFO] - Domain : Property, Question : 97
[2025-02-21 07:12:39,730][root][INFO] - Domain : Property, Question : 100
[2025-02-21 07:13:10,226][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 07:13:40,761][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 07:14:10,643][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 07:14:40,958][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 07:15:10,610][root][INFO] - Processing question number 90
[2025-02-21 07:15:10,615][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 07:15:41,689][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 07:16:10,828][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 07:16:40,839][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 07:17:10,148][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 07:17:40,692][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 07:18:10,330][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 07:18:40,251][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 07:19:10,490][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 07:19:41,173][root][INFO] - Inference complete
[2025-02-21 07:19:41,173][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,181][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,200][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,210][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,210][root][INFO] - Saved parsed outputs
[2025-02-21 07:19:41,210][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,212][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,212][root][INFO] - Saved parsing metadata
[2025-02-21 07:19:41,213][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,214][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:19:41,222][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 07:19:41,239][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 07:19:41,239][root][INFO] - Summary of metrics : {'label_accuracy': 0.42424242424242425, 'misclassification_rate': 0.5757575757575757, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 99, 'correct_predictions': 42, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.5, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.21428571428571427, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.4375, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.18181818181818182, 'Criminal_Law_confidence': 0.1919191919191919, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 10, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 07:19:47,735][root][INFO] - Setting global seed to 989
[2025-02-21 07:19:47,742][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-02-21 07:19:47,743][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 07:19:47,744][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 07:19:47,746][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 07:19:47,748][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 07:19:47,748][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 07:19:47,930][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 07:19:48,406][root][INFO] - Full model selected, loading model
[2025-02-21 07:20:06,706][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 07:21:07,697][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 07:21:07,698][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 07:21:39,046][root][INFO] - Peft model loaded successfully
[2025-02-21 07:21:45,062][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 07:21:45,064][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 07:21:45,064][root][INFO] - Starting inference
[2025-02-21 07:21:45,307][root][INFO] - Processing question number 0
[2025-02-21 07:21:45,313][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 07:22:15,354][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 07:22:45,874][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 07:23:15,947][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 07:23:46,494][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 07:24:16,484][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 07:24:46,393][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 07:25:17,094][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 07:25:47,331][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 07:26:17,208][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 07:26:47,777][root][INFO] - Processing question number 10
[2025-02-21 07:26:47,780][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 07:27:19,672][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 07:27:49,362][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 07:28:19,599][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 07:28:50,326][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 07:29:21,061][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 07:29:50,816][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 07:30:20,504][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 07:30:50,645][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 07:31:20,797][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 07:31:50,694][root][INFO] - Processing question number 20
[2025-02-21 07:31:50,698][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 07:32:20,771][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 07:32:51,102][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 07:33:20,994][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 07:33:50,706][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 07:34:21,093][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 07:34:51,264][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 07:35:22,285][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 07:35:52,453][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 07:36:22,664][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 07:36:52,198][root][INFO] - Processing question number 30
[2025-02-21 07:36:52,202][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 07:37:22,656][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 07:37:53,396][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 07:38:23,636][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 07:38:53,735][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 07:39:23,727][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 07:39:54,365][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 07:40:24,418][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 07:40:54,839][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 07:41:25,085][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 07:41:56,040][root][INFO] - Processing question number 40
[2025-02-21 07:41:56,044][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 07:42:26,329][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 07:42:56,643][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 07:43:27,381][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 07:43:58,073][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 07:44:28,015][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 07:44:58,265][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 07:45:29,812][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 07:45:59,126][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 07:46:29,274][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 07:47:00,072][root][INFO] - Processing question number 50
[2025-02-21 07:47:00,077][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 07:47:31,065][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 07:48:01,392][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 07:48:31,012][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 07:49:02,299][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 07:49:32,610][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 07:50:01,960][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 07:50:32,965][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 07:51:02,699][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 07:51:33,460][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 07:52:05,069][root][INFO] - Processing question number 60
[2025-02-21 07:52:05,073][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 07:52:34,823][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 07:53:04,902][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 07:53:35,594][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 07:54:05,353][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 07:54:35,527][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 07:55:05,791][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 07:55:36,079][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 07:56:06,683][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 07:56:37,041][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 07:57:07,899][root][INFO] - Processing question number 70
[2025-02-21 07:57:07,903][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 07:57:37,991][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 07:58:08,101][root][INFO] - Domain : Property, Question : 6
[2025-02-21 07:58:38,030][root][INFO] - Domain : Property, Question : 13
[2025-02-21 07:59:08,586][root][INFO] - Domain : Property, Question : 20
[2025-02-21 07:59:39,109][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:00:08,944][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:00:39,557][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:01:09,985][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:01:40,645][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:02:10,675][root][INFO] - Processing question number 80
[2025-02-21 08:02:10,680][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:02:41,172][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:03:11,655][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:03:41,613][root][INFO] - Domain : Property, Question : 89
[2025-02-21 08:04:11,577][root][INFO] - Domain : Property, Question : 97
[2025-02-21 08:04:42,339][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:05:12,932][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 08:05:43,551][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:06:13,510][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 08:06:43,897][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 08:07:13,617][root][INFO] - Processing question number 90
[2025-02-21 08:07:13,623][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 08:07:44,783][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 08:08:13,995][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 08:08:44,122][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 08:09:13,504][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 08:09:44,126][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 08:10:13,844][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 08:10:43,888][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 08:11:14,202][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 08:11:44,965][root][INFO] - Inference complete
[2025-02-21 08:11:44,965][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:44,972][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:44,975][root][WARNING] - No match found for 3. Explanation in question number 2 in domain Constitutional_law
[2025-02-21 08:11:44,988][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:44,993][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:44,993][root][INFO] - Saved parsed outputs
[2025-02-21 08:11:44,993][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:44,995][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:44,995][root][INFO] - Saved parsing metadata
[2025-02-21 08:11:44,996][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:44,998][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:11:45,010][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 08:11:45,029][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 08:11:45,030][root][INFO] - Summary of metrics : {'label_accuracy': 0.26262626262626265, 'misclassification_rate': 0.7373737373737373, 'combined_accuracy': 0.16161616161616163, 'malformed_label': 2, 'malformed_domain': 37, 'total_predictions': 99, 'correct_predictions': 26, 'correct_label_and_domain': 16, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.14285714285714285, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.1717171717171717, 'Criminal_Law_confidence': 0.21212121212121213, 'Evidence_confidence': 0.06060606060606061, 'Real_Property_confidence': 0.06060606060606061, 'Torts_confidence': 0.1414141414141414, 'Civil_Procedure_confidence': 0.0707070707070707, 'correct_domain_wrong_label': 46, 'correct_label_wrong_domain': 10, 'both_wrong': 27}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 08:11:53,091][root][INFO] - Setting global seed to 989
[2025-02-21 08:11:53,098][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-02-21 08:11:53,099][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 08:11:53,100][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-02-21 08:11:53,102][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 08:11:53,104][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 08:11:53,104][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-02-21 08:11:53,249][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 08:11:53,505][root][INFO] - Full model selected, loading model
[2025-02-21 08:12:11,908][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 08:12:11,908][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 08:12:18,792][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 08:12:18,794][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 08:12:18,794][root][INFO] - Starting inference
[2025-02-21 08:12:19,006][root][INFO] - Processing question number 0
[2025-02-21 08:12:19,015][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-02-21 08:12:48,799][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-02-21 08:13:19,158][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-02-21 08:13:49,105][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-02-21 08:14:19,521][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-02-21 08:14:49,389][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-02-21 08:15:19,205][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-02-21 08:15:49,815][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-02-21 08:16:19,988][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-02-21 08:16:49,736][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-02-21 08:17:20,170][root][INFO] - Processing question number 10
[2025-02-21 08:17:20,172][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-02-21 08:17:51,939][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-02-21 08:18:21,455][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-02-21 08:18:51,551][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-02-21 08:19:22,195][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-02-21 08:19:52,859][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-02-21 08:20:22,544][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-02-21 08:20:52,021][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-02-21 08:21:22,043][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-02-21 08:21:52,042][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-02-21 08:22:21,837][root][INFO] - Processing question number 20
[2025-02-21 08:22:21,839][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-02-21 08:22:51,794][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-02-21 08:23:21,997][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-02-21 08:23:51,690][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-02-21 08:24:21,175][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-02-21 08:24:51,449][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-02-21 08:25:21,523][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-02-21 08:25:52,334][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-02-21 08:26:22,310][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-02-21 08:26:52,487][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-02-21 08:27:21,976][root][INFO] - Processing question number 30
[2025-02-21 08:27:21,979][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 08:27:52,326][root][INFO] - Domain : Contracts, Question : 8
[2025-02-21 08:28:22,987][root][INFO] - Domain : Contracts, Question : 16
[2025-02-21 08:28:53,150][root][INFO] - Domain : Contracts, Question : 22
[2025-02-21 08:29:23,101][root][INFO] - Domain : Contracts, Question : 27
[2025-02-21 08:29:52,964][root][INFO] - Domain : Contracts, Question : 38
[2025-02-21 08:30:23,595][root][INFO] - Domain : Contracts, Question : 46
[2025-02-21 08:30:53,482][root][INFO] - Domain : Contracts, Question : 51
[2025-02-21 08:31:23,802][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 08:31:53,938][root][INFO] - Domain : Contracts, Question : 66
[2025-02-21 08:32:24,758][root][INFO] - Processing question number 40
[2025-02-21 08:32:24,761][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 08:32:54,940][root][INFO] - Domain : Contracts, Question : 81
[2025-02-21 08:33:25,117][root][INFO] - Domain : Contracts, Question : 88
[2025-02-21 08:33:55,792][root][INFO] - Domain : Contracts, Question : 94
[2025-02-21 08:34:26,326][root][INFO] - Domain : Torts, Question : 4
[2025-02-21 08:34:56,194][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 08:35:27,456][root][INFO] - Domain : Torts, Question : 24
[2025-02-21 08:35:58,925][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 08:36:28,137][root][INFO] - Domain : Torts, Question : 41
[2025-02-21 08:36:58,127][root][INFO] - Domain : Torts, Question : 47
[2025-02-21 08:37:28,827][root][INFO] - Processing question number 50
[2025-02-21 08:37:28,833][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 08:37:59,651][root][INFO] - Domain : Torts, Question : 62
[2025-02-21 08:38:29,893][root][INFO] - Domain : Torts, Question : 76
[2025-02-21 08:38:59,327][root][INFO] - Domain : Torts, Question : 82
[2025-02-21 08:39:30,525][root][INFO] - Domain : Torts, Question : 90
[2025-02-21 08:40:00,728][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 08:40:29,974][root][INFO] - Domain : Torts, Question : 99
[2025-02-21 08:41:00,817][root][INFO] - Domain : Evidence, Question : 5
[2025-02-21 08:41:30,492][root][INFO] - Domain : Evidence, Question : 12
[2025-02-21 08:42:01,141][root][INFO] - Domain : Evidence, Question : 18
[2025-02-21 08:42:32,655][root][INFO] - Processing question number 60
[2025-02-21 08:42:32,659][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 08:43:02,310][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 08:43:32,265][root][INFO] - Domain : Evidence, Question : 34
[2025-02-21 08:44:02,832][root][INFO] - Domain : Evidence, Question : 40
[2025-02-21 08:44:32,466][root][INFO] - Domain : Evidence, Question : 44
[2025-02-21 08:45:02,616][root][INFO] - Domain : Evidence, Question : 53
[2025-02-21 08:45:32,762][root][INFO] - Domain : Evidence, Question : 59
[2025-02-21 08:46:02,932][root][INFO] - Domain : Evidence, Question : 68
[2025-02-21 08:46:33,434][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 08:47:03,704][root][INFO] - Domain : Evidence, Question : 78
[2025-02-21 08:47:34,449][root][INFO] - Processing question number 70
[2025-02-21 08:47:34,453][root][INFO] - Domain : Evidence, Question : 86
[2025-02-21 08:48:04,373][root][INFO] - Domain : Evidence, Question : 96
[2025-02-21 08:48:34,359][root][INFO] - Domain : Property, Question : 6
[2025-02-21 08:49:04,165][root][INFO] - Domain : Property, Question : 13
[2025-02-21 08:49:34,594][root][INFO] - Domain : Property, Question : 20
[2025-02-21 08:50:04,968][root][INFO] - Domain : Property, Question : 33
[2025-02-21 08:50:34,702][root][INFO] - Domain : Property, Question : 39
[2025-02-21 08:51:05,211][root][INFO] - Domain : Property, Question : 48
[2025-02-21 08:51:35,543][root][INFO] - Domain : Property, Question : 54
[2025-02-21 08:52:06,113][root][INFO] - Domain : Property, Question : 61
[2025-02-21 08:52:36,050][root][INFO] - Processing question number 80
[2025-02-21 08:52:36,055][root][INFO] - Domain : Property, Question : 67
[2025-02-21 08:53:06,429][root][INFO] - Domain : Property, Question : 75
[2025-02-21 08:53:36,759][root][INFO] - Domain : Property, Question : 83
[2025-02-21 08:54:06,620][root][INFO] - Domain : Property, Question : 89
[2025-02-21 08:54:36,504][root][INFO] - Domain : Property, Question : 97
[2025-02-21 08:55:07,152][root][INFO] - Domain : Property, Question : 100
[2025-02-21 08:55:37,617][root][INFO] - Domain : Criminal_law, Question : 10
[2025-02-21 08:56:08,161][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 08:56:37,990][root][INFO] - Domain : Criminal_law, Question : 26
[2025-02-21 08:57:08,285][root][INFO] - Domain : Criminal_law, Question : 30
[2025-02-21 08:57:37,922][root][INFO] - Processing question number 90
[2025-02-21 08:57:37,928][root][INFO] - Domain : Criminal_law, Question : 36
[2025-02-21 08:58:08,991][root][INFO] - Domain : Criminal_law, Question : 45
[2025-02-21 08:58:38,083][root][INFO] - Domain : Criminal_law, Question : 50
[2025-02-21 08:59:08,073][root][INFO] - Domain : Criminal_law, Question : 57
[2025-02-21 08:59:37,400][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:00:07,914][root][INFO] - Domain : Criminal_law, Question : 74
[2025-02-21 09:00:37,520][root][INFO] - Domain : Criminal_law, Question : 80
[2025-02-21 09:01:07,433][root][INFO] - Domain : Criminal_law, Question : 85
[2025-02-21 09:01:37,658][root][INFO] - Domain : Criminal_law, Question : 92
[2025-02-21 09:02:08,317][root][INFO] - Inference complete
[2025-02-21 09:02:08,317][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,325][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,344][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,363][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,363][root][INFO] - Saved parsed outputs
[2025-02-21 09:02:08,363][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,372][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,372][root][INFO] - Saved parsing metadata
[2025-02-21 09:02:08,373][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,375][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
[2025-02-21 09:02:08,384][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-02-21 09:02:08,401][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_1
[2025-02-21 09:02:08,401][root][INFO] - Summary of metrics : {'label_accuracy': 0.3434343434343434, 'misclassification_rate': 0.6565656565656566, 'combined_accuracy': 0.2222222222222222, 'malformed_label': 1, 'malformed_domain': 35, 'total_predictions': 99, 'correct_predictions': 34, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.46153846153846156, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.3125, 'Constitutional_Law_confidence': 0.10101010101010101, 'Contracts_confidence': 0.1414141414141414, 'Criminal_Law_confidence': 0.16161616161616163, 'Evidence_confidence': 0.10101010101010101, 'Real_Property_confidence': 0.0707070707070707, 'Torts_confidence': 0.12121212121212122, 'Civil_Procedure_confidence': 0.09090909090909091, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 12, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 09:02:15,961][root][INFO] - Setting global seed to 206
[2025-02-21 09:02:15,969][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 09:02:15,969][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 09:02:15,970][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 09:02:15,972][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:02:15,974][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:02:15,974][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 09:02:16,115][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:02:16,363][root][INFO] - Full model selected, loading model
[2025-02-21 09:02:32,797][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 09:03:35,316][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 09:03:35,433][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 09:03:59,904][root][INFO] - Peft model loaded successfully
[2025-02-21 09:04:05,926][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:04:05,928][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:04:05,928][root][INFO] - Starting inference
[2025-02-21 09:04:06,159][root][INFO] - Processing question number 0
[2025-02-21 09:04:06,164][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 09:04:36,627][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 09:05:07,442][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 09:05:38,390][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 09:06:08,817][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 09:06:38,690][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 09:07:07,993][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 09:07:37,770][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 09:08:07,835][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 09:08:37,193][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 09:09:07,199][root][INFO] - Processing question number 10
[2025-02-21 09:09:07,201][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 09:09:36,393][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 09:10:06,190][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 09:10:36,141][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 09:11:05,555][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 09:11:35,925][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 09:12:05,900][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 09:12:35,825][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 09:13:05,593][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 09:13:35,944][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 09:14:06,387][root][INFO] - Processing question number 20
[2025-02-21 09:14:06,390][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 09:14:35,578][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 09:15:05,691][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 09:15:35,319][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 09:16:05,118][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 09:16:35,003][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 09:17:05,418][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 09:17:35,390][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 09:18:05,517][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 09:18:35,460][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 09:19:05,987][root][INFO] - Processing question number 30
[2025-02-21 09:19:05,989][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 09:19:35,995][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 09:20:05,814][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 09:20:35,572][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 09:21:06,067][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 09:21:36,042][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 09:22:06,124][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 09:22:36,115][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 09:23:06,733][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 09:23:36,886][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 09:24:07,040][root][INFO] - Processing question number 40
[2025-02-21 09:24:07,043][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 09:24:37,167][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 09:25:07,122][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 09:25:37,495][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 09:26:06,741][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 09:26:37,337][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 09:27:07,429][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 09:27:37,354][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 09:28:07,473][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 09:28:37,505][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 09:29:07,849][root][INFO] - Processing question number 50
[2025-02-21 09:29:07,852][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 09:29:38,442][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 09:30:08,008][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 09:30:38,611][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 09:31:08,840][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 09:31:38,430][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 09:32:08,333][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 09:32:39,130][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 09:33:09,594][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 09:33:40,075][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 09:34:10,378][root][INFO] - Processing question number 60
[2025-02-21 09:34:10,382][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 09:34:40,438][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 09:35:10,540][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 09:35:41,372][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 09:36:11,763][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 09:36:41,947][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 09:37:11,667][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 09:37:41,256][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 09:38:10,731][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 09:38:40,431][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 09:39:10,101][root][INFO] - Processing question number 70
[2025-02-21 09:39:10,106][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 09:39:40,379][root][INFO] - Domain : Property, Question : 9
[2025-02-21 09:40:10,453][root][INFO] - Domain : Property, Question : 17
[2025-02-21 09:40:40,811][root][INFO] - Domain : Property, Question : 25
[2025-02-21 09:41:11,650][root][INFO] - Domain : Property, Question : 30
[2025-02-21 09:41:41,298][root][INFO] - Domain : Property, Question : 36
[2025-02-21 09:42:11,600][root][INFO] - Domain : Property, Question : 46
[2025-02-21 09:42:42,939][root][INFO] - Domain : Property, Question : 53
[2025-02-21 09:43:13,289][root][INFO] - Domain : Property, Question : 59
[2025-02-21 09:43:42,525][root][INFO] - Domain : Property, Question : 66
[2025-02-21 09:44:12,244][root][INFO] - Processing question number 80
[2025-02-21 09:44:12,249][root][INFO] - Domain : Property, Question : 69
[2025-02-21 09:44:42,822][root][INFO] - Domain : Property, Question : 81
[2025-02-21 09:45:13,463][root][INFO] - Domain : Property, Question : 88
[2025-02-21 09:45:44,002][root][INFO] - Domain : Property, Question : 91
[2025-02-21 09:46:14,298][root][INFO] - Domain : Property, Question : 94
[2025-02-21 09:46:45,600][root][INFO] - Domain : Property, Question : 100
[2025-02-21 09:47:15,501][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 09:47:45,961][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 09:48:16,934][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 09:48:47,005][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 09:49:17,020][root][INFO] - Processing question number 90
[2025-02-21 09:49:17,025][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 09:49:47,038][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 09:50:17,403][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 09:50:47,605][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 09:51:17,551][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 09:51:48,192][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 09:52:18,654][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 09:52:48,858][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 09:53:18,618][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 09:53:47,954][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 09:54:18,461][root][INFO] - Inference complete
[2025-02-21 09:54:18,461][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,470][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,485][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,498][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,498][root][INFO] - Saved parsed outputs
[2025-02-21 09:54:18,498][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,517][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,517][root][INFO] - Saved parsing metadata
[2025-02-21 09:54:18,518][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,520][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:18,530][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 09:54:18,570][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 09:54:18,570][root][INFO] - Summary of metrics : {'label_accuracy': 0.33, 'misclassification_rate': 0.6699999999999999, 'combined_accuracy': 0.26, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 33, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 7, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 09:54:26,212][root][INFO] - Setting global seed to 206
[2025-02-21 09:54:26,220][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 09:54:26,220][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 09:54:26,221][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 09:54:26,223][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 09:54:26,225][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 09:54:26,225][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 09:54:26,403][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 09:54:26,704][root][INFO] - Full model selected, loading model
[2025-02-21 09:54:43,903][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 09:54:43,903][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 09:54:50,260][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 09:54:50,262][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 09:54:50,262][root][INFO] - Starting inference
[2025-02-21 09:54:50,467][root][INFO] - Processing question number 0
[2025-02-21 09:54:50,469][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 09:55:20,665][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 09:55:51,216][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 09:56:21,961][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 09:56:52,203][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 09:57:21,828][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 09:57:50,903][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 09:58:20,483][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 09:58:50,351][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 09:59:19,476][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 09:59:49,262][root][INFO] - Processing question number 10
[2025-02-21 09:59:49,264][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:00:18,243][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:00:47,816][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:01:17,531][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:01:46,673][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:02:16,778][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:02:46,543][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:03:16,209][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:03:45,777][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:04:15,845][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 10:04:46,059][root][INFO] - Processing question number 20
[2025-02-21 10:04:46,062][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 10:05:15,079][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 10:05:44,955][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 10:06:14,410][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 10:06:43,983][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 10:07:13,636][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 10:07:43,914][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 10:08:13,599][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 10:08:43,492][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 10:09:13,179][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 10:09:43,489][root][INFO] - Processing question number 30
[2025-02-21 10:09:43,493][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 10:10:13,265][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 10:10:42,859][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 10:11:12,403][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 10:11:42,676][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 10:12:12,334][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 10:12:42,106][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 10:13:11,792][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 10:13:42,163][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 10:14:12,053][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 10:14:41,972][root][INFO] - Processing question number 40
[2025-02-21 10:14:41,976][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 10:15:11,862][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 10:15:41,522][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 10:16:11,675][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 10:16:40,724][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 10:17:11,115][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 10:17:41,024][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 10:18:10,694][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 10:18:40,583][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 10:19:10,364][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 10:19:40,464][root][INFO] - Processing question number 50
[2025-02-21 10:19:40,468][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 10:20:10,835][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 10:20:40,174][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 10:21:10,546][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 10:21:40,539][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 10:22:09,917][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 10:22:39,516][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 10:23:09,999][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 10:23:40,263][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 10:24:10,525][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 10:24:40,561][root][INFO] - Processing question number 60
[2025-02-21 10:24:40,565][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 10:25:10,387][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 10:25:40,266][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 10:26:10,805][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 10:26:40,889][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 10:27:10,894][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 10:27:40,413][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 10:28:09,766][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 10:28:38,912][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 10:29:08,406][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 10:29:37,839][root][INFO] - Processing question number 70
[2025-02-21 10:29:37,843][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 10:30:07,833][root][INFO] - Domain : Property, Question : 9
[2025-02-21 10:30:37,728][root][INFO] - Domain : Property, Question : 17
[2025-02-21 10:31:07,815][root][INFO] - Domain : Property, Question : 25
[2025-02-21 10:31:38,377][root][INFO] - Domain : Property, Question : 30
[2025-02-21 10:32:07,798][root][INFO] - Domain : Property, Question : 36
[2025-02-21 10:32:37,844][root][INFO] - Domain : Property, Question : 46
[2025-02-21 10:33:08,857][root][INFO] - Domain : Property, Question : 53
[2025-02-21 10:33:38,918][root][INFO] - Domain : Property, Question : 59
[2025-02-21 10:34:07,967][root][INFO] - Domain : Property, Question : 66
[2025-02-21 10:34:37,445][root][INFO] - Processing question number 80
[2025-02-21 10:34:37,450][root][INFO] - Domain : Property, Question : 69
[2025-02-21 10:35:07,814][root][INFO] - Domain : Property, Question : 81
[2025-02-21 10:35:38,216][root][INFO] - Domain : Property, Question : 88
[2025-02-21 10:36:08,538][root][INFO] - Domain : Property, Question : 91
[2025-02-21 10:36:38,574][root][INFO] - Domain : Property, Question : 94
[2025-02-21 10:37:09,542][root][INFO] - Domain : Property, Question : 100
[2025-02-21 10:37:39,173][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 10:38:09,385][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 10:38:40,138][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 10:39:10,036][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 10:39:39,960][root][INFO] - Processing question number 90
[2025-02-21 10:39:39,966][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 10:40:09,886][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 10:40:40,164][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 10:41:10,224][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 10:41:40,066][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 10:42:10,559][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 10:42:40,936][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 10:43:10,998][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 10:43:40,643][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 10:44:09,810][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 10:44:40,205][root][INFO] - Inference complete
[2025-02-21 10:44:40,205][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,213][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,230][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,236][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,236][root][INFO] - Saved parsed outputs
[2025-02-21 10:44:40,236][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,243][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,243][root][INFO] - Saved parsing metadata
[2025-02-21 10:44:40,244][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,246][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:44:40,247][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 10:44:40,263][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 10:44:40,263][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.22, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 53, 'correct_label_wrong_domain': 6, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 10:44:46,972][root][INFO] - Setting global seed to 206
[2025-02-21 10:44:46,979][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 10:44:46,980][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 10:44:46,981][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 10:44:46,983][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 10:44:46,985][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 10:44:46,985][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 10:44:47,125][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 10:44:47,384][root][INFO] - Full model selected, loading model
[2025-02-21 10:45:04,610][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 10:46:03,548][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 10:46:03,549][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 10:46:29,123][root][INFO] - Peft model loaded successfully
[2025-02-21 10:46:35,109][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 10:46:35,111][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 10:46:35,111][root][INFO] - Starting inference
[2025-02-21 10:46:35,326][root][INFO] - Processing question number 0
[2025-02-21 10:46:35,338][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 10:47:05,832][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 10:47:36,700][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 10:48:07,724][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 10:48:38,222][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 10:49:08,153][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 10:49:37,477][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 10:50:07,336][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 10:50:37,481][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 10:51:06,886][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 10:51:36,945][root][INFO] - Processing question number 10
[2025-02-21 10:51:36,946][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 10:52:06,201][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 10:52:36,049][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 10:53:06,040][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 10:53:35,543][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 10:54:05,971][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 10:54:36,019][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 10:55:06,008][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 10:55:35,844][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 10:56:06,234][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 10:56:36,716][root][INFO] - Processing question number 20
[2025-02-21 10:56:36,718][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 10:57:06,006][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 10:57:36,166][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 10:58:05,866][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 10:58:35,711][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 10:59:05,664][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 10:59:36,139][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:00:06,149][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:00:36,331][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:01:06,341][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:01:36,935][root][INFO] - Processing question number 30
[2025-02-21 11:01:36,939][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:02:07,003][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:02:36,872][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:03:06,705][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:03:37,265][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:04:07,248][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 11:04:37,297][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 11:05:07,306][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 11:05:37,960][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 11:06:08,142][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 11:06:38,340][root][INFO] - Processing question number 40
[2025-02-21 11:06:38,343][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 11:07:08,510][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 11:07:38,482][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 11:08:08,957][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 11:08:38,273][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 11:09:08,937][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 11:09:39,083][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 11:10:09,079][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 11:10:39,242][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 11:11:09,318][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 11:11:39,744][root][INFO] - Processing question number 50
[2025-02-21 11:11:39,748][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 11:12:10,479][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 11:12:40,104][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 11:13:10,769][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 11:13:41,054][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 11:14:10,718][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 11:14:40,659][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 11:15:11,493][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 11:15:42,048][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 11:16:12,596][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 11:16:42,970][root][INFO] - Processing question number 60
[2025-02-21 11:16:42,976][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 11:17:13,081][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 11:17:43,252][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 11:18:14,145][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 11:18:44,564][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 11:19:14,849][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 11:19:44,657][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 11:20:14,302][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 11:20:43,824][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 11:21:13,610][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 11:21:43,348][root][INFO] - Processing question number 70
[2025-02-21 11:21:43,357][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 11:22:13,713][root][INFO] - Domain : Property, Question : 9
[2025-02-21 11:22:43,961][root][INFO] - Domain : Property, Question : 17
[2025-02-21 11:23:14,468][root][INFO] - Domain : Property, Question : 25
[2025-02-21 11:23:45,444][root][INFO] - Domain : Property, Question : 30
[2025-02-21 11:24:15,218][root][INFO] - Domain : Property, Question : 36
[2025-02-21 11:24:45,657][root][INFO] - Domain : Property, Question : 46
[2025-02-21 11:25:17,099][root][INFO] - Domain : Property, Question : 53
[2025-02-21 11:25:47,552][root][INFO] - Domain : Property, Question : 59
[2025-02-21 11:26:16,940][root][INFO] - Domain : Property, Question : 66
[2025-02-21 11:26:46,754][root][INFO] - Processing question number 80
[2025-02-21 11:26:46,759][root][INFO] - Domain : Property, Question : 69
[2025-02-21 11:27:17,587][root][INFO] - Domain : Property, Question : 81
[2025-02-21 11:27:48,479][root][INFO] - Domain : Property, Question : 88
[2025-02-21 11:28:19,317][root][INFO] - Domain : Property, Question : 91
[2025-02-21 11:28:49,910][root][INFO] - Domain : Property, Question : 94
[2025-02-21 11:29:21,474][root][INFO] - Domain : Property, Question : 100
[2025-02-21 11:29:51,651][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 11:30:22,378][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 11:30:53,638][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 11:31:24,049][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 11:31:54,475][root][INFO] - Processing question number 90
[2025-02-21 11:31:54,481][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 11:32:24,918][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 11:32:55,702][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 11:33:26,319][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 11:33:56,678][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 11:34:27,730][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 11:34:58,608][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 11:35:29,230][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 11:35:59,423][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 11:36:29,194][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 11:37:00,150][root][INFO] - Inference complete
[2025-02-21 11:37:00,151][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,160][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,176][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,183][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,184][root][INFO] - Saved parsed outputs
[2025-02-21 11:37:00,184][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,186][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,186][root][INFO] - Saved parsing metadata
[2025-02-21 11:37:00,188][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,190][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:00,191][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 11:37:00,198][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 11:37:00,198][root][INFO] - Summary of metrics : {'label_accuracy': 0.29, 'misclassification_rate': 0.71, 'combined_accuracy': 0.25, 'malformed_label': 0, 'malformed_domain': 23, 'total_predictions': 100, 'correct_predictions': 29, 'correct_label_and_domain': 25, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.4666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 52, 'correct_label_wrong_domain': 4, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 11:37:08,368][root][INFO] - Setting global seed to 206
[2025-02-21 11:37:08,382][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 11:37:08,382][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 11:37:08,384][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 11:37:08,388][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 11:37:08,390][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 11:37:08,390][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 11:37:08,547][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 11:37:09,018][root][INFO] - Full model selected, loading model
[2025-02-21 11:37:26,465][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 11:37:26,466][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 11:37:32,784][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 11:37:32,786][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 11:37:32,787][root][INFO] - Starting inference
[2025-02-21 11:37:32,968][root][INFO] - Processing question number 0
[2025-02-21 11:37:32,970][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 11:38:03,605][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 11:38:34,544][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 11:39:05,679][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 11:39:36,308][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 11:40:06,319][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 11:40:35,785][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 11:41:05,761][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 11:41:36,029][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 11:42:05,552][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 11:42:35,739][root][INFO] - Processing question number 10
[2025-02-21 11:42:35,741][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 11:43:05,117][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 11:43:35,081][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 11:44:05,153][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 11:44:34,695][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 11:45:05,197][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 11:45:35,364][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 11:46:05,429][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 11:46:35,387][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 11:47:05,850][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 11:47:36,452][root][INFO] - Processing question number 20
[2025-02-21 11:47:36,455][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 11:48:05,869][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 11:48:36,146][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 11:49:05,964][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 11:49:35,925][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 11:50:05,955][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 11:50:36,566][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 11:51:06,652][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 11:51:36,945][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 11:52:07,040][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 11:52:37,748][root][INFO] - Processing question number 30
[2025-02-21 11:52:37,751][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 11:53:07,924][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 11:53:37,913][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 11:54:07,776][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 11:54:38,320][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 11:55:08,170][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 11:55:38,325][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 11:56:08,407][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 11:56:39,177][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 11:57:09,469][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 11:57:39,785][root][INFO] - Processing question number 40
[2025-02-21 11:57:39,790][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 11:58:10,076][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 11:58:40,134][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 11:59:10,684][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 11:59:40,138][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:00:10,920][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:00:41,188][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:01:11,264][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:01:41,547][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:02:11,728][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:02:42,229][root][INFO] - Processing question number 50
[2025-02-21 12:02:42,233][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:03:13,008][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:03:42,744][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 12:04:13,525][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 12:04:43,927][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 12:05:13,715][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 12:05:43,730][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 12:06:14,628][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 12:06:45,333][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 12:07:16,095][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 12:07:46,567][root][INFO] - Processing question number 60
[2025-02-21 12:07:46,572][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 12:08:16,820][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 12:08:47,139][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 12:09:18,117][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 12:09:48,621][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 12:10:19,040][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 12:10:48,989][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 12:11:18,776][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 12:11:48,360][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 12:12:18,287][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 12:12:48,157][root][INFO] - Processing question number 70
[2025-02-21 12:12:48,162][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 12:13:18,587][root][INFO] - Domain : Property, Question : 9
[2025-02-21 12:13:48,904][root][INFO] - Domain : Property, Question : 17
[2025-02-21 12:14:19,422][root][INFO] - Domain : Property, Question : 25
[2025-02-21 12:14:50,411][root][INFO] - Domain : Property, Question : 30
[2025-02-21 12:15:20,258][root][INFO] - Domain : Property, Question : 36
[2025-02-21 12:15:50,728][root][INFO] - Domain : Property, Question : 46
[2025-02-21 12:16:22,171][root][INFO] - Domain : Property, Question : 53
[2025-02-21 12:16:52,655][root][INFO] - Domain : Property, Question : 59
[2025-02-21 12:17:22,139][root][INFO] - Domain : Property, Question : 66
[2025-02-21 12:17:52,051][root][INFO] - Processing question number 80
[2025-02-21 12:17:52,058][root][INFO] - Domain : Property, Question : 69
[2025-02-21 12:18:22,852][root][INFO] - Domain : Property, Question : 81
[2025-02-21 12:18:53,686][root][INFO] - Domain : Property, Question : 88
[2025-02-21 12:19:24,448][root][INFO] - Domain : Property, Question : 91
[2025-02-21 12:19:54,900][root][INFO] - Domain : Property, Question : 94
[2025-02-21 12:20:26,286][root][INFO] - Domain : Property, Question : 100
[2025-02-21 12:20:56,341][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 12:21:26,980][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 12:21:58,157][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 12:22:28,476][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 12:22:58,739][root][INFO] - Processing question number 90
[2025-02-21 12:22:58,746][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 12:23:28,904][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 12:23:59,489][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 12:24:29,860][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 12:25:00,020][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 12:25:30,815][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 12:26:01,496][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 12:26:31,867][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 12:27:01,816][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 12:27:31,292][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 12:28:01,994][root][INFO] - Inference complete
[2025-02-21 12:28:01,995][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,005][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,023][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,028][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,028][root][INFO] - Saved parsed outputs
[2025-02-21 12:28:02,028][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,030][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,030][root][INFO] - Saved parsing metadata
[2025-02-21 12:28:02,031][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,033][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:28:02,034][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 12:28:02,072][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 12:28:02,072][root][INFO] - Summary of metrics : {'label_accuracy': 0.31, 'misclassification_rate': 0.69, 'combined_accuracy': 0.22, 'malformed_label': 0, 'malformed_domain': 27, 'total_predictions': 100, 'correct_predictions': 31, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.4666666666666667, 'Criminal_Law_accuracy': 0.35714285714285715, 'Evidence_accuracy': 0.2, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 51, 'correct_label_wrong_domain': 9, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 12:28:14,741][root][INFO] - Setting global seed to 206
[2025-02-21 12:28:14,749][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 12:28:14,750][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 12:28:14,751][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 12:28:14,754][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 12:28:14,758][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 12:28:14,758][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 12:28:14,950][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 12:28:16,047][root][INFO] - Full model selected, loading model
[2025-02-21 12:28:32,474][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 12:29:32,163][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 12:29:32,163][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 12:29:57,635][root][INFO] - Peft model loaded successfully
[2025-02-21 12:30:03,636][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 12:30:03,639][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 12:30:03,639][root][INFO] - Starting inference
[2025-02-21 12:30:03,854][root][INFO] - Processing question number 0
[2025-02-21 12:30:03,857][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 12:30:34,407][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 12:31:05,387][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 12:31:36,508][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 12:32:07,131][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 12:32:37,232][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 12:33:06,658][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 12:33:36,619][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 12:34:06,873][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 12:34:36,372][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 12:35:06,534][root][INFO] - Processing question number 10
[2025-02-21 12:35:06,536][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 12:35:35,881][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 12:36:05,819][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 12:36:35,899][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 12:37:05,490][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 12:37:36,008][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 12:38:06,145][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 12:38:36,222][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 12:39:06,153][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 12:39:36,635][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 12:40:07,216][root][INFO] - Processing question number 20
[2025-02-21 12:40:07,219][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 12:40:36,582][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 12:41:06,836][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 12:41:36,620][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 12:42:06,561][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 12:42:36,603][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 12:43:07,178][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 12:43:37,274][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 12:44:07,547][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 12:44:37,638][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 12:45:08,324][root][INFO] - Processing question number 30
[2025-02-21 12:45:08,334][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 12:45:38,480][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 12:46:08,437][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 12:46:38,351][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 12:47:09,004][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 12:47:39,069][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 12:48:09,211][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 12:48:39,301][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 12:49:10,042][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 12:49:40,310][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 12:50:10,599][root][INFO] - Processing question number 40
[2025-02-21 12:50:10,603][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 12:50:40,853][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 12:51:10,916][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 12:51:41,473][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 12:52:10,876][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 12:52:41,630][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 12:53:11,866][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 12:53:41,942][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 12:54:12,191][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 12:54:42,346][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 12:55:12,867][root][INFO] - Processing question number 50
[2025-02-21 12:55:12,872][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 12:55:43,612][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 12:56:13,308][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 12:56:44,058][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 12:57:14,432][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 12:57:44,173][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 12:58:14,192][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 12:58:45,118][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 12:59:15,761][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 12:59:46,406][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:00:16,876][root][INFO] - Processing question number 60
[2025-02-21 13:00:16,882][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:00:47,077][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:01:17,340][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:01:48,327][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:02:18,858][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:02:49,241][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:03:19,150][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:03:48,884][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 13:04:18,503][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 13:04:48,377][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 13:05:18,194][root][INFO] - Processing question number 70
[2025-02-21 13:05:18,199][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 13:05:48,573][root][INFO] - Domain : Property, Question : 9
[2025-02-21 13:06:18,847][root][INFO] - Domain : Property, Question : 17
[2025-02-21 13:06:49,365][root][INFO] - Domain : Property, Question : 25
[2025-02-21 13:07:20,371][root][INFO] - Domain : Property, Question : 30
[2025-02-21 13:07:50,162][root][INFO] - Domain : Property, Question : 36
[2025-02-21 13:08:20,637][root][INFO] - Domain : Property, Question : 46
[2025-02-21 13:08:52,122][root][INFO] - Domain : Property, Question : 53
[2025-02-21 13:09:22,612][root][INFO] - Domain : Property, Question : 59
[2025-02-21 13:09:52,030][root][INFO] - Domain : Property, Question : 66
[2025-02-21 13:10:21,899][root][INFO] - Processing question number 80
[2025-02-21 13:10:21,904][root][INFO] - Domain : Property, Question : 69
[2025-02-21 13:10:52,655][root][INFO] - Domain : Property, Question : 81
[2025-02-21 13:11:23,447][root][INFO] - Domain : Property, Question : 88
[2025-02-21 13:11:54,155][root][INFO] - Domain : Property, Question : 91
[2025-02-21 13:12:24,625][root][INFO] - Domain : Property, Question : 94
[2025-02-21 13:12:56,063][root][INFO] - Domain : Property, Question : 100
[2025-02-21 13:13:26,110][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 13:13:56,712][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 13:14:27,851][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 13:14:58,132][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 13:15:28,441][root][INFO] - Processing question number 90
[2025-02-21 13:15:28,446][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 13:15:58,753][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 13:16:29,414][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 13:16:59,904][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 13:17:30,138][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 13:18:01,064][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 13:18:31,824][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 13:19:02,317][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 13:19:32,385][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 13:20:02,024][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 13:20:32,822][root][INFO] - Inference complete
[2025-02-21 13:20:32,822][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,831][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,845][root][WARNING] - No match found for 3. Explanation in question number 32 in domain Torts
[2025-02-21 13:20:32,848][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,855][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,855][root][INFO] - Saved parsed outputs
[2025-02-21 13:20:32,855][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,856][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,856][root][INFO] - Saved parsing metadata
[2025-02-21 13:20:32,858][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,859][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:20:32,861][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 13:20:32,882][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 13:20:32,882][root][INFO] - Summary of metrics : {'label_accuracy': 0.24, 'misclassification_rate': 0.76, 'combined_accuracy': 0.18, 'malformed_label': 3, 'malformed_domain': 29, 'total_predictions': 100, 'correct_predictions': 24, 'correct_label_and_domain': 18, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.14285714285714285, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.13, 'Contracts_confidence': 0.17, 'Criminal_Law_confidence': 0.2, 'Evidence_confidence': 0.05, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 53, 'correct_label_wrong_domain': 6, 'both_wrong': 23}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 13:20:43,090][root][INFO] - Setting global seed to 206
[2025-02-21 13:20:43,097][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 13:20:43,098][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 13:20:43,099][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 13:20:43,100][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 13:20:43,102][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 13:20:43,102][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 13:20:43,249][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 13:20:43,531][root][INFO] - Full model selected, loading model
[2025-02-21 13:20:58,969][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 13:20:58,969][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 13:21:05,198][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 13:21:05,201][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 13:21:05,201][root][INFO] - Starting inference
[2025-02-21 13:21:05,374][root][INFO] - Processing question number 0
[2025-02-21 13:21:05,376][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 13:21:35,685][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 13:22:06,521][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 13:22:37,583][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 13:23:08,103][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 13:23:37,997][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 13:24:07,348][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 13:24:37,211][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 13:25:07,371][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 13:25:36,783][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 13:26:06,850][root][INFO] - Processing question number 10
[2025-02-21 13:26:06,854][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 13:26:36,118][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 13:27:05,972][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 13:27:35,938][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 13:28:05,454][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 13:28:35,860][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 13:29:05,912][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 13:29:35,868][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 13:30:05,709][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 13:30:36,062][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 13:31:06,554][root][INFO] - Processing question number 20
[2025-02-21 13:31:06,557][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 13:31:35,855][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 13:32:06,018][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 13:32:35,723][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 13:33:05,566][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 13:33:35,481][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 13:34:05,987][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 13:34:35,957][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 13:35:06,131][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 13:35:36,095][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 13:36:06,685][root][INFO] - Processing question number 30
[2025-02-21 13:36:06,691][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 13:36:36,739][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 13:37:06,605][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 13:37:36,423][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 13:38:06,980][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 13:38:36,918][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 13:39:06,961][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 13:39:36,924][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 13:40:07,572][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 13:40:37,746][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 13:41:07,938][root][INFO] - Processing question number 40
[2025-02-21 13:41:07,941][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 13:41:38,097][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 13:42:08,028][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 13:42:38,455][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 13:43:07,776][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 13:43:38,440][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 13:44:08,586][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 13:44:38,535][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 13:45:08,691][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 13:45:38,747][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 13:46:09,126][root][INFO] - Processing question number 50
[2025-02-21 13:46:09,130][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 13:46:39,779][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 13:47:09,387][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 13:47:40,041][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 13:48:10,319][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 13:48:39,978][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 13:49:09,869][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 13:49:40,646][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 13:50:11,193][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 13:50:41,743][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 13:51:12,063][root][INFO] - Processing question number 60
[2025-02-21 13:51:12,069][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 13:51:42,178][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 13:52:12,346][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 13:52:43,182][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 13:53:13,554][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 13:53:43,842][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 13:54:13,652][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 13:54:43,296][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 13:55:12,736][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 13:55:42,523][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 13:56:12,245][root][INFO] - Processing question number 70
[2025-02-21 13:56:12,250][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 13:56:42,536][root][INFO] - Domain : Property, Question : 9
[2025-02-21 13:57:12,777][root][INFO] - Domain : Property, Question : 17
[2025-02-21 13:57:43,207][root][INFO] - Domain : Property, Question : 25
[2025-02-21 13:58:14,100][root][INFO] - Domain : Property, Question : 30
[2025-02-21 13:58:43,811][root][INFO] - Domain : Property, Question : 36
[2025-02-21 13:59:14,155][root][INFO] - Domain : Property, Question : 46
[2025-02-21 13:59:45,471][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:00:15,883][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:00:45,231][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:01:14,999][root][INFO] - Processing question number 80
[2025-02-21 14:01:15,004][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:01:45,659][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:02:16,359][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:02:46,982][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:03:17,303][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:03:48,562][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:04:18,474][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 14:04:48,981][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 14:05:20,032][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 14:05:50,223][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 14:06:20,429][root][INFO] - Processing question number 90
[2025-02-21 14:06:20,446][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 14:06:50,661][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 14:07:21,234][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 14:07:51,583][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 14:08:21,722][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 14:08:52,504][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 14:09:23,173][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 14:09:53,530][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 14:10:23,466][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 14:10:52,928][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 14:11:23,616][root][INFO] - Inference complete
[2025-02-21 14:11:23,616][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,625][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,642][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,648][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,648][root][INFO] - Saved parsed outputs
[2025-02-21 14:11:23,648][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,650][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,650][root][INFO] - Saved parsing metadata
[2025-02-21 14:11:23,650][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,652][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:11:23,653][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_206/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 14:11:23,677][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 14:11:23,678][root][INFO] - Summary of metrics : {'label_accuracy': 0.27, 'misclassification_rate': 0.73, 'combined_accuracy': 0.19, 'malformed_label': 1, 'malformed_domain': 32, 'total_predictions': 100, 'correct_predictions': 27, 'correct_label_and_domain': 19, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.2857142857142857, 'Evidence_accuracy': 0.26666666666666666, 'Real_Property_accuracy': 0.13333333333333333, 'Torts_accuracy': 0.2857142857142857, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.16, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.16, 'Civil_Procedure_confidence': 0.09, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 8, 'both_wrong': 24}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_206 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 14:11:31,623][root][INFO] - Setting global seed to 989
[2025-02-21 14:11:31,630][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 14:11:31,631][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 14:11:31,632][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 14:11:31,634][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 14:11:31,638][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 14:11:31,638][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 14:11:31,830][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 14:11:32,097][root][INFO] - Full model selected, loading model
[2025-02-21 14:11:48,075][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 14:12:47,945][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 14:12:47,946][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 14:13:13,227][root][INFO] - Peft model loaded successfully
[2025-02-21 14:13:19,247][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 14:13:19,248][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 14:13:19,249][root][INFO] - Starting inference
[2025-02-21 14:13:19,462][root][INFO] - Processing question number 0
[2025-02-21 14:13:19,464][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 14:13:49,968][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 14:14:20,799][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 14:14:51,766][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 14:15:22,225][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 14:15:52,095][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 14:16:21,386][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 14:16:51,201][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 14:17:21,302][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 14:17:50,672][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 14:18:20,693][root][INFO] - Processing question number 10
[2025-02-21 14:18:20,695][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 14:18:49,914][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 14:19:19,715][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 14:19:49,659][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 14:20:19,111][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 14:20:49,512][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 14:21:19,493][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 14:21:49,429][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 14:22:19,225][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 14:22:49,584][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 14:23:20,018][root][INFO] - Processing question number 20
[2025-02-21 14:23:20,022][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 14:23:49,260][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 14:24:19,443][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 14:24:49,098][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 14:25:18,911][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 14:25:48,827][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 14:26:19,313][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 14:26:49,278][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 14:27:19,406][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 14:27:49,368][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 14:28:19,916][root][INFO] - Processing question number 30
[2025-02-21 14:28:19,919][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 14:28:49,941][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 14:29:19,772][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 14:29:49,564][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 14:30:20,079][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 14:30:50,021][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 14:31:20,040][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 14:31:50,003][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 14:32:20,618][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 14:32:50,755][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 14:33:20,922][root][INFO] - Processing question number 40
[2025-02-21 14:33:20,927][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 14:33:51,051][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 14:34:20,987][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 14:34:51,405][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 14:35:20,676][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 14:35:51,305][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 14:36:21,412][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 14:36:51,371][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 14:37:21,503][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 14:37:51,519][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 14:38:21,900][root][INFO] - Processing question number 50
[2025-02-21 14:38:21,904][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 14:38:52,519][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 14:39:22,098][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 14:39:52,718][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 14:40:22,964][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 14:40:52,593][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 14:41:22,488][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 14:41:53,288][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 14:42:23,795][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 14:42:54,315][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 14:43:24,658][root][INFO] - Processing question number 60
[2025-02-21 14:43:24,662][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 14:43:54,778][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 14:44:24,976][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 14:44:55,849][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 14:45:26,222][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 14:45:56,471][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 14:46:26,242][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 14:46:55,848][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 14:47:25,340][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 14:47:55,085][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 14:48:24,773][root][INFO] - Processing question number 70
[2025-02-21 14:48:24,778][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 14:48:55,036][root][INFO] - Domain : Property, Question : 9
[2025-02-21 14:49:25,184][root][INFO] - Domain : Property, Question : 17
[2025-02-21 14:49:55,576][root][INFO] - Domain : Property, Question : 25
[2025-02-21 14:50:26,456][root][INFO] - Domain : Property, Question : 30
[2025-02-21 14:50:56,145][root][INFO] - Domain : Property, Question : 36
[2025-02-21 14:51:26,524][root][INFO] - Domain : Property, Question : 46
[2025-02-21 14:51:57,885][root][INFO] - Domain : Property, Question : 53
[2025-02-21 14:52:28,297][root][INFO] - Domain : Property, Question : 59
[2025-02-21 14:52:57,608][root][INFO] - Domain : Property, Question : 66
[2025-02-21 14:53:27,350][root][INFO] - Processing question number 80
[2025-02-21 14:53:27,355][root][INFO] - Domain : Property, Question : 69
[2025-02-21 14:53:57,977][root][INFO] - Domain : Property, Question : 81
[2025-02-21 14:54:28,652][root][INFO] - Domain : Property, Question : 88
[2025-02-21 14:54:59,236][root][INFO] - Domain : Property, Question : 91
[2025-02-21 14:55:29,583][root][INFO] - Domain : Property, Question : 94
[2025-02-21 14:56:00,888][root][INFO] - Domain : Property, Question : 100
[2025-02-21 14:56:30,811][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 14:57:01,290][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 14:57:32,306][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 14:58:02,469][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 14:58:32,652][root][INFO] - Processing question number 90
[2025-02-21 14:58:32,657][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 14:59:02,841][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 14:59:33,382][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:00:03,754][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:00:33,870][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:01:04,685][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:01:35,314][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:02:05,696][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:02:35,620][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:03:05,129][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:03:35,801][root][INFO] - Inference complete
[2025-02-21 15:03:35,802][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,809][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,825][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,831][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,832][root][INFO] - Saved parsed outputs
[2025-02-21 15:03:35,832][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,833][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,833][root][INFO] - Saved parsing metadata
[2025-02-21 15:03:35,834][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,836][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:03:35,839][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:03:35,869][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 15:03:35,869][root][INFO] - Summary of metrics : {'label_accuracy': 0.33, 'misclassification_rate': 0.6699999999999999, 'combined_accuracy': 0.26, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 33, 'correct_label_and_domain': 26, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.14285714285714285, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 48, 'correct_label_wrong_domain': 7, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 15:03:43,334][root][INFO] - Setting global seed to 989
[2025-02-21 15:03:43,342][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 15:03:43,342][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 15:03:43,343][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:03:43,345][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:03:43,347][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:03:43,347][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:03:43,500][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:03:43,740][root][INFO] - Full model selected, loading model
[2025-02-21 15:03:56,936][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 15:03:56,937][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 15:04:03,170][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:04:03,172][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:04:03,172][root][INFO] - Starting inference
[2025-02-21 15:04:03,347][root][INFO] - Processing question number 0
[2025-02-21 15:04:03,353][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 15:04:33,459][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 15:05:04,162][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 15:05:35,064][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 15:06:05,452][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 15:06:35,222][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 15:07:04,440][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 15:07:34,177][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 15:08:04,197][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 15:08:33,485][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 15:09:03,416][root][INFO] - Processing question number 10
[2025-02-21 15:09:03,418][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 15:09:32,553][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 15:10:02,276][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 15:10:32,107][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 15:11:01,400][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 15:11:31,665][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 15:12:01,578][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 15:12:31,404][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 15:13:01,118][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 15:13:31,341][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 15:14:01,707][root][INFO] - Processing question number 20
[2025-02-21 15:14:01,710][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 15:14:30,884][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 15:15:00,909][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 15:15:30,479][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 15:16:00,195][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 15:16:29,985][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 15:17:00,345][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 15:17:30,191][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 15:18:00,246][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 15:18:30,094][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 15:19:00,571][root][INFO] - Processing question number 30
[2025-02-21 15:19:00,574][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 15:19:30,509][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 15:20:00,255][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 15:20:29,960][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 15:21:00,404][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 15:21:30,226][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 15:22:00,158][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 15:22:30,007][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 15:23:00,540][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 15:23:30,598][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 15:24:00,674][root][INFO] - Processing question number 40
[2025-02-21 15:24:00,678][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 15:24:30,730][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 15:25:00,550][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 15:25:30,865][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 15:26:00,067][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 15:26:30,616][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 15:27:00,646][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 15:27:30,473][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 15:28:00,523][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 15:28:30,473][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 15:29:00,737][root][INFO] - Processing question number 50
[2025-02-21 15:29:00,741][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 15:29:31,282][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 15:30:00,774][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 15:30:31,321][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 15:31:01,482][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 15:31:31,035][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 15:32:00,806][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 15:32:31,467][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 15:33:01,907][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 15:33:32,348][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 15:34:02,552][root][INFO] - Processing question number 60
[2025-02-21 15:34:02,556][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 15:34:32,556][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 15:35:02,613][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 15:35:33,331][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 15:36:03,595][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 15:36:33,759][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 15:37:03,536][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 15:37:33,099][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 15:38:02,463][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 15:38:32,149][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 15:39:01,757][root][INFO] - Processing question number 70
[2025-02-21 15:39:01,762][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 15:39:31,947][root][INFO] - Domain : Property, Question : 9
[2025-02-21 15:40:02,032][root][INFO] - Domain : Property, Question : 17
[2025-02-21 15:40:32,313][root][INFO] - Domain : Property, Question : 25
[2025-02-21 15:41:03,072][root][INFO] - Domain : Property, Question : 30
[2025-02-21 15:41:32,686][root][INFO] - Domain : Property, Question : 36
[2025-02-21 15:42:02,917][root][INFO] - Domain : Property, Question : 46
[2025-02-21 15:42:34,131][root][INFO] - Domain : Property, Question : 53
[2025-02-21 15:43:04,376][root][INFO] - Domain : Property, Question : 59
[2025-02-21 15:43:33,614][root][INFO] - Domain : Property, Question : 66
[2025-02-21 15:44:03,348][root][INFO] - Processing question number 80
[2025-02-21 15:44:03,353][root][INFO] - Domain : Property, Question : 69
[2025-02-21 15:44:33,917][root][INFO] - Domain : Property, Question : 81
[2025-02-21 15:45:04,505][root][INFO] - Domain : Property, Question : 88
[2025-02-21 15:45:35,014][root][INFO] - Domain : Property, Question : 91
[2025-02-21 15:46:05,239][root][INFO] - Domain : Property, Question : 94
[2025-02-21 15:46:36,404][root][INFO] - Domain : Property, Question : 100
[2025-02-21 15:47:06,230][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 15:47:36,643][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 15:48:07,602][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 15:48:37,698][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 15:49:07,811][root][INFO] - Processing question number 90
[2025-02-21 15:49:07,817][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 15:49:37,936][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 15:50:08,401][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 15:50:38,644][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 15:51:08,683][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 15:51:39,364][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 15:52:09,926][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 15:52:40,189][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 15:53:10,028][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 15:53:39,395][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 15:54:09,992][root][INFO] - Inference complete
[2025-02-21 15:54:09,992][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:09,999][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:10,017][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:10,023][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:10,023][root][INFO] - Saved parsed outputs
[2025-02-21 15:54:10,023][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:10,024][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:10,024][root][INFO] - Saved parsing metadata
[2025-02-21 15:54:10,025][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:10,027][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:54:10,028][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/greedy/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 15:54:10,075][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 15:54:10,075][root][INFO] - Summary of metrics : {'label_accuracy': 0.28, 'misclassification_rate': 0.72, 'combined_accuracy': 0.22, 'malformed_label': 0, 'malformed_domain': 25, 'total_predictions': 100, 'correct_predictions': 28, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.13, 'correct_domain_wrong_label': 53, 'correct_label_wrong_domain': 6, 'both_wrong': 19}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 15:54:19,191][root][INFO] - Setting global seed to 989
[2025-02-21 15:54:19,199][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 15:54:19,199][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 15:54:19,201][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 15:54:19,203][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 15:54:19,208][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 15:54:19,208][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 15:54:19,353][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 15:54:19,620][root][INFO] - Full model selected, loading model
[2025-02-21 15:54:36,679][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 15:55:37,723][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 15:55:37,724][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 15:56:03,217][root][INFO] - Peft model loaded successfully
[2025-02-21 15:56:09,233][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 15:56:09,235][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 15:56:09,235][root][INFO] - Starting inference
[2025-02-21 15:56:09,461][root][INFO] - Processing question number 0
[2025-02-21 15:56:09,463][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 15:56:40,150][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 15:57:11,125][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 15:57:42,251][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 15:58:12,869][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 15:58:42,910][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 15:59:12,320][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 15:59:42,274][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:00:12,507][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:00:41,999][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:01:12,161][root][INFO] - Processing question number 10
[2025-02-21 16:01:12,163][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:01:41,521][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:02:11,466][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:02:41,564][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:03:11,180][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:03:41,714][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:04:11,864][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 16:04:41,955][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 16:05:11,898][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 16:05:42,396][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 16:06:12,996][root][INFO] - Processing question number 20
[2025-02-21 16:06:12,999][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 16:06:42,372][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 16:07:12,627][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 16:07:42,418][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 16:08:12,360][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 16:08:42,391][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 16:09:12,944][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 16:09:43,036][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 16:10:13,298][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 16:10:43,387][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 16:11:14,064][root][INFO] - Processing question number 30
[2025-02-21 16:11:14,068][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 16:11:44,208][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 16:12:14,153][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 16:12:44,061][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 16:13:14,701][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 16:13:44,761][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 16:14:14,892][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 16:14:44,977][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 16:15:15,708][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 16:15:45,969][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 16:16:16,247][root][INFO] - Processing question number 40
[2025-02-21 16:16:16,251][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 16:16:46,496][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 16:17:16,550][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 16:17:47,106][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 16:18:16,504][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 16:18:47,250][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 16:19:17,474][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 16:19:47,563][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 16:20:17,814][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 16:20:47,981][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 16:21:18,506][root][INFO] - Processing question number 50
[2025-02-21 16:21:18,511][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 16:21:49,268][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 16:22:18,964][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 16:22:49,719][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 16:23:20,085][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 16:23:49,828][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 16:24:19,856][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 16:24:50,790][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 16:25:21,447][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 16:25:52,115][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 16:26:22,609][root][INFO] - Processing question number 60
[2025-02-21 16:26:22,614][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 16:26:52,838][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 16:27:23,122][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 16:27:54,144][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 16:28:24,685][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 16:28:55,091][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 16:29:25,014][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 16:29:54,770][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 16:30:24,410][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 16:30:54,312][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 16:31:24,159][root][INFO] - Processing question number 70
[2025-02-21 16:31:24,164][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 16:31:54,574][root][INFO] - Domain : Property, Question : 9
[2025-02-21 16:32:24,868][root][INFO] - Domain : Property, Question : 17
[2025-02-21 16:32:55,416][root][INFO] - Domain : Property, Question : 25
[2025-02-21 16:33:26,424][root][INFO] - Domain : Property, Question : 30
[2025-02-21 16:33:56,228][root][INFO] - Domain : Property, Question : 36
[2025-02-21 16:34:26,718][root][INFO] - Domain : Property, Question : 46
[2025-02-21 16:34:58,209][root][INFO] - Domain : Property, Question : 53
[2025-02-21 16:35:28,706][root][INFO] - Domain : Property, Question : 59
[2025-02-21 16:35:58,138][root][INFO] - Domain : Property, Question : 66
[2025-02-21 16:36:28,010][root][INFO] - Processing question number 80
[2025-02-21 16:36:28,015][root][INFO] - Domain : Property, Question : 69
[2025-02-21 16:36:58,771][root][INFO] - Domain : Property, Question : 81
[2025-02-21 16:37:29,586][root][INFO] - Domain : Property, Question : 88
[2025-02-21 16:38:00,326][root][INFO] - Domain : Property, Question : 91
[2025-02-21 16:38:30,815][root][INFO] - Domain : Property, Question : 94
[2025-02-21 16:39:02,289][root][INFO] - Domain : Property, Question : 100
[2025-02-21 16:39:32,359][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 16:40:02,989][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 16:40:34,152][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 16:41:04,462][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 16:41:34,791][root][INFO] - Processing question number 90
[2025-02-21 16:41:34,797][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 16:42:05,108][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 16:42:35,770][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 16:43:06,271][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 16:43:36,527][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 16:44:07,482][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 16:44:38,256][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 16:45:08,769][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 16:45:38,861][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 16:46:08,523][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 16:46:39,359][root][INFO] - Inference complete
[2025-02-21 16:46:39,359][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,366][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,383][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,389][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,389][root][INFO] - Saved parsed outputs
[2025-02-21 16:46:39,389][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,391][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,391][root][INFO] - Saved parsing metadata
[2025-02-21 16:46:39,392][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,394][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:46:39,395][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 16:46:39,426][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 16:46:39,426][root][INFO] - Summary of metrics : {'label_accuracy': 0.26, 'misclassification_rate': 0.74, 'combined_accuracy': 0.2, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 26, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.4, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.15384615384615385, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.07, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 54, 'correct_label_wrong_domain': 6, 'both_wrong': 20}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 16:46:46,947][root][INFO] - Setting global seed to 989
[2025-02-21 16:46:46,954][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 16:46:46,954][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 16:46:46,956][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 16:46:46,958][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 16:46:46,960][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 16:46:46,961][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 16:46:47,108][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 16:46:47,375][root][INFO] - Full model selected, loading model
[2025-02-21 16:47:02,853][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 16:47:02,853][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 16:47:09,060][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 16:47:09,062][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 16:47:09,062][root][INFO] - Starting inference
[2025-02-21 16:47:09,275][root][INFO] - Processing question number 0
[2025-02-21 16:47:09,278][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 16:47:39,639][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 16:48:10,520][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 16:48:41,605][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 16:49:12,164][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 16:49:42,095][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 16:50:11,474][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 16:50:41,370][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 16:51:11,560][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 16:51:40,998][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 16:52:11,100][root][INFO] - Processing question number 10
[2025-02-21 16:52:11,102][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 16:52:40,411][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 16:53:10,292][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 16:53:40,294][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 16:54:09,764][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 16:54:40,200][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 16:55:10,300][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 16:55:40,305][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 16:56:10,191][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 16:56:40,598][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 16:57:11,139][root][INFO] - Processing question number 20
[2025-02-21 16:57:11,142][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 16:57:40,495][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 16:58:10,712][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 16:58:40,466][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 16:59:10,354][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 16:59:40,311][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:00:10,833][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:00:40,847][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:01:11,067][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:01:41,094][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:02:11,747][root][INFO] - Processing question number 30
[2025-02-21 17:02:11,751][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:02:41,859][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:03:11,772][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:03:41,636][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:04:12,244][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 17:04:42,236][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 17:05:12,315][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 17:05:42,329][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 17:06:13,036][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 17:06:43,271][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 17:07:13,531][root][INFO] - Processing question number 40
[2025-02-21 17:07:13,535][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 17:07:43,829][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 17:08:13,887][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 17:08:44,421][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 17:09:13,844][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 17:09:44,550][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 17:10:14,703][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 17:10:44,667][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 17:11:14,826][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 17:11:44,920][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 17:12:15,444][root][INFO] - Processing question number 50
[2025-02-21 17:12:15,448][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 17:12:46,209][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 17:13:15,918][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 17:13:46,548][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 17:14:16,756][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 17:14:46,350][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 17:15:16,275][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 17:15:47,138][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 17:16:17,756][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 17:16:49,526][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 17:17:19,841][root][INFO] - Processing question number 60
[2025-02-21 17:17:19,847][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 17:17:50,025][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 17:18:22,721][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 17:18:53,590][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 17:19:23,896][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 17:19:54,111][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 17:20:23,935][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 17:20:53,518][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 17:21:22,899][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 17:21:52,622][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 17:22:22,278][root][INFO] - Processing question number 70
[2025-02-21 17:22:22,285][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 17:22:52,503][root][INFO] - Domain : Property, Question : 9
[2025-02-21 17:23:22,614][root][INFO] - Domain : Property, Question : 17
[2025-02-21 17:23:52,929][root][INFO] - Domain : Property, Question : 25
[2025-02-21 17:24:23,715][root][INFO] - Domain : Property, Question : 30
[2025-02-21 17:24:53,362][root][INFO] - Domain : Property, Question : 36
[2025-02-21 17:25:23,631][root][INFO] - Domain : Property, Question : 46
[2025-02-21 17:25:54,873][root][INFO] - Domain : Property, Question : 53
[2025-02-21 17:26:25,157][root][INFO] - Domain : Property, Question : 59
[2025-02-21 17:26:54,447][root][INFO] - Domain : Property, Question : 66
[2025-02-21 17:27:24,162][root][INFO] - Processing question number 80
[2025-02-21 17:27:24,167][root][INFO] - Domain : Property, Question : 69
[2025-02-21 17:27:54,768][root][INFO] - Domain : Property, Question : 81
[2025-02-21 17:28:25,407][root][INFO] - Domain : Property, Question : 88
[2025-02-21 17:28:55,978][root][INFO] - Domain : Property, Question : 91
[2025-02-21 17:29:26,242][root][INFO] - Domain : Property, Question : 94
[2025-02-21 17:29:57,440][root][INFO] - Domain : Property, Question : 100
[2025-02-21 17:30:27,298][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 17:30:57,746][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 17:31:28,732][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 17:31:58,862][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 17:32:29,020][root][INFO] - Processing question number 90
[2025-02-21 17:32:29,026][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 17:32:59,183][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 17:33:29,696][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 17:33:59,991][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 17:34:30,072][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 17:35:00,787][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 17:35:31,394][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 17:36:01,696][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 17:36:31,575][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 17:37:00,980][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 17:37:31,609][root][INFO] - Inference complete
[2025-02-21 17:37:31,609][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,616][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,634][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,639][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,639][root][INFO] - Saved parsed outputs
[2025-02-21 17:37:31,639][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,641][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,641][root][INFO] - Saved parsing metadata
[2025-02-21 17:37:31,642][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,644][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:37:31,645][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_025/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 17:37:31,693][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 17:37:31,693][root][INFO] - Summary of metrics : {'label_accuracy': 0.32, 'misclassification_rate': 0.6799999999999999, 'combined_accuracy': 0.2, 'malformed_label': 0, 'malformed_domain': 26, 'total_predictions': 100, 'correct_predictions': 32, 'correct_label_and_domain': 20, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.5, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.12, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.22, 'Evidence_confidence': 0.06, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.1, 'correct_domain_wrong_label': 54, 'correct_label_wrong_domain': 12, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 17:37:43,596][root][INFO] - Setting global seed to 989
[2025-02-21 17:37:43,604][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-02-21 17:37:43,604][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 17:37:43,606][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 17:37:43,608][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 17:37:43,613][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 17:37:43,613][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 17:37:43,771][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 17:37:44,015][root][INFO] - Full model selected, loading model
[2025-02-21 17:37:59,086][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-02-21 17:38:58,786][root][INFO] - Fine-tuned model selected, loading adapter
[2025-02-21 17:38:58,787][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-02-21 17:39:24,439][root][INFO] - Peft model loaded successfully
[2025-02-21 17:39:30,472][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 17:39:30,474][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 17:39:30,474][root][INFO] - Starting inference
[2025-02-21 17:39:30,693][root][INFO] - Processing question number 0
[2025-02-21 17:39:30,695][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 17:40:01,486][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 17:40:32,389][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 17:41:03,435][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 17:41:33,969][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 17:42:03,928][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 17:42:33,278][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 17:43:03,169][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 17:43:33,334][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 17:44:02,767][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 17:44:32,849][root][INFO] - Processing question number 10
[2025-02-21 17:44:32,851][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 17:45:02,137][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 17:45:32,101][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 17:46:02,127][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 17:46:31,667][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 17:47:02,197][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 17:47:32,282][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 17:48:02,289][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 17:48:32,160][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 17:49:02,580][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 17:49:33,096][root][INFO] - Processing question number 20
[2025-02-21 17:49:33,098][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 17:50:02,409][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 17:50:32,612][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 17:51:02,346][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 17:51:32,223][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 17:52:02,207][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 17:52:32,717][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 17:53:02,761][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 17:53:32,967][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 17:54:03,012][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 17:54:33,632][root][INFO] - Processing question number 30
[2025-02-21 17:54:33,635][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 17:55:03,730][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 17:55:33,630][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 17:56:03,500][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 17:56:34,089][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 17:57:04,097][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 17:57:34,176][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 17:58:04,212][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 17:58:34,896][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 17:59:05,109][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 17:59:35,341][root][INFO] - Processing question number 40
[2025-02-21 17:59:35,344][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:00:05,543][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:00:35,623][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:01:06,197][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:01:35,576][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:02:06,334][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:02:36,518][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:03:06,542][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:03:36,752][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:04:06,861][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 18:04:37,333][root][INFO] - Processing question number 50
[2025-02-21 18:04:37,337][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 18:05:08,029][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 18:05:37,670][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 18:06:08,367][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 18:06:38,679][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 18:07:08,364][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 18:07:38,317][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 18:08:09,178][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 18:08:39,773][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 18:09:10,356][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 18:09:40,766][root][INFO] - Processing question number 60
[2025-02-21 18:09:40,771][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 18:10:10,904][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 18:10:41,085][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 18:11:11,984][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 18:11:42,414][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 18:12:12,701][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 18:12:42,521][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 18:13:12,165][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 18:13:41,697][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 18:14:11,485][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 18:14:41,216][root][INFO] - Processing question number 70
[2025-02-21 18:14:41,221][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 18:15:11,513][root][INFO] - Domain : Property, Question : 9
[2025-02-21 18:15:41,726][root][INFO] - Domain : Property, Question : 17
[2025-02-21 18:16:12,187][root][INFO] - Domain : Property, Question : 25
[2025-02-21 18:16:43,120][root][INFO] - Domain : Property, Question : 30
[2025-02-21 18:17:12,850][root][INFO] - Domain : Property, Question : 36
[2025-02-21 18:17:43,254][root][INFO] - Domain : Property, Question : 46
[2025-02-21 18:18:14,662][root][INFO] - Domain : Property, Question : 53
[2025-02-21 18:18:45,075][root][INFO] - Domain : Property, Question : 59
[2025-02-21 18:19:14,425][root][INFO] - Domain : Property, Question : 66
[2025-02-21 18:19:44,213][root][INFO] - Processing question number 80
[2025-02-21 18:19:44,230][root][INFO] - Domain : Property, Question : 69
[2025-02-21 18:20:14,911][root][INFO] - Domain : Property, Question : 81
[2025-02-21 18:20:45,631][root][INFO] - Domain : Property, Question : 88
[2025-02-21 18:21:16,284][root][INFO] - Domain : Property, Question : 91
[2025-02-21 18:21:46,680][root][INFO] - Domain : Property, Question : 94
[2025-02-21 18:22:18,058][root][INFO] - Domain : Property, Question : 100
[2025-02-21 18:22:48,037][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 18:23:18,643][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 18:23:49,705][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 18:24:19,917][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 18:24:50,148][root][INFO] - Processing question number 90
[2025-02-21 18:24:50,154][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 18:25:20,388][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 18:25:50,972][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 18:26:21,397][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 18:26:51,555][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 18:27:22,410][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 18:27:53,096][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 18:28:23,522][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 18:28:53,517][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 18:29:23,080][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 18:29:53,821][root][INFO] - Inference complete
[2025-02-21 18:29:53,821][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,828][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,831][root][WARNING] - No match found for 3. Explanation in question number 78 in domain Constitutional_law
[2025-02-21 18:29:53,842][root][WARNING] - No match found for 3. Explanation in question number 59 in domain Property
[2025-02-21 18:29:53,846][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,852][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,852][root][INFO] - Saved parsed outputs
[2025-02-21 18:29:53,852][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,853][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,853][root][INFO] - Saved parsing metadata
[2025-02-21 18:29:53,854][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,855][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:29:53,857][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/trained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 18:29:53,897][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 18:29:53,897][root][INFO] - Summary of metrics : {'label_accuracy': 0.25, 'misclassification_rate': 0.75, 'combined_accuracy': 0.22, 'malformed_label': 3, 'malformed_domain': 29, 'total_predictions': 100, 'correct_predictions': 25, 'correct_label_and_domain': 22, 'Constitutional_Law_accuracy': 0.21428571428571427, 'Contracts_accuracy': 0.3333333333333333, 'Criminal_Law_accuracy': 0.5714285714285714, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.23076923076923078, 'Constitutional_Law_confidence': 0.11, 'Contracts_confidence': 0.18, 'Criminal_Law_confidence': 0.19, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.03, 'Torts_confidence': 0.13, 'Civil_Procedure_confidence': 0.11, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 3, 'both_wrong': 26}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Running evaluation with config: seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 3 to status running with exit code None
Eval status update completed for job 3
[2025-02-21 18:30:01,806][root][INFO] - Setting global seed to 989
[2025-02-21 18:30:01,812][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-02-21 18:30:01,813][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : number_list 
[2025-02-21 18:30:01,814][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-02-21 18:30:01,815][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-02-21 18:30:01,817][root][INFO] - Indexing complete, sampling of questions set to False
[2025-02-21 18:30:01,818][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-02-21 18:30:01,979][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-02-21 18:30:02,236][root][INFO] - Full model selected, loading model
[2025-02-21 18:30:20,544][root][INFO] - Baseline model selected, no adapter needed
[2025-02-21 18:30:20,544][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-02-21 18:30:26,867][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'number_list', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-02-21 18:30:26,868][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 18:30:26,868][root][INFO] - Starting inference
[2025-02-21 18:30:27,051][root][INFO] - Processing question number 0
[2025-02-21 18:30:27,053][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-02-21 18:30:57,670][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-02-21 18:31:28,425][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-02-21 18:31:59,381][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-02-21 18:32:29,826][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-02-21 18:32:59,654][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-02-21 18:33:28,933][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-02-21 18:33:58,731][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-02-21 18:34:28,812][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-02-21 18:34:58,156][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-02-21 18:35:28,148][root][INFO] - Processing question number 10
[2025-02-21 18:35:28,150][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-02-21 18:35:57,343][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-02-21 18:36:27,115][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-02-21 18:36:57,002][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-02-21 18:37:26,356][root][INFO] - Domain : Criminal_law, Question : 2
[2025-02-21 18:37:56,674][root][INFO] - Domain : Criminal_law, Question : 8
[2025-02-21 18:38:26,647][root][INFO] - Domain : Criminal_law, Question : 15
[2025-02-21 18:38:56,523][root][INFO] - Domain : Criminal_law, Question : 21
[2025-02-21 18:39:26,291][root][INFO] - Domain : Criminal_law, Question : 29
[2025-02-21 18:39:56,570][root][INFO] - Domain : Criminal_law, Question : 37
[2025-02-21 18:40:27,000][root][INFO] - Processing question number 20
[2025-02-21 18:40:27,002][root][INFO] - Domain : Criminal_law, Question : 44
[2025-02-21 18:40:56,240][root][INFO] - Domain : Criminal_law, Question : 55
[2025-02-21 18:41:26,338][root][INFO] - Domain : Criminal_law, Question : 64
[2025-02-21 18:41:55,977][root][INFO] - Domain : Criminal_law, Question : 71
[2025-02-21 18:42:25,761][root][INFO] - Domain : Criminal_law, Question : 76
[2025-02-21 18:42:55,615][root][INFO] - Domain : Criminal_law, Question : 83
[2025-02-21 18:43:26,045][root][INFO] - Domain : Criminal_law, Question : 89
[2025-02-21 18:43:55,959][root][INFO] - Domain : Criminal_law, Question : 96
[2025-02-21 18:44:26,073][root][INFO] - Domain : Contracts, Question : 3
[2025-02-21 18:44:55,983][root][INFO] - Domain : Contracts, Question : 7
[2025-02-21 18:45:26,513][root][INFO] - Processing question number 30
[2025-02-21 18:45:26,516][root][INFO] - Domain : Contracts, Question : 14
[2025-02-21 18:45:56,513][root][INFO] - Domain : Contracts, Question : 24
[2025-02-21 18:46:26,324][root][INFO] - Domain : Contracts, Question : 28
[2025-02-21 18:46:56,093][root][INFO] - Domain : Contracts, Question : 34
[2025-02-21 18:47:26,594][root][INFO] - Domain : Contracts, Question : 42
[2025-02-21 18:47:56,479][root][INFO] - Domain : Contracts, Question : 48
[2025-02-21 18:48:26,472][root][INFO] - Domain : Contracts, Question : 58
[2025-02-21 18:48:56,379][root][INFO] - Domain : Contracts, Question : 65
[2025-02-21 18:49:26,968][root][INFO] - Domain : Contracts, Question : 72
[2025-02-21 18:49:57,085][root][INFO] - Domain : Contracts, Question : 77
[2025-02-21 18:50:27,218][root][INFO] - Processing question number 40
[2025-02-21 18:50:27,222][root][INFO] - Domain : Contracts, Question : 84
[2025-02-21 18:50:57,322][root][INFO] - Domain : Contracts, Question : 87
[2025-02-21 18:51:27,205][root][INFO] - Domain : Contracts, Question : 97
[2025-02-21 18:51:57,575][root][INFO] - Domain : Evidence, Question : 4
[2025-02-21 18:52:26,836][root][INFO] - Domain : Evidence, Question : 10
[2025-02-21 18:52:57,434][root][INFO] - Domain : Evidence, Question : 16
[2025-02-21 18:53:27,519][root][INFO] - Domain : Evidence, Question : 23
[2025-02-21 18:53:57,421][root][INFO] - Domain : Evidence, Question : 31
[2025-02-21 18:54:27,522][root][INFO] - Domain : Evidence, Question : 38
[2025-02-21 18:54:57,521][root][INFO] - Domain : Evidence, Question : 43
[2025-02-21 18:55:27,846][root][INFO] - Processing question number 50
[2025-02-21 18:55:27,850][root][INFO] - Domain : Evidence, Question : 50
[2025-02-21 18:55:58,446][root][INFO] - Domain : Evidence, Question : 51
[2025-02-21 18:56:28,007][root][INFO] - Domain : Evidence, Question : 60
[2025-02-21 18:56:58,605][root][INFO] - Domain : Evidence, Question : 73
[2025-02-21 18:57:28,826][root][INFO] - Domain : Evidence, Question : 80
[2025-02-21 18:57:58,429][root][INFO] - Domain : Evidence, Question : 85
[2025-02-21 18:58:28,263][root][INFO] - Domain : Evidence, Question : 90
[2025-02-21 18:58:58,983][root][INFO] - Domain : Evidence, Question : 98
[2025-02-21 18:59:29,476][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-02-21 18:59:59,976][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-02-21 19:00:30,240][root][INFO] - Processing question number 60
[2025-02-21 19:00:30,244][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-02-21 19:01:00,299][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-02-21 19:01:30,413][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-02-21 19:02:01,191][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-02-21 19:02:31,508][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-02-21 19:03:01,729][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-02-21 19:03:31,478][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-02-21 19:04:01,065][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-02-21 19:04:30,446][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-02-21 19:05:00,179][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-02-21 19:05:29,849][root][INFO] - Processing question number 70
[2025-02-21 19:05:29,853][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-02-21 19:06:00,081][root][INFO] - Domain : Property, Question : 9
[2025-02-21 19:06:30,203][root][INFO] - Domain : Property, Question : 17
[2025-02-21 19:07:00,527][root][INFO] - Domain : Property, Question : 25
[2025-02-21 19:07:31,328][root][INFO] - Domain : Property, Question : 30
[2025-02-21 19:08:00,981][root][INFO] - Domain : Property, Question : 36
[2025-02-21 19:08:31,307][root][INFO] - Domain : Property, Question : 46
[2025-02-21 19:09:02,597][root][INFO] - Domain : Property, Question : 53
[2025-02-21 19:09:32,873][root][INFO] - Domain : Property, Question : 59
[2025-02-21 19:10:02,190][root][INFO] - Domain : Property, Question : 66
[2025-02-21 19:10:31,936][root][INFO] - Processing question number 80
[2025-02-21 19:10:31,941][root][INFO] - Domain : Property, Question : 69
[2025-02-21 19:11:02,519][root][INFO] - Domain : Property, Question : 81
[2025-02-21 19:11:33,132][root][INFO] - Domain : Property, Question : 88
[2025-02-21 19:12:03,673][root][INFO] - Domain : Property, Question : 91
[2025-02-21 19:12:33,911][root][INFO] - Domain : Property, Question : 94
[2025-02-21 19:13:05,086][root][INFO] - Domain : Property, Question : 100
[2025-02-21 19:13:34,918][root][INFO] - Domain : Torts, Question : 11
[2025-02-21 19:14:05,343][root][INFO] - Domain : Torts, Question : 18
[2025-02-21 19:14:36,308][root][INFO] - Domain : Torts, Question : 22
[2025-02-21 19:15:06,522][root][INFO] - Domain : Torts, Question : 32
[2025-02-21 19:15:36,697][root][INFO] - Processing question number 90
[2025-02-21 19:15:36,703][root][INFO] - Domain : Torts, Question : 39
[2025-02-21 19:16:06,914][root][INFO] - Domain : Torts, Question : 45
[2025-02-21 19:16:37,471][root][INFO] - Domain : Torts, Question : 52
[2025-02-21 19:17:07,768][root][INFO] - Domain : Torts, Question : 57
[2025-02-21 19:17:37,842][root][INFO] - Domain : Torts, Question : 63
[2025-02-21 19:18:08,561][root][INFO] - Domain : Torts, Question : 67
[2025-02-21 19:18:39,167][root][INFO] - Domain : Torts, Question : 74
[2025-02-21 19:19:09,467][root][INFO] - Domain : Torts, Question : 79
[2025-02-21 19:19:39,344][root][INFO] - Domain : Torts, Question : 92
[2025-02-21 19:20:08,750][root][INFO] - Domain : Torts, Question : 95
[2025-02-21 19:20:39,377][root][INFO] - Inference complete
[2025-02-21 19:20:39,378][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,385][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,405][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,410][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,410][root][INFO] - Saved parsed outputs
[2025-02-21 19:20:39,410][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,411][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,411][root][INFO] - Saved parsing metadata
[2025-02-21 19:20:39,412][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,414][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
[2025-02-21 19:20:39,415][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama2/seed_989/all_domains_1_samples/untrained_full_model/temp_06/number_list_answer_first_few_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-02-21 19:20:39,443][root][INFO] - Evaluation completed for number_list_answer_first_few_shot_unstructured, on test_set_2
[2025-02-21 19:20:39,443][root][INFO] - Summary of metrics : {'label_accuracy': 0.25, 'misclassification_rate': 0.75, 'combined_accuracy': 0.17, 'malformed_label': 0, 'malformed_domain': 34, 'total_predictions': 100, 'correct_predictions': 25, 'correct_label_and_domain': 17, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.42857142857142855, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.1, 'Contracts_confidence': 0.14, 'Criminal_Law_confidence': 0.21, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.06, 'Torts_confidence': 0.14, 'Civil_Procedure_confidence': 0.05, 'correct_domain_wrong_label': 49, 'correct_label_wrong_domain': 8, 'both_wrong': 26}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '3', 'seeds=seed_989 model=llama2 tokenizer=llama2 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=number_list_answer_first_few_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 3 to status completed with exit code 0
Eval status update completed for job 3
Job 3 completed at Fri Feb 21 19:20:40 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n507
Job ID: 25309338
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 20:32:14
CPU Efficiency: 9.93% of 8-14:44:40 core-walltime
Job Wall-clock time: 20:40:28
Memory Utilized: 28.73 GB
Memory Efficiency: 79.81% of 36.00 GB
