Starting job 8 at Thu Mar  6 09:35:18 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=json_answer_first_zero_shot_unstructured train=json_answer_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '8', 'training']
Updating job 8 to status training with exit code None
Status update completed for job 8
[2025-03-06 09:35:30,357][root][INFO] - Global seed set to 314
[2025-03-06 09:35:30,359][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 09:35:30,359][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 09:35:30,359][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 09:35:30,359][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 09:35:30,360][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-03-06 09:35:30,376][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:35:30,383][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 09:35:30,385][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 09:35:30,457][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 09:35:31,224][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 09:35:52,483][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 09:36:21,260][root][INFO] - Model prepared for kbit training
[2025-03-06 09:36:21,261][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'up_proj', 'down_proj', 'gate_proj', 'v_proj', 'k_proj', 'o_proj', 'q_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 09:36:22,966][root][INFO] - Lora adapter added to model
[2025-03-06 09:36:22,969][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_answer_first_zero_shot_unstructured
[2025-03-06 09:36:23,195][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.9965, 'grad_norm': 0.5323458313941956, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.6189, 'grad_norm': 0.3592286705970764, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.4201, 'grad_norm': 0.3737235367298126, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.2571, 'grad_norm': 0.4698016941547394, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0042, 'grad_norm': 0.4160475730895996, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 300.8999, 'train_samples_per_second': 0.349, 'train_steps_per_second': 0.05, 'train_loss': 1.4593668778737385, 'epoch': 15.0}
[2025-03-06 09:41:31,880][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_answer_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '8', 'trained', '0']
Updating job 8 to status trained with exit code 0
Status update completed for job 8
Starting evaluations for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 09:41:41,452][root][INFO] - Setting global seed to 206
[2025-03-06 09:41:41,457][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:41:41,457][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 09:41:41,459][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:41:41,484][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:41:41,489][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:41:41,489][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:41:41,637][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:41:42,226][root][INFO] - Full model selected, loading model
[2025-03-06 09:41:55,625][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:43:41,216][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:43:41,227][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:44:13,078][root][INFO] - Peft model loaded successfully
[2025-03-06 09:44:20,589][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:44:20,590][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 09:44:20,590][root][INFO] - Starting inference
[2025-03-06 09:44:20,749][root][INFO] - Processing question number 0
[2025-03-06 09:44:20,768][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:44:31,647][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:44:42,382][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:44:47,814][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:44:58,456][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:45:05,315][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:45:33,452][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:45:39,826][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:45:55,445][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:46:03,150][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:46:07,829][root][INFO] - Processing question number 10
[2025-03-06 09:46:07,831][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:46:14,090][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:46:31,200][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:46:59,497][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:47:09,337][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:47:17,342][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:47:29,102][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:47:35,733][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:47:39,378][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:47:45,043][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:47:48,901][root][INFO] - Processing question number 20
[2025-03-06 09:47:48,904][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:47:57,234][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:48:05,064][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 09:48:11,080][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 09:48:18,123][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 09:48:22,799][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 09:48:34,490][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 09:48:38,711][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 09:48:46,463][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 09:48:57,119][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 09:49:04,661][root][INFO] - Processing question number 30
[2025-03-06 09:49:04,663][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 09:49:23,225][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 09:49:32,380][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 09:49:39,309][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 09:49:45,745][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 09:49:54,697][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 09:50:04,891][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 09:50:19,908][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 09:50:31,117][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 09:50:49,766][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 09:51:02,472][root][INFO] - Processing question number 40
[2025-03-06 09:51:02,475][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 09:51:15,033][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 09:51:21,960][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 09:51:38,621][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 09:51:55,747][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 09:52:04,573][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 09:52:12,372][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 09:52:17,623][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 09:52:22,426][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 09:52:26,406][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 09:52:31,122][root][INFO] - Processing question number 50
[2025-03-06 09:52:31,125][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 09:52:37,686][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 09:53:06,292][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 09:53:11,656][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 09:53:19,103][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 09:53:27,841][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 09:53:35,322][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 09:53:44,838][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 09:53:54,679][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 09:54:15,519][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 09:54:21,930][root][INFO] - Processing question number 60
[2025-03-06 09:54:21,933][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 09:54:34,908][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 09:54:40,016][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 09:54:47,286][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 09:54:55,959][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 09:55:02,364][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 09:55:07,760][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 09:55:11,760][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 09:55:18,935][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 09:55:26,116][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 09:55:32,733][root][INFO] - Processing question number 70
[2025-03-06 09:55:32,736][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 09:55:38,832][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 09:55:43,055][root][INFO] - Domain : Property, Question : 6
[2025-03-06 09:55:51,833][root][INFO] - Domain : Property, Question : 13
[2025-03-06 09:56:10,516][root][INFO] - Domain : Property, Question : 20
[2025-03-06 09:56:19,445][root][INFO] - Domain : Property, Question : 33
[2025-03-06 09:56:28,540][root][INFO] - Domain : Property, Question : 39
[2025-03-06 09:56:40,515][root][INFO] - Domain : Property, Question : 48
[2025-03-06 09:56:58,271][root][INFO] - Domain : Property, Question : 54
[2025-03-06 09:57:13,224][root][INFO] - Domain : Property, Question : 61
[2025-03-06 09:57:22,064][root][INFO] - Processing question number 80
[2025-03-06 09:57:22,068][root][INFO] - Domain : Property, Question : 67
[2025-03-06 09:57:35,825][root][INFO] - Domain : Property, Question : 75
[2025-03-06 09:57:45,876][root][INFO] - Domain : Property, Question : 83
[2025-03-06 09:57:51,202][root][INFO] - Domain : Property, Question : 89
[2025-03-06 09:58:03,322][root][INFO] - Domain : Property, Question : 97
[2025-03-06 09:58:13,564][root][INFO] - Domain : Property, Question : 100
[2025-03-06 09:58:24,589][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 09:58:29,535][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 09:58:37,669][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 09:59:06,053][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 09:59:16,289][root][INFO] - Processing question number 90
[2025-03-06 09:59:16,293][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:59:25,960][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:59:53,522][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:00:21,810][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:00:25,211][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:00:32,302][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:00:39,159][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:00:46,700][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:00:50,787][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:01:02,982][root][INFO] - Inference complete
[2025-03-06 10:01:02,982][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:02,987][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:02,988][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:02,989][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:01:02,989][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:02,989][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:01:02,989][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:02,989][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:01:02,990][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:02,990][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:02,990][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:01:02,990][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:02,991][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:02,991][root][WARNING] - |Q. 77||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:01:02,991][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:02,991][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:01:02,995][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:02,996][root][WARNING] - |Q. 62||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:01:02,996][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:02,996][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:01:03,000][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:03,000][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:01:03,000][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:03,001][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:01:03,001][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:03,001][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:01:03,001][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:03,001][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:01:03,002][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:01:03,002][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:01:03,002][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:01:03,002][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:01:03,004][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:03,017][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:03,017][root][INFO] - Saved parsed outputs
[2025-03-06 10:01:03,017][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:03,018][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:03,019][root][INFO] - Saved parsing metadata
[2025-03-06 10:01:03,019][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:03,020][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:03,022][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:01:03,043][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 10:01:03,043][root][INFO] - Summary of metrics : {'label_accuracy': 0.43434343434343436, 'misclassification_rate': 0.5656565656565656, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 16, 'malformed_domain': 24, 'total_predictions': 99, 'correct_predictions': 43, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.2222222222222222, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.21212121212121213, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 11, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 10:01:09,991][root][INFO] - Setting global seed to 206
[2025-03-06 10:01:09,998][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:01:09,998][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:01:09,999][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:01:10,001][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:01:10,004][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:01:10,004][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:01:10,162][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:01:10,689][root][INFO] - Full model selected, loading model
[2025-03-06 10:01:30,829][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:01:30,829][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:01:38,800][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:01:38,801][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:01:38,801][root][INFO] - Starting inference
[2025-03-06 10:01:38,950][root][INFO] - Processing question number 0
[2025-03-06 10:01:38,952][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:01:45,408][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:01:51,790][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:01:57,523][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:02:05,114][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:02:10,487][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:02:17,717][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:02:28,979][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:02:36,489][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:02:42,739][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:02:47,950][root][INFO] - Processing question number 10
[2025-03-06 10:02:47,951][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:02:55,440][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:02:59,785][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:03:03,819][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:03:12,242][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:03:20,047][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:03:26,614][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:03:33,764][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:03:38,558][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:03:43,264][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:03:47,963][root][INFO] - Processing question number 20
[2025-03-06 10:03:47,965][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:03:53,872][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:04:01,133][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:04:08,339][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:04:14,025][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:04:20,236][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:04:31,615][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:04:38,405][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:04:44,183][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:04:50,480][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:04:56,025][root][INFO] - Processing question number 30
[2025-03-06 10:04:56,027][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:05:01,920][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:05:07,084][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:05:14,448][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:05:22,170][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:05:28,802][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:05:34,176][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:05:38,925][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:05:45,299][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:05:52,191][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:05:56,983][root][INFO] - Processing question number 40
[2025-03-06 10:05:56,986][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:06:03,256][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:06:09,654][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:06:17,891][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:06:23,840][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:06:32,018][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:06:38,727][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:06:45,894][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:06:50,079][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:06:56,723][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:07:00,623][root][INFO] - Processing question number 50
[2025-03-06 10:07:00,625][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:07:07,830][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:07:15,317][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:07:20,904][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:07:31,244][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:07:38,230][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:07:42,854][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:07:53,825][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:07:59,924][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:08:05,596][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:08:10,748][root][INFO] - Processing question number 60
[2025-03-06 10:08:10,751][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:08:17,618][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:08:21,424][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:08:29,780][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:08:36,276][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:08:41,354][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:08:50,057][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:08:58,181][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:09:06,124][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:09:10,392][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:09:16,361][root][INFO] - Processing question number 70
[2025-03-06 10:09:16,364][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:09:23,858][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:09:29,773][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:09:34,349][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:09:43,286][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:09:48,963][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:09:55,737][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:10:02,789][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:10:07,859][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:10:12,298][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:10:18,208][root][INFO] - Processing question number 80
[2025-03-06 10:10:18,212][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:10:26,349][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:10:32,725][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:10:38,628][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:10:44,723][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:10:52,000][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:10:58,488][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:11:06,668][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:11:15,607][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:11:22,871][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:11:29,754][root][INFO] - Processing question number 90
[2025-03-06 10:11:29,758][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:11:35,202][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:11:39,988][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:11:45,686][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:11:49,126][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:11:56,442][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:12:01,418][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:12:06,927][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:12:13,495][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:12:19,648][root][INFO] - Inference complete
[2025-03-06 10:12:19,649][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,654][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,664][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,668][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,668][root][INFO] - Saved parsed outputs
[2025-03-06 10:12:19,668][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,669][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,669][root][INFO] - Saved parsing metadata
[2025-03-06 10:12:19,670][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,671][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:12:19,672][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:12:19,718][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 10:12:19,718][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.0, 'malformed_label': 16, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 44, 'both_wrong': 55}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 10:12:26,715][root][INFO] - Setting global seed to 206
[2025-03-06 10:12:26,721][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:12:26,723][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:12:26,724][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:12:26,725][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:12:26,728][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:12:26,728][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:12:26,870][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:12:27,420][root][INFO] - Full model selected, loading model
[2025-03-06 10:12:43,686][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:14:26,925][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:14:26,926][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:15:02,436][root][INFO] - Peft model loaded successfully
[2025-03-06 10:15:09,915][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:15:09,916][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:15:09,916][root][INFO] - Starting inference
[2025-03-06 10:15:10,082][root][INFO] - Processing question number 0
[2025-03-06 10:15:10,084][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:15:15,128][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:15:43,976][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:15:49,899][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:16:02,406][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:16:11,149][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:16:24,728][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:16:29,351][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:16:41,935][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:16:49,470][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:16:54,412][root][INFO] - Processing question number 10
[2025-03-06 10:16:54,413][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:17:03,973][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:17:13,281][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:17:18,708][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:17:26,327][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:17:45,035][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:17:55,129][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:18:03,298][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:18:09,778][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:18:17,310][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:18:23,041][root][INFO] - Processing question number 20
[2025-03-06 10:18:23,044][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:18:33,082][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:18:38,622][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:18:47,538][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:18:57,790][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:19:02,835][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:19:12,741][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:19:17,395][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:19:45,939][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:19:55,510][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:20:00,123][root][INFO] - Processing question number 30
[2025-03-06 10:20:00,125][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:20:28,690][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:20:31,620][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:20:39,602][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:20:46,301][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:20:49,832][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:20:56,895][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:21:15,982][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:21:25,126][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:21:41,802][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:21:52,045][root][INFO] - Processing question number 40
[2025-03-06 10:21:52,048][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:22:15,130][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:22:28,421][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:22:36,550][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:22:48,618][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:22:56,046][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:23:01,355][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:23:06,943][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:23:11,614][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:23:15,691][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:23:20,408][root][INFO] - Processing question number 50
[2025-03-06 10:23:20,411][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:23:24,661][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:23:35,368][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:23:40,067][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:23:54,571][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:24:05,683][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:24:17,804][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:24:46,849][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:25:15,035][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:25:25,308][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:25:31,724][root][INFO] - Processing question number 60
[2025-03-06 10:25:31,728][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:25:40,666][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:25:45,320][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:25:52,505][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:26:02,995][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:26:12,024][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:26:16,647][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:26:23,232][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:26:30,878][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:26:49,055][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:26:55,954][root][INFO] - Processing question number 70
[2025-03-06 10:26:55,957][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:27:05,864][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:27:10,079][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:27:18,426][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:27:37,880][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:27:45,360][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:27:52,110][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:27:59,781][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:28:10,021][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:28:27,111][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:28:36,660][root][INFO] - Processing question number 80
[2025-03-06 10:28:36,664][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:28:52,289][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:29:01,155][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:29:10,996][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:29:19,939][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:29:35,663][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:29:41,019][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:29:54,248][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:30:07,927][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:30:36,560][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:30:44,007][root][INFO] - Processing question number 90
[2025-03-06 10:30:44,011][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:30:55,966][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:31:00,513][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:31:08,318][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:31:11,616][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:31:21,555][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:31:27,791][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:31:35,762][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:31:44,874][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:31:50,418][root][INFO] - Inference complete
[2025-03-06 10:31:50,419][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,423][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,424][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,425][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:50,425][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,425][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:31:50,426][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,426][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:31:50,426][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,428][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,429][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:50,429][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,429][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:31:50,429][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,430][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:50,430][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,430][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:31:50,430][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,431][root][WARNING] - |Q. 46||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:31:50,431][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,433][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,433][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:50,434][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,434][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:31:50,434][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,434][root][WARNING] - |Q. 5||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:50,434][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,434][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:31:50,438][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,438][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:50,438][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,438][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:31:50,438][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:50,439][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:50,439][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:50,439][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:31:50,440][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,444][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,444][root][INFO] - Saved parsed outputs
[2025-03-06 10:31:50,445][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,446][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,446][root][INFO] - Saved parsing metadata
[2025-03-06 10:31:50,446][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,448][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:31:50,449][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:31:50,456][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 10:31:50,456][root][INFO] - Summary of metrics : {'label_accuracy': 0.42424242424242425, 'misclassification_rate': 0.5757575757575757, 'combined_accuracy': 0.3333333333333333, 'malformed_label': 14, 'malformed_domain': 23, 'total_predictions': 99, 'correct_predictions': 42, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.14285714285714285, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.21212121212121213, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.21212121212121213, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 9, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 10:31:56,687][root][INFO] - Setting global seed to 206
[2025-03-06 10:31:56,692][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:31:56,693][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:31:56,694][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:31:56,695][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:31:56,697][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:31:56,697][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:31:56,843][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:31:57,383][root][INFO] - Full model selected, loading model
[2025-03-06 10:32:16,326][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:32:16,326][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:32:23,998][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:32:23,999][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:32:23,999][root][INFO] - Starting inference
[2025-03-06 10:32:24,158][root][INFO] - Processing question number 0
[2025-03-06 10:32:24,160][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:32:32,109][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:32:38,746][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:32:44,676][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:32:52,725][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:32:58,513][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:33:04,052][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:33:11,972][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:33:19,571][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:33:24,892][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:33:31,265][root][INFO] - Processing question number 10
[2025-03-06 10:33:31,266][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:33:37,668][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:33:46,140][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:33:50,326][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:33:59,784][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:34:02,896][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:34:09,470][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:34:16,839][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:34:21,860][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:34:27,243][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:34:31,988][root][INFO] - Processing question number 20
[2025-03-06 10:34:31,990][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:34:38,230][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:34:44,170][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:34:48,929][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:34:55,258][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:35:01,479][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:35:11,265][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:35:21,171][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:35:28,151][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:35:35,107][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:35:41,517][root][INFO] - Processing question number 30
[2025-03-06 10:35:41,519][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:35:46,922][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:35:52,688][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:36:00,403][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:36:07,655][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:36:13,890][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:36:20,491][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:36:27,013][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:36:33,638][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:36:38,353][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:36:42,545][root][INFO] - Processing question number 40
[2025-03-06 10:36:42,548][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:36:49,570][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:36:56,354][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:37:10,274][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:37:16,556][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:37:23,304][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:37:30,401][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:37:35,661][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:37:39,178][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:37:43,701][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:37:47,638][root][INFO] - Processing question number 50
[2025-03-06 10:37:47,640][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:37:52,859][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:38:00,140][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:38:06,231][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:38:14,350][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:38:26,362][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:38:31,346][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:38:39,978][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:38:45,375][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:38:52,209][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:38:57,364][root][INFO] - Processing question number 60
[2025-03-06 10:38:57,366][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:39:02,274][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:39:13,899][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:39:24,253][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:39:31,542][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:39:36,670][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:39:41,112][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:39:47,425][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:39:53,146][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:39:59,057][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:40:09,213][root][INFO] - Processing question number 70
[2025-03-06 10:40:09,216][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:40:17,194][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:40:23,492][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:40:28,112][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:40:34,183][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:40:39,867][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:40:43,967][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:40:53,131][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:41:00,826][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:41:05,258][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:41:11,962][root][INFO] - Processing question number 80
[2025-03-06 10:41:11,965][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:41:17,415][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:41:23,671][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:41:30,770][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:41:37,153][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:41:42,606][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:41:48,235][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:41:55,109][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:42:01,347][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:42:07,073][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:42:13,895][root][INFO] - Processing question number 90
[2025-03-06 10:42:13,899][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:42:20,835][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:42:25,180][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:42:36,086][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:42:39,517][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:42:47,137][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:42:51,001][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:42:57,882][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:43:04,425][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:43:10,460][root][INFO] - Inference complete
[2025-03-06 10:43:10,460][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,466][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,476][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,480][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,481][root][INFO] - Saved parsed outputs
[2025-03-06 10:43:10,481][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,482][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,482][root][INFO] - Saved parsing metadata
[2025-03-06 10:43:10,483][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,485][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:43:10,486][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:43:10,531][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 10:43:10,531][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.0, 'malformed_label': 17, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 41, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 10:43:17,424][root][INFO] - Setting global seed to 206
[2025-03-06 10:43:17,430][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:43:17,430][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:43:17,431][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:43:17,433][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:43:17,435][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:43:17,435][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:43:17,604][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:43:18,140][root][INFO] - Full model selected, loading model
[2025-03-06 10:43:34,967][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:45:18,032][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:45:18,033][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:45:56,100][root][INFO] - Peft model loaded successfully
[2025-03-06 10:46:03,606][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:46:03,607][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:46:03,607][root][INFO] - Starting inference
[2025-03-06 10:46:03,763][root][INFO] - Processing question number 0
[2025-03-06 10:46:03,765][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:46:10,761][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:46:16,241][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:46:22,574][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:46:35,189][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:46:47,448][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:46:59,446][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:47:10,342][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:47:18,298][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:47:25,291][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:47:29,871][root][INFO] - Processing question number 10
[2025-03-06 10:47:29,873][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:47:37,278][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:47:49,948][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:48:03,240][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:48:13,063][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:48:22,770][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:48:30,045][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:48:38,636][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:48:42,896][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:48:48,147][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:48:52,488][root][INFO] - Processing question number 20
[2025-03-06 10:48:52,490][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:49:03,278][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:49:07,273][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:49:13,384][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:49:20,122][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:49:30,183][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:49:51,066][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:49:59,845][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:50:10,888][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:50:22,793][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:50:30,740][root][INFO] - Processing question number 30
[2025-03-06 10:50:30,743][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:50:38,946][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:50:47,724][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:50:57,657][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:51:08,829][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:51:16,948][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:51:27,934][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:51:35,197][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:51:45,190][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:51:52,796][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:52:01,074][root][INFO] - Processing question number 40
[2025-03-06 10:52:01,076][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:52:06,951][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:52:13,787][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:52:26,196][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:52:43,289][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:52:54,500][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:53:01,143][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:53:13,364][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:53:22,986][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:53:30,803][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:53:36,536][root][INFO] - Processing question number 50
[2025-03-06 10:53:36,539][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:53:47,148][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:53:57,118][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:54:04,745][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:54:34,165][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:54:41,956][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:54:57,542][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:55:05,702][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:55:12,091][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:55:17,269][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:55:23,596][root][INFO] - Processing question number 60
[2025-03-06 10:55:23,600][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:55:37,212][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:55:41,374][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:55:48,532][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:55:59,965][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:56:07,772][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:56:12,614][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:56:17,359][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:56:26,314][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:56:31,720][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:56:38,447][root][INFO] - Processing question number 70
[2025-03-06 10:56:38,451][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:56:45,430][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:56:49,738][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:56:56,626][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:57:09,272][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:57:15,787][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:57:28,188][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:57:46,630][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:57:58,992][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:58:08,565][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:58:19,415][root][INFO] - Processing question number 80
[2025-03-06 10:58:19,418][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:58:40,495][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:58:49,320][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:58:55,282][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:59:05,709][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:59:15,811][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:59:22,322][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:59:26,442][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:59:31,370][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:59:48,565][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:59:56,293][root][INFO] - Processing question number 90
[2025-03-06 10:59:56,296][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:00:09,463][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:00:14,056][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:00:19,856][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:00:23,733][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:00:43,849][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:00:48,388][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:00:54,586][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:01:07,249][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:01:17,108][root][INFO] - Inference complete
[2025-03-06 11:01:17,109][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,119][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,120][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:17,120][root][WARNING] - |Q. 28||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:01:17,121][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:17,121][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:17,122][root][WARNING] - |Q. 77||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:01:17,122][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:17,123][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:17,123][root][WARNING] - |Q. 65||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:01:17,124][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:17,125][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:17,125][root][WARNING] - |Q. 46||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:01:17,125][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:17,126][root][WARNING] - |Q. 81||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:17,126][root][WARNING] - |Q. 81||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:01:17,126][root][INFO] - |Q. 81||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:17,126][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:17,126][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:01:17,126][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:17,128][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:01:17,128][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:01:17,128][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:01:17,129][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:01:17,134][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,138][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,138][root][INFO] - Saved parsed outputs
[2025-03-06 11:01:17,138][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,140][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,140][root][INFO] - Saved parsing metadata
[2025-03-06 11:01:17,140][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,141][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:17,143][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:01:17,156][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:01:17,156][root][INFO] - Summary of metrics : {'label_accuracy': 0.45454545454545453, 'misclassification_rate': 0.5454545454545454, 'combined_accuracy': 0.35353535353535354, 'malformed_label': 11, 'malformed_domain': 27, 'total_predictions': 99, 'correct_predictions': 45, 'correct_label_and_domain': 35, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.38461538461538464, 'Evidence_accuracy': 0.6666666666666666, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.125, 'Constitutional_Law_confidence': 0.15151515151515152, 'Contracts_confidence': 0.21212121212121213, 'Criminal_Law_confidence': 0.1111111111111111, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.21212121212121213, 'Civil_Procedure_confidence': 0.1111111111111111, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 10, 'both_wrong': 17}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 11:01:23,543][root][INFO] - Setting global seed to 206
[2025-03-06 11:01:23,548][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:01:23,548][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:01:23,549][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:01:23,551][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:01:23,553][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:01:23,553][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:01:23,702][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:01:24,267][root][INFO] - Full model selected, loading model
[2025-03-06 11:01:42,021][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:01:42,021][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:01:49,635][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:01:49,636][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:01:49,636][root][INFO] - Starting inference
[2025-03-06 11:01:49,788][root][INFO] - Processing question number 0
[2025-03-06 11:01:49,790][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:01:56,294][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:02:01,676][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:02:14,542][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:02:19,672][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:02:25,225][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:02:34,216][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:02:45,671][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:02:50,375][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:02:55,559][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:03:01,369][root][INFO] - Processing question number 10
[2025-03-06 11:03:01,371][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:03:06,725][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:03:11,380][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:03:15,902][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:03:23,656][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:03:27,850][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:03:38,406][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:03:47,581][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:03:51,699][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:03:56,904][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:04:02,955][root][INFO] - Processing question number 20
[2025-03-06 11:04:02,957][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:04:08,510][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:04:14,826][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:04:20,884][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:04:31,261][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:04:40,289][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:04:48,408][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:04:58,823][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:05:05,797][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:05:14,905][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:05:24,673][root][INFO] - Processing question number 30
[2025-03-06 11:05:24,675][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:05:34,342][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:05:41,575][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:05:48,221][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:05:55,192][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:06:01,698][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:06:10,845][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:06:15,999][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:06:21,786][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:06:28,462][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:06:33,665][root][INFO] - Processing question number 40
[2025-03-06 11:06:33,667][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:06:37,703][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:06:43,060][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:06:55,312][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:07:00,395][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:07:06,233][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:07:11,812][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:07:20,734][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:07:25,315][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:07:31,882][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:07:35,632][root][INFO] - Processing question number 50
[2025-03-06 11:07:35,634][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:07:43,833][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:07:48,538][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:07:55,930][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:08:05,502][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:08:13,054][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:08:19,505][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:08:27,005][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:08:32,575][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:08:40,138][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:08:45,800][root][INFO] - Processing question number 60
[2025-03-06 11:08:45,803][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:08:50,122][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:08:56,858][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:09:04,278][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:09:11,569][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:09:18,291][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:09:25,100][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:09:32,187][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:09:38,730][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:09:44,272][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:09:50,849][root][INFO] - Processing question number 70
[2025-03-06 11:09:50,852][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:09:57,957][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:10:01,989][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:10:06,875][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:10:18,003][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:10:25,612][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:10:30,155][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:10:41,429][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:10:51,154][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:10:58,075][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:11:03,385][root][INFO] - Processing question number 80
[2025-03-06 11:11:03,389][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:11:11,106][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:11:18,287][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:11:24,238][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:11:29,487][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:11:37,309][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:11:43,532][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:11:52,623][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:11:59,629][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:12:05,535][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:12:13,391][root][INFO] - Processing question number 90
[2025-03-06 11:12:13,395][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:12:23,238][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:12:29,232][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:12:36,167][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:12:41,379][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:12:49,406][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:12:55,913][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:13:01,110][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:13:06,640][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:13:13,636][root][INFO] - Inference complete
[2025-03-06 11:13:13,636][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,642][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,652][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,657][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,657][root][INFO] - Saved parsed outputs
[2025-03-06 11:13:13,657][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,658][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,658][root][INFO] - Saved parsing metadata
[2025-03-06 11:13:13,659][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,660][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:13:13,662][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:13:13,680][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:13:13,681][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.0, 'malformed_label': 14, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 44, 'both_wrong': 55}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 11:13:20,533][root][INFO] - Setting global seed to 989
[2025-03-06 11:13:20,538][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:13:20,538][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:13:20,540][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:13:20,541][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:13:20,544][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:13:20,544][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:13:20,689][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:13:21,267][root][INFO] - Full model selected, loading model
[2025-03-06 11:13:37,151][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:15:18,063][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:15:18,108][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:15:54,402][root][INFO] - Peft model loaded successfully
[2025-03-06 11:16:01,795][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:16:01,796][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:16:01,797][root][INFO] - Starting inference
[2025-03-06 11:16:01,950][root][INFO] - Processing question number 0
[2025-03-06 11:16:01,952][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:16:13,178][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:16:23,986][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:16:29,457][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:16:40,184][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:16:47,070][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:17:15,302][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:17:21,725][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:17:37,454][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:17:45,167][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:17:49,845][root][INFO] - Processing question number 10
[2025-03-06 11:17:49,846][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:17:56,097][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:18:13,190][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:18:41,458][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:18:51,288][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:18:59,283][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:19:11,031][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:19:17,653][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:19:21,295][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:19:26,956][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:19:30,813][root][INFO] - Processing question number 20
[2025-03-06 11:19:30,815][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:19:39,138][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:19:46,957][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:19:52,967][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:20:00,002][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:20:04,675][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:20:16,353][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:20:20,572][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:20:28,314][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:20:38,907][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:20:46,380][root][INFO] - Processing question number 30
[2025-03-06 11:20:46,382][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:21:04,813][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:21:13,886][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:21:20,758][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:21:27,135][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:21:36,042][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:21:46,184][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:22:01,069][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:22:12,186][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:22:30,728][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:22:43,379][root][INFO] - Processing question number 40
[2025-03-06 11:22:43,382][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:22:55,826][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:23:02,692][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:23:19,234][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:23:36,279][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:23:45,061][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:23:52,837][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:23:58,058][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:24:02,827][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:24:06,781][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:24:11,463][root][INFO] - Processing question number 50
[2025-03-06 11:24:11,466][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:24:17,977][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:24:46,476][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:24:51,804][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:24:59,213][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:25:07,902][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:25:15,334][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:25:24,825][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:25:34,643][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:25:55,374][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:26:01,743][root][INFO] - Processing question number 60
[2025-03-06 11:26:01,746][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:26:14,640][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:26:19,753][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:26:27,025][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:26:35,707][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:26:42,114][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:26:47,516][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:26:51,519][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:26:58,703][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:27:05,891][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:27:12,515][root][INFO] - Processing question number 70
[2025-03-06 11:27:12,518][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:27:18,619][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:27:22,847][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:27:31,635][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:27:50,336][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:27:59,274][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:28:08,380][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:28:20,366][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:28:38,141][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:28:53,110][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:29:01,947][root][INFO] - Processing question number 80
[2025-03-06 11:29:01,951][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:29:15,726][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:29:25,779][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:29:31,110][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:29:43,250][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:29:53,505][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:30:04,541][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:30:09,493][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:30:17,635][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:30:46,057][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:30:56,308][root][INFO] - Processing question number 90
[2025-03-06 11:30:56,312][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:31:05,991][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:31:33,576][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:32:01,888][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:32:05,293][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:32:12,391][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:32:19,256][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:32:26,805][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:32:30,899][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:32:43,154][root][INFO] - Inference complete
[2025-03-06 11:32:43,154][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,160][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,161][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,162][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:32:43,162][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,162][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:32:43,163][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,163][root][WARNING] - |Q. 42||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:32:43,163][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,163][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,163][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:32:43,163][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,164][root][WARNING] - |Q. 77||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,164][root][WARNING] - |Q. 77||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:32:43,164][root][INFO] - |Q. 77||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,164][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:32:43,169][root][WARNING] - |Q. 62||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,169][root][WARNING] - |Q. 62||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:32:43,169][root][INFO] - |Q. 62||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,169][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:32:43,174][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,174][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:32:43,174][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,174][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:32:43,175][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,175][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:32:43,175][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,175][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:32:43,175][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:32:43,176][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:32:43,176][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:32:43,176][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:32:43,177][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,181][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,181][root][INFO] - Saved parsed outputs
[2025-03-06 11:32:43,182][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,183][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,183][root][INFO] - Saved parsing metadata
[2025-03-06 11:32:43,184][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,185][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:32:43,187][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:32:43,230][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:32:43,230][root][INFO] - Summary of metrics : {'label_accuracy': 0.43434343434343436, 'misclassification_rate': 0.5656565656565656, 'combined_accuracy': 0.32323232323232326, 'malformed_label': 16, 'malformed_domain': 24, 'total_predictions': 99, 'correct_predictions': 43, 'correct_label_and_domain': 32, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.35714285714285715, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.1414141414141414, 'Contracts_confidence': 0.2222222222222222, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.21212121212121213, 'Civil_Procedure_confidence': 0.13131313131313133, 'correct_domain_wrong_label': 43, 'correct_label_wrong_domain': 11, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 11:32:51,357][root][INFO] - Setting global seed to 989
[2025-03-06 11:32:51,365][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:32:51,365][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:32:51,366][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:32:51,388][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:32:51,393][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:32:51,393][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:32:51,544][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:32:52,083][root][INFO] - Full model selected, loading model
[2025-03-06 11:33:09,131][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:33:09,131][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:33:16,754][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:33:16,756][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:33:16,756][root][INFO] - Starting inference
[2025-03-06 11:33:16,904][root][INFO] - Processing question number 0
[2025-03-06 11:33:16,906][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:33:23,218][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:33:29,597][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:33:35,328][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:33:42,913][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:33:48,281][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:33:55,506][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:34:06,765][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:34:14,274][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:34:20,526][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:34:25,738][root][INFO] - Processing question number 10
[2025-03-06 11:34:25,739][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:34:33,222][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:34:37,570][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:34:41,603][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:34:50,026][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:34:57,831][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:35:04,404][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:35:11,557][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:35:16,351][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:35:21,061][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:35:25,773][root][INFO] - Processing question number 20
[2025-03-06 11:35:25,774][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:35:31,720][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:35:39,043][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:35:46,306][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:35:52,029][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:35:58,289][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:36:09,764][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:36:16,602][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:36:22,428][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:36:28,733][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:36:34,287][root][INFO] - Processing question number 30
[2025-03-06 11:36:34,289][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:36:40,221][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:36:45,431][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:36:52,855][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:37:00,644][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:37:07,321][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:37:12,710][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:37:17,467][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:37:23,853][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:37:30,777][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:37:35,592][root][INFO] - Processing question number 40
[2025-03-06 11:37:35,594][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:37:41,913][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:37:48,361][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:37:56,659][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:38:02,655][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:38:10,863][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:38:17,569][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:38:24,729][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:38:28,915][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:38:35,553][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:38:39,449][root][INFO] - Processing question number 50
[2025-03-06 11:38:39,451][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:38:46,651][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:38:54,154][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:38:59,782][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:39:10,190][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:39:17,213][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:39:21,853][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:39:32,817][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:39:38,917][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:39:44,587][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:39:49,739][root][INFO] - Processing question number 60
[2025-03-06 11:39:49,742][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:39:56,608][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:40:00,411][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:40:08,763][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:40:15,261][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:40:20,335][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:40:29,038][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:40:37,154][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:40:45,095][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:40:49,362][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:40:55,353][root][INFO] - Processing question number 70
[2025-03-06 11:40:55,356][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:41:02,844][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:41:08,757][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:41:13,330][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:41:22,269][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:41:27,941][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:41:34,714][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:41:41,758][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:41:46,827][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:41:51,261][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:41:57,170][root][INFO] - Processing question number 80
[2025-03-06 11:41:57,173][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:42:05,303][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:42:11,675][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:42:17,575][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:42:23,669][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:42:30,943][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:42:37,430][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:42:45,618][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:42:54,556][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:43:01,813][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:43:08,697][root][INFO] - Processing question number 90
[2025-03-06 11:43:08,701][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:43:14,141][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:43:18,929][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:43:24,619][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:43:28,062][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:43:35,373][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:43:40,351][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:43:45,855][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:43:52,416][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:43:58,567][root][INFO] - Inference complete
[2025-03-06 11:43:58,567][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,571][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,582][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,586][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,586][root][INFO] - Saved parsed outputs
[2025-03-06 11:43:58,586][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,587][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,588][root][INFO] - Saved parsing metadata
[2025-03-06 11:43:58,588][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,589][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:43:58,591][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:43:58,620][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:43:58,620][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.0, 'malformed_label': 16, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 44, 'both_wrong': 55}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 11:44:05,809][root][INFO] - Setting global seed to 989
[2025-03-06 11:44:05,816][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:44:05,816][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:44:05,817][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:44:05,819][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:44:05,822][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:44:05,822][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:44:05,969][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:44:06,510][root][INFO] - Full model selected, loading model
[2025-03-06 11:44:27,035][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:46:09,989][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:46:09,989][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:46:43,385][root][INFO] - Peft model loaded successfully
[2025-03-06 11:46:51,265][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:46:51,267][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:46:51,267][root][INFO] - Starting inference
[2025-03-06 11:46:51,453][root][INFO] - Processing question number 0
[2025-03-06 11:46:51,455][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:46:58,769][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:47:11,364][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:47:16,744][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:47:30,433][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:47:37,579][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:48:05,957][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:48:12,843][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:48:23,149][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:48:33,077][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:48:37,980][root][INFO] - Processing question number 10
[2025-03-06 11:48:37,982][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:48:44,337][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:49:06,767][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:49:15,959][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:49:25,871][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:49:37,491][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:49:46,493][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:49:54,944][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:50:02,999][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:50:08,343][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:50:13,853][root][INFO] - Processing question number 20
[2025-03-06 11:50:13,855][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:50:18,377][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:50:22,777][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:50:30,332][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:50:38,244][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:50:45,205][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:50:59,600][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:51:06,310][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:51:12,790][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:51:23,848][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:51:28,195][root][INFO] - Processing question number 30
[2025-03-06 11:51:28,197][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:51:56,794][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:52:05,902][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:52:14,220][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:52:20,562][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:52:27,535][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:52:34,926][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:52:44,163][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:52:50,270][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:53:02,805][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:53:14,144][root][INFO] - Processing question number 40
[2025-03-06 11:53:14,146][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:53:25,809][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:53:34,716][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:53:53,773][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:54:03,031][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:54:15,497][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:54:22,459][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:54:27,298][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:54:32,957][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:54:36,944][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:54:41,529][root][INFO] - Processing question number 50
[2025-03-06 11:54:41,532][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:54:48,429][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:54:59,475][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:55:04,850][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:55:11,090][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:55:23,291][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:55:39,585][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:55:49,576][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:55:55,244][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:56:21,714][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:56:33,194][root][INFO] - Processing question number 60
[2025-03-06 11:56:33,197][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:56:40,725][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:56:51,608][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:56:58,986][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:57:03,662][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:57:10,031][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:57:18,919][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:57:26,063][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:57:31,603][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:57:35,915][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:57:42,331][root][INFO] - Processing question number 70
[2025-03-06 11:57:42,335][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:57:47,118][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:57:56,929][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:58:01,537][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:58:16,490][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:58:25,105][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:58:32,144][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:58:38,106][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:58:52,656][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:59:02,640][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:59:19,344][root][INFO] - Processing question number 80
[2025-03-06 11:59:19,348][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:59:27,298][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:59:44,467][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:59:54,497][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:00:00,875][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:00:10,304][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:00:17,702][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:00:22,588][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:00:42,312][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:01:10,942][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:01:18,258][root][INFO] - Processing question number 90
[2025-03-06 12:01:18,262][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:01:29,094][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:01:34,932][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:01:39,866][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:01:43,162][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:01:54,614][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:02:00,898][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:02:08,505][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:02:13,126][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:02:19,914][root][INFO] - Inference complete
[2025-03-06 12:02:19,914][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,919][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,921][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:02:19,921][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:02:19,922][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:02:19,922][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:02:19,922][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:02:19,922][root][WARNING] - |Q. 49||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:02:19,922][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:02:19,925][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:02:19,925][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:02:19,926][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:02:19,926][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:02:19,932][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:02:19,932][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:02:19,932][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:02:19,932][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:02:19,934][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,938][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,939][root][INFO] - Saved parsed outputs
[2025-03-06 12:02:19,939][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,940][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,940][root][INFO] - Saved parsing metadata
[2025-03-06 12:02:19,941][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,942][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:02:19,943][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:02:19,957][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:02:19,957][root][INFO] - Summary of metrics : {'label_accuracy': 0.43434343434343436, 'misclassification_rate': 0.5656565656565656, 'combined_accuracy': 0.31313131313131315, 'malformed_label': 17, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 43, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.2857142857142857, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.5384615384615384, 'Civil_Procedure_accuracy': 0.1875, 'Constitutional_Law_confidence': 0.15151515151515152, 'Contracts_confidence': 0.20202020202020202, 'Criminal_Law_confidence': 0.10101010101010101, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.020202020202020204, 'Torts_confidence': 0.21212121212121213, 'Civil_Procedure_confidence': 0.12121212121212122, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 12, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 12:02:29,098][root][INFO] - Setting global seed to 989
[2025-03-06 12:02:29,105][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:02:29,105][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:02:29,107][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:02:29,108][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:02:29,110][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:02:29,111][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:02:29,282][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:02:29,824][root][INFO] - Full model selected, loading model
[2025-03-06 12:02:54,929][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:02:54,942][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:03:02,966][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:03:02,967][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:03:02,968][root][INFO] - Starting inference
[2025-03-06 12:03:03,115][root][INFO] - Processing question number 0
[2025-03-06 12:03:03,117][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:03:11,300][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:03:16,645][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:03:45,135][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:03:51,697][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:03:58,941][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:04:06,145][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:04:15,396][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:04:20,282][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:04:24,969][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:04:29,317][root][INFO] - Processing question number 10
[2025-03-06 12:04:29,319][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:04:35,952][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:04:40,295][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:04:44,231][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:04:55,261][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:04:59,774][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:05:07,989][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:05:15,886][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:05:20,727][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:05:25,654][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:05:30,127][root][INFO] - Processing question number 20
[2025-03-06 12:05:30,129][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:05:39,983][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:05:48,417][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:05:53,894][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:06:01,124][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:06:07,756][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:06:13,587][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:06:20,997][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:06:30,040][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:06:36,714][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:06:42,313][root][INFO] - Processing question number 30
[2025-03-06 12:06:42,316][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:06:52,079][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:06:57,246][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:07:04,308][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:07:10,503][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:07:15,919][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:07:22,054][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:07:29,213][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:07:36,797][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:07:43,340][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:07:50,816][root][INFO] - Processing question number 40
[2025-03-06 12:07:50,818][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:07:57,558][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:08:04,129][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:08:12,625][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:08:17,613][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:08:26,467][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:08:32,740][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:08:38,278][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:08:44,388][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:08:49,272][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:08:53,343][root][INFO] - Processing question number 50
[2025-03-06 12:08:53,346][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:08:58,561][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:09:06,162][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:09:10,769][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:09:20,536][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:09:30,441][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:09:39,011][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:09:50,080][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:09:55,653][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:10:01,558][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:10:07,317][root][INFO] - Processing question number 60
[2025-03-06 12:10:07,320][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:10:14,297][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:10:19,174][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:10:27,097][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:10:31,232][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:10:36,359][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:10:41,980][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:10:49,620][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:10:55,520][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:11:01,426][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:11:07,908][root][INFO] - Processing question number 70
[2025-03-06 12:11:07,911][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:11:15,428][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:11:22,407][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:11:26,440][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:11:33,158][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:11:39,484][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:11:43,177][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:11:51,119][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:11:57,752][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:12:01,814][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:12:08,835][root][INFO] - Processing question number 80
[2025-03-06 12:12:08,839][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:12:13,094][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:12:20,080][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:12:28,229][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:12:33,298][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:12:39,917][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:12:44,956][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:12:51,594][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:12:56,740][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:13:02,740][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:13:08,928][root][INFO] - Processing question number 90
[2025-03-06 12:13:08,931][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:13:16,005][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:13:20,976][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:13:29,062][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:13:34,097][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:13:41,385][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:13:46,007][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:13:52,289][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:14:00,112][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:14:05,771][root][INFO] - Inference complete
[2025-03-06 12:14:05,771][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,776][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,777][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:14:05,777][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:14:05,778][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:14:05,778][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:14:05,787][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,792][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,792][root][INFO] - Saved parsed outputs
[2025-03-06 12:14:05,792][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,794][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,794][root][INFO] - Saved parsing metadata
[2025-03-06 12:14:05,795][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,796][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:14:05,797][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:14:05,835][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:14:05,835][root][INFO] - Summary of metrics : {'label_accuracy': 0.42424242424242425, 'misclassification_rate': 0.5757575757575757, 'combined_accuracy': 0.0, 'malformed_label': 16, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 57}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 12:14:13,114][root][INFO] - Setting global seed to 989
[2025-03-06 12:14:13,121][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:14:13,121][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:14:13,123][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:14:13,124][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:14:13,127][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:14:13,127][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:14:13,273][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:14:14,104][root][INFO] - Full model selected, loading model
[2025-03-06 12:14:35,368][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:16:18,554][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:16:18,555][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:16:53,251][root][INFO] - Peft model loaded successfully
[2025-03-06 12:17:01,128][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:17:01,130][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:17:01,130][root][INFO] - Starting inference
[2025-03-06 12:17:01,311][root][INFO] - Processing question number 0
[2025-03-06 12:17:01,314][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:17:08,256][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:17:14,013][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:17:30,366][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:17:59,138][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:18:07,656][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:18:21,251][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:18:50,224][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:18:56,026][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:19:02,659][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:19:15,316][root][INFO] - Processing question number 10
[2025-03-06 12:19:15,317][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:19:30,727][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:19:42,800][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:19:47,014][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:20:00,365][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:20:12,319][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:20:19,280][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:20:27,777][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:20:33,534][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:20:38,295][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:20:43,942][root][INFO] - Processing question number 20
[2025-03-06 12:20:43,944][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:20:47,704][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:20:53,205][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:21:04,381][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:21:11,122][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:21:19,052][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:21:29,766][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:21:38,642][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:21:47,050][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:21:54,973][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:22:02,834][root][INFO] - Processing question number 30
[2025-03-06 12:22:02,836][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:22:16,398][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:22:26,128][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:22:33,186][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:22:39,489][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:22:44,778][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:22:57,664][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:23:10,734][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:23:21,913][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:23:36,570][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:23:47,675][root][INFO] - Processing question number 40
[2025-03-06 12:23:47,677][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:23:56,455][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:24:09,430][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:24:26,850][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:24:41,932][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:24:56,180][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:25:04,940][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:25:11,941][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:25:18,900][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:25:31,020][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:25:49,906][root][INFO] - Processing question number 50
[2025-03-06 12:25:49,909][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:25:57,271][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:26:15,723][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:26:25,449][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:26:31,968][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:26:41,330][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:26:53,786][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:27:02,185][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:27:08,846][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:27:16,144][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:27:29,659][root][INFO] - Processing question number 60
[2025-03-06 12:27:29,662][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:27:47,390][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:27:52,766][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:28:02,684][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:28:12,439][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:28:18,452][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:28:28,536][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:28:33,214][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:28:40,100][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:28:47,313][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:28:56,047][root][INFO] - Processing question number 70
[2025-03-06 12:28:56,050][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:29:07,915][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:29:15,557][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:29:22,522][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:29:28,889][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:29:57,146][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:30:04,376][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:30:11,096][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:30:19,478][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:30:38,851][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:30:43,334][root][INFO] - Processing question number 80
[2025-03-06 12:30:43,337][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:30:51,414][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:31:04,418][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:31:13,532][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:31:26,334][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:31:39,693][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:31:49,788][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:31:59,603][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:32:04,172][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:32:27,649][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:32:40,472][root][INFO] - Processing question number 90
[2025-03-06 12:32:40,476][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:33:03,230][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:33:07,645][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:33:18,369][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:33:21,493][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:33:43,470][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:33:50,484][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:34:01,829][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:34:09,661][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:34:22,301][root][INFO] - Inference complete
[2025-03-06 12:34:22,302][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,306][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,307][root][WARNING] - |Q. 7||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:34:22,308][root][WARNING] - |Q. 7||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:34:22,308][root][INFO] - |Q. 7||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:34:22,308][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:34:22,309][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:34:22,309][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:34:22,309][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:34:22,309][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:34:22,310][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:34:22,310][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:34:22,310][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:34:22,310][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:34:22,311][root][WARNING] - |Q. 70||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:34:22,311][root][WARNING] - |Q. 70||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:34:22,311][root][INFO] - |Q. 70||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:34:22,315][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:34:22,315][root][WARNING] - |Q. 88||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:34:22,315][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:34:22,321][root][WARNING] - |Q. 45||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:34:22,321][root][WARNING] - |Q. 45||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:34:22,321][root][INFO] - |Q. 45||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:34:22,321][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:34:22,323][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,327][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,327][root][INFO] - Saved parsed outputs
[2025-03-06 12:34:22,327][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,329][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,329][root][INFO] - Saved parsing metadata
[2025-03-06 12:34:22,330][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,331][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:22,332][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:34:22,346][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:34:22,346][root][INFO] - Summary of metrics : {'label_accuracy': 0.41414141414141414, 'misclassification_rate': 0.5858585858585859, 'combined_accuracy': 0.31313131313131315, 'malformed_label': 12, 'malformed_domain': 26, 'total_predictions': 99, 'correct_predictions': 41, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.2857142857142857, 'Contracts_accuracy': 0.42857142857142855, 'Criminal_Law_accuracy': 0.23076923076923078, 'Evidence_accuracy': 0.6, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.3076923076923077, 'Civil_Procedure_accuracy': 0.25, 'Constitutional_Law_confidence': 0.13131313131313133, 'Contracts_confidence': 0.21212121212121213, 'Criminal_Law_confidence': 0.09090909090909091, 'Evidence_confidence': 0.1111111111111111, 'Real_Property_confidence': 0.030303030303030304, 'Torts_confidence': 0.1919191919191919, 'Civil_Procedure_confidence': 0.1414141414141414, 'correct_domain_wrong_label': 42, 'correct_label_wrong_domain': 10, 'both_wrong': 16}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 12:34:28,644][root][INFO] - Setting global seed to 989
[2025-03-06 12:34:28,650][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:34:28,650][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:34:28,651][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:34:28,653][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:34:28,655][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:34:28,655][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:34:28,827][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:34:29,356][root][INFO] - Full model selected, loading model
[2025-03-06 12:34:48,589][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:34:48,589][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:34:56,204][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:34:56,205][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:34:56,205][root][INFO] - Starting inference
[2025-03-06 12:34:56,349][root][INFO] - Processing question number 0
[2025-03-06 12:34:56,352][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:35:01,395][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:35:08,708][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:35:12,511][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:35:16,447][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:35:21,732][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:35:33,072][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:35:45,468][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:35:54,333][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:36:01,503][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:36:08,461][root][INFO] - Processing question number 10
[2025-03-06 12:36:08,462][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:36:15,861][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:36:21,320][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:36:26,835][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:36:39,606][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:36:44,670][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:36:51,040][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:36:57,861][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:37:06,353][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:37:10,241][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:37:15,565][root][INFO] - Processing question number 20
[2025-03-06 12:37:15,567][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:37:23,167][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:37:30,311][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:37:36,995][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:37:41,432][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:37:48,290][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:37:53,845][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:37:59,801][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:38:07,048][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:38:13,902][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:38:18,688][root][INFO] - Processing question number 30
[2025-03-06 12:38:18,691][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:38:25,412][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:38:31,264][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:38:38,138][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:38:47,953][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:38:52,826][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:38:59,970][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:39:05,254][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:39:11,914][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:39:17,490][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:39:22,506][root][INFO] - Processing question number 40
[2025-03-06 12:39:22,509][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:39:28,280][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:39:35,837][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:39:45,310][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:39:51,264][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:40:01,811][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:40:11,203][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:40:15,847][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:40:19,360][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:40:24,329][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:40:29,407][root][INFO] - Processing question number 50
[2025-03-06 12:40:29,409][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:40:38,169][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:40:45,211][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:40:50,575][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:40:55,216][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:41:02,031][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:41:09,693][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:41:16,275][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:41:24,776][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:41:30,956][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:41:35,809][root][INFO] - Processing question number 60
[2025-03-06 12:41:35,812][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:41:44,734][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:41:49,719][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:42:00,051][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:42:06,805][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:42:17,441][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:42:26,326][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:42:33,240][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:42:40,508][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:42:46,184][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:42:53,458][root][INFO] - Processing question number 70
[2025-03-06 12:42:53,461][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:42:59,288][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:43:03,081][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:43:09,929][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:43:15,982][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:43:20,982][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:43:26,930][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:43:35,596][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:43:41,484][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:43:47,198][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:43:54,508][root][INFO] - Processing question number 80
[2025-03-06 12:43:54,512][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:44:02,133][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:44:08,418][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:44:12,539][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:44:18,097][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:44:28,559][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:44:42,259][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:44:48,477][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:44:53,755][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:45:02,051][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:45:09,087][root][INFO] - Processing question number 90
[2025-03-06 12:45:09,091][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:45:15,597][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:45:22,837][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:45:32,435][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:45:35,995][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:45:42,541][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:45:48,462][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:45:53,839][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:46:01,151][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:46:11,353][root][INFO] - Inference complete
[2025-03-06 12:46:11,354][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,358][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,368][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,372][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,372][root][INFO] - Saved parsed outputs
[2025-03-06 12:46:11,373][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,374][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,374][root][INFO] - Saved parsing metadata
[2025-03-06 12:46:11,374][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,376][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:46:11,377][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:46:11,384][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:46:11,384][root][INFO] - Summary of metrics : {'label_accuracy': 0.37373737373737376, 'misclassification_rate': 0.6262626262626263, 'combined_accuracy': 0.0, 'malformed_label': 16, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 37, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 37, 'both_wrong': 62}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 12:46:17,641][root][INFO] - Setting global seed to 206
[2025-03-06 12:46:17,646][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 12:46:17,647][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:46:17,648][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 12:46:17,672][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:46:17,674][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:46:17,674][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 12:46:17,839][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:46:18,510][root][INFO] - Full model selected, loading model
[2025-03-06 12:46:41,400][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:48:24,785][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:48:24,786][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:49:00,606][root][INFO] - Peft model loaded successfully
[2025-03-06 12:49:08,548][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:49:08,549][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 12:49:08,550][root][INFO] - Starting inference
[2025-03-06 12:49:08,737][root][INFO] - Processing question number 0
[2025-03-06 12:49:08,739][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 12:49:15,430][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 12:49:21,512][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 12:49:30,282][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 12:49:37,965][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 12:49:52,049][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 12:50:03,073][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 12:50:09,166][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 12:50:17,885][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 12:50:25,477][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 12:50:32,807][root][INFO] - Processing question number 10
[2025-03-06 12:50:32,808][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 12:50:36,644][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 12:50:43,505][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 12:50:51,653][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 12:51:09,394][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 12:51:16,446][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 12:51:20,222][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:51:26,059][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 12:51:31,350][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 12:51:36,800][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 12:51:43,946][root][INFO] - Processing question number 20
[2025-03-06 12:51:43,947][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 12:51:48,225][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 12:51:52,398][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:51:58,303][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 12:52:02,433][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 12:52:11,474][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 12:52:40,012][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 12:52:46,387][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 12:52:54,150][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:53:00,067][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 12:53:07,116][root][INFO] - Processing question number 30
[2025-03-06 12:53:07,118][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 12:53:21,116][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 12:53:26,010][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 12:53:53,504][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 12:54:04,869][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 12:54:20,355][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 12:54:28,290][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:54:38,165][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 12:54:42,546][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:54:51,953][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 12:55:08,312][root][INFO] - Processing question number 40
[2025-03-06 12:55:08,314][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 12:55:16,157][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 12:55:24,333][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 12:55:32,752][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 12:55:38,357][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 12:55:51,518][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 12:55:57,462][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:56:02,747][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:56:08,283][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 12:56:12,331][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 12:56:18,085][root][INFO] - Processing question number 50
[2025-03-06 12:56:18,088][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 12:56:22,633][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 12:56:26,981][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 12:56:41,297][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:56:49,472][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 12:57:06,811][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 12:57:21,308][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 12:57:34,922][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 12:57:50,145][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 12:58:01,303][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 12:58:10,162][root][INFO] - Processing question number 60
[2025-03-06 12:58:10,165][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 12:58:17,375][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 12:58:21,912][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 12:58:32,701][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 12:58:41,560][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 12:58:51,172][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 12:58:56,819][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 12:59:03,410][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 12:59:11,018][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 12:59:23,876][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 12:59:32,785][root][INFO] - Processing question number 70
[2025-03-06 12:59:32,789][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 12:59:45,773][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:00:04,908][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:00:16,739][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:00:41,712][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:01:02,250][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:01:13,508][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:01:22,118][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:01:35,782][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:01:45,295][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:01:54,252][root][INFO] - Processing question number 80
[2025-03-06 13:01:54,270][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:01:58,988][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:02:09,379][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:02:16,663][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:02:26,130][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:02:55,238][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:03:23,457][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:03:33,328][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:03:42,254][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:03:49,614][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:04:02,294][root][INFO] - Processing question number 90
[2025-03-06 13:04:02,329][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:04:10,088][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:04:17,845][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:04:23,925][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:04:30,270][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:04:36,712][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:04:48,195][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:05:01,185][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:05:08,325][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:05:16,872][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:05:23,136][root][INFO] - Inference complete
[2025-03-06 13:05:23,137][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,142][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,145][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,146][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:05:23,146][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,146][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:05:23,148][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,148][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:05:23,148][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,148][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,149][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:05:23,149][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,151][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,152][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:05:23,152][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,152][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,152][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:05:23,152][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,153][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,153][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:05:23,153][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,154][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,154][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:05:23,155][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,155][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,156][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:05:23,156][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,156][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:05:23,156][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:05:23,157][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:05:23,157][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:05:23,157][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:05:23,159][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,163][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,163][root][INFO] - Saved parsed outputs
[2025-03-06 13:05:23,163][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,170][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,170][root][INFO] - Saved parsing metadata
[2025-03-06 13:05:23,171][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,172][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:05:23,176][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:05:23,231][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 13:05:23,232][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.34, 'malformed_label': 14, 'malformed_domain': 29, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.17, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.17, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 15, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 13:05:39,749][root][INFO] - Setting global seed to 206
[2025-03-06 13:05:39,757][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 13:05:39,757][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:05:39,758][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:05:39,776][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:05:39,780][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:05:39,781][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:05:39,933][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:05:40,503][root][INFO] - Full model selected, loading model
[2025-03-06 13:05:59,241][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:05:59,241][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:06:06,907][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:06:06,909][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:06:06,909][root][INFO] - Starting inference
[2025-03-06 13:06:07,061][root][INFO] - Processing question number 0
[2025-03-06 13:06:07,063][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:06:16,093][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:06:22,818][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:06:29,625][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:06:35,418][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:06:41,934][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:06:48,090][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:06:56,708][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:07:02,223][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:07:07,932][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:07:12,807][root][INFO] - Processing question number 10
[2025-03-06 13:07:12,809][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:07:17,739][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:07:24,902][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:07:32,350][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:07:38,007][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:07:47,552][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:07:53,605][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:07:58,526][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:08:05,331][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:08:10,725][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:08:17,532][root][INFO] - Processing question number 20
[2025-03-06 13:08:17,534][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:08:21,980][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:08:27,454][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:08:34,336][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:08:41,912][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:08:47,728][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:08:53,508][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:08:59,989][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:09:07,320][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:09:12,861][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:09:19,646][root][INFO] - Processing question number 30
[2025-03-06 13:09:19,648][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:09:26,307][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:09:31,711][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:09:36,005][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:09:42,290][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:09:46,940][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:09:53,589][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:09:59,398][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:10:06,570][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:10:10,829][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:10:16,228][root][INFO] - Processing question number 40
[2025-03-06 13:10:16,230][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:10:21,106][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:10:27,548][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:10:35,768][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:10:42,161][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:10:50,963][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:10:56,346][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:11:02,834][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:11:08,399][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:11:14,638][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:11:19,286][root][INFO] - Processing question number 50
[2025-03-06 13:11:19,289][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:11:26,692][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:11:30,149][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:11:36,775][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:11:44,110][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:11:52,424][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:11:59,681][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:12:09,262][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:12:14,913][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:12:25,090][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:12:34,438][root][INFO] - Processing question number 60
[2025-03-06 13:12:34,441][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:12:39,730][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:12:46,006][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 13:12:52,538][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 13:12:58,225][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 13:13:08,794][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 13:13:14,459][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 13:13:20,133][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 13:13:26,597][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 13:13:31,310][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 13:13:38,882][root][INFO] - Processing question number 70
[2025-03-06 13:13:38,885][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 13:13:42,569][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:13:47,890][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:13:53,335][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:14:00,507][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:14:04,611][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:14:09,547][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:14:17,713][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:14:23,441][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:14:28,725][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:14:32,823][root][INFO] - Processing question number 80
[2025-03-06 13:14:32,827][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:14:38,003][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:14:42,374][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:14:49,864][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:14:54,376][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:15:03,184][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:15:08,439][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:15:17,501][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:15:23,748][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:15:29,214][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:15:35,208][root][INFO] - Processing question number 90
[2025-03-06 13:15:35,212][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:15:40,525][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:15:48,869][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:15:57,678][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:16:02,538][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:16:10,350][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:16:17,343][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:16:21,298][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:16:28,820][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:16:35,542][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:16:42,027][root][INFO] - Inference complete
[2025-03-06 13:16:42,027][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,032][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,042][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,046][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,047][root][INFO] - Saved parsed outputs
[2025-03-06 13:16:42,047][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,055][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,055][root][INFO] - Saved parsing metadata
[2025-03-06 13:16:42,055][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,057][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:16:42,058][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:16:42,071][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 13:16:42,072][root][INFO] - Summary of metrics : {'label_accuracy': 0.42, 'misclassification_rate': 0.5800000000000001, 'combined_accuracy': 0.0, 'malformed_label': 6, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 13:16:49,319][root][INFO] - Setting global seed to 206
[2025-03-06 13:16:49,325][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 13:16:49,325][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:16:49,326][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:16:49,328][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:16:49,329][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:16:49,330][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:16:49,476][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:16:50,001][root][INFO] - Full model selected, loading model
[2025-03-06 13:17:08,586][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:18:50,941][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:18:50,941][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:19:29,680][root][INFO] - Peft model loaded successfully
[2025-03-06 13:19:37,153][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:19:37,155][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:19:37,155][root][INFO] - Starting inference
[2025-03-06 13:19:37,322][root][INFO] - Processing question number 0
[2025-03-06 13:19:37,324][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:19:50,420][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:19:59,299][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:20:13,236][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:20:32,755][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:20:50,017][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:20:59,896][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:21:28,506][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:21:34,884][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:21:40,967][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:21:48,473][root][INFO] - Processing question number 10
[2025-03-06 13:21:48,475][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:22:02,120][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:22:10,262][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:22:15,604][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:22:23,752][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:22:27,296][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:22:35,523][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:22:41,822][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:22:49,983][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:22:56,816][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:23:05,540][root][INFO] - Processing question number 20
[2025-03-06 13:23:05,543][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:23:15,662][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:23:23,215][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:23:30,261][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:23:39,480][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:23:46,952][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:24:04,952][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:24:11,382][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:24:19,438][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:24:25,586][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:24:36,613][root][INFO] - Processing question number 30
[2025-03-06 13:24:36,615][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:24:44,218][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:24:50,238][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:25:02,894][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:25:07,687][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:25:25,400][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:25:31,309][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:25:41,095][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:25:47,838][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:25:55,122][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:25:59,696][root][INFO] - Processing question number 40
[2025-03-06 13:25:59,699][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:26:13,879][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:26:18,173][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:26:25,900][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:26:33,917][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:26:46,560][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:27:02,902][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:27:11,596][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:27:16,898][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:27:36,712][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:27:42,534][root][INFO] - Processing question number 50
[2025-03-06 13:27:42,537][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:27:48,924][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:28:05,581][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:28:20,368][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:28:31,327][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:28:44,140][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:28:56,584][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:29:06,830][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:29:13,052][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:29:21,687][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:29:30,543][root][INFO] - Processing question number 60
[2025-03-06 13:29:30,547][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:29:36,636][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:29:49,643][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 13:29:58,824][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 13:30:06,194][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 13:30:15,418][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 13:30:25,046][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 13:30:31,787][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 13:30:47,814][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 13:30:59,302][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 13:31:08,518][root][INFO] - Processing question number 70
[2025-03-06 13:31:08,521][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 13:31:17,083][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:31:30,858][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:31:42,361][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:31:53,084][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:32:14,428][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:32:23,867][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:32:36,541][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:33:05,433][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:33:14,983][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:33:19,776][root][INFO] - Processing question number 80
[2025-03-06 13:33:19,780][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:33:27,287][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:33:33,115][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:33:44,812][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:33:53,850][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:34:03,883][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:34:12,505][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:34:21,803][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:34:28,033][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:34:53,791][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:35:06,339][root][INFO] - Processing question number 90
[2025-03-06 13:35:06,344][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:35:10,454][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:35:22,080][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:35:29,131][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:35:33,658][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:35:40,523][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:35:50,025][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:36:09,365][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:36:19,405][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:36:27,835][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:36:40,408][root][INFO] - Inference complete
[2025-03-06 13:36:40,408][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,451][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,453][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:36:40,453][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:36:40,454][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:36:40,454][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:36:40,455][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:36:40,455][root][WARNING] - |Q. 8||D: Criminal_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:36:40,455][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:36:40,460][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:36:40,460][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:36:40,460][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:36:40,461][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:36:40,461][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:36:40,461][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:36:40,461][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:36:40,462][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:36:40,462][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:36:40,463][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:36:40,463][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:36:40,463][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:36:40,463][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:36:40,466][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,471][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,471][root][INFO] - Saved parsed outputs
[2025-03-06 13:36:40,471][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,472][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,472][root][INFO] - Saved parsing metadata
[2025-03-06 13:36:40,473][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,500][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:36:40,501][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:36:40,532][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 13:36:40,532][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.33, 'malformed_label': 13, 'malformed_domain': 29, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 33, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.38461538461538464, 'Constitutional_Law_confidence': 0.17, 'Contracts_confidence': 0.21, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.16, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 16, 'both_wrong': 13}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 13:36:48,138][root][INFO] - Setting global seed to 206
[2025-03-06 13:36:48,146][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 13:36:48,146][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:36:48,147][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:36:48,156][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:36:48,159][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:36:48,159][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:36:49,083][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:36:51,077][root][INFO] - Full model selected, loading model
[2025-03-06 13:37:15,418][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:37:15,434][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:37:23,857][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:37:23,860][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:37:23,860][root][INFO] - Starting inference
[2025-03-06 13:37:24,019][root][INFO] - Processing question number 0
[2025-03-06 13:37:24,021][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:37:32,214][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:37:38,772][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:37:51,790][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:37:56,085][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:38:01,776][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:38:08,394][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:38:16,835][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:38:22,322][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:38:27,871][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:38:33,206][root][INFO] - Processing question number 10
[2025-03-06 13:38:33,208][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:38:38,729][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:38:43,969][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:38:49,762][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:38:57,692][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:39:05,957][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:39:14,232][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:39:19,436][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:39:24,595][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:39:31,380][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:39:38,077][root][INFO] - Processing question number 20
[2025-03-06 13:39:38,079][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:39:43,379][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:39:48,088][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:39:55,049][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:40:01,158][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:40:06,047][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:40:12,809][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:40:20,920][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:40:29,345][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:40:35,859][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:40:46,512][root][INFO] - Processing question number 30
[2025-03-06 13:40:46,514][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:40:55,502][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:41:01,920][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:41:07,797][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:41:14,244][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:41:18,901][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:41:25,807][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:41:34,061][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:41:41,854][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:41:45,892][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:41:51,442][root][INFO] - Processing question number 40
[2025-03-06 13:41:51,445][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:41:59,986][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:42:07,692][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:42:14,252][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:42:19,286][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:42:28,514][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:42:34,778][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:42:40,699][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:42:49,408][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:42:55,308][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:43:00,007][root][INFO] - Processing question number 50
[2025-03-06 13:43:00,010][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:43:06,896][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:43:10,614][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:43:16,573][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:43:26,675][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:43:34,857][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:43:43,895][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:43:54,991][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:44:00,798][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:44:07,471][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:44:12,511][root][INFO] - Processing question number 60
[2025-03-06 13:44:12,514][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:44:17,776][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:44:26,564][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 13:44:34,257][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 13:44:43,203][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 13:44:50,775][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 13:44:56,299][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 13:45:02,372][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 13:45:08,205][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 13:45:15,119][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 13:45:25,312][root][INFO] - Processing question number 70
[2025-03-06 13:45:25,315][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 13:45:28,976][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:45:35,064][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:45:39,947][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:45:51,836][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:45:58,486][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:46:07,001][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:46:16,258][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:46:21,426][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:46:27,012][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:46:33,807][root][INFO] - Processing question number 80
[2025-03-06 13:46:33,811][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:46:37,964][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:46:43,053][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:46:50,837][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:46:55,299][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:47:01,374][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:47:06,885][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:47:18,265][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:47:25,266][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:47:31,873][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:47:39,885][root][INFO] - Processing question number 90
[2025-03-06 13:47:39,889][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:47:45,466][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:47:53,072][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:47:59,760][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:48:05,661][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:48:17,055][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:48:24,654][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:48:30,055][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:48:36,349][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:48:42,577][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:48:51,615][root][INFO] - Inference complete
[2025-03-06 13:48:51,615][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,620][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,631][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,635][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,635][root][INFO] - Saved parsed outputs
[2025-03-06 13:48:51,635][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,636][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,636][root][INFO] - Saved parsing metadata
[2025-03-06 13:48:51,637][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,638][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:48:51,639][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:48:51,653][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 13:48:51,653][root][INFO] - Summary of metrics : {'label_accuracy': 0.42, 'misclassification_rate': 0.5800000000000001, 'combined_accuracy': 0.0, 'malformed_label': 9, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 13:48:57,850][root][INFO] - Setting global seed to 206
[2025-03-06 13:48:57,855][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 13:48:57,855][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:48:57,857][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:48:57,858][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:48:57,860][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:48:57,860][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:48:58,007][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:48:58,565][root][INFO] - Full model selected, loading model
[2025-03-06 13:49:12,827][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:50:57,116][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:50:57,151][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:51:33,439][root][INFO] - Peft model loaded successfully
[2025-03-06 13:51:40,930][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:51:40,933][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:40,933][root][INFO] - Starting inference
[2025-03-06 13:51:41,080][root][INFO] - Processing question number 0
[2025-03-06 13:51:41,082][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:51:49,657][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:51:53,338][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:51:59,097][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:52:10,108][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:52:15,970][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:52:23,397][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:52:36,412][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:52:47,658][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:52:56,542][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:53:03,655][root][INFO] - Processing question number 10
[2025-03-06 13:53:03,657][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:53:09,845][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:53:15,672][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:53:19,836][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:53:27,754][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:53:32,937][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:53:38,963][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:53:49,257][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:53:58,911][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:54:07,722][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:54:11,527][root][INFO] - Processing question number 20
[2025-03-06 13:54:11,529][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:54:17,451][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:54:24,404][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:54:32,546][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:54:39,743][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:54:45,438][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:54:54,442][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:55:00,689][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:55:05,631][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:55:11,505][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:55:28,173][root][INFO] - Processing question number 30
[2025-03-06 13:55:28,176][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:55:37,896][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:55:45,924][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:55:58,997][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:56:05,259][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:56:09,606][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:56:15,504][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:56:24,029][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:56:32,299][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:56:40,584][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:56:47,186][root][INFO] - Processing question number 40
[2025-03-06 13:56:47,189][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:56:57,430][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:57:12,128][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:57:24,360][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:57:34,206][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:57:49,338][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:57:53,917][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:58:05,440][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:58:10,883][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:58:22,125][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:58:28,846][root][INFO] - Processing question number 50
[2025-03-06 13:58:28,849][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:58:33,796][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:58:42,596][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:58:50,310][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:59:00,688][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:59:28,810][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:59:38,576][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:59:47,458][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:00:04,154][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:00:09,202][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:00:20,235][root][INFO] - Processing question number 60
[2025-03-06 14:00:20,238][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:00:28,340][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:00:39,808][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:01:09,036][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:01:21,960][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:01:27,092][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:01:44,012][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:01:51,438][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:01:55,922][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:02:07,467][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:02:18,486][root][INFO] - Processing question number 70
[2025-03-06 14:02:18,490][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:02:28,633][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:02:49,192][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:03:12,121][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:03:28,013][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:03:36,605][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:03:43,597][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:03:51,381][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:04:20,305][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:04:25,261][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:04:30,375][root][INFO] - Processing question number 80
[2025-03-06 14:04:30,378][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:04:44,452][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:05:02,513][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:05:16,345][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:05:30,539][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:05:41,380][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:06:09,855][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:06:21,509][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:06:28,025][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:06:36,792][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:06:44,800][root][INFO] - Processing question number 90
[2025-03-06 14:06:44,805][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:06:52,680][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:07:02,332][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:07:06,493][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:07:10,028][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:07:21,974][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:07:34,305][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:07:48,258][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:07:54,590][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:07:58,085][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:08:09,199][root][INFO] - Inference complete
[2025-03-06 14:08:09,200][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,204][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,211][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,212][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:08:09,212][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,212][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:08:09,212][root][WARNING] - |Q. 98||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,213][root][WARNING] - |Q. 98||D: Evidence| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:08:09,213][root][INFO] - |Q. 98||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,213][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,213][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:08:09,213][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,214][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,214][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:08:09,214][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,214][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:08:09,215][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,215][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:08:09,215][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,216][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,216][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:08:09,216][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,216][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,216][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:08:09,216][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,217][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,218][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:08:09,218][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,218][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:08:09,219][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:08:09,219][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:08:09,219][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:08:09,219][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:08:09,222][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,226][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,226][root][INFO] - Saved parsed outputs
[2025-03-06 14:08:09,226][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,227][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,228][root][INFO] - Saved parsing metadata
[2025-03-06 14:08:09,228][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,229][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:09,231][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:08:09,281][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:08:09,281][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.3, 'malformed_label': 10, 'malformed_domain': 35, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 30, 'Constitutional_Law_accuracy': 0.35714285714285715, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.3333333333333333, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.16, 'Contracts_confidence': 0.16, 'Criminal_Law_confidence': 0.03, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.04, 'Torts_confidence': 0.19, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 35, 'correct_label_wrong_domain': 17, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 14:08:16,701][root][INFO] - Setting global seed to 206
[2025-03-06 14:08:16,708][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 14:08:16,709][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:08:16,710][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:08:16,711][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:08:16,794][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:08:16,794][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:08:17,011][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:08:17,668][root][INFO] - Full model selected, loading model
[2025-03-06 14:08:42,964][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:08:42,972][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:08:51,942][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:08:51,943][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:08:51,944][root][INFO] - Starting inference
[2025-03-06 14:08:52,093][root][INFO] - Processing question number 0
[2025-03-06 14:08:52,095][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:09:00,154][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:09:10,984][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:09:18,733][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:09:23,147][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:09:28,792][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:09:37,207][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:09:42,693][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:09:52,220][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:09:58,320][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:10:05,501][root][INFO] - Processing question number 10
[2025-03-06 14:10:05,503][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:10:09,632][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:10:18,609][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:10:24,600][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:10:31,593][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:10:42,457][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:10:49,554][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:10:54,622][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:11:00,554][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:11:05,322][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:11:09,813][root][INFO] - Processing question number 20
[2025-03-06 14:11:09,815][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:11:14,703][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:11:20,424][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:11:25,218][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:11:30,553][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:11:34,396][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:11:42,218][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:11:52,886][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:12:03,175][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:12:08,247][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:12:16,306][root][INFO] - Processing question number 30
[2025-03-06 14:12:16,308][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:12:25,747][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:12:30,892][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:12:36,823][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:12:44,115][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:12:51,891][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:12:59,185][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:13:07,512][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:13:13,069][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:13:17,894][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:13:23,649][root][INFO] - Processing question number 40
[2025-03-06 14:13:23,651][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:13:28,853][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:13:37,428][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:13:42,884][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:13:48,965][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:13:58,738][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:14:02,955][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:14:09,884][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:14:20,870][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:14:26,403][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:14:35,765][root][INFO] - Processing question number 50
[2025-03-06 14:14:35,768][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:14:41,728][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:14:45,937][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:14:54,025][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:15:00,939][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:15:08,804][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:15:14,191][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:15:20,940][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:15:29,835][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:15:37,154][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:15:42,926][root][INFO] - Processing question number 60
[2025-03-06 14:15:42,929][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:15:49,474][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:15:54,685][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:16:04,121][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:16:12,148][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:16:19,538][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:16:27,940][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:16:34,239][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:16:38,458][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:16:44,509][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:16:54,982][root][INFO] - Processing question number 70
[2025-03-06 14:16:54,986][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:17:01,714][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:17:06,248][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:17:14,221][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:17:19,255][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:17:25,409][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:17:34,253][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:17:42,380][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:17:51,810][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:17:56,950][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:18:01,345][root][INFO] - Processing question number 80
[2025-03-06 14:18:01,349][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:18:06,097][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:18:15,242][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:18:21,255][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:18:26,806][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:18:31,772][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:18:37,652][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:18:50,309][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:18:56,878][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:19:07,364][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:19:12,808][root][INFO] - Processing question number 90
[2025-03-06 14:19:12,812][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:19:19,401][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:19:25,981][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:19:33,086][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:19:37,298][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:19:47,986][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:19:54,470][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:19:58,679][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:20:08,460][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:20:14,465][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:20:22,013][root][INFO] - Inference complete
[2025-03-06 14:20:22,013][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,018][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,028][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,032][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,032][root][INFO] - Saved parsed outputs
[2025-03-06 14:20:22,032][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,033][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,033][root][INFO] - Saved parsing metadata
[2025-03-06 14:20:22,034][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,036][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:20:22,037][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:20:22,079][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:20:22,079][root][INFO] - Summary of metrics : {'label_accuracy': 0.4, 'misclassification_rate': 0.6, 'combined_accuracy': 0.0, 'malformed_label': 11, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 40, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 40, 'both_wrong': 60}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 14:20:30,938][root][INFO] - Setting global seed to 989
[2025-03-06 14:20:30,944][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:20:30,944][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:20:30,946][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:20:30,948][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:20:30,952][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:20:30,952][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:20:31,100][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:20:31,645][root][INFO] - Full model selected, loading model
[2025-03-06 14:20:50,990][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:22:33,909][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:22:33,925][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:23:10,940][root][INFO] - Peft model loaded successfully
[2025-03-06 14:23:18,425][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:23:18,426][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:23:18,427][root][INFO] - Starting inference
[2025-03-06 14:23:18,588][root][INFO] - Processing question number 0
[2025-03-06 14:23:18,590][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:23:25,186][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:23:31,266][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:23:40,033][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:23:47,713][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:24:01,792][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:24:12,809][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:24:18,899][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:24:27,610][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:24:35,199][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:24:42,522][root][INFO] - Processing question number 10
[2025-03-06 14:24:42,524][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:24:46,355][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:24:53,214][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:25:01,360][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:25:19,094][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:25:26,142][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:25:29,915][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:25:35,750][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:25:41,040][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:25:46,489][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:25:53,630][root][INFO] - Processing question number 20
[2025-03-06 14:25:53,632][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:25:57,909][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:26:02,080][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:26:07,982][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:26:12,110][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:26:21,150][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:26:49,681][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:26:56,054][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:27:03,815][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:27:09,727][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:27:16,769][root][INFO] - Processing question number 30
[2025-03-06 14:27:16,780][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:27:30,776][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:27:35,669][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:28:03,151][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:28:14,515][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:28:29,997][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:28:37,933][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:28:47,802][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:28:52,163][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:29:01,512][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:29:17,752][root][INFO] - Processing question number 40
[2025-03-06 14:29:17,754][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:29:25,445][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:29:33,579][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:29:41,994][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:29:47,597][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:30:00,753][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:30:06,693][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:30:11,976][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:30:17,513][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:30:21,561][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:30:27,315][root][INFO] - Processing question number 50
[2025-03-06 14:30:27,318][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:30:31,860][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:30:36,209][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:30:50,522][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:30:58,694][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:31:15,978][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:31:30,455][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:31:44,070][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:31:59,301][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:32:10,458][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:32:19,323][root][INFO] - Processing question number 60
[2025-03-06 14:32:19,327][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:32:26,537][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:32:31,074][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:32:41,866][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:32:50,728][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:33:00,343][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:33:05,993][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:33:12,587][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:33:20,196][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:33:33,061][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:33:41,980][root][INFO] - Processing question number 70
[2025-03-06 14:33:41,983][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:33:55,034][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:34:14,322][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:34:26,193][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:34:51,184][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:35:11,728][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:35:22,995][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:35:31,605][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:35:45,276][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:35:54,792][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:36:03,751][root][INFO] - Processing question number 80
[2025-03-06 14:36:03,754][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:36:08,466][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:36:18,864][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:36:26,148][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:36:35,620][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:37:04,732][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:37:32,961][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:37:42,833][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:37:51,762][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:37:59,125][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:38:11,810][root][INFO] - Processing question number 90
[2025-03-06 14:38:11,814][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:38:19,575][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:38:27,361][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:38:33,481][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:38:39,869][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:38:46,365][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:38:57,937][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:39:10,929][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:39:18,072][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:39:26,614][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:39:32,877][root][INFO] - Inference complete
[2025-03-06 14:39:32,877][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,882][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,885][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,886][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:32,886][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,886][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:39:32,888][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,888][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:32,888][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,888][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,889][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:32,889][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,892][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,892][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:32,892][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,892][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,892][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:32,892][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,893][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,893][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:32,893][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,894][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,895][root][WARNING] - |Q. 53||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:32,895][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,896][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,896][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:32,896][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,896][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:39:32,896][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:32,897][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:39:32,897][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:32,897][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:39:32,899][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,903][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,903][root][INFO] - Saved parsed outputs
[2025-03-06 14:39:32,903][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,905][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,905][root][INFO] - Saved parsing metadata
[2025-03-06 14:39:32,905][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,907][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:32,908][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:39:32,921][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:39:32,921][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.34, 'malformed_label': 14, 'malformed_domain': 29, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 34, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.2, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.17, 'Contracts_confidence': 0.2, 'Criminal_Law_confidence': 0.05, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.17, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 37, 'correct_label_wrong_domain': 15, 'both_wrong': 14}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 14:39:39,248][root][INFO] - Setting global seed to 989
[2025-03-06 14:39:39,253][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 14:39:39,254][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:39:39,255][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:39:39,256][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:39:39,258][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:39:39,258][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:39:39,412][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:39:39,934][root][INFO] - Full model selected, loading model
[2025-03-06 14:39:54,497][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:39:54,498][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:40:02,119][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:40:02,121][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:40:02,121][root][INFO] - Starting inference
[2025-03-06 14:40:02,263][root][INFO] - Processing question number 0
[2025-03-06 14:40:02,265][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:40:11,208][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:40:17,920][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:40:24,731][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:40:30,525][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:40:37,044][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:40:43,192][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:40:51,814][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:40:57,331][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:41:03,040][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:41:07,918][root][INFO] - Processing question number 10
[2025-03-06 14:41:07,920][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:41:12,853][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:41:20,018][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:41:27,471][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:41:33,131][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:41:42,675][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:41:48,728][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:41:53,650][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:42:00,455][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:42:05,850][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:42:12,659][root][INFO] - Processing question number 20
[2025-03-06 14:42:12,661][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:42:17,109][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:42:22,584][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:42:29,467][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:42:37,044][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:42:42,861][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:42:48,640][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:42:55,124][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:43:02,456][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:43:08,001][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:43:14,757][root][INFO] - Processing question number 30
[2025-03-06 14:43:14,759][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:43:21,425][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:43:26,829][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:43:31,125][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:43:37,413][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:43:42,062][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:43:48,712][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:43:54,522][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:44:01,698][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:44:05,959][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:44:11,359][root][INFO] - Processing question number 40
[2025-03-06 14:44:11,361][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:44:16,237][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:44:22,685][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:44:30,906][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:44:37,301][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:44:46,107][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:44:51,491][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:44:57,978][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:45:03,547][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:45:09,788][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:45:14,437][root][INFO] - Processing question number 50
[2025-03-06 14:45:14,440][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:45:21,843][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:45:25,301][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:45:31,927][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:45:39,264][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:45:47,578][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:45:54,835][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:46:04,414][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:46:10,066][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:46:20,244][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:46:29,595][root][INFO] - Processing question number 60
[2025-03-06 14:46:29,598][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:46:34,897][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:46:41,134][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:46:47,634][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:46:53,292][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:47:03,815][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:47:09,456][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:47:15,104][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:47:21,543][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:47:26,233][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:47:33,771][root][INFO] - Processing question number 70
[2025-03-06 14:47:33,774][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:47:37,439][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:47:42,736][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:47:48,157][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:47:55,301][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:47:59,386][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:48:04,303][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:48:12,434][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:48:18,138][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:48:23,398][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:48:27,477][root][INFO] - Processing question number 80
[2025-03-06 14:48:27,480][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:48:32,636][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:48:36,987][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:48:44,445][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:48:48,938][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:48:57,708][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:49:02,942][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:49:11,966][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:49:18,189][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:49:23,631][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:49:29,602][root][INFO] - Processing question number 90
[2025-03-06 14:49:29,606][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:49:34,897][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:49:43,205][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:49:51,978][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:49:56,818][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:50:04,598][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:50:11,562][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:50:15,499][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:50:22,989][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:50:29,683][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:50:36,155][root][INFO] - Inference complete
[2025-03-06 14:50:36,155][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,161][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,171][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,175][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,175][root][INFO] - Saved parsed outputs
[2025-03-06 14:50:36,175][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,176][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,177][root][INFO] - Saved parsing metadata
[2025-03-06 14:50:36,177][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,179][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:50:36,180][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:50:36,466][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:50:36,466][root][INFO] - Summary of metrics : {'label_accuracy': 0.42, 'misclassification_rate': 0.5800000000000001, 'combined_accuracy': 0.0, 'malformed_label': 6, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 42, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 42, 'both_wrong': 58}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 14:51:17,406][root][INFO] - Setting global seed to 989
[2025-03-06 14:51:17,431][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:51:17,432][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:51:17,433][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:51:17,434][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:51:17,440][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:51:17,440][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:51:17,620][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:51:18,247][root][INFO] - Full model selected, loading model
[2025-03-06 14:51:49,813][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:53:34,869][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:53:34,869][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:54:09,965][root][INFO] - Peft model loaded successfully
[2025-03-06 14:54:17,526][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:54:17,528][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:54:17,528][root][INFO] - Starting inference
[2025-03-06 14:54:17,770][root][INFO] - Processing question number 0
[2025-03-06 14:54:17,772][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:54:24,955][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:54:31,415][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:54:39,149][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:54:51,118][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:54:59,616][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:55:06,835][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:55:11,624][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:55:17,156][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:55:26,309][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:55:30,555][root][INFO] - Processing question number 10
[2025-03-06 14:55:30,557][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:55:35,940][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:55:41,509][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:55:47,269][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:55:52,428][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:55:57,129][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:56:01,156][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:56:13,005][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:56:23,236][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:56:33,864][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:56:41,483][root][INFO] - Processing question number 20
[2025-03-06 14:56:41,485][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:56:47,633][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:56:55,096][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:57:10,807][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:57:17,915][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:57:28,424][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:57:35,125][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:57:40,243][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:57:46,007][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:57:51,838][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:58:06,597][root][INFO] - Processing question number 30
[2025-03-06 14:58:06,599][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:58:12,644][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:58:22,011][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:58:31,470][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:58:44,216][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:59:12,721][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:59:19,856][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:59:35,601][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:59:39,909][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:59:45,537][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:59:52,190][root][INFO] - Processing question number 40
[2025-03-06 14:59:52,193][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:59:56,943][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:00:05,241][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:00:13,320][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:00:21,045][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:00:34,367][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:00:40,312][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:00:46,733][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:00:55,257][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:01:05,571][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:01:11,834][root][INFO] - Processing question number 50
[2025-03-06 15:01:11,837][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:01:20,626][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:01:25,062][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:01:40,124][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:01:52,149][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:01:58,746][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:02:04,809][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:02:14,634][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:02:28,302][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:02:33,125][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:02:37,953][root][INFO] - Processing question number 60
[2025-03-06 15:02:37,955][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:02:45,444][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:02:53,528][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:03:07,448][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:03:23,881][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:03:52,897][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:04:21,400][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:04:31,112][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:04:47,661][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:04:56,417][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:05:03,246][root][INFO] - Processing question number 70
[2025-03-06 15:05:03,249][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:05:16,285][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:05:31,917][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:05:42,406][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:05:52,775][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:06:20,930][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:06:31,691][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:06:42,364][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:07:11,290][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:07:20,304][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:07:27,186][root][INFO] - Processing question number 80
[2025-03-06 15:07:27,190][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:07:31,945][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:07:46,790][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:07:55,678][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:08:00,954][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:08:15,691][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:08:24,689][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:08:38,288][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:08:47,529][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:08:51,751][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:09:02,207][root][INFO] - Processing question number 90
[2025-03-06 15:09:02,212][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:09:09,582][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:09:16,482][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:09:22,206][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:09:26,873][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:09:33,935][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:09:46,040][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:10:04,002][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:10:12,215][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:10:21,479][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:10:30,202][root][INFO] - Inference complete
[2025-03-06 15:10:30,202][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,208][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,210][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,210][root][WARNING] - |Q. 20||D: Constitutional_law| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:10:30,210][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,213][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,214][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:10:30,214][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,214][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:10:30,214][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,215][root][WARNING] - |Q. 48||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:10:30,215][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,217][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,218][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:10:30,218][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,218][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,218][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:10:30,218][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,219][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,219][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:10:30,219][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,219][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:10:30,220][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,220][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:10:30,220][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,220][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:10:30,220][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,220][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:10:30,220][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,221][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,221][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:10:30,221][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,222][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,222][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:10:30,222][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,222][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:10:30,223][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:10:30,223][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:10:30,223][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:10:30,223][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:10:30,226][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,231][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,231][root][INFO] - Saved parsed outputs
[2025-03-06 15:10:30,231][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,233][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,233][root][INFO] - Saved parsing metadata
[2025-03-06 15:10:30,234][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,249][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:10:30,251][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:10:30,272][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:10:30,272][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.31, 'malformed_label': 15, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 31, 'Constitutional_Law_accuracy': 0.5, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.4666666666666667, 'Real_Property_accuracy': 0.06666666666666667, 'Torts_accuracy': 0.5, 'Civil_Procedure_accuracy': 0.3076923076923077, 'Constitutional_Law_confidence': 0.17, 'Contracts_confidence': 0.19, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.08, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.17, 'Civil_Procedure_confidence': 0.14, 'correct_domain_wrong_label': 38, 'correct_label_wrong_domain': 16, 'both_wrong': 15}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 15:10:40,162][root][INFO] - Setting global seed to 989
[2025-03-06 15:10:40,170][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:10:40,170][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:10:40,171][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:10:40,173][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:10:40,176][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:10:40,176][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:10:40,327][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:10:40,888][root][INFO] - Full model selected, loading model
[2025-03-06 15:11:02,151][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:11:02,152][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:11:10,027][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:11:10,029][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:11:10,029][root][INFO] - Starting inference
[2025-03-06 15:11:10,197][root][INFO] - Processing question number 0
[2025-03-06 15:11:10,199][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:11:20,240][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:11:30,398][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:11:37,091][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:11:44,050][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:11:52,055][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:11:57,637][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:12:07,683][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:12:12,985][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:12:19,299][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:12:24,630][root][INFO] - Processing question number 10
[2025-03-06 15:12:24,631][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:12:30,107][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:12:41,305][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:12:48,469][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:12:55,490][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:13:02,369][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:13:07,756][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:13:12,955][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:13:16,715][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:13:23,591][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:13:30,193][root][INFO] - Processing question number 20
[2025-03-06 15:13:30,195][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:13:35,136][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:13:39,248][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:13:45,119][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:13:49,377][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:13:54,625][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:14:01,110][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:14:09,957][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:14:19,072][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:14:25,400][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:14:33,290][root][INFO] - Processing question number 30
[2025-03-06 15:14:33,292][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:14:40,895][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:14:46,672][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:14:51,103][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:14:58,561][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:15:03,758][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:15:09,653][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:15:17,766][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:15:22,803][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:15:27,064][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:15:32,520][root][INFO] - Processing question number 40
[2025-03-06 15:15:32,523][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:15:39,865][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:15:45,697][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:15:54,745][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:16:00,941][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:16:09,042][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:16:16,266][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:16:22,279][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:16:28,318][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:16:38,075][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:16:42,772][root][INFO] - Processing question number 50
[2025-03-06 15:16:42,775][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:16:50,302][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:16:54,019][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:17:00,946][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:17:10,072][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:17:19,397][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:17:27,171][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:17:36,441][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:17:43,119][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:17:50,203][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:17:55,514][root][INFO] - Processing question number 60
[2025-03-06 15:17:55,517][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:18:05,052][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:18:15,269][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:18:21,336][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:18:32,023][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:18:41,072][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:18:49,877][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:18:55,788][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:19:00,712][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:19:07,485][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:19:14,834][root][INFO] - Processing question number 70
[2025-03-06 15:19:14,837][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:19:19,957][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:19:25,859][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:19:36,204][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:19:43,983][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:19:49,595][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:19:55,712][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:20:03,645][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:20:12,460][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:20:17,417][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:20:21,540][root][INFO] - Processing question number 80
[2025-03-06 15:20:21,543][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:20:26,796][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:20:31,837][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:20:38,773][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:20:43,407][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:20:49,306][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:20:53,741][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:21:03,519][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:21:09,480][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:21:15,943][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:21:21,340][root][INFO] - Processing question number 90
[2025-03-06 15:21:21,344][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:21:27,242][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:21:34,284][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:21:44,180][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:21:48,752][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:21:55,162][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:21:59,661][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:22:04,053][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:22:11,579][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:22:18,211][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:22:26,218][root][INFO] - Inference complete
[2025-03-06 15:22:26,218][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,226][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,236][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,241][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,241][root][INFO] - Saved parsed outputs
[2025-03-06 15:22:26,241][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,252][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,252][root][INFO] - Saved parsing metadata
[2025-03-06 15:22:26,253][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,254][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:22:26,256][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:22:26,304][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:22:26,304][root][INFO] - Summary of metrics : {'label_accuracy': 0.41, 'misclassification_rate': 0.5900000000000001, 'combined_accuracy': 0.0, 'malformed_label': 8, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 41, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 41, 'both_wrong': 59}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 15:22:37,557][root][INFO] - Setting global seed to 989
[2025-03-06 15:22:37,565][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:22:37,565][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:22:37,567][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:22:37,568][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:22:37,573][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:22:37,573][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:22:37,785][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:22:38,361][root][INFO] - Full model selected, loading model
[2025-03-06 15:22:56,900][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:24:38,745][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:24:38,794][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:25:15,895][root][INFO] - Peft model loaded successfully
[2025-03-06 15:25:23,261][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:25:23,264][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:25:23,264][root][INFO] - Starting inference
[2025-03-06 15:25:23,422][root][INFO] - Processing question number 0
[2025-03-06 15:25:23,424][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:25:29,115][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:25:35,376][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:25:42,291][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:25:53,348][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:26:00,982][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:26:10,033][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:26:16,770][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:26:27,363][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:26:33,355][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:26:38,372][root][INFO] - Processing question number 10
[2025-03-06 15:26:38,374][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:26:55,172][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:27:01,549][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:27:10,226][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:27:16,164][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:27:20,613][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:27:25,096][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:27:30,253][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:27:37,584][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:27:45,425][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:27:53,592][root][INFO] - Processing question number 20
[2025-03-06 15:27:53,594][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:27:59,424][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:28:03,995][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:28:10,582][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:28:16,503][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:28:28,159][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:28:56,931][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:29:04,184][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:29:23,325][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:29:35,779][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:29:51,292][root][INFO] - Processing question number 30
[2025-03-06 15:29:51,296][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:29:57,475][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:30:06,973][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:30:22,153][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:30:51,167][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:31:13,407][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:31:18,032][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:31:25,001][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:31:33,690][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:31:38,220][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:31:45,191][root][INFO] - Processing question number 40
[2025-03-06 15:31:45,193][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:32:01,803][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:32:07,635][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:32:28,797][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:32:32,802][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:32:58,865][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:33:03,712][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:33:09,404][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:33:14,529][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:33:23,086][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:33:30,544][root][INFO] - Processing question number 50
[2025-03-06 15:33:30,547][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:33:37,153][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:33:53,727][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:34:03,165][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:34:12,801][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:34:19,618][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:34:24,772][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:34:38,029][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:34:45,903][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:34:55,239][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:35:03,812][root][INFO] - Processing question number 60
[2025-03-06 15:35:03,815][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:35:11,410][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:35:17,668][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:35:27,797][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:35:39,773][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:36:01,078][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:36:13,159][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:36:19,318][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:36:25,464][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:36:34,661][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:36:39,973][root][INFO] - Processing question number 70
[2025-03-06 15:36:39,976][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:36:50,450][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:37:02,407][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:37:11,020][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:37:24,843][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:37:33,897][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:37:42,738][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:37:50,054][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:38:18,996][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:38:28,073][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:38:35,402][root][INFO] - Processing question number 80
[2025-03-06 15:38:35,406][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:38:42,303][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:38:50,608][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:39:01,131][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:39:08,297][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:39:22,665][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:39:29,893][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:39:39,322][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:39:45,191][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:39:51,200][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:40:01,417][root][INFO] - Processing question number 90
[2025-03-06 15:40:01,421][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:40:07,270][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:40:20,541][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:40:30,051][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:40:37,332][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:40:50,332][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:41:03,109][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:41:08,533][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:41:13,354][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:41:19,635][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:41:41,089][root][INFO] - Inference complete
[2025-03-06 15:41:41,090][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,097][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,100][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,101][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:41:41,101][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,101][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:41:41,102][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,103][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:41:41,103][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,103][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:41:41,104][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,104][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,104][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,106][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,106][root][WARNING] - |Q. 5||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,106][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,107][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,107][root][WARNING] - |Q. 33||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,107][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,107][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,108][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,108][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,108][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,108][root][WARNING] - |Q. 54||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,108][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,109][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,109][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,109][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,109][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,109][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,109][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,110][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,110][root][WARNING] - |Q. 93||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,110][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,110][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,111][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,111][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,111][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,112][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:41:41,112][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,112][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:41:41,114][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:41:41,114][root][WARNING] - |Q. 92||D: Torts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:41:41,114][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:41:41,115][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,147][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,147][root][INFO] - Saved parsed outputs
[2025-03-06 15:41:41,147][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,149][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,149][root][INFO] - Saved parsing metadata
[2025-03-06 15:41:41,150][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,152][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:41:41,153][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:41:41,167][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:41:41,167][root][INFO] - Summary of metrics : {'label_accuracy': 0.51, 'misclassification_rate': 0.49, 'combined_accuracy': 0.38, 'malformed_label': 10, 'malformed_domain': 31, 'total_predictions': 100, 'correct_predictions': 51, 'correct_label_and_domain': 38, 'Constitutional_Law_accuracy': 0.42857142857142855, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.21428571428571427, 'Evidence_accuracy': 0.5333333333333333, 'Real_Property_accuracy': 0.2, 'Torts_accuracy': 0.7142857142857143, 'Civil_Procedure_accuracy': 0.46153846153846156, 'Constitutional_Law_confidence': 0.16, 'Contracts_confidence': 0.14, 'Criminal_Law_confidence': 0.04, 'Evidence_confidence': 0.09, 'Real_Property_confidence': 0.05, 'Torts_confidence': 0.17, 'Civil_Procedure_confidence': 0.15, 'correct_domain_wrong_label': 31, 'correct_label_wrong_domain': 13, 'both_wrong': 18}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 8 to status running with exit code None
Eval status update completed for job 8
[2025-03-06 15:41:48,698][root][INFO] - Setting global seed to 989
[2025-03-06 15:41:48,703][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:41:48,703][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:41:48,705][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:41:48,706][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:41:48,708][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:41:48,708][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:41:48,862][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:41:49,405][root][INFO] - Full model selected, loading model
[2025-03-06 15:42:07,700][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:42:07,700][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:42:15,335][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:42:15,337][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:42:15,337][root][INFO] - Starting inference
[2025-03-06 15:42:15,485][root][INFO] - Processing question number 0
[2025-03-06 15:42:15,487][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:42:28,287][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:42:35,728][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:42:44,160][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:42:50,064][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:42:57,846][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:43:02,313][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:43:09,273][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:43:15,550][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:43:29,039][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:43:33,200][root][INFO] - Processing question number 10
[2025-03-06 15:43:33,202][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:43:43,001][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:43:51,902][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:43:56,111][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:44:04,986][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:44:14,086][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:44:20,252][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:44:26,962][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:44:35,816][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:44:42,467][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:44:47,648][root][INFO] - Processing question number 20
[2025-03-06 15:44:47,650][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:44:53,846][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:44:59,060][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:45:03,396][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:45:09,641][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:45:15,025][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:45:21,558][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:45:30,778][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:45:36,452][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:45:43,746][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:45:51,410][root][INFO] - Processing question number 30
[2025-03-06 15:45:51,412][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:46:01,554][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:46:05,891][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:46:12,092][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:46:20,154][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:46:24,722][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:46:32,409][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:46:39,793][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:46:46,952][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:46:53,355][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:47:00,009][root][INFO] - Processing question number 40
[2025-03-06 15:47:00,012][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:47:04,717][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:47:14,700][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:47:22,922][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:47:28,359][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:47:36,792][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:47:42,464][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:47:51,043][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:47:57,725][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:48:03,992][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:48:12,888][root][INFO] - Processing question number 50
[2025-03-06 15:48:12,890][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:48:22,104][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:48:25,821][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:48:32,473][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:48:39,478][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:48:46,211][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:48:53,415][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:49:00,722][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:49:08,694][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:49:17,492][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:49:23,262][root][INFO] - Processing question number 60
[2025-03-06 15:49:23,265][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:49:31,052][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:49:40,674][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:49:46,636][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:49:54,293][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:50:00,942][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:50:10,078][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:50:14,665][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:50:19,197][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:50:26,614][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:50:32,921][root][INFO] - Processing question number 70
[2025-03-06 15:50:32,924][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:50:39,793][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:50:46,984][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:50:56,912][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:51:03,381][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:51:09,085][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:51:14,429][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:51:19,593][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:51:27,778][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:51:31,801][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:51:36,422][root][INFO] - Processing question number 80
[2025-03-06 15:51:36,425][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:51:40,855][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:51:44,519][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:51:52,482][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:51:57,392][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:52:04,846][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:52:09,551][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:52:18,537][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:52:23,666][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:52:31,056][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:52:37,325][root][INFO] - Processing question number 90
[2025-03-06 15:52:37,328][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:52:42,404][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:52:49,963][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:52:57,530][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:53:01,428][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:53:07,751][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:53:16,382][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:53:25,237][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:53:31,897][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:53:39,025][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:53:45,165][root][INFO] - Inference complete
[2025-03-06 15:53:45,165][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,174][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,185][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,189][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,189][root][INFO] - Saved parsed outputs
[2025-03-06 15:53:45,190][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,191][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,191][root][INFO] - Saved parsing metadata
[2025-03-06 15:53:45,192][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,193][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:45,204][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:53:45,236][root][INFO] - Evaluation completed for json_answer_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:53:45,236][root][INFO] - Summary of metrics : {'label_accuracy': 0.39, 'misclassification_rate': 0.61, 'combined_accuracy': 0.0, 'malformed_label': 14, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '8', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 8 to status completed with exit code 0
Eval status update completed for job 8
Job 8 completed at Thu Mar  6 15:53:46 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n508
Job ID: 25358383
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 06:13:07
CPU Efficiency: 9.84% of 2-15:10:00 core-walltime
Job Wall-clock time: 06:19:00
Memory Utilized: 35.08 GB
Memory Efficiency: 97.45% of 36.00 GB
