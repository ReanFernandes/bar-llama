Starting job 16 at Thu Mar  6 10:16:19 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=json_fact_first_zero_shot_unstructured train=json_fact_first_zero_shot_unstructured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '16', 'training']
Updating job 16 to status training with exit code None
Status update completed for job 16
[2025-03-06 10:16:35,316][root][INFO] - Global seed set to 314
[2025-03-06 10:16:35,317][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 10:16:35,318][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 10:16:35,318][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 10:16:35,318][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:16:35,318][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/raw_dataset.json
[2025-03-06 10:16:35,335][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:16:35,349][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 10:16:35,351][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 10:16:35,355][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 10:16:36,143][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 10:17:00,195][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 10:17:32,503][root][INFO] - Model prepared for kbit training
[2025-03-06 10:17:32,504][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'q_proj', 'v_proj', 'down_proj', 'gate_proj', 'o_proj', 'k_proj', 'up_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 10:17:34,274][root][INFO] - Lora adapter added to model
[2025-03-06 10:17:34,277][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_fact_first_zero_shot_unstructured
[2025-03-06 10:17:34,499][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.9999, 'grad_norm': 0.5632866024971008, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.6248, 'grad_norm': 0.365170955657959, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.4174, 'grad_norm': 0.3812391459941864, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.2581, 'grad_norm': 0.552935004234314, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 1.0084, 'grad_norm': 0.37440818548202515, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 301.6701, 'train_samples_per_second': 0.348, 'train_steps_per_second': 0.05, 'train_loss': 1.4617114226023356, 'epoch': 15.0}
[2025-03-06 10:22:43,798][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_fact_first_zero_shot_unstructured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '16', 'trained', '0']
Updating job 16 to status trained with exit code 0
Status update completed for job 16
Starting evaluations for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 10:22:53,801][root][INFO] - Setting global seed to 206
[2025-03-06 10:22:53,808][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:22:53,808][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:22:53,810][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:22:53,812][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:22:53,817][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:22:53,817][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:22:54,062][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:22:54,629][root][INFO] - Full model selected, loading model
[2025-03-06 10:23:10,623][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:25:07,130][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:25:07,146][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:25:40,870][root][INFO] - Peft model loaded successfully
[2025-03-06 10:25:48,437][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:25:48,439][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:25:48,439][root][INFO] - Starting inference
[2025-03-06 10:25:48,641][root][INFO] - Processing question number 0
[2025-03-06 10:25:48,643][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:25:53,233][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:26:00,411][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:26:07,688][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:26:29,081][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:26:38,487][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:26:49,612][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:26:54,940][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:27:23,263][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:27:27,299][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:27:31,990][root][INFO] - Processing question number 10
[2025-03-06 10:27:31,992][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:27:38,354][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:27:45,792][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:27:49,886][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:27:56,812][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:28:02,218][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:28:14,024][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:28:19,809][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:28:29,076][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:28:37,196][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:28:47,427][root][INFO] - Processing question number 20
[2025-03-06 10:28:47,429][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:28:56,802][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:29:01,995][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:29:08,104][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:29:12,972][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:29:20,022][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:29:24,339][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:29:28,708][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:29:37,825][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:30:06,189][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:30:12,560][root][INFO] - Processing question number 30
[2025-03-06 10:30:12,563][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:30:40,962][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:30:51,390][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:30:58,458][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:31:05,386][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:31:09,744][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:31:27,504][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:31:32,673][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:31:44,374][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:31:49,788][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:31:57,863][root][INFO] - Processing question number 40
[2025-03-06 10:31:57,866][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:32:09,946][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:32:17,732][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:32:25,809][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:32:32,100][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:32:38,480][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:32:43,306][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:32:54,768][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:33:03,277][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:33:08,178][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:33:12,827][root][INFO] - Processing question number 50
[2025-03-06 10:33:12,830][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:33:17,470][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:33:23,878][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:33:30,859][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:33:39,254][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:33:55,406][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:34:01,507][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:34:11,786][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:34:20,148][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:34:25,930][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:34:31,564][root][INFO] - Processing question number 60
[2025-03-06 10:34:31,567][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:34:39,167][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:34:45,728][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:35:14,406][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:35:22,867][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:35:29,367][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:35:42,198][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:35:53,612][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:36:11,206][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:36:18,626][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:36:25,804][root][INFO] - Processing question number 70
[2025-03-06 10:36:25,808][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:36:32,771][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:36:37,046][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:36:40,919][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:36:53,146][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:37:01,173][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:37:08,282][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:37:16,875][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:37:30,025][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:37:44,671][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:37:50,829][root][INFO] - Processing question number 80
[2025-03-06 10:37:50,833][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:38:00,783][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:38:17,564][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:38:27,330][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:38:38,128][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:38:46,528][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:38:56,167][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:39:03,091][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:39:12,794][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:39:41,222][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:39:48,435][root][INFO] - Processing question number 90
[2025-03-06 10:39:48,439][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:39:55,551][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:40:01,541][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:40:09,842][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:40:17,061][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:40:24,814][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:40:31,234][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:40:39,105][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:40:45,646][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:40:53,075][root][INFO] - Inference complete
[2025-03-06 10:40:53,075][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,081][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,083][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:53,083][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:53,084][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:53,084][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:40:53,085][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:53,085][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 10:40:53,085][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:53,087][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:53,087][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:53,087][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:53,087][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:40:53,087][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:53,088][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:53,088][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:53,088][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:40:53,092][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:53,092][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:53,092][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:53,092][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:40:53,095][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:40:53,096][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:40:53,096][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:40:53,096][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:40:53,097][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,102][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,102][root][INFO] - Saved parsed outputs
[2025-03-06 10:40:53,102][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,103][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,103][root][INFO] - Saved parsing metadata
[2025-03-06 10:40:53,104][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,106][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:40:53,107][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:40:53,128][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 10:40:53,128][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 8, 'malformed_domain': 94, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.010101010101010102, 'Civil_Procedure_confidence': 0.010101010101010102, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 48, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 10:41:01,964][root][INFO] - Setting global seed to 206
[2025-03-06 10:41:01,972][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:41:01,972][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:41:01,974][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:41:01,993][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:41:01,996][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:41:01,996][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:41:02,281][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:41:02,897][root][INFO] - Full model selected, loading model
[2025-03-06 10:41:20,258][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:41:20,258][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:41:28,046][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:41:28,048][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:41:28,048][root][INFO] - Starting inference
[2025-03-06 10:41:28,249][root][INFO] - Processing question number 0
[2025-03-06 10:41:28,252][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:41:33,725][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:41:40,222][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:41:47,331][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:41:59,254][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:42:04,104][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:42:10,084][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:42:15,963][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:42:23,227][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:42:29,279][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:42:35,449][root][INFO] - Processing question number 10
[2025-03-06 10:42:35,451][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:42:42,586][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:42:49,135][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:42:57,261][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:43:07,718][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:43:11,849][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:43:16,441][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:43:23,310][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:43:28,123][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:43:32,892][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:43:37,609][root][INFO] - Processing question number 20
[2025-03-06 10:43:37,610][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:43:44,675][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:43:50,416][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:43:56,041][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:44:02,021][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:44:08,116][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:44:16,012][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:44:21,943][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:44:32,361][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:44:37,858][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:44:46,112][root][INFO] - Processing question number 30
[2025-03-06 10:44:46,114][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:44:52,892][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:45:08,943][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:45:15,856][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:45:21,746][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:45:28,128][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:45:34,096][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:45:39,985][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:45:47,902][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:45:52,414][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:45:57,410][root][INFO] - Processing question number 40
[2025-03-06 10:45:57,412][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:46:02,704][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:46:09,406][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:46:16,613][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:46:25,156][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:46:29,661][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:46:58,084][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:47:04,019][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:47:10,139][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:47:17,088][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:47:21,785][root][INFO] - Processing question number 50
[2025-03-06 10:47:21,787][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:47:26,201][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:47:36,252][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:47:40,437][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:47:48,276][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:47:56,196][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:48:02,347][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:48:10,084][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:48:16,254][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:48:22,315][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:48:28,187][root][INFO] - Processing question number 60
[2025-03-06 10:48:28,190][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:48:35,670][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:48:43,872][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:48:52,441][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:49:00,456][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:49:07,834][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:49:18,042][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:49:24,051][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:49:29,736][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:49:37,571][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:49:47,430][root][INFO] - Processing question number 70
[2025-03-06 10:49:47,433][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:49:52,689][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:50:00,795][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:50:06,914][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:50:14,510][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:50:22,683][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:50:29,758][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:50:39,614][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:50:44,939][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:50:50,627][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:50:59,116][root][INFO] - Processing question number 80
[2025-03-06 10:50:59,120][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:51:03,724][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:51:11,909][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:51:16,806][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:51:22,385][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:51:30,060][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:51:37,403][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:51:44,283][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:51:51,301][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:51:58,000][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:52:04,782][root][INFO] - Processing question number 90
[2025-03-06 10:52:04,786][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:52:13,599][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:52:19,161][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:52:27,428][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:52:31,331][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:52:39,230][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:52:45,209][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:52:50,959][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:52:58,009][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:53:04,140][root][INFO] - Inference complete
[2025-03-06 10:53:04,140][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,145][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,150][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:53:04,151][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:53:04,151][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:53:04,152][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 10:53:04,157][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,162][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,162][root][INFO] - Saved parsed outputs
[2025-03-06 10:53:04,162][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,163][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,163][root][INFO] - Saved parsing metadata
[2025-03-06 10:53:04,164][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,165][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:53:04,167][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:53:04,186][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 10:53:04,186][root][INFO] - Summary of metrics : {'label_accuracy': 0.5656565656565656, 'misclassification_rate': 0.43434343434343436, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 56, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 56, 'both_wrong': 43}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 10:53:11,020][root][INFO] - Setting global seed to 206
[2025-03-06 10:53:11,026][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:53:11,026][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 10:53:11,027][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:53:11,029][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:53:11,030][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:53:11,031][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:53:11,197][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:53:11,758][root][INFO] - Full model selected, loading model
[2025-03-06 10:53:27,897][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:55:23,460][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:55:23,512][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:55:59,148][root][INFO] - Peft model loaded successfully
[2025-03-06 10:56:06,749][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:56:06,751][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 10:56:06,751][root][INFO] - Starting inference
[2025-03-06 10:56:06,957][root][INFO] - Processing question number 0
[2025-03-06 10:56:06,959][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:56:13,006][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:56:20,626][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:56:30,511][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:56:48,746][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:56:55,459][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:57:03,611][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:57:08,943][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:57:25,199][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:57:31,532][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:57:36,265][root][INFO] - Processing question number 10
[2025-03-06 10:57:36,266][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:57:41,501][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:57:51,067][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:58:00,049][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:58:06,219][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:58:27,657][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:58:41,713][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:58:48,735][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:58:53,284][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:58:59,701][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:59:09,352][root][INFO] - Processing question number 20
[2025-03-06 10:59:09,354][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:59:14,980][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:59:24,243][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:59:52,486][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:00:04,707][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:00:09,986][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:00:15,623][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:00:34,715][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:00:44,822][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:00:57,236][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:01:04,083][root][INFO] - Processing question number 30
[2025-03-06 11:01:04,085][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:01:10,155][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:01:14,526][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:01:23,615][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:01:33,112][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:01:36,661][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:01:53,505][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:01:57,199][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:02:04,964][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:02:17,171][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:02:25,243][root][INFO] - Processing question number 40
[2025-03-06 11:02:25,245][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:02:34,935][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:02:40,275][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:02:57,702][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:03:18,295][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:03:23,796][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:03:33,556][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:03:52,148][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:04:00,537][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:04:05,398][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:04:10,185][root][INFO] - Processing question number 50
[2025-03-06 11:04:10,188][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:04:15,153][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:04:20,165][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:04:26,416][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:04:34,950][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:04:54,569][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:05:03,896][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:05:12,973][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:05:16,811][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:05:24,741][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:05:30,478][root][INFO] - Processing question number 60
[2025-03-06 11:05:30,482][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:05:38,812][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:05:46,635][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:06:01,565][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:06:06,801][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:06:14,246][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:06:29,203][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:06:35,127][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:06:41,656][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:06:46,080][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:06:52,089][root][INFO] - Processing question number 70
[2025-03-06 11:06:52,093][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:06:58,729][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:07:06,336][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:07:10,433][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:07:24,214][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:07:30,708][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:07:35,277][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:07:43,540][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:07:53,169][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:08:03,902][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:08:10,223][root][INFO] - Processing question number 80
[2025-03-06 11:08:10,226][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:08:17,688][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:08:25,130][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:08:31,661][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:08:37,432][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:08:44,907][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:08:51,863][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:09:02,498][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:09:08,620][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:09:14,140][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:09:19,637][root][INFO] - Processing question number 90
[2025-03-06 11:09:19,641][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:09:29,754][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:09:35,323][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:10:03,964][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:10:08,485][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:10:15,211][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:10:20,758][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:10:26,667][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:10:33,322][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:10:41,993][root][INFO] - Inference complete
[2025-03-06 11:10:41,994][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:41,998][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:42,000][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:10:42,000][root][WARNING] - |Q. 21||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:10:42,000][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:10:42,003][root][WARNING] - |Q. 43||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:10:42,003][root][WARNING] - |Q. 43||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:10:42,004][root][INFO] - |Q. 43||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:10:42,004][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:10:42,011][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:10:42,011][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:10:42,011][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:10:42,011][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:10:42,012][root][WARNING] - |Q. 50||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:10:42,012][root][WARNING] - |Q. 50||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:10:42,012][root][INFO] - |Q. 50||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:10:42,012][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:10:42,014][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:42,018][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:42,018][root][INFO] - Saved parsed outputs
[2025-03-06 11:10:42,018][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:42,019][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:42,019][root][INFO] - Saved parsing metadata
[2025-03-06 11:10:42,020][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:42,036][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:10:42,038][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:10:42,071][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:10:42,071][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.010101010101010102, 'malformed_label': 8, 'malformed_domain': 94, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.010101010101010102, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.020202020202020204, 'Civil_Procedure_confidence': 0.010101010101010102, 'correct_domain_wrong_label': 4, 'correct_label_wrong_domain': 45, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 11:11:09,493][root][INFO] - Setting global seed to 206
[2025-03-06 11:11:09,564][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:11:09,564][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:11:09,565][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:11:09,595][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:11:09,598][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:11:09,598][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:11:09,758][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:11:10,362][root][INFO] - Full model selected, loading model
[2025-03-06 11:11:33,439][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:11:33,440][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:11:41,785][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:11:41,787][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:11:41,787][root][INFO] - Starting inference
[2025-03-06 11:11:41,986][root][INFO] - Processing question number 0
[2025-03-06 11:11:41,989][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:11:46,511][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:11:53,254][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:11:59,649][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:12:10,782][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:12:16,579][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:12:29,266][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:12:35,149][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:12:40,913][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:12:46,473][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:12:52,439][root][INFO] - Processing question number 10
[2025-03-06 11:12:52,441][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:13:22,527][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:13:29,358][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:13:37,878][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:13:44,225][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:13:48,662][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:13:52,840][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:14:00,170][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:14:05,024][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:14:10,740][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:14:16,581][root][INFO] - Processing question number 20
[2025-03-06 11:14:16,584][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:14:23,018][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:14:29,948][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:14:35,665][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:14:41,696][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:14:48,949][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:14:53,757][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:15:00,345][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:15:07,754][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:15:16,756][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:15:22,460][root][INFO] - Processing question number 30
[2025-03-06 11:15:22,462][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:15:30,216][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:15:44,764][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:15:51,274][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:15:57,671][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:16:03,468][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:16:09,070][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:16:13,650][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:16:20,753][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:16:29,488][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:16:36,374][root][INFO] - Processing question number 40
[2025-03-06 11:16:36,377][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:16:41,574][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:16:47,962][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:16:58,504][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:17:06,694][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:17:13,000][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:17:20,849][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:17:25,795][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:17:30,885][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:17:40,329][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:17:44,968][root][INFO] - Processing question number 50
[2025-03-06 11:17:44,971][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:17:49,511][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:17:58,199][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:18:04,439][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:18:12,857][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:18:19,975][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:18:32,506][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:18:40,515][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:18:46,805][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:19:02,259][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:19:08,929][root][INFO] - Processing question number 60
[2025-03-06 11:19:08,932][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:19:19,633][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:19:25,093][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:19:34,917][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:19:39,125][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:19:46,609][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:19:55,389][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:20:02,843][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:20:08,903][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:20:13,286][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:20:22,970][root][INFO] - Processing question number 70
[2025-03-06 11:20:22,974][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:20:31,733][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:20:37,665][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:20:43,800][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:20:52,616][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:20:58,912][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:21:03,648][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:21:10,774][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:21:15,405][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:21:21,460][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:21:30,013][root][INFO] - Processing question number 80
[2025-03-06 11:21:30,017][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:21:35,918][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:21:44,633][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:21:49,658][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:21:54,779][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:22:01,258][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:22:08,976][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:22:16,649][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:22:24,546][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:22:32,167][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:22:38,411][root][INFO] - Processing question number 90
[2025-03-06 11:22:38,415][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:22:45,316][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:22:50,429][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:22:55,963][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:23:00,427][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:23:08,799][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:23:14,420][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:23:20,038][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:23:27,554][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:23:33,636][root][INFO] - Inference complete
[2025-03-06 11:23:33,636][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,641][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,643][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:23:33,643][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:23:33,644][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:23:33,644][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:23:33,653][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,657][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,657][root][INFO] - Saved parsed outputs
[2025-03-06 11:23:33,657][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,658][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,658][root][INFO] - Saved parsing metadata
[2025-03-06 11:23:33,659][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,673][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:23:33,675][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:23:33,715][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:23:33,715][root][INFO] - Summary of metrics : {'label_accuracy': 0.5555555555555556, 'misclassification_rate': 0.4444444444444444, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 55, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 55, 'both_wrong': 44}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 11:23:42,274][root][INFO] - Setting global seed to 206
[2025-03-06 11:23:42,280][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:23:42,281][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:23:42,282][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:23:42,299][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:23:42,301][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:23:42,302][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:23:42,479][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:23:43,050][root][INFO] - Full model selected, loading model
[2025-03-06 11:24:06,625][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:26:00,673][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:26:00,699][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:26:35,690][root][INFO] - Peft model loaded successfully
[2025-03-06 11:26:43,295][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:26:43,296][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:26:43,296][root][INFO] - Starting inference
[2025-03-06 11:26:43,507][root][INFO] - Processing question number 0
[2025-03-06 11:26:43,509][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:26:51,440][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:26:58,961][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:27:16,514][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:27:20,604][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:27:34,238][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:27:41,963][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:27:52,130][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:27:57,483][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:28:25,790][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:28:30,522][root][INFO] - Processing question number 10
[2025-03-06 11:28:30,524][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:28:36,513][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:28:49,774][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:28:56,045][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:29:06,496][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:29:14,262][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:29:19,973][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:29:25,729][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:29:33,290][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:29:41,993][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:29:53,061][root][INFO] - Processing question number 20
[2025-03-06 11:29:53,063][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:30:01,378][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:30:08,635][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:30:15,433][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:30:25,239][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:30:35,318][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:30:42,723][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:30:48,979][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:31:03,784][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:31:16,692][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:31:26,167][root][INFO] - Processing question number 30
[2025-03-06 11:31:26,169][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:31:31,676][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:31:40,889][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:31:50,562][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:31:57,189][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:32:03,577][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:32:14,299][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:32:20,743][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:32:30,673][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:32:36,689][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:32:42,327][root][INFO] - Processing question number 40
[2025-03-06 11:32:42,330][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:32:51,908][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:32:58,753][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:33:06,902][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:33:18,712][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:33:26,298][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:33:38,804][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:33:49,229][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:33:54,852][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:33:59,163][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:34:05,045][root][INFO] - Processing question number 50
[2025-03-06 11:34:05,048][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:34:09,592][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:34:13,361][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:34:18,566][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:34:23,280][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:34:30,439][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:34:40,110][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:34:50,066][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:34:55,022][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:35:05,981][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:35:11,479][root][INFO] - Processing question number 60
[2025-03-06 11:35:11,483][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:35:16,582][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:35:22,976][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:35:37,129][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:35:43,125][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:35:51,210][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:36:00,025][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:36:08,757][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:36:21,477][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:36:32,255][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:36:43,790][root][INFO] - Processing question number 70
[2025-03-06 11:36:43,794][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:36:54,006][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:36:58,507][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:37:03,049][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:37:08,596][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:37:15,037][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:37:20,675][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:37:27,069][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:37:32,622][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:37:42,539][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:37:50,085][root][INFO] - Processing question number 80
[2025-03-06 11:37:50,088][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:38:00,415][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:38:14,296][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:38:23,286][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:38:31,784][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:38:40,916][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:38:48,362][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:38:52,215][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:39:20,706][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:39:28,613][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:39:41,355][root][INFO] - Processing question number 90
[2025-03-06 11:39:41,359][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:39:54,634][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:40:01,401][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:40:09,740][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:40:16,312][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:40:23,996][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:40:27,379][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:40:36,706][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:41:05,350][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:41:25,967][root][INFO] - Inference complete
[2025-03-06 11:41:25,968][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:25,982][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:25,984][root][WARNING] - |Q. 28||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:41:25,984][root][WARNING] - |Q. 28||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:41:25,984][root][INFO] - |Q. 28||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:41:25,985][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:41:25,985][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:41:25,985][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:41:25,985][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:41:25,986][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:41:25,986][root][WARNING] - |Q. 91||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:41:25,986][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:41:25,994][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:41:25,994][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:41:25,994][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:41:25,994][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:41:25,996][root][WARNING] - |Q. 85||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:41:25,996][root][WARNING] - |Q. 85||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:41:25,996][root][INFO] - |Q. 85||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:41:25,996][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 11:41:25,997][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:26,001][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:26,002][root][INFO] - Saved parsed outputs
[2025-03-06 11:41:26,002][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:26,006][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:26,006][root][INFO] - Saved parsing metadata
[2025-03-06 11:41:26,006][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:26,061][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:41:26,063][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:41:26,166][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:41:26,166][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.09090909090909091, 'malformed_label': 7, 'malformed_domain': 80, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 9, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.07142857142857142, 'Criminal_Law_accuracy': 0.3076923076923077, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.23076923076923078, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.04040404040404041, 'Contracts_confidence': 0.020202020202020204, 'Criminal_Law_confidence': 0.050505050505050504, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.04040404040404041, 'Civil_Procedure_confidence': 0.04040404040404041, 'correct_domain_wrong_label': 10, 'correct_label_wrong_domain': 37, 'both_wrong': 43}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 11:41:37,431][root][INFO] - Setting global seed to 206
[2025-03-06 11:41:37,439][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:41:37,439][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:41:37,440][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:41:37,455][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:41:37,458][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:41:37,458][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:41:37,629][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:41:38,188][root][INFO] - Full model selected, loading model
[2025-03-06 11:42:03,299][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:42:03,311][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:42:11,584][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:42:11,585][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:42:11,585][root][INFO] - Starting inference
[2025-03-06 11:42:11,782][root][INFO] - Processing question number 0
[2025-03-06 11:42:11,784][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:42:19,225][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:42:25,876][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:42:35,631][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:42:42,210][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:42:48,240][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:42:55,146][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:43:00,848][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:43:05,706][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:43:11,585][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:43:16,360][root][INFO] - Processing question number 10
[2025-03-06 11:43:16,361][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:43:22,003][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:43:28,706][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:43:34,749][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:43:42,909][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:43:49,196][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:43:53,248][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:43:59,548][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:44:10,815][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:44:15,221][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:44:20,886][root][INFO] - Processing question number 20
[2025-03-06 11:44:20,888][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:44:27,698][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:44:33,395][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:44:38,530][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:44:46,284][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:44:54,614][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:45:00,020][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:45:07,035][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:45:14,594][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:45:21,753][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:45:29,725][root][INFO] - Processing question number 30
[2025-03-06 11:45:29,727][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:45:37,219][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:45:43,379][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:45:51,743][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:45:58,699][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:46:04,231][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:46:10,996][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:46:15,625][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:46:22,318][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:46:29,674][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:46:36,196][root][INFO] - Processing question number 40
[2025-03-06 11:46:36,199][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:46:42,829][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:46:51,532][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:46:59,601][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:47:06,364][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:47:11,179][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:47:20,887][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:47:27,674][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:47:34,791][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:47:44,756][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:47:52,965][root][INFO] - Processing question number 50
[2025-03-06 11:47:52,968][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:48:02,243][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:48:13,701][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:48:20,130][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:48:29,414][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:48:37,829][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:48:48,211][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:48:58,240][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:49:02,619][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:49:07,997][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:49:14,344][root][INFO] - Processing question number 60
[2025-03-06 11:49:14,347][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:49:20,624][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:49:27,661][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:49:34,319][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:49:39,820][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:49:47,952][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:49:57,235][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:50:06,439][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:50:13,793][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:50:21,525][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:50:29,244][root][INFO] - Processing question number 70
[2025-03-06 11:50:29,248][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:50:35,601][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:50:43,552][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:50:48,008][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:50:54,982][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:51:01,605][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:51:09,473][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:51:21,207][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:51:35,926][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:51:41,529][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:51:47,108][root][INFO] - Processing question number 80
[2025-03-06 11:51:47,111][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:51:52,720][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:52:00,430][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:52:05,372][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:52:10,957][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:52:17,494][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:52:27,335][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:52:33,769][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:52:40,943][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:52:54,229][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:52:59,992][root][INFO] - Processing question number 90
[2025-03-06 11:52:59,996][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:53:05,930][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:53:13,251][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:53:19,944][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:53:23,971][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:53:31,151][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:53:36,920][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:53:42,593][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:53:50,771][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:53:56,960][root][INFO] - Inference complete
[2025-03-06 11:53:56,960][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:56,965][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:56,974][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:53:56,974][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 11:53:56,974][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:53:56,977][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:56,981][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:56,982][root][INFO] - Saved parsed outputs
[2025-03-06 11:53:56,982][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:56,983][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:56,983][root][INFO] - Saved parsing metadata
[2025-03-06 11:53:56,984][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:57,006][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:53:57,008][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:53:57,038][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 11:53:57,038][root][INFO] - Summary of metrics : {'label_accuracy': 0.5353535353535354, 'misclassification_rate': 0.46464646464646464, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 53, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 53, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 11:54:07,015][root][INFO] - Setting global seed to 989
[2025-03-06 11:54:07,036][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:54:07,036][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 11:54:07,037][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:54:07,053][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:54:07,055][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:54:07,055][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:54:07,231][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:54:07,783][root][INFO] - Full model selected, loading model
[2025-03-06 11:54:25,186][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:56:20,012][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:56:20,013][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:56:57,001][root][INFO] - Peft model loaded successfully
[2025-03-06 11:57:04,574][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:57:04,576][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 11:57:04,576][root][INFO] - Starting inference
[2025-03-06 11:57:04,789][root][INFO] - Processing question number 0
[2025-03-06 11:57:04,791][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:57:09,399][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:57:16,579][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:57:23,860][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:57:45,262][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:57:54,666][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:58:05,795][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:58:11,125][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:58:39,462][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:58:43,495][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:58:48,188][root][INFO] - Processing question number 10
[2025-03-06 11:58:48,189][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:58:54,555][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:59:01,992][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:59:06,085][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:59:13,017][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:59:18,421][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:59:30,229][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:59:36,014][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:59:45,282][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:59:53,407][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:00:03,643][root][INFO] - Processing question number 20
[2025-03-06 12:00:03,645][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:00:13,021][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:00:18,216][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:00:24,328][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:00:29,192][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:00:36,254][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:00:40,572][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:00:44,941][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:00:54,062][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:01:22,428][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:01:28,796][root][INFO] - Processing question number 30
[2025-03-06 12:01:28,798][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:01:57,179][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:02:07,611][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:02:14,680][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:02:21,607][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:02:25,964][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:02:43,730][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:02:48,907][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:03:00,631][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:03:06,053][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:03:14,143][root][INFO] - Processing question number 40
[2025-03-06 12:03:14,146][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:03:26,250][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:03:34,048][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:03:42,126][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:03:48,420][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:03:54,803][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:03:59,629][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:04:11,092][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:04:19,605][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:04:24,510][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:04:29,161][root][INFO] - Processing question number 50
[2025-03-06 12:04:29,164][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:04:33,807][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:04:40,222][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:04:47,205][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:04:55,604][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:05:11,773][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:05:17,875][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:05:28,166][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:05:36,536][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:05:42,321][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:05:47,965][root][INFO] - Processing question number 60
[2025-03-06 12:05:47,968][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:05:55,574][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:06:02,139][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:06:30,834][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:06:39,300][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:06:45,810][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:06:58,655][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:07:10,071][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:07:27,673][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:07:35,100][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:07:42,287][root][INFO] - Processing question number 70
[2025-03-06 12:07:42,290][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:07:49,264][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:07:53,543][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:07:57,416][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:08:09,649][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:08:17,682][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:08:24,795][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:08:33,386][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:08:46,540][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:09:01,185][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:09:07,344][root][INFO] - Processing question number 80
[2025-03-06 12:09:07,348][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:09:17,299][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:09:34,092][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:09:43,858][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:09:54,657][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:10:03,069][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:10:12,717][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:10:19,642][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:10:29,341][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:10:57,772][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:11:04,994][root][INFO] - Processing question number 90
[2025-03-06 12:11:04,998][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:11:12,123][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:11:18,118][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:11:26,424][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:11:33,653][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:11:41,411][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:11:47,840][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:11:55,744][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:12:02,310][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:12:09,798][root][INFO] - Inference complete
[2025-03-06 12:12:09,799][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,804][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,806][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:09,806][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:09,807][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:09,807][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:12:09,808][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:09,808][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 12:12:09,808][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:09,810][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:09,810][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:09,810][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:09,810][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:12:09,811][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:09,811][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:09,811][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:09,811][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:12:09,815][root][WARNING] - |Q. 34||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:09,815][root][WARNING] - |Q. 34||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:09,815][root][INFO] - |Q. 34||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:09,815][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:12:09,818][root][WARNING] - |Q. 26||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:12:09,819][root][WARNING] - |Q. 26||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:12:09,819][root][INFO] - |Q. 26||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:12:09,819][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:12:09,821][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,825][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,825][root][INFO] - Saved parsed outputs
[2025-03-06 12:12:09,825][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,826][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,826][root][INFO] - Saved parsing metadata
[2025-03-06 12:12:09,827][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,828][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:09,830][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:12:09,837][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:12:09,838][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.030303030303030304, 'malformed_label': 8, 'malformed_domain': 94, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 3, 'Constitutional_Law_accuracy': 0.07142857142857142, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07692307692307693, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.020202020202020204, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.010101010101010102, 'Civil_Procedure_confidence': 0.010101010101010102, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 48, 'both_wrong': 46}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 12:12:17,041][root][INFO] - Setting global seed to 989
[2025-03-06 12:12:17,047][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:12:17,047][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:12:17,048][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:12:17,050][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:12:17,052][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:12:17,052][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:12:17,209][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:12:17,900][root][INFO] - Full model selected, loading model
[2025-03-06 12:12:44,493][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:12:44,526][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:12:53,097][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:12:53,099][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:12:53,099][root][INFO] - Starting inference
[2025-03-06 12:12:53,302][root][INFO] - Processing question number 0
[2025-03-06 12:12:53,304][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:12:59,217][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:13:05,750][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:13:12,900][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:13:24,827][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:13:29,697][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:13:35,718][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:13:41,641][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:13:48,956][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:13:55,051][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:14:01,225][root][INFO] - Processing question number 10
[2025-03-06 12:14:01,227][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:14:08,327][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:14:14,865][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:14:22,983][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:14:33,432][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:14:37,561][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:14:42,144][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:14:49,003][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:14:53,808][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:14:58,570][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:15:03,282][root][INFO] - Processing question number 20
[2025-03-06 12:15:03,284][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:15:10,346][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:15:16,073][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:15:21,688][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:15:27,656][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:15:33,747][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:15:41,630][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:15:47,560][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:15:57,960][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:16:03,455][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:16:11,700][root][INFO] - Processing question number 30
[2025-03-06 12:16:11,703][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:16:18,476][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:16:34,510][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:16:41,414][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:16:47,293][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:16:53,662][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:16:59,618][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:17:05,493][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:17:13,397][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:17:17,898][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:17:22,882][root][INFO] - Processing question number 40
[2025-03-06 12:17:22,885][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:17:28,166][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:17:34,852][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:17:42,055][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:17:50,591][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:17:55,089][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:18:23,476][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:18:29,405][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:18:35,508][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:18:42,442][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:18:47,129][root][INFO] - Processing question number 50
[2025-03-06 12:18:47,132][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:18:51,542][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:19:01,575][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:19:05,752][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:19:13,582][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:19:21,499][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:19:27,644][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:19:35,383][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:19:41,544][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:19:47,601][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:19:53,469][root][INFO] - Processing question number 60
[2025-03-06 12:19:53,472][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:20:00,943][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:20:09,129][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:20:17,692][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:20:25,690][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:20:33,056][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:20:43,249][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:20:49,249][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:20:54,928][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:21:02,761][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:21:12,607][root][INFO] - Processing question number 70
[2025-03-06 12:21:12,610][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:21:17,858][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:21:25,953][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:21:32,064][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:21:39,648][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:21:47,810][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:21:54,870][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:22:04,711][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:22:10,025][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:22:15,709][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:22:24,186][root][INFO] - Processing question number 80
[2025-03-06 12:22:24,189][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:22:28,788][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:22:36,976][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:22:41,868][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:22:47,433][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:22:55,099][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:23:02,436][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:23:09,312][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:23:16,318][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:23:23,001][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:23:29,766][root][INFO] - Processing question number 90
[2025-03-06 12:23:29,770][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:23:38,572][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:23:44,124][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:23:52,383][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:23:56,275][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:24:04,165][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:24:10,133][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:24:15,877][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:24:22,929][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:24:29,048][root][INFO] - Inference complete
[2025-03-06 12:24:29,048][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,053][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,057][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:24:29,058][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:24:29,058][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:24:29,059][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:24:29,064][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,068][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,068][root][INFO] - Saved parsed outputs
[2025-03-06 12:24:29,068][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,070][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,070][root][INFO] - Saved parsing metadata
[2025-03-06 12:24:29,071][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,072][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:24:29,074][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:24:29,102][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:24:29,103][root][INFO] - Summary of metrics : {'label_accuracy': 0.5656565656565656, 'misclassification_rate': 0.43434343434343436, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 56, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 56, 'both_wrong': 43}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 12:24:37,012][root][INFO] - Setting global seed to 989
[2025-03-06 12:24:37,018][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:24:37,019][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:24:37,020][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:24:37,021][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:24:37,025][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:24:37,025][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:24:37,172][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:24:37,754][root][INFO] - Full model selected, loading model
[2025-03-06 12:24:56,560][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:26:49,494][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:26:49,494][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:27:25,552][root][INFO] - Peft model loaded successfully
[2025-03-06 12:27:33,129][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:27:33,130][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:27:33,130][root][INFO] - Starting inference
[2025-03-06 12:27:33,332][root][INFO] - Processing question number 0
[2025-03-06 12:27:33,335][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:27:38,462][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:27:46,399][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:27:55,540][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:28:07,846][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:28:17,017][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:28:23,228][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:28:27,964][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:28:37,174][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:28:45,875][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:28:50,376][root][INFO] - Processing question number 10
[2025-03-06 12:28:50,377][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:28:55,606][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:29:11,470][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:29:15,920][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:29:23,608][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:29:28,145][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:29:36,706][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:29:43,898][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:29:51,404][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:29:57,305][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:30:09,716][root][INFO] - Processing question number 20
[2025-03-06 12:30:09,718][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:30:14,656][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:30:20,262][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:30:26,971][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:30:32,328][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:30:37,882][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:30:44,697][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:30:48,411][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:30:58,584][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:31:05,420][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:31:09,870][root][INFO] - Processing question number 30
[2025-03-06 12:31:09,873][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:31:16,620][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:31:25,321][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:31:32,958][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:31:37,496][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:31:41,400][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:32:07,211][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:32:12,293][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:32:19,026][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:32:27,064][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:32:33,439][root][INFO] - Processing question number 40
[2025-03-06 12:32:33,442][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:32:39,967][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:32:46,722][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:32:54,734][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:33:04,006][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:33:09,537][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:33:22,547][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:33:33,160][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:33:39,859][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:33:46,401][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:33:51,179][root][INFO] - Processing question number 50
[2025-03-06 12:33:51,182][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:33:55,312][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:34:08,920][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:34:14,307][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:34:21,274][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:34:30,186][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:34:37,286][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:34:46,957][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:35:00,858][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:35:10,082][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:35:15,763][root][INFO] - Processing question number 60
[2025-03-06 12:35:15,766][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:35:24,085][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:35:35,960][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:35:43,678][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:35:47,647][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:35:53,707][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:36:01,688][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:36:05,557][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:36:10,607][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:36:15,480][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:36:27,295][root][INFO] - Processing question number 70
[2025-03-06 12:36:27,298][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:36:34,331][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:36:42,200][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:36:46,288][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:37:15,203][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:37:22,338][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:37:27,164][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:37:36,816][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:37:39,634][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:37:48,235][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:38:01,808][root][INFO] - Processing question number 80
[2025-03-06 12:38:01,812][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:38:13,170][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:38:21,752][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:38:32,128][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:38:39,346][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:38:45,374][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:38:52,639][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:38:59,485][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:39:03,478][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:39:16,036][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:39:20,981][root][INFO] - Processing question number 90
[2025-03-06 12:39:20,985][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:39:32,688][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:39:38,873][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:39:45,099][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:39:48,586][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:39:55,945][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:40:03,647][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:40:12,104][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:40:17,925][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:40:26,814][root][INFO] - Inference complete
[2025-03-06 12:40:26,814][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,819][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,827][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:40:26,828][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:40:26,828][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:40:26,828][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 12:40:26,831][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,835][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,836][root][INFO] - Saved parsed outputs
[2025-03-06 12:40:26,836][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,837][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,837][root][INFO] - Saved parsing metadata
[2025-03-06 12:40:26,838][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,839][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:40:26,841][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:40:26,881][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:40:26,881][root][INFO] - Summary of metrics : {'label_accuracy': 0.5151515151515151, 'misclassification_rate': 0.48484848484848486, 'combined_accuracy': 0.04040404040404041, 'malformed_label': 5, 'malformed_domain': 91, 'total_predictions': 99, 'correct_predictions': 51, 'correct_label_and_domain': 4, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.15384615384615385, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07692307692307693, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.030303030303030304, 'Evidence_confidence': 0.010101010101010102, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.020202020202020204, 'Civil_Procedure_confidence': 0.010101010101010102, 'correct_domain_wrong_label': 4, 'correct_label_wrong_domain': 47, 'both_wrong': 44}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 12:40:38,602][root][INFO] - Setting global seed to 989
[2025-03-06 12:40:38,609][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:40:38,609][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:40:38,610][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:40:38,612][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:40:38,614][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:40:38,614][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:40:38,791][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:40:39,404][root][INFO] - Full model selected, loading model
[2025-03-06 12:41:04,858][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:41:04,918][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:41:13,135][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:41:13,137][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:41:13,137][root][INFO] - Starting inference
[2025-03-06 12:41:13,341][root][INFO] - Processing question number 0
[2025-03-06 12:41:13,343][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:41:17,882][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:41:22,591][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:41:31,963][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:41:40,426][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:41:45,949][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:41:55,522][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:42:03,067][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:42:09,474][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:42:14,401][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:42:21,473][root][INFO] - Processing question number 10
[2025-03-06 12:42:21,475][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:42:28,823][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:42:36,238][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:42:42,498][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:42:48,331][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:42:54,010][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:42:58,548][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:43:06,193][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:43:13,747][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:43:18,640][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:43:26,211][root][INFO] - Processing question number 20
[2025-03-06 12:43:26,213][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:43:32,055][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:43:40,187][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:43:47,573][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:43:53,961][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:44:01,673][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:44:09,634][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:44:18,234][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:44:23,762][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:44:30,315][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:44:36,018][root][INFO] - Processing question number 30
[2025-03-06 12:44:36,020][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:44:43,177][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:44:49,512][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:44:56,620][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:45:03,435][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:45:09,007][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:45:19,640][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:45:26,908][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:45:34,106][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:45:39,484][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:45:45,677][root][INFO] - Processing question number 40
[2025-03-06 12:45:45,680][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:45:51,614][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:45:58,512][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:46:05,873][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:46:13,744][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:46:20,464][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:46:26,612][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:46:36,362][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:46:41,180][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:46:48,182][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:46:52,824][root][INFO] - Processing question number 50
[2025-03-06 12:46:52,826][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:46:56,672][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:47:04,482][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:47:08,253][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:47:17,243][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:47:25,510][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:47:31,940][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:47:38,153][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:47:43,474][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:47:50,828][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:47:58,346][root][INFO] - Processing question number 60
[2025-03-06 12:47:58,349][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:48:02,818][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:48:11,089][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:48:23,542][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:48:32,036][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:48:36,360][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:48:46,655][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:48:52,115][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:48:57,803][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:49:02,354][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:49:10,244][root][INFO] - Processing question number 70
[2025-03-06 12:49:10,247][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:49:15,772][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:49:23,578][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:49:29,162][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:49:36,130][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:49:42,245][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:49:48,290][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:49:56,579][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:50:04,708][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:50:10,577][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:50:17,298][root][INFO] - Processing question number 80
[2025-03-06 12:50:17,302][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:50:22,215][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:50:28,489][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:50:36,795][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:50:45,166][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:50:50,771][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:50:57,292][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:51:03,996][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:51:10,706][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:51:17,502][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:51:24,248][root][INFO] - Processing question number 90
[2025-03-06 12:51:24,252][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:51:33,268][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:51:38,963][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:51:46,519][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:51:50,761][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:51:58,860][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:52:04,080][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:52:10,927][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:52:17,162][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:52:21,960][root][INFO] - Inference complete
[2025-03-06 12:52:21,961][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,965][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,976][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,980][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,980][root][INFO] - Saved parsed outputs
[2025-03-06 12:52:21,980][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,981][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,981][root][INFO] - Saved parsing metadata
[2025-03-06 12:52:21,981][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,996][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:52:21,998][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:52:22,014][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 12:52:22,014][root][INFO] - Summary of metrics : {'label_accuracy': 0.6060606060606061, 'misclassification_rate': 0.3939393939393939, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 60, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 60, 'both_wrong': 39}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 12:52:30,176][root][INFO] - Setting global seed to 989
[2025-03-06 12:52:30,183][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:52:30,183][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 12:52:30,185][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:52:30,186][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:52:30,189][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:52:30,189][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:52:30,355][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:52:30,945][root][INFO] - Full model selected, loading model
[2025-03-06 12:52:48,543][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:54:41,779][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:54:41,779][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:55:19,843][root][INFO] - Peft model loaded successfully
[2025-03-06 12:55:27,383][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:55:27,385][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 12:55:27,385][root][INFO] - Starting inference
[2025-03-06 12:55:27,623][root][INFO] - Processing question number 0
[2025-03-06 12:55:27,625][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:55:34,233][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:55:43,089][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:56:11,465][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:56:29,820][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:56:42,423][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:56:48,233][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:56:52,737][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:57:00,112][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:57:05,675][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:57:10,588][root][INFO] - Processing question number 10
[2025-03-06 12:57:10,590][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:57:15,816][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:57:24,410][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:57:27,909][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:57:34,070][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:57:42,758][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:57:48,602][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:57:56,521][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:58:01,563][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:58:06,329][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:58:11,268][root][INFO] - Processing question number 20
[2025-03-06 12:58:11,270][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:58:26,622][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:58:32,370][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:58:39,760][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:58:46,378][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:58:52,805][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:59:01,363][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:59:09,641][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:59:18,988][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:59:47,674][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:59:53,653][root][INFO] - Processing question number 30
[2025-03-06 12:59:53,678][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:59:59,967][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:00:05,437][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:00:13,589][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:00:20,130][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:00:24,574][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:00:30,461][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:00:35,324][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:00:45,507][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:00:52,772][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:01:09,614][root][INFO] - Processing question number 40
[2025-03-06 13:01:09,617][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:01:18,603][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:01:28,462][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:01:36,666][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:01:49,436][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:02:02,954][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:02:09,700][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:02:17,428][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:02:28,078][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:02:37,295][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:02:47,332][root][INFO] - Processing question number 50
[2025-03-06 13:02:47,335][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:02:54,952][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:03:06,025][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:03:12,766][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:03:20,340][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:03:32,854][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:03:42,447][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:03:50,016][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:03:55,337][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:04:04,515][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:04:09,688][root][INFO] - Processing question number 60
[2025-03-06 13:04:09,691][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:04:14,745][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:04:21,324][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:04:29,927][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:04:35,159][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:04:43,542][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:04:52,789][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:05:01,628][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:05:12,115][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:05:17,117][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:05:26,187][root][INFO] - Processing question number 70
[2025-03-06 13:05:26,190][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:05:37,098][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:05:49,869][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:05:54,759][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:06:01,272][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:06:05,671][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:06:16,315][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:06:23,200][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:06:36,627][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:06:45,012][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:06:53,040][root][INFO] - Processing question number 80
[2025-03-06 13:06:53,044][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:06:58,101][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:07:04,330][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:07:11,670][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:07:17,203][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:07:29,216][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:07:38,391][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:07:49,108][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:08:00,935][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:08:13,551][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:08:17,287][root][INFO] - Processing question number 90
[2025-03-06 13:08:17,291][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:08:27,677][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:08:34,540][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:08:43,524][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:08:52,943][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:09:01,740][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:09:10,773][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:09:20,474][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:09:29,195][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:09:40,678][root][INFO] - Inference complete
[2025-03-06 13:09:40,679][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,684][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,685][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:09:40,686][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:09:40,686][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:09:40,686][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:09:40,688][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:09:40,688][root][WARNING] - |Q. 98||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:09:40,688][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:09:40,690][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:09:40,690][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:09:40,690][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:09:40,690][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:09:40,694][root][WARNING] - |Q. 68||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:09:40,695][root][WARNING] - |Q. 68||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:09:40,695][root][INFO] - |Q. 68||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:09:40,695][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:09:40,696][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:09:40,696][root][WARNING] - |Q. 33||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:09:40,696][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:09:40,700][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,704][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,704][root][INFO] - Saved parsed outputs
[2025-03-06 13:09:40,704][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,714][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,714][root][INFO] - Saved parsing metadata
[2025-03-06 13:09:40,715][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,716][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:09:40,717][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:09:40,748][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 13:09:40,748][root][INFO] - Summary of metrics : {'label_accuracy': 0.5353535353535354, 'misclassification_rate': 0.46464646464646464, 'combined_accuracy': 0.08080808080808081, 'malformed_label': 3, 'malformed_domain': 83, 'total_predictions': 99, 'correct_predictions': 53, 'correct_label_and_domain': 8, 'Constitutional_Law_accuracy': 0.14285714285714285, 'Contracts_accuracy': 0.21428571428571427, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.13333333333333333, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0625, 'Constitutional_Law_confidence': 0.04040404040404041, 'Contracts_confidence': 0.0707070707070707, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.020202020202020204, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.020202020202020204, 'Civil_Procedure_confidence': 0.020202020202020204, 'correct_domain_wrong_label': 8, 'correct_label_wrong_domain': 45, 'both_wrong': 38}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 13:09:47,645][root][INFO] - Setting global seed to 989
[2025-03-06 13:09:47,650][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 13:09:47,650][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:09:47,652][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:09:47,653][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:09:47,655][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:09:47,655][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:09:47,817][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:09:48,421][root][INFO] - Full model selected, loading model
[2025-03-06 13:10:14,744][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:10:14,759][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:10:23,149][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:10:23,151][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:10:23,151][root][INFO] - Starting inference
[2025-03-06 13:10:23,369][root][INFO] - Processing question number 0
[2025-03-06 13:10:23,371][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:10:29,011][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:10:33,674][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:10:38,980][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:10:49,115][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:10:56,363][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:11:03,720][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:11:13,558][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:11:24,999][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:11:30,962][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:11:39,883][root][INFO] - Processing question number 10
[2025-03-06 13:11:39,885][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:11:45,426][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:11:56,407][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:12:03,449][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:12:12,349][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:12:17,338][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:12:22,863][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:12:30,051][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:12:36,499][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:12:40,718][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:12:46,016][root][INFO] - Processing question number 20
[2025-03-06 13:12:46,018][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:12:52,451][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:12:59,521][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:13:04,831][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:13:12,987][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:13:18,029][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:13:24,194][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:13:33,073][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:13:40,294][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:13:47,257][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:13:51,970][root][INFO] - Processing question number 30
[2025-03-06 13:13:51,972][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:13:59,955][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:14:07,351][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:14:14,456][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:14:21,445][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:14:28,015][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:14:33,753][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:14:37,653][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:14:44,104][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:14:53,345][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:14:59,344][root][INFO] - Processing question number 40
[2025-03-06 13:14:59,347][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:15:07,534][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:15:14,061][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:15:28,246][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:15:34,495][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:15:41,122][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:15:47,225][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:15:51,471][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:15:56,338][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:16:01,602][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:16:07,765][root][INFO] - Processing question number 50
[2025-03-06 13:16:07,767][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:16:15,377][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:16:22,396][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:16:25,849][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:16:34,120][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:16:42,837][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:16:52,457][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:17:03,360][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:17:10,255][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:17:18,816][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:17:25,807][root][INFO] - Processing question number 60
[2025-03-06 13:17:25,810][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:17:37,347][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:17:45,062][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:17:49,181][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:17:55,124][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:17:59,850][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:18:04,983][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:18:09,209][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:18:15,857][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:18:20,497][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:18:29,260][root][INFO] - Processing question number 70
[2025-03-06 13:18:29,263][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:18:34,563][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:18:39,855][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:18:45,749][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:18:52,803][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:19:01,959][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:19:10,230][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:19:18,606][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:19:25,121][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:19:30,807][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:19:36,608][root][INFO] - Processing question number 80
[2025-03-06 13:19:36,612][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:19:43,775][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:19:50,549][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:19:59,489][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:20:06,519][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:20:14,619][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:20:20,491][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:20:27,007][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:20:34,947][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:20:48,353][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:20:56,359][root][INFO] - Processing question number 90
[2025-03-06 13:20:56,363][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:21:06,224][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:21:12,187][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:21:19,831][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:21:27,485][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:21:33,867][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:21:40,884][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:21:45,779][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:21:58,457][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:22:05,884][root][INFO] - Inference complete
[2025-03-06 13:22:05,884][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,889][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,895][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:22:05,896][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:22:05,896][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:22:05,896][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:22:05,901][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,905][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,905][root][INFO] - Saved parsed outputs
[2025-03-06 13:22:05,905][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,906][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,906][root][INFO] - Saved parsing metadata
[2025-03-06 13:22:05,907][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,908][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
[2025-03-06 13:22:05,910][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:22:05,953][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_1
[2025-03-06 13:22:05,953][root][INFO] - Summary of metrics : {'label_accuracy': 0.494949494949495, 'misclassification_rate': 0.505050505050505, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 49, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 49, 'both_wrong': 50}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 13:22:14,705][root][INFO] - Setting global seed to 206
[2025-03-06 13:22:14,713][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 13:22:14,713][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:22:14,715][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:22:14,730][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:22:14,734][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:22:14,734][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:22:14,890][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:22:15,450][root][INFO] - Full model selected, loading model
[2025-03-06 13:22:33,492][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:24:26,775][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:24:26,775][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:25:04,624][root][INFO] - Peft model loaded successfully
[2025-03-06 13:25:12,205][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:25:12,208][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:25:12,208][root][INFO] - Starting inference
[2025-03-06 13:25:12,431][root][INFO] - Processing question number 0
[2025-03-06 13:25:12,433][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:25:20,084][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:25:25,986][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:25:34,585][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:25:47,727][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:25:54,180][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:26:01,154][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:26:08,349][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:26:14,575][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:26:25,532][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:26:31,913][root][INFO] - Processing question number 10
[2025-03-06 13:26:31,914][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:26:41,007][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:26:50,247][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:27:02,272][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:27:13,037][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:27:19,743][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:27:24,783][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:27:28,391][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:27:31,773][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:27:38,972][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:27:43,441][root][INFO] - Processing question number 20
[2025-03-06 13:27:43,443][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:27:49,636][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:27:54,727][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:28:03,725][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:28:14,013][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:28:22,026][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:28:28,606][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:28:40,175][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:28:49,775][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:28:58,879][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:29:06,261][root][INFO] - Processing question number 30
[2025-03-06 13:29:06,263][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:29:12,995][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:29:21,414][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:29:27,666][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:29:33,074][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:29:39,322][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:29:44,051][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:29:53,663][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:30:00,138][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:30:14,240][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:30:19,529][root][INFO] - Processing question number 40
[2025-03-06 13:30:19,533][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:30:27,336][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:30:35,302][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:30:43,784][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:30:50,958][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:31:04,001][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:31:12,041][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:31:20,234][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:31:25,922][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:31:40,579][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:31:46,531][root][INFO] - Processing question number 50
[2025-03-06 13:31:46,534][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:31:52,417][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:31:55,095][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:32:01,572][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:32:12,900][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:32:18,690][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:32:24,304][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:32:38,280][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:32:47,200][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:32:53,918][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:32:59,970][root][INFO] - Processing question number 60
[2025-03-06 13:32:59,974][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:33:05,071][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:33:15,440][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 13:33:23,736][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 13:33:33,128][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 13:33:41,200][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 13:34:09,353][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 13:34:18,268][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 13:34:27,617][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 13:34:33,976][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 13:34:38,670][root][INFO] - Processing question number 70
[2025-03-06 13:34:38,679][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 13:34:44,865][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:34:48,707][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:34:58,518][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:35:12,829][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:35:40,776][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:35:47,038][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:35:57,028][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:36:10,824][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:36:19,051][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:36:25,071][root][INFO] - Processing question number 80
[2025-03-06 13:36:25,075][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:36:34,248][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:36:41,812][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:36:54,942][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:36:59,864][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:37:12,492][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:37:17,749][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:37:33,108][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:37:38,759][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:37:43,318][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:37:47,379][root][INFO] - Processing question number 90
[2025-03-06 13:37:47,383][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:37:53,295][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:38:00,653][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:38:10,389][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:38:15,390][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:38:24,498][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:38:36,607][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:38:49,163][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:38:57,180][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:39:02,429][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:39:09,847][root][INFO] - Inference complete
[2025-03-06 13:39:09,847][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,854][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,860][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:09,860][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:09,861][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:09,861][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:39:09,863][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:09,864][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:09,864][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:09,864][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:39:09,865][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:09,865][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 13:39:09,865][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:09,865][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:39:09,866][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:39:09,866][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:39:09,866][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 13:39:09,869][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,873][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,873][root][INFO] - Saved parsed outputs
[2025-03-06 13:39:09,873][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,875][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,875][root][INFO] - Saved parsing metadata
[2025-03-06 13:39:09,876][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,878][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:09,879][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:39:09,906][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 13:39:09,906][root][INFO] - Summary of metrics : {'label_accuracy': 0.51, 'misclassification_rate': 0.49, 'combined_accuracy': 0.0, 'malformed_label': 5, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 51, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 51, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 13:39:19,905][root][INFO] - Setting global seed to 206
[2025-03-06 13:39:19,913][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 13:39:19,913][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:39:19,914][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:39:19,926][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:39:19,929][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:39:19,929][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:39:20,098][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:39:20,712][root][INFO] - Full model selected, loading model
[2025-03-06 13:39:47,046][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:39:47,070][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:39:55,440][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:39:55,442][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:39:55,442][root][INFO] - Starting inference
[2025-03-06 13:39:55,621][root][INFO] - Processing question number 0
[2025-03-06 13:39:55,624][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:40:04,238][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:40:10,749][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:40:21,133][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:40:27,865][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:40:34,007][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:40:40,359][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:40:46,193][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:40:53,607][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:41:00,321][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:41:06,345][root][INFO] - Processing question number 10
[2025-03-06 13:41:06,347][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:41:11,694][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:41:19,479][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:41:25,138][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:41:31,529][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:41:43,108][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:41:49,229][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:41:54,711][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:42:00,233][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:42:08,758][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:42:16,186][root][INFO] - Processing question number 20
[2025-03-06 13:42:16,188][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:42:21,226][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:42:26,903][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:42:31,612][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:42:39,349][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:42:44,690][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:42:50,400][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:42:56,454][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:43:02,493][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:43:08,326][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:43:14,470][root][INFO] - Processing question number 30
[2025-03-06 13:43:14,473][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:43:20,478][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:43:26,399][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:43:36,295][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:43:42,472][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:43:47,909][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:43:53,316][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:44:00,601][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:44:06,204][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:44:11,109][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:44:20,581][root][INFO] - Processing question number 40
[2025-03-06 13:44:20,583][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:44:26,245][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:44:31,104][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:44:38,122][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:44:42,813][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:44:51,514][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:44:57,374][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:45:02,849][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:45:08,904][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:45:18,326][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:45:26,199][root][INFO] - Processing question number 50
[2025-03-06 13:45:26,202][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:45:34,103][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:45:40,998][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:45:49,372][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:45:57,661][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:46:02,963][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:46:09,117][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:46:17,764][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:46:23,402][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:46:33,901][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:46:41,315][root][INFO] - Processing question number 60
[2025-03-06 13:46:41,319][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:46:46,635][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:46:56,186][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 13:47:01,926][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 13:47:06,837][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 13:47:13,580][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 13:47:19,421][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 13:47:23,884][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 13:47:27,805][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 13:47:34,437][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 13:47:40,561][root][INFO] - Processing question number 70
[2025-03-06 13:47:40,565][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 13:47:46,745][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:47:51,925][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:48:01,595][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:48:10,631][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:48:16,336][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:48:23,923][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:48:31,616][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:48:44,157][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:48:49,658][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:48:54,960][root][INFO] - Processing question number 80
[2025-03-06 13:48:54,964][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:49:00,138][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:49:07,569][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:49:14,775][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:49:19,313][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:49:24,894][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:49:33,141][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:49:40,992][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:49:46,775][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:49:52,784][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:50:01,147][root][INFO] - Processing question number 90
[2025-03-06 13:50:01,151][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:50:06,103][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:50:11,718][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:50:23,464][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:50:28,776][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:50:34,822][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:50:42,226][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:50:47,681][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:50:53,565][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:51:02,892][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:51:09,055][root][INFO] - Inference complete
[2025-03-06 13:51:09,055][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,061][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,071][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,087][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,087][root][INFO] - Saved parsed outputs
[2025-03-06 13:51:09,087][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,089][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,089][root][INFO] - Saved parsing metadata
[2025-03-06 13:51:09,090][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,091][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:51:09,092][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:51:09,167][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 13:51:09,167][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 52}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 13:51:17,763][root][INFO] - Setting global seed to 206
[2025-03-06 13:51:17,770][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 13:51:17,771][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 13:51:17,772][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:51:17,774][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:51:17,776][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:51:17,776][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:51:17,929][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:51:18,656][root][INFO] - Full model selected, loading model
[2025-03-06 13:51:37,903][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:53:32,573][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:53:32,573][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:54:10,606][root][INFO] - Peft model loaded successfully
[2025-03-06 13:54:18,568][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:54:18,570][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 13:54:18,570][root][INFO] - Starting inference
[2025-03-06 13:54:18,783][root][INFO] - Processing question number 0
[2025-03-06 13:54:18,785][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:54:27,097][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:54:34,690][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:55:03,905][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:55:13,030][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:55:20,560][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:55:25,223][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:55:32,720][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:55:38,312][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:55:43,697][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:55:51,017][root][INFO] - Processing question number 10
[2025-03-06 13:55:51,019][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:56:00,337][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:56:28,855][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:56:39,737][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:56:48,274][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:56:54,768][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:57:00,360][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:57:11,008][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:57:15,099][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:57:25,341][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:57:32,475][root][INFO] - Processing question number 20
[2025-03-06 13:57:32,477][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:57:35,298][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:57:40,439][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:57:46,869][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:57:51,050][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:57:56,267][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:58:02,868][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:58:28,499][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:58:43,125][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:58:48,063][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:58:55,290][root][INFO] - Processing question number 30
[2025-03-06 13:58:55,293][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:59:03,744][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:59:08,374][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:59:15,850][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:59:20,884][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:59:36,693][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:59:46,308][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:00:04,017][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:00:11,818][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:00:26,608][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:00:42,415][root][INFO] - Processing question number 40
[2025-03-06 14:00:42,418][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:00:53,481][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:00:58,651][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:01:09,124][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:01:16,413][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:01:26,409][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:01:36,985][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:01:44,022][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:01:55,266][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:02:14,349][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:02:19,843][root][INFO] - Processing question number 50
[2025-03-06 14:02:19,846][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:02:27,697][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:02:30,399][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:02:39,914][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:02:48,784][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:02:55,487][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:03:01,973][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:03:13,095][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:03:18,738][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:03:24,185][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:03:30,388][root][INFO] - Processing question number 60
[2025-03-06 14:03:30,391][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:03:37,455][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:03:48,859][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:03:56,147][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:04:00,741][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:04:07,274][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:04:16,474][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:04:21,970][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:04:29,219][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:04:36,646][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:04:42,152][root][INFO] - Processing question number 70
[2025-03-06 14:04:42,156][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:04:50,380][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:04:56,441][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:05:25,370][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:05:40,972][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:05:49,683][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:06:03,248][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:06:13,092][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:06:42,078][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:06:49,797][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:06:53,569][root][INFO] - Processing question number 80
[2025-03-06 14:06:53,573][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:07:01,198][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:07:09,353][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:07:22,741][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:07:30,285][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:07:34,705][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:07:41,473][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:07:50,101][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:07:57,350][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:08:06,607][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:08:17,838][root][INFO] - Processing question number 90
[2025-03-06 14:08:17,842][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:08:24,358][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:08:37,821][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:08:50,948][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:08:54,766][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:09:00,447][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:09:05,694][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:09:13,140][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:09:16,333][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:09:36,404][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:09:43,306][root][INFO] - Inference complete
[2025-03-06 14:09:43,306][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,311][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,312][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,313][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:43,313][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,313][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:09:43,314][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,315][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:43,315][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,315][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:09:43,320][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,320][root][WARNING] - |Q. 19||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:43,320][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,321][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,321][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:43,321][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,322][root][WARNING] - |Q. 75||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,322][root][WARNING] - |Q. 75||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:43,322][root][INFO] - |Q. 75||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,322][root][WARNING] - |Q. 17||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,323][root][WARNING] - |Q. 17||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:43,323][root][INFO] - |Q. 17||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,323][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:09:43,323][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,323][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:09:43,323][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,324][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:43,324][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:43,324][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:43,325][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 14:09:43,328][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,334][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,334][root][INFO] - Saved parsed outputs
[2025-03-06 14:09:43,334][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,336][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,336][root][INFO] - Saved parsing metadata
[2025-03-06 14:09:43,336][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,338][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:09:43,348][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:09:43,381][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:09:43,381][root][INFO] - Summary of metrics : {'label_accuracy': 0.58, 'misclassification_rate': 0.42000000000000004, 'combined_accuracy': 0.01, 'malformed_label': 4, 'malformed_domain': 97, 'total_predictions': 100, 'correct_predictions': 58, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 57, 'both_wrong': 40}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 14:09:50,324][root][INFO] - Setting global seed to 206
[2025-03-06 14:09:50,330][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 14:09:50,330][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:09:50,331][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:09:50,333][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:09:50,336][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:09:50,336][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:09:50,542][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:09:51,125][root][INFO] - Full model selected, loading model
[2025-03-06 14:10:17,545][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:10:17,550][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:10:25,974][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:10:25,976][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:10:25,976][root][INFO] - Starting inference
[2025-03-06 14:10:26,171][root][INFO] - Processing question number 0
[2025-03-06 14:10:26,173][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:10:35,564][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:10:41,200][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:10:48,139][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:10:54,979][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:11:03,233][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:11:08,389][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:11:14,233][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:11:20,239][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:11:28,374][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:11:33,857][root][INFO] - Processing question number 10
[2025-03-06 14:11:33,859][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:11:39,573][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:11:48,898][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:11:56,585][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:12:02,767][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:12:10,723][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:12:16,673][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:12:22,345][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:12:29,746][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:12:38,257][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:12:45,012][root][INFO] - Processing question number 20
[2025-03-06 14:12:45,014][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:12:49,517][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:12:54,330][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:13:00,076][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:13:06,151][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:13:11,907][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:13:16,800][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:13:25,202][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:13:33,596][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:13:39,664][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:13:48,974][root][INFO] - Processing question number 30
[2025-03-06 14:13:48,977][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:13:54,850][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:14:00,417][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:14:07,361][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:14:13,638][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:14:19,351][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:14:24,899][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:14:33,491][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:14:39,651][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:14:50,036][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:14:59,965][root][INFO] - Processing question number 40
[2025-03-06 14:14:59,967][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:15:06,185][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:15:11,040][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:15:17,566][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:15:23,235][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:15:32,718][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:15:39,093][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:15:44,079][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:15:49,177][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:15:57,343][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:16:03,208][root][INFO] - Processing question number 50
[2025-03-06 14:16:03,210][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:16:08,724][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:16:16,323][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:16:25,227][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:16:36,289][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:16:44,856][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:16:52,258][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:17:01,018][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:17:06,424][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:17:12,606][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:17:19,451][root][INFO] - Processing question number 60
[2025-03-06 14:17:19,454][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:17:24,594][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:17:29,227][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:17:35,114][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:17:40,485][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:17:45,859][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:17:54,276][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:17:58,693][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:18:02,564][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:18:07,133][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:18:13,313][root][INFO] - Processing question number 70
[2025-03-06 14:18:13,317][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:18:17,900][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:18:23,454][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:18:30,194][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:18:37,851][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:18:43,252][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:18:50,399][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:18:59,957][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:19:08,750][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:19:13,721][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:19:18,622][root][INFO] - Processing question number 80
[2025-03-06 14:19:18,626][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:19:24,031][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:19:30,560][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:19:37,838][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:19:43,565][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:19:49,383][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:19:54,323][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:20:06,250][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:20:12,414][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:20:18,530][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:20:24,952][root][INFO] - Processing question number 90
[2025-03-06 14:20:24,956][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:20:30,093][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:20:36,316][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:20:42,423][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:20:47,698][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:20:54,733][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:21:02,910][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:21:12,762][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:21:19,758][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:21:27,984][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:21:34,114][root][INFO] - Inference complete
[2025-03-06 14:21:34,114][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,119][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,123][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:21:34,123][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:21:34,124][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:21:34,130][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,134][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,134][root][INFO] - Saved parsed outputs
[2025-03-06 14:21:34,134][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,135][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,135][root][INFO] - Saved parsing metadata
[2025-03-06 14:21:34,135][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,137][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:21:34,138][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:21:34,161][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:21:34,161][root][INFO] - Summary of metrics : {'label_accuracy': 0.45, 'misclassification_rate': 0.55, 'combined_accuracy': 0.0, 'malformed_label': 1, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 45, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 45, 'both_wrong': 55}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 14:21:41,847][root][INFO] - Setting global seed to 206
[2025-03-06 14:21:41,854][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:21:41,854][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:21:41,855][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:21:41,856][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:21:41,859][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:21:41,859][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:21:42,027][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:21:42,688][root][INFO] - Full model selected, loading model
[2025-03-06 14:22:04,614][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:23:59,306][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:23:59,307][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:24:36,726][root][INFO] - Peft model loaded successfully
[2025-03-06 14:24:44,256][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:24:44,257][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:24:44,257][root][INFO] - Starting inference
[2025-03-06 14:24:44,453][root][INFO] - Processing question number 0
[2025-03-06 14:24:44,455][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:24:52,412][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:24:59,635][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:25:24,997][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:25:34,784][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:25:41,037][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:25:48,086][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:26:00,116][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:26:06,086][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:26:14,956][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:26:23,109][root][INFO] - Processing question number 10
[2025-03-06 14:26:23,111][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:26:37,956][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:26:43,941][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:26:52,331][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:26:58,386][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:27:05,250][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:27:10,340][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:27:14,931][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:27:19,385][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:27:46,915][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:27:54,049][root][INFO] - Processing question number 20
[2025-03-06 14:27:54,051][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:27:57,759][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:28:12,939][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:28:18,195][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:28:26,569][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:28:35,357][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:28:42,511][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:28:52,264][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:29:01,409][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:29:06,989][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:29:12,460][root][INFO] - Processing question number 30
[2025-03-06 14:29:12,463][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:29:22,314][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:29:32,290][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:29:41,178][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:29:46,545][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:29:51,812][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:30:03,700][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:30:12,902][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:30:20,184][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:30:26,706][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:30:34,819][root][INFO] - Processing question number 40
[2025-03-06 14:30:34,822][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:30:41,689][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:30:45,197][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:30:52,057][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:31:00,756][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:31:14,348][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:31:23,302][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:31:28,653][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:31:48,370][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:31:56,130][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:32:01,036][root][INFO] - Processing question number 50
[2025-03-06 14:32:01,039][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:32:07,162][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:32:10,984][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:32:14,849][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:32:22,020][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:32:26,209][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:32:35,965][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:32:43,941][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:33:04,498][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:33:09,538][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:33:18,747][root][INFO] - Processing question number 60
[2025-03-06 14:33:18,750][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:33:25,737][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:33:34,784][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:33:41,890][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:33:58,131][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:34:04,342][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:34:11,022][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:34:18,923][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:34:26,356][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:34:35,350][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:34:42,080][root][INFO] - Processing question number 70
[2025-03-06 14:34:42,083][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:34:50,080][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:34:56,004][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:35:14,882][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:35:26,274][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:35:31,319][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:35:39,217][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:35:47,506][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:35:55,419][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:36:03,909][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:36:10,260][root][INFO] - Processing question number 80
[2025-03-06 14:36:10,264][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:36:17,247][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:36:22,578][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:36:30,878][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:36:36,720][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:36:46,563][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:37:00,906][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:37:14,777][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:37:20,669][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:37:25,137][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:37:30,008][root][INFO] - Processing question number 90
[2025-03-06 14:37:30,012][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:37:37,130][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:37:52,966][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:38:15,518][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:38:23,143][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:38:28,784][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:38:48,206][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:38:55,057][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:39:03,437][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:39:15,763][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:39:24,847][root][INFO] - Inference complete
[2025-03-06 14:39:24,847][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,853][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,858][root][WARNING] - |Q. 77||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:24,859][root][WARNING] - |Q. 77||D: Contracts| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:24,859][root][INFO] - |Q. 77||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:24,862][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:24,862][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:24,862][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:24,862][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:24,862][root][WARNING] - |Q. 61||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:24,863][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:24,863][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:39:24,864][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 14:39:24,864][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:39:24,867][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,872][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,872][root][INFO] - Saved parsed outputs
[2025-03-06 14:39:24,872][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,873][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,873][root][INFO] - Saved parsing metadata
[2025-03-06 14:39:24,873][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,891][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:39:24,918][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:39:24,940][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:39:24,940][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.02, 'malformed_label': 3, 'malformed_domain': 87, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 2, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.07692307692307693, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.06, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.01, 'Torts_confidence': 0.04, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 11, 'correct_label_wrong_domain': 54, 'both_wrong': 33}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 14:39:36,203][root][INFO] - Setting global seed to 206
[2025-03-06 14:39:36,211][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 14:39:36,211][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:39:36,213][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:39:36,215][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:39:36,217][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:39:36,217][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:39:36,374][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:39:36,963][root][INFO] - Full model selected, loading model
[2025-03-06 14:40:02,192][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:40:02,209][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:40:10,515][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:40:10,516][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:40:10,516][root][INFO] - Starting inference
[2025-03-06 14:40:10,696][root][INFO] - Processing question number 0
[2025-03-06 14:40:10,698][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:40:20,231][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:40:26,006][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:40:32,299][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:40:39,241][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:40:45,128][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:40:51,538][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:40:55,168][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:41:02,511][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:41:09,607][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:41:14,323][root][INFO] - Processing question number 10
[2025-03-06 14:41:14,325][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:41:18,879][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:41:23,324][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:41:28,134][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:41:35,310][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:41:41,332][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:41:49,310][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:41:54,799][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:42:00,290][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:42:09,601][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:42:18,774][root][INFO] - Processing question number 20
[2025-03-06 14:42:18,776][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:42:25,980][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:42:31,712][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:42:40,340][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:42:47,654][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:42:55,610][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:43:03,226][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:43:09,527][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:43:16,823][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:43:21,584][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:43:26,862][root][INFO] - Processing question number 30
[2025-03-06 14:43:26,864][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:43:31,734][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:43:37,668][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:43:45,261][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:43:52,467][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:43:58,457][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:44:03,411][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:44:10,490][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:44:19,208][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:44:24,301][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:44:33,862][root][INFO] - Processing question number 40
[2025-03-06 14:44:33,865][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:44:39,261][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:44:46,163][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:44:51,450][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:44:58,611][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:45:05,103][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:45:08,970][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:45:13,459][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:45:18,101][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:45:26,459][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:45:31,543][root][INFO] - Processing question number 50
[2025-03-06 14:45:31,545][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:45:36,462][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:45:44,422][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:45:50,492][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:46:02,359][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:46:07,576][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:46:14,663][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:46:21,614][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:46:29,327][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:46:39,974][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:46:53,871][root][INFO] - Processing question number 60
[2025-03-06 14:46:53,874][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:46:58,200][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:47:06,739][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:47:15,023][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:47:19,935][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:47:26,323][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:47:32,405][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:47:40,399][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:47:48,332][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:47:54,489][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:47:59,143][root][INFO] - Processing question number 70
[2025-03-06 14:47:59,147][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:48:05,252][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:48:10,491][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:48:21,762][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:48:28,203][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:48:32,842][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:48:41,755][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:48:48,297][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:48:55,051][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:49:03,182][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:49:09,037][root][INFO] - Processing question number 80
[2025-03-06 14:49:09,040][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:49:13,028][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:49:18,869][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:49:29,717][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:49:37,939][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:49:44,186][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:49:49,447][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:49:58,879][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:50:05,793][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:50:13,842][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:50:19,209][root][INFO] - Processing question number 90
[2025-03-06 14:50:19,212][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:50:25,177][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:50:32,095][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:50:38,618][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:50:41,398][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:50:48,481][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:50:54,843][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:51:01,408][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:51:09,737][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:51:15,851][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:51:22,142][root][INFO] - Inference complete
[2025-03-06 14:51:22,142][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,147][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,158][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,162][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,163][root][INFO] - Saved parsed outputs
[2025-03-06 14:51:22,163][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,164][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,164][root][INFO] - Saved parsing metadata
[2025-03-06 14:51:22,164][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,166][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:51:22,167][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:51:22,173][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 14:51:22,173][root][INFO] - Summary of metrics : {'label_accuracy': 0.49, 'misclassification_rate': 0.51, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 49, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 49, 'both_wrong': 51}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 14:51:28,911][root][INFO] - Setting global seed to 989
[2025-03-06 14:51:28,916][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:51:28,917][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 14:51:28,918][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:51:28,950][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:51:28,952][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:51:28,952][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:51:29,112][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:51:29,723][root][INFO] - Full model selected, loading model
[2025-03-06 14:51:57,268][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:53:52,416][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:53:52,417][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:54:28,351][root][INFO] - Peft model loaded successfully
[2025-03-06 14:54:35,869][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:54:35,871][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 14:54:35,871][root][INFO] - Starting inference
[2025-03-06 14:54:36,080][root][INFO] - Processing question number 0
[2025-03-06 14:54:36,081][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:54:43,829][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:54:49,735][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:54:58,330][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:55:11,464][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:55:17,914][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:55:24,883][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:55:32,075][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:55:38,291][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:55:49,243][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:55:55,621][root][INFO] - Processing question number 10
[2025-03-06 14:55:55,623][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:56:04,705][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:56:13,940][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:56:25,953][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:56:36,739][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:56:43,437][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:56:48,471][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:56:52,075][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:56:55,457][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:57:02,651][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:57:07,119][root][INFO] - Processing question number 20
[2025-03-06 14:57:07,122][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:57:13,310][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:57:18,400][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:57:27,396][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:57:37,685][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:57:45,694][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:57:52,273][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:58:03,836][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:58:13,434][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:58:22,539][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:58:29,921][root][INFO] - Processing question number 30
[2025-03-06 14:58:29,923][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:58:36,652][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:58:45,068][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:58:51,312][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:58:56,718][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:59:02,965][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:59:07,696][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:59:17,304][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:59:23,779][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:59:37,873][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:59:43,157][root][INFO] - Processing question number 40
[2025-03-06 14:59:43,159][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:59:50,954][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:59:58,911][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:00:07,386][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:00:14,551][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:00:27,592][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:00:35,636][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:00:43,829][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:00:49,516][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:01:04,164][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:01:10,113][root][INFO] - Processing question number 50
[2025-03-06 15:01:10,116][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:01:15,992][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:01:18,668][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:01:25,142][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:01:36,469][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:01:42,256][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:01:47,869][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:02:01,833][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:02:10,747][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:02:17,466][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:02:23,518][root][INFO] - Processing question number 60
[2025-03-06 15:02:23,521][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:02:28,617][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:02:38,988][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:02:47,282][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:02:56,674][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:03:04,744][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:03:32,893][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:03:41,799][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:03:51,147][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:03:57,507][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:04:02,202][root][INFO] - Processing question number 70
[2025-03-06 15:04:02,205][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:04:08,389][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:04:12,231][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:04:22,038][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:04:36,351][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:05:04,289][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:05:10,548][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:05:20,535][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:05:34,335][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:05:42,560][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:05:48,576][root][INFO] - Processing question number 80
[2025-03-06 15:05:48,580][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:05:57,747][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:06:05,312][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:06:18,436][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:06:23,359][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:06:35,992][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:06:41,249][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:06:56,596][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:07:02,246][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:07:06,805][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:07:10,864][root][INFO] - Processing question number 90
[2025-03-06 15:07:10,868][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:07:16,780][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:07:24,139][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:07:33,868][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:07:38,867][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:07:47,975][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:08:00,085][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:08:12,641][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:08:20,655][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:08:25,901][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:08:33,321][root][INFO] - Inference complete
[2025-03-06 15:08:33,321][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,327][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,333][root][WARNING] - |Q. 31||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:08:33,333][root][WARNING] - |Q. 31||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:08:33,334][root][INFO] - |Q. 31||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:08:33,334][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:08:33,336][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:08:33,336][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:08:33,336][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:08:33,336][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:08:33,337][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:08:33,338][root][WARNING] - |Q. 25||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:08:33,338][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:08:33,338][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:08:33,338][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:08:33,338][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:08:33,338][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:08:33,342][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,346][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,347][root][INFO] - Saved parsed outputs
[2025-03-06 15:08:33,347][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,348][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,348][root][INFO] - Saved parsing metadata
[2025-03-06 15:08:33,349][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,350][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:08:33,360][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:08:33,413][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:08:33,413][root][INFO] - Summary of metrics : {'label_accuracy': 0.51, 'misclassification_rate': 0.49, 'combined_accuracy': 0.0, 'malformed_label': 5, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 51, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 51, 'both_wrong': 49}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 15:08:42,031][root][INFO] - Setting global seed to 989
[2025-03-06 15:08:42,037][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:08:42,038][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:08:42,039][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:08:42,041][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:08:42,057][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:08:42,057][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:08:42,346][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:08:42,960][root][INFO] - Full model selected, loading model
[2025-03-06 15:09:09,198][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:09:09,228][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:09:17,374][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:09:17,376][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:09:17,376][root][INFO] - Starting inference
[2025-03-06 15:09:17,576][root][INFO] - Processing question number 0
[2025-03-06 15:09:17,578][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:09:26,055][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:09:32,554][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:09:42,923][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:09:49,653][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:09:55,787][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:10:02,129][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:10:07,955][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:10:15,353][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:10:22,063][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:10:28,076][root][INFO] - Processing question number 10
[2025-03-06 15:10:28,077][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:10:33,423][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:10:41,194][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:10:46,852][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:10:53,238][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:11:04,803][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:11:10,918][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:11:16,396][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:11:21,915][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:11:30,434][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:11:37,853][root][INFO] - Processing question number 20
[2025-03-06 15:11:37,855][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:11:42,891][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:11:48,563][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:11:53,268][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:12:01,001][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:12:06,340][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:12:12,052][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:12:18,100][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:12:24,132][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:12:29,958][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:12:36,094][root][INFO] - Processing question number 30
[2025-03-06 15:12:36,098][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:12:42,094][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:12:48,008][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:12:57,893][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:13:04,069][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:13:09,498][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:13:14,893][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:13:22,170][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:13:27,766][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:13:32,668][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:13:42,129][root][INFO] - Processing question number 40
[2025-03-06 15:13:42,132][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:13:47,785][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:13:52,636][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:13:59,644][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:14:04,329][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:14:13,018][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:14:18,869][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:14:24,341][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:14:30,384][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:14:39,791][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:14:47,652][root][INFO] - Processing question number 50
[2025-03-06 15:14:47,655][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:14:55,548][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:15:02,440][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:15:10,787][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:15:19,059][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:15:24,354][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:15:30,501][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:15:39,134][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:15:44,761][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:15:55,247][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:16:02,656][root][INFO] - Processing question number 60
[2025-03-06 15:16:02,659][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:16:07,971][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:16:17,510][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:16:23,249][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:16:28,154][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:16:34,889][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:16:40,726][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:16:45,189][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:16:49,107][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:16:55,735][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:17:01,854][root][INFO] - Processing question number 70
[2025-03-06 15:17:01,857][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:17:08,033][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:17:13,214][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:17:22,873][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:17:31,899][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:17:37,600][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:17:45,180][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:17:52,867][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:18:05,389][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:18:10,886][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:18:16,184][root][INFO] - Processing question number 80
[2025-03-06 15:18:16,187][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:18:21,359][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:18:28,782][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:18:35,984][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:18:40,519][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:18:46,100][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:18:54,339][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:19:02,183][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:19:07,963][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:19:13,964][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:19:22,321][root][INFO] - Processing question number 90
[2025-03-06 15:19:22,325][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:19:27,271][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:19:32,880][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:19:44,606][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:19:49,911][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:19:55,951][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:20:03,346][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:20:08,795][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:20:14,675][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:20:23,994][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:20:30,154][root][INFO] - Inference complete
[2025-03-06 15:20:30,154][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,161][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,172][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,176][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,176][root][INFO] - Saved parsed outputs
[2025-03-06 15:20:30,176][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,178][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,178][root][INFO] - Saved parsing metadata
[2025-03-06 15:20:30,179][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,219][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:20:30,220][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:20:30,320][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:20:30,320][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 52}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 15:20:39,211][root][INFO] - Setting global seed to 989
[2025-03-06 15:20:39,219][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:20:39,219][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:20:39,220][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:20:39,222][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:20:39,224][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:20:39,224][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:20:39,384][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:20:39,938][root][INFO] - Full model selected, loading model
[2025-03-06 15:20:59,535][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:22:53,285][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:22:53,286][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:23:28,299][root][INFO] - Peft model loaded successfully
[2025-03-06 15:23:35,897][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:23:35,899][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:23:35,899][root][INFO] - Starting inference
[2025-03-06 15:23:36,102][root][INFO] - Processing question number 0
[2025-03-06 15:23:36,104][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:23:42,511][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:23:52,552][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:24:04,584][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:24:12,681][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:24:20,940][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:24:25,827][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:24:34,201][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:24:38,695][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:24:44,664][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:24:49,697][root][INFO] - Processing question number 10
[2025-03-06 15:24:49,699][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:24:59,979][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:25:07,704][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:25:13,244][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:25:35,002][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:25:46,657][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:25:52,244][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:25:59,206][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:26:03,839][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:26:09,912][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:26:22,368][root][INFO] - Processing question number 20
[2025-03-06 15:26:22,370][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:26:29,078][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:26:32,894][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:26:41,062][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:26:45,063][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:26:53,478][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:27:00,311][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:27:09,602][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:27:16,352][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:27:22,890][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:27:31,372][root][INFO] - Processing question number 30
[2025-03-06 15:27:31,374][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:27:37,304][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:27:46,131][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:27:53,130][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:27:59,276][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:28:27,849][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:28:33,173][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:28:42,976][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:28:48,634][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:28:57,406][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:29:06,118][root][INFO] - Processing question number 40
[2025-03-06 15:29:06,121][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:29:14,003][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:29:27,154][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:29:37,175][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:29:45,514][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:29:57,638][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:30:06,553][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:30:15,023][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:30:26,893][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:30:44,516][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:30:49,654][root][INFO] - Processing question number 50
[2025-03-06 15:30:49,657][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:30:55,551][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:31:00,722][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:31:10,668][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:31:27,665][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:31:32,166][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:31:42,984][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:31:49,984][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:32:03,596][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:32:09,878][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:32:24,813][root][INFO] - Processing question number 60
[2025-03-06 15:32:24,816][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:32:32,070][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:32:44,318][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:32:51,326][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:33:00,157][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:33:08,676][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:33:13,853][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:33:22,578][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:33:28,024][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:33:35,136][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:33:40,735][root][INFO] - Processing question number 70
[2025-03-06 15:33:40,738][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:33:52,464][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:33:56,248][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:34:06,951][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:34:19,911][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:34:38,689][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:34:44,461][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:34:52,124][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:35:21,109][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:35:27,747][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:35:35,751][root][INFO] - Processing question number 80
[2025-03-06 15:35:35,755][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:35:54,286][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:36:01,927][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:36:08,785][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:36:14,718][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:36:23,885][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:36:32,447][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:36:42,961][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:36:52,708][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:36:58,181][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:37:02,283][root][INFO] - Processing question number 90
[2025-03-06 15:37:02,287][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:37:07,019][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:37:13,944][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:37:21,494][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:37:27,140][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:37:32,316][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:38:01,449][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:38:07,513][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:38:11,882][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:38:15,794][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:38:27,933][root][INFO] - Inference complete
[2025-03-06 15:38:27,933][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,939][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,944][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:27,945][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:27,945][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:27,945][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:27,950][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:27,951][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:27,951][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:27,951][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:27,951][root][WARNING] - |Q. 59||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:27,951][root][WARNING] - |Q. 59||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 15:38:27,951][root][INFO] - |Q. 59||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:27,953][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:27,954][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:27,954][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:27,954][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:38:27,955][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,960][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,960][root][INFO] - Saved parsed outputs
[2025-03-06 15:38:27,960][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,961][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,961][root][INFO] - Saved parsing metadata
[2025-03-06 15:38:27,962][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,964][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:38:27,966][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:38:27,985][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:38:27,985][root][INFO] - Summary of metrics : {'label_accuracy': 0.56, 'misclassification_rate': 0.43999999999999995, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 98, 'total_predictions': 100, 'correct_predictions': 56, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.01, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.01, 'correct_domain_wrong_label': 2, 'correct_label_wrong_domain': 56, 'both_wrong': 42}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 15:38:35,962][root][INFO] - Setting global seed to 989
[2025-03-06 15:38:35,969][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:38:35,969][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:38:35,971][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:38:35,972][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:38:35,987][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:38:35,987][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:38:36,141][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:38:36,757][root][INFO] - Full model selected, loading model
[2025-03-06 15:39:05,644][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:39:05,663][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:39:14,124][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:39:14,126][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:39:14,126][root][INFO] - Starting inference
[2025-03-06 15:39:14,328][root][INFO] - Processing question number 0
[2025-03-06 15:39:14,338][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:39:21,858][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:39:29,179][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:39:38,814][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:39:46,172][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:39:52,286][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:39:56,857][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:40:09,550][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:40:16,484][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:40:22,953][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:40:34,116][root][INFO] - Processing question number 10
[2025-03-06 15:40:34,118][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:40:39,795][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:40:44,419][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:40:50,414][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:40:57,325][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:41:07,006][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:41:13,149][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:41:18,507][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:41:23,367][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:41:28,564][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:41:36,442][root][INFO] - Processing question number 20
[2025-03-06 15:41:36,444][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:41:44,102][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:41:48,234][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:41:53,760][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:42:01,170][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:42:06,751][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:42:13,167][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:42:23,385][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:42:30,727][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:42:37,168][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:42:44,804][root][INFO] - Processing question number 30
[2025-03-06 15:42:44,806][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:42:54,744][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:42:59,549][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:43:05,908][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:43:14,275][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:43:20,176][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:43:25,455][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:43:32,357][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:43:37,877][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:43:42,245][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:43:52,702][root][INFO] - Processing question number 40
[2025-03-06 15:43:52,705][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:43:58,197][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:44:06,247][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:44:15,698][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:44:20,388][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:44:30,827][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:44:36,211][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:44:42,226][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:44:47,825][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:45:01,089][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:45:09,192][root][INFO] - Processing question number 50
[2025-03-06 15:45:09,195][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:45:15,500][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:45:21,492][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:45:28,775][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:45:37,847][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:45:46,348][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:45:53,237][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:46:03,104][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:46:08,962][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:46:16,876][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:46:23,646][root][INFO] - Processing question number 60
[2025-03-06 15:46:23,649][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:46:33,012][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:46:38,746][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:46:44,682][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:46:53,244][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:46:58,899][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:47:04,576][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:47:10,123][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:47:15,885][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:47:19,739][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:47:25,433][root][INFO] - Processing question number 70
[2025-03-06 15:47:25,437][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:47:29,980][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:47:34,486][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:47:43,644][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:47:50,698][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:47:57,324][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:48:04,201][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:48:11,687][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:48:16,690][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:48:22,661][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:48:28,023][root][INFO] - Processing question number 80
[2025-03-06 15:48:28,026][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:48:36,077][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:48:44,765][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:48:53,173][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:48:57,987][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:49:05,225][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:49:11,815][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:49:20,499][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:49:26,391][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:49:32,740][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:49:40,730][root][INFO] - Processing question number 90
[2025-03-06 15:49:40,734][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:49:45,921][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:49:51,965][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:49:57,390][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:50:02,716][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:50:09,149][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:50:16,727][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:50:22,194][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:50:28,099][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:50:37,393][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:50:42,930][root][INFO] - Inference complete
[2025-03-06 15:50:42,931][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,937][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,939][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:50:42,940][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:50:42,940][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:50:42,940][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 15:50:42,949][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,953][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,953][root][INFO] - Saved parsed outputs
[2025-03-06 15:50:42,953][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,955][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,955][root][INFO] - Saved parsing metadata
[2025-03-06 15:50:42,955][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,957][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:50:42,959][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:50:42,989][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 15:50:42,989][root][INFO] - Summary of metrics : {'label_accuracy': 0.44, 'misclassification_rate': 0.56, 'combined_accuracy': 0.0, 'malformed_label': 1, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 44, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 44, 'both_wrong': 56}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 15:50:50,363][root][INFO] - Setting global seed to 989
[2025-03-06 15:50:50,369][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:50:50,370][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 15:50:50,371][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:50:50,373][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:50:50,376][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:50:50,376][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:50:50,562][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:50:51,151][root][INFO] - Full model selected, loading model
[2025-03-06 15:51:16,527][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:53:12,254][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:53:12,254][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:53:47,737][root][INFO] - Peft model loaded successfully
[2025-03-06 15:53:55,260][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:53:55,263][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 15:53:55,263][root][INFO] - Starting inference
[2025-03-06 15:53:55,486][root][INFO] - Processing question number 0
[2025-03-06 15:53:55,488][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:54:09,396][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:54:13,509][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:54:18,781][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:54:26,975][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:54:54,674][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:55:00,735][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:55:07,228][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:55:14,303][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:55:17,676][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:55:24,774][root][INFO] - Processing question number 10
[2025-03-06 15:55:24,776][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:55:37,363][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:55:48,792][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:55:56,355][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:56:03,990][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:56:16,401][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:56:24,659][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:56:29,796][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:56:34,814][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:56:42,559][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:56:51,513][root][INFO] - Processing question number 20
[2025-03-06 15:56:51,515][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:56:57,064][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:57:03,825][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:57:10,764][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:57:16,034][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:57:21,575][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:57:28,511][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:57:35,786][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:57:43,283][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:57:49,922][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:57:57,531][root][INFO] - Processing question number 30
[2025-03-06 15:57:57,533][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:58:04,715][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:58:09,480][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:58:17,684][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:58:21,952][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:58:27,407][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:58:32,647][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:58:38,547][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:58:49,666][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:58:59,369][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:59:08,361][root][INFO] - Processing question number 40
[2025-03-06 15:59:08,364][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:59:15,739][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:59:20,781][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:59:32,630][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:59:44,443][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:59:57,806][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:00:03,958][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:00:09,722][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:00:16,299][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:00:29,552][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:00:35,469][root][INFO] - Processing question number 50
[2025-03-06 16:00:35,472][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:00:42,664][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:00:47,520][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:00:55,681][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:01:10,063][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:01:17,453][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:01:32,588][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:01:47,194][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:01:55,939][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:02:22,989][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:02:28,058][root][INFO] - Processing question number 60
[2025-03-06 16:02:28,061][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:02:53,979][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:03:07,847][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:03:37,185][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:03:45,332][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:03:57,567][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:04:04,896][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:04:11,803][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:04:27,384][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:04:35,606][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:04:47,633][root][INFO] - Processing question number 70
[2025-03-06 16:04:47,637][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:04:53,153][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:05:01,440][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:05:12,401][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:05:19,323][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:05:24,555][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:05:31,861][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:05:42,964][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:06:03,659][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:06:08,548][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:06:15,869][root][INFO] - Processing question number 80
[2025-03-06 16:06:15,873][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:06:31,045][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:06:40,524][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:06:47,340][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:06:56,135][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:07:01,211][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:07:07,985][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:07:21,196][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:07:28,684][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:07:34,713][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:07:43,445][root][INFO] - Processing question number 90
[2025-03-06 16:07:43,449][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:07:48,136][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:08:01,666][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:08:19,650][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:08:25,397][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:08:32,480][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:08:41,316][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:08:49,462][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:08:54,059][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:09:01,576][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:09:12,452][root][INFO] - Inference complete
[2025-03-06 16:09:12,452][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,459][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,467][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:09:12,468][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:09:12,468][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:09:12,468][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:09:12,469][root][WARNING] - |Q. 40||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:09:12,469][root][WARNING] - |Q. 40||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:09:12,469][root][INFO] - |Q. 40||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:09:12,469][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:09:12,470][root][WARNING] - |Q. 68||D: Civil_procedure| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 16:09:12,470][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:09:12,473][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:09:12,473][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:09:12,473][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:09:12,473][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:09:12,475][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,479][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,479][root][INFO] - Saved parsed outputs
[2025-03-06 16:09:12,479][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,481][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,481][root][INFO] - Saved parsing metadata
[2025-03-06 16:09:12,482][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,483][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:12,485][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:09:12,503][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 16:09:12,503][root][INFO] - Summary of metrics : {'label_accuracy': 0.55, 'misclassification_rate': 0.44999999999999996, 'combined_accuracy': 0.07, 'malformed_label': 4, 'malformed_domain': 86, 'total_predictions': 100, 'correct_predictions': 55, 'correct_label_and_domain': 7, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.13333333333333333, 'Criminal_Law_accuracy': 0.07142857142857142, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.21428571428571427, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.02, 'Contracts_confidence': 0.07, 'Criminal_Law_confidence': 0.02, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.04, 'Civil_Procedure_confidence': 0.03, 'correct_domain_wrong_label': 7, 'correct_label_wrong_domain': 48, 'both_wrong': 38}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 16 to status running with exit code None
Eval status update completed for job 16
[2025-03-06 16:09:20,577][root][INFO] - Setting global seed to 989
[2025-03-06 16:09:20,584][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 16:09:20,584][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : fact_first 
 Explanation type : unstructured 
 Response Format : json 
[2025-03-06 16:09:20,586][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:09:20,587][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:09:20,590][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:09:20,590][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:09:20,756][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:09:21,333][root][INFO] - Full model selected, loading model
[2025-03-06 16:09:46,942][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:09:46,967][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:09:55,274][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/unstructured_example.json', 'explanation_type': 'unstructured', 'response_type': 'fact_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:09:55,276][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:09:55,276][root][INFO] - Starting inference
[2025-03-06 16:09:55,465][root][INFO] - Processing question number 0
[2025-03-06 16:09:55,467][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:10:01,859][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:10:09,678][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:10:20,849][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:10:29,536][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:10:36,637][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:10:44,035][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:10:51,290][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:10:57,656][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:11:03,890][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:11:11,386][root][INFO] - Processing question number 10
[2025-03-06 16:11:11,388][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:11:19,659][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:11:28,336][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:11:40,093][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:11:45,819][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:11:56,413][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:12:03,226][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:12:08,482][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:12:14,825][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:12:20,011][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:12:27,086][root][INFO] - Processing question number 20
[2025-03-06 16:12:27,088][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:12:32,707][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:12:37,152][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:12:42,532][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:12:46,975][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:12:52,727][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:12:57,248][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:13:03,037][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:13:08,031][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:13:14,829][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:13:23,897][root][INFO] - Processing question number 30
[2025-03-06 16:13:23,899][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:13:31,883][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:13:40,003][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:13:47,583][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:13:51,899][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:13:58,837][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:14:05,108][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:14:11,767][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:14:17,505][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:14:21,459][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:14:28,650][root][INFO] - Processing question number 40
[2025-03-06 16:14:28,653][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:14:34,089][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:14:40,892][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:14:47,930][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:14:51,949][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:15:04,067][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:15:09,061][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:15:15,217][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:15:22,972][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:15:29,568][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:15:39,553][root][INFO] - Processing question number 50
[2025-03-06 16:15:39,556][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:15:47,287][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:15:59,371][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:16:06,176][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:16:14,856][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:16:22,870][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:16:28,220][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:16:37,735][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:16:46,179][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:16:52,953][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:17:00,435][root][INFO] - Processing question number 60
[2025-03-06 16:17:00,439][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:17:06,946][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:17:12,942][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:17:18,822][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:17:24,555][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:17:35,585][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:17:40,439][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:17:47,380][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:17:53,406][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:17:58,833][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:18:05,330][root][INFO] - Processing question number 70
[2025-03-06 16:18:05,334][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:18:10,648][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:18:15,238][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:18:23,819][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:18:30,625][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:18:35,659][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:18:45,265][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:18:52,789][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:19:02,416][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:19:07,158][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:19:11,606][root][INFO] - Processing question number 80
[2025-03-06 16:19:11,609][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:19:20,339][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:19:26,589][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:19:33,026][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:19:38,063][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:19:46,085][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:19:55,785][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:20:08,028][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:20:14,185][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:20:21,163][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:20:27,760][root][INFO] - Processing question number 90
[2025-03-06 16:20:27,763][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:20:33,996][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:20:38,135][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:20:42,535][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:20:47,945][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:20:54,554][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:21:01,839][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:21:08,909][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:21:12,864][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:21:19,330][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:21:25,597][root][INFO] - Inference complete
[2025-03-06 16:21:25,597][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,603][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,605][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:21:25,606][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:21:25,606][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:21:25,606][root][WARNING] - Expected a string for unstructured explanation but got different format.
[2025-03-06 16:21:25,615][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,619][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,620][root][INFO] - Saved parsed outputs
[2025-03-06 16:21:25,620][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,621][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,621][root][INFO] - Saved parsing metadata
[2025-03-06 16:21:25,622][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,624][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
[2025-03-06 16:21:25,625][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_fact_first_zero_shot_unstructured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:21:25,641][root][INFO] - Evaluation completed for json_fact_first_zero_shot_unstructured, on test_set_2
[2025-03-06 16:21:25,641][root][INFO] - Summary of metrics : {'label_accuracy': 0.43, 'misclassification_rate': 0.5700000000000001, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 43, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 43, 'both_wrong': 57}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '16', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_fact_first_zero_shot_unstructured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 16 to status completed with exit code 0
Eval status update completed for job 16
Job 16 completed at Thu Mar  6 16:21:27 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n518
Job ID: 25358391
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 05:59:11
CPU Efficiency: 9.82% of 2-12:56:40 core-walltime
Job Wall-clock time: 06:05:40
Memory Utilized: 35.71 GB
Memory Efficiency: 99.18% of 36.00 GB
