Starting job 6 at Thu Mar  6 08:59:10 CET 2025
Configuration: model=llama3 tokenizer=llama3 dataset=all_domains_1_samples prompt=json_answer_first_zero_shot_structured train=json_answer_first_zero_shot_structured ++train.training_args.per_device_train_batch_size=7 ++train.training_args.gradient_accumulation_steps=1
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '6', 'training']
Updating job 6 to status training with exit code None
Status update completed for job 6
[2025-03-06 08:59:18,730][root][INFO] - Global seed set to 314
[2025-03-06 08:59:18,732][root][WARNING] - Quantisation will be done on loaded model, THIS IS A QLORA FINE-TUNING RUN
[2025-03-06 08:59:18,732][root][WARNING] - Following flags are set for the run : 
 Use Quantisation before fine-tuning : True 
 Perform Validation on epoch end : False
[2025-03-06 08:59:18,732][root][INFO] - Running Fine-tuning on the all_domains_1_samples dataset
[2025-03-06 08:59:18,732][root][INFO] - Current training config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 08:59:18,732][root][INFO] - Loading dataset from /home/fr/fr_fr/fr_rf1031/bar-llama/dataset/seed_dataset/distilled_dataset.json
[2025-03-06 08:59:18,748][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 08:59:18,760][root][INFO] - Indexing complete, sampling of questions set to True
[2025-03-06 08:59:18,762][root][INFO] - Questions selected, dataset contains 7 questions with 1.0 questions per domain
[2025-03-06 08:59:18,765][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${train.prompt.response_format}_${train.prompt.response_type}_${train.prompt.explanation_type}.txt', 'include_system_prompt': True}
[2025-03-06 08:59:19,611][root][INFO] - Tokenizer meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 08:59:43,937][root][INFO] - Quantised model meta-llama/Llama-3.1-8B-Instruct loaded successfully
[2025-03-06 09:00:12,487][root][INFO] - Model prepared for kbit training
[2025-03-06 09:00:12,488][root][INFO] - Lora config loaded, following are the details : 
 LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules={'v_proj', 'up_proj', 'k_proj', 'q_proj', 'o_proj', 'gate_proj', 'down_proj'}, lora_alpha=32, lora_dropout=0.05, fan_in_fan_out=False, bias='none', use_rslora=False, modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None, rank_pattern={}, alpha_pattern={}, megatron_config=None, megatron_core='megatron.core', loftq_config={}, use_dora=False, layer_replication=None, runtime_config=LoraRuntimeConfig(ephemeral_gpu_offload=False))
[2025-03-06 09:00:14,222][root][INFO] - Lora adapter added to model
[2025-03-06 09:00:14,225][root][INFO] - Model adapter will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_answer_first_zero_shot_structured
[2025-03-06 09:00:14,485][accelerate.utils.other][WARNING] - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'loss': 1.7907, 'grad_norm': 0.5036883354187012, 'learning_rate': 9.42728012826605e-05, 'epoch': 3.0}
{'loss': 1.4382, 'grad_norm': 0.35239332914352417, 'learning_rate': 3.226975564787322e-05, 'epoch': 6.0}
{'loss': 1.2346, 'grad_norm': 0.36622393131256104, 'learning_rate': 9.85470908713026e-05, 'epoch': 9.0}
{'loss': 1.0842, 'grad_norm': 0.33947989344596863, 'learning_rate': 4.397316598723383e-05, 'epoch': 12.0}
{'loss': 0.8553, 'grad_norm': 0.38370272517204285, 'learning_rate': 0.0, 'epoch': 15.0}
{'train_runtime': 324.1738, 'train_samples_per_second': 0.324, 'train_steps_per_second': 0.046, 'train_loss': 1.2805874029795328, 'epoch': 15.0}
[2025-03-06 09:05:46,429][root][INFO] - Finetuning complete, model saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/sft_adapters/llama3/all_domains_1_samples/llama3_json_answer_first_zero_shot_structured
Starting update_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_status.py', '6', 'trained', '0']
Updating job 6 to status trained with exit code 0
Status update completed for job 6
Starting evaluations for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 09:05:55,580][root][INFO] - Setting global seed to 206
[2025-03-06 09:05:55,586][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:05:55,586][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:05:55,587][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:05:55,589][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:05:55,591][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:05:55,591][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:05:55,734][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:05:56,294][root][INFO] - Full model selected, loading model
[2025-03-06 09:06:11,607][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:07:56,958][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:07:56,959][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:08:30,707][root][INFO] - Peft model loaded successfully
[2025-03-06 09:08:38,326][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:08:38,328][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:08:38,329][root][INFO] - Starting inference
[2025-03-06 09:08:38,484][root][INFO] - Processing question number 0
[2025-03-06 09:08:38,501][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:08:52,142][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:09:05,052][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:09:16,874][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:09:34,292][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:09:48,253][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:10:00,969][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:10:14,396][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:10:28,628][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:10:40,663][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:10:51,157][root][INFO] - Processing question number 10
[2025-03-06 09:10:51,159][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:11:07,155][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:11:18,696][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:11:31,860][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:11:47,072][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:12:00,441][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:12:13,973][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:12:25,068][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:12:36,886][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:12:47,613][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:12:57,288][root][INFO] - Processing question number 20
[2025-03-06 09:12:57,290][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:13:10,708][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:13:24,218][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 09:13:36,713][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 09:13:49,809][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 09:14:02,276][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 09:14:14,512][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 09:14:27,346][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 09:14:39,698][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 09:14:53,089][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 09:15:01,927][root][INFO] - Processing question number 30
[2025-03-06 09:15:01,930][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 09:15:14,869][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 09:15:28,730][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 09:15:39,706][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 09:15:51,852][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 09:16:02,162][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 09:16:15,499][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 09:16:30,407][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 09:16:45,397][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 09:16:58,655][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 09:17:12,344][root][INFO] - Processing question number 40
[2025-03-06 09:17:12,347][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 09:17:26,791][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 09:17:42,227][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 09:17:57,576][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 09:18:12,692][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 09:18:24,124][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 09:18:37,892][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 09:18:50,270][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 09:19:02,940][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 09:19:14,409][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 09:19:26,310][root][INFO] - Processing question number 50
[2025-03-06 09:19:26,313][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 09:19:39,414][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 09:19:53,170][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 09:20:04,651][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 09:20:23,121][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 09:20:32,586][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 09:20:41,788][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 09:20:53,764][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 09:21:06,818][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 09:21:18,272][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 09:21:29,678][root][INFO] - Processing question number 60
[2025-03-06 09:21:29,737][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 09:21:40,844][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 09:21:50,798][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 09:22:06,344][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 09:22:16,488][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 09:22:29,931][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 09:22:40,410][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 09:22:50,493][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 09:23:06,067][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 09:23:18,327][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 09:23:30,549][root][INFO] - Processing question number 70
[2025-03-06 09:23:30,552][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 09:23:41,846][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 09:23:57,784][root][INFO] - Domain : Property, Question : 6
[2025-03-06 09:24:11,036][root][INFO] - Domain : Property, Question : 13
[2025-03-06 09:24:26,387][root][INFO] - Domain : Property, Question : 20
[2025-03-06 09:24:39,541][root][INFO] - Domain : Property, Question : 33
[2025-03-06 09:24:51,887][root][INFO] - Domain : Property, Question : 39
[2025-03-06 09:25:07,649][root][INFO] - Domain : Property, Question : 48
[2025-03-06 09:25:19,338][root][INFO] - Domain : Property, Question : 54
[2025-03-06 09:25:33,765][root][INFO] - Domain : Property, Question : 61
[2025-03-06 09:25:45,590][root][INFO] - Processing question number 80
[2025-03-06 09:25:45,594][root][INFO] - Domain : Property, Question : 67
[2025-03-06 09:25:59,774][root][INFO] - Domain : Property, Question : 75
[2025-03-06 09:26:16,350][root][INFO] - Domain : Property, Question : 83
[2025-03-06 09:26:27,291][root][INFO] - Domain : Property, Question : 89
[2025-03-06 09:26:41,671][root][INFO] - Domain : Property, Question : 97
[2025-03-06 09:26:54,398][root][INFO] - Domain : Property, Question : 100
[2025-03-06 09:27:09,703][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 09:27:23,099][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 09:27:35,933][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 09:27:47,966][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 09:27:58,452][root][INFO] - Processing question number 90
[2025-03-06 09:27:58,456][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:28:12,314][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:28:20,336][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 09:28:33,937][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 09:28:43,990][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 09:28:56,815][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 09:29:08,073][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 09:29:18,950][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 09:29:32,796][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 09:29:46,288][root][INFO] - Inference complete
[2025-03-06 09:29:46,289][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,294][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,306][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,325][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,325][root][INFO] - Saved parsed outputs
[2025-03-06 09:29:46,325][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,329][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,329][root][INFO] - Saved parsing metadata
[2025-03-06 09:29:46,330][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,331][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:29:46,338][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 09:29:46,369][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 09:29:46,369][root][INFO] - Summary of metrics : {'label_accuracy': 0.31313131313131315, 'misclassification_rate': 0.6868686868686869, 'combined_accuracy': 0.0, 'malformed_label': 34, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 31, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 31, 'both_wrong': 68}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 09:30:00,905][root][INFO] - Setting global seed to 206
[2025-03-06 09:30:00,926][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 09:30:00,927][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:30:00,928][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:30:00,930][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:30:00,933][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:30:00,933][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:30:01,095][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:30:01,668][root][INFO] - Full model selected, loading model
[2025-03-06 09:30:22,529][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 09:30:22,529][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 09:30:30,404][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:30:30,406][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:30:30,406][root][INFO] - Starting inference
[2025-03-06 09:30:30,540][root][INFO] - Processing question number 0
[2025-03-06 09:30:30,542][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:30:42,534][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:30:53,649][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:31:06,707][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:31:16,908][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:31:27,978][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:31:43,101][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:31:54,216][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:32:05,913][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:32:14,516][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:32:27,774][root][INFO] - Processing question number 10
[2025-03-06 09:32:27,776][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:32:38,886][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:32:48,323][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:32:59,808][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:33:09,346][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:33:19,217][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:33:28,764][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:33:40,239][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:33:49,385][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:33:58,775][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:34:11,045][root][INFO] - Processing question number 20
[2025-03-06 09:34:11,048][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:34:20,268][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:34:32,500][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 09:34:43,168][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 09:34:53,901][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 09:35:04,695][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 09:35:14,447][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 09:35:23,693][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 09:35:32,542][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 09:35:42,850][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 09:35:54,438][root][INFO] - Processing question number 30
[2025-03-06 09:35:54,440][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 09:36:06,173][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 09:36:17,605][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 09:36:30,007][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 09:36:41,235][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 09:36:48,435][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 09:37:01,424][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 09:37:12,524][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 09:37:23,034][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 09:37:34,714][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 09:37:46,232][root][INFO] - Processing question number 40
[2025-03-06 09:37:46,235][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 09:37:56,994][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 09:38:11,218][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 09:38:25,596][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 09:38:39,364][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 09:38:48,732][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 09:38:57,470][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 09:39:08,444][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 09:39:19,483][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 09:39:30,556][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 09:39:40,750][root][INFO] - Processing question number 50
[2025-03-06 09:39:40,753][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 09:39:51,586][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 09:40:02,770][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 09:40:11,333][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 09:40:20,857][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 09:40:32,165][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 09:40:41,663][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 09:41:01,228][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 09:41:11,900][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 09:41:24,830][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 09:41:35,341][root][INFO] - Processing question number 60
[2025-03-06 09:41:35,344][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 09:41:45,088][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 09:41:54,344][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 09:42:06,527][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 09:42:15,313][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 09:42:23,120][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 09:42:38,844][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 09:42:48,336][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 09:42:58,092][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 09:43:09,999][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 09:43:25,824][root][INFO] - Processing question number 70
[2025-03-06 09:43:25,828][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 09:43:37,285][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 09:43:49,720][root][INFO] - Domain : Property, Question : 6
[2025-03-06 09:43:59,684][root][INFO] - Domain : Property, Question : 13
[2025-03-06 09:44:10,136][root][INFO] - Domain : Property, Question : 20
[2025-03-06 09:44:19,915][root][INFO] - Domain : Property, Question : 33
[2025-03-06 09:44:28,341][root][INFO] - Domain : Property, Question : 39
[2025-03-06 09:44:41,109][root][INFO] - Domain : Property, Question : 48
[2025-03-06 09:44:50,151][root][INFO] - Domain : Property, Question : 54
[2025-03-06 09:45:02,327][root][INFO] - Domain : Property, Question : 61
[2025-03-06 09:45:13,243][root][INFO] - Processing question number 80
[2025-03-06 09:45:13,247][root][INFO] - Domain : Property, Question : 67
[2025-03-06 09:45:24,490][root][INFO] - Domain : Property, Question : 75
[2025-03-06 09:45:36,443][root][INFO] - Domain : Property, Question : 83
[2025-03-06 09:45:47,132][root][INFO] - Domain : Property, Question : 89
[2025-03-06 09:45:56,044][root][INFO] - Domain : Property, Question : 97
[2025-03-06 09:46:08,898][root][INFO] - Domain : Property, Question : 100
[2025-03-06 09:46:22,969][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 09:46:33,454][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 09:46:43,875][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 09:46:56,104][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 09:47:07,389][root][INFO] - Processing question number 90
[2025-03-06 09:47:07,393][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 09:47:20,496][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 09:47:28,213][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 09:47:43,470][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 09:47:51,544][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 09:48:04,103][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 09:48:14,339][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 09:48:22,837][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 09:48:36,734][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 09:48:47,122][root][INFO] - Inference complete
[2025-03-06 09:48:47,122][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,127][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,129][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,129][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,130][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,130][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,130][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,130][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,131][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,131][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,131][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,132][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,132][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,132][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,132][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,132][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,132][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,133][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,133][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,133][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,133][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,134][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,134][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,134][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,134][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,134][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,134][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,134][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,134][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,135][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,135][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,135][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,135][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,135][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,135][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,135][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,136][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,136][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,136][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,136][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,136][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,136][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,137][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,137][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,137][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,137][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,137][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,138][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,138][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,138][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,138][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,138][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,138][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,138][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,139][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,139][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,139][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,139][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,140][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,140][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,140][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,140][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,140][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,141][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,141][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,141][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,141][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,141][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,141][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,142][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,142][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,142][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,142][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,142][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,143][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,143][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,143][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,143][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,144][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,144][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,144][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,144][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,144][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,144][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,145][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,145][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,145][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,146][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,146][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,146][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,147][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,147][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,147][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,147][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,147][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,147][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,147][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,147][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,148][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,148][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,148][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,148][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,148][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,148][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,148][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,149][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,149][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,149][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,149][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,149][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,149][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,149][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,149][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,150][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,150][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,150][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,150][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,151][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,151][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,152][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 09:48:47,152][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 09:48:47,152][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 09:48:47,154][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,168][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,168][root][INFO] - Saved parsed outputs
[2025-03-06 09:48:47,168][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,181][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,181][root][INFO] - Saved parsing metadata
[2025-03-06 09:48:47,182][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,183][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:48:47,185][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 09:48:47,266][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 09:48:47,266][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 51}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 09:48:53,626][root][INFO] - Setting global seed to 206
[2025-03-06 09:48:53,631][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 09:48:53,632][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 09:48:53,633][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 09:48:53,634][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 09:48:53,636][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 09:48:53,637][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 09:48:53,799][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 09:48:54,353][root][INFO] - Full model selected, loading model
[2025-03-06 09:49:07,731][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 09:50:51,552][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 09:50:51,634][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 09:51:26,116][root][INFO] - Peft model loaded successfully
[2025-03-06 09:51:33,759][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 09:51:33,760][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 09:51:33,760][root][INFO] - Starting inference
[2025-03-06 09:51:33,916][root][INFO] - Processing question number 0
[2025-03-06 09:51:33,918][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 09:51:44,021][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 09:51:56,147][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 09:52:15,146][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 09:52:27,646][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 09:52:40,899][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 09:52:55,998][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 09:53:11,671][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 09:53:24,162][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 09:53:37,685][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 09:53:48,756][root][INFO] - Processing question number 10
[2025-03-06 09:53:48,758][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 09:54:05,450][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 09:54:20,231][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 09:54:32,822][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 09:54:47,636][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 09:54:59,885][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 09:55:12,643][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 09:55:23,040][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 09:55:35,719][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 09:55:47,287][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 09:55:57,643][root][INFO] - Processing question number 20
[2025-03-06 09:55:57,645][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 09:56:09,886][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 09:56:22,735][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 09:56:31,913][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 09:56:46,368][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 09:57:00,800][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 09:57:13,342][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 09:57:25,597][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 09:57:38,433][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 09:57:53,592][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 09:58:05,560][root][INFO] - Processing question number 30
[2025-03-06 09:58:05,562][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 09:58:20,161][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 09:58:34,667][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 09:58:45,876][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 09:58:57,707][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 09:59:07,704][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 09:59:20,257][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 09:59:35,109][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 09:59:50,915][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:00:04,696][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:00:17,297][root][INFO] - Processing question number 40
[2025-03-06 10:00:17,299][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:00:33,245][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:00:49,092][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:01:04,821][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:01:17,405][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:01:29,785][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:01:41,720][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:01:54,256][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:02:05,674][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:02:15,876][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:02:26,641][root][INFO] - Processing question number 50
[2025-03-06 10:02:26,645][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:02:39,640][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:02:53,727][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:03:06,180][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:03:19,223][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:03:27,850][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:03:37,868][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:03:49,230][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:03:59,624][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:04:12,728][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:04:24,362][root][INFO] - Processing question number 60
[2025-03-06 10:04:24,365][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:04:37,652][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:04:51,088][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:05:04,356][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:05:13,290][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:05:25,650][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:05:36,598][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:05:47,623][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:06:05,674][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:06:17,933][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:06:32,038][root][INFO] - Processing question number 70
[2025-03-06 10:06:32,042][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:06:44,496][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:07:02,099][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:07:12,226][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:07:28,243][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:07:42,350][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:07:54,327][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:08:11,094][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:08:23,991][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:08:38,558][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:08:49,999][root][INFO] - Processing question number 80
[2025-03-06 10:08:50,002][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:09:05,145][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:09:21,790][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:09:32,816][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:09:46,959][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:09:58,554][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:10:16,355][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:10:31,069][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:10:42,400][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:10:56,876][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:11:07,995][root][INFO] - Processing question number 90
[2025-03-06 10:11:08,007][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:11:22,094][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:11:30,269][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:11:47,132][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:11:55,577][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:12:08,774][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:12:18,845][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:12:29,229][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:12:44,498][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:12:56,202][root][INFO] - Inference complete
[2025-03-06 10:12:56,202][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,207][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,220][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,224][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,224][root][INFO] - Saved parsed outputs
[2025-03-06 10:12:56,224][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,226][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,226][root][INFO] - Saved parsing metadata
[2025-03-06 10:12:56,226][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,228][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:12:56,229][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:12:56,242][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 10:12:56,242][root][INFO] - Summary of metrics : {'label_accuracy': 0.3333333333333333, 'misclassification_rate': 0.6666666666666667, 'combined_accuracy': 0.0, 'malformed_label': 31, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 33, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 33, 'both_wrong': 66}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 10:13:03,931][root][INFO] - Setting global seed to 206
[2025-03-06 10:13:03,939][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:13:03,939][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:13:03,941][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:13:03,943][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:13:03,945][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:13:03,945][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:13:04,094][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:13:04,769][root][INFO] - Full model selected, loading model
[2025-03-06 10:13:28,623][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:13:28,624][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:13:36,262][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:13:36,263][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:13:36,263][root][INFO] - Starting inference
[2025-03-06 10:13:36,411][root][INFO] - Processing question number 0
[2025-03-06 10:13:36,413][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:13:49,064][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:14:00,504][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:14:10,675][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:14:21,577][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:14:32,101][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:14:47,793][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:14:59,128][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:15:10,101][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:15:19,151][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:15:31,368][root][INFO] - Processing question number 10
[2025-03-06 10:15:31,370][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:15:42,512][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:15:52,260][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:16:06,085][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:16:16,431][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:16:26,555][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:16:34,385][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:16:45,012][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:16:55,445][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:17:03,708][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:17:12,721][root][INFO] - Processing question number 20
[2025-03-06 10:17:12,723][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:17:23,088][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:17:32,737][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:17:42,739][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:17:52,461][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:18:03,746][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:18:14,689][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:18:23,983][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:18:33,678][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:18:41,567][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:18:52,423][root][INFO] - Processing question number 30
[2025-03-06 10:18:52,425][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:19:07,362][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:19:17,162][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:19:28,372][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:19:38,475][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:19:46,809][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:19:57,054][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:20:08,000][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:20:19,379][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:20:31,271][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:20:41,867][root][INFO] - Processing question number 40
[2025-03-06 10:20:41,870][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:20:52,610][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:21:06,407][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:21:19,734][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:21:34,171][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:21:46,550][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:21:55,184][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:22:08,112][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:22:19,218][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:22:28,731][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:22:41,495][root][INFO] - Processing question number 50
[2025-03-06 10:22:41,498][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:22:52,686][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:23:05,745][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:23:15,025][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:23:26,112][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:23:43,537][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:23:54,949][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:24:11,369][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:24:23,587][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:24:35,528][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:24:45,888][root][INFO] - Processing question number 60
[2025-03-06 10:24:45,891][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:24:55,895][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:25:04,969][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:25:18,783][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:25:27,551][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:25:35,263][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:25:54,597][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:26:04,558][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:26:15,868][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:26:26,405][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:26:39,161][root][INFO] - Processing question number 70
[2025-03-06 10:26:39,165][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:26:50,612][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:27:00,197][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:27:10,616][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:27:22,525][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:27:33,572][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:27:41,645][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:27:55,073][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:28:06,294][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:28:16,523][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:28:27,845][root][INFO] - Processing question number 80
[2025-03-06 10:28:27,849][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:28:38,463][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:28:51,587][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:29:02,076][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:29:13,098][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:29:23,298][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:29:34,810][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:29:46,742][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:29:56,692][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:30:08,130][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:30:19,697][root][INFO] - Processing question number 90
[2025-03-06 10:30:19,701][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:30:33,526][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:30:41,985][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:30:53,160][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:31:02,075][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:31:14,821][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:31:25,097][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:31:33,383][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:31:47,391][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:31:58,465][root][INFO] - Inference complete
[2025-03-06 10:31:58,466][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,471][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,472][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,472][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,473][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,473][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,473][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,474][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,474][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,474][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,474][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,474][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,475][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,475][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,475][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,475][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,475][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,476][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,476][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,476][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,477][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,477][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,477][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,477][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,477][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,477][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,478][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,478][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,478][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,478][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,478][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,478][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,479][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,479][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,479][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,479][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,479][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,479][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,480][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,480][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,480][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,480][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,480][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,481][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,481][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,481][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,481][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,481][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,481][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,482][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,482][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,482][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,482][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,482][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,483][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,483][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,483][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,483][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,483][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,484][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,484][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,484][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,484][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,484][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,485][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,485][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,485][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,485][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,485][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,485][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,486][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,486][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,486][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,486][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,486][root][WARNING] - |Q. 47||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,486][root][WARNING] - |Q. 47||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,487][root][INFO] - |Q. 47||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,487][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,487][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,487][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,487][root][WARNING] - |Q. 76||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,487][root][WARNING] - |Q. 76||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,488][root][INFO] - |Q. 76||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,488][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,488][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,488][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,488][root][WARNING] - |Q. 95||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,488][root][WARNING] - |Q. 95||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,489][root][INFO] - |Q. 95||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,489][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,489][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,489][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,489][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,490][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,490][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,490][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,491][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,491][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,491][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,492][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,492][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,492][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,492][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,492][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,492][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,492][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,492][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,493][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,493][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,493][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,493][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,493][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,493][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,494][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,494][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,494][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,494][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,495][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,495][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,495][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,495][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,495][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,496][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,496][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,496][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,496][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,496][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,496][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,497][root][WARNING] - |Q. 15||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,497][root][WARNING] - |Q. 15||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,497][root][INFO] - |Q. 15||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,498][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 10:31:58,498][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:31:58,498][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 10:31:58,499][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,504][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,504][root][INFO] - Saved parsed outputs
[2025-03-06 10:31:58,504][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,506][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,506][root][INFO] - Saved parsing metadata
[2025-03-06 10:31:58,506][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,508][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:31:58,509][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:31:58,544][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 10:31:58,545][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.0, 'malformed_label': 4, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 46, 'both_wrong': 53}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 10:32:06,081][root][INFO] - Setting global seed to 206
[2025-03-06 10:32:06,088][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 10:32:06,089][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:32:06,090][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:32:06,092][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:32:06,095][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:32:06,095][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:32:06,238][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:32:06,864][root][INFO] - Full model selected, loading model
[2025-03-06 10:32:20,659][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 10:34:01,065][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 10:34:01,065][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 10:34:35,212][root][INFO] - Peft model loaded successfully
[2025-03-06 10:34:42,593][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:34:42,595][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:34:42,595][root][INFO] - Starting inference
[2025-03-06 10:34:42,755][root][INFO] - Processing question number 0
[2025-03-06 10:34:42,756][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:34:52,147][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:35:03,849][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:35:18,127][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:35:30,333][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:35:43,050][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:35:54,297][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:36:07,796][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:36:23,960][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:36:34,379][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:36:44,328][root][INFO] - Processing question number 10
[2025-03-06 10:36:44,330][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:36:58,058][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:37:09,910][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:37:21,043][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:37:35,891][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:37:46,520][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:37:57,044][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:38:08,258][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:38:20,218][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 10:38:31,356][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 10:38:43,093][root][INFO] - Processing question number 20
[2025-03-06 10:38:43,095][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 10:38:53,363][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 10:39:06,242][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 10:39:17,382][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 10:39:28,933][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 10:39:44,494][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 10:39:56,688][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 10:40:08,111][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 10:40:22,952][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 10:40:36,300][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 10:40:47,372][root][INFO] - Processing question number 30
[2025-03-06 10:40:47,374][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 10:41:02,667][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 10:41:16,343][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 10:41:28,342][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 10:41:40,816][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 10:41:53,374][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 10:42:07,253][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 10:42:21,902][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 10:42:33,367][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 10:42:47,986][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 10:43:01,628][root][INFO] - Processing question number 40
[2025-03-06 10:43:01,630][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 10:43:15,538][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 10:43:32,125][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 10:43:47,344][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 10:44:01,114][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 10:44:10,745][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 10:44:22,554][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 10:44:35,937][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 10:44:46,262][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 10:44:56,654][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 10:45:07,435][root][INFO] - Processing question number 50
[2025-03-06 10:45:07,439][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 10:45:21,753][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 10:45:37,352][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 10:45:50,079][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 10:46:01,205][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 10:46:11,015][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 10:46:20,488][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 10:46:34,292][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 10:46:43,178][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 10:46:56,718][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 10:47:07,637][root][INFO] - Processing question number 60
[2025-03-06 10:47:07,640][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 10:47:18,235][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 10:47:28,502][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 10:47:41,916][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 10:47:50,816][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 10:48:00,275][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 10:48:12,303][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 10:48:23,193][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 10:48:37,756][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 10:48:48,522][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 10:49:03,257][root][INFO] - Processing question number 70
[2025-03-06 10:49:03,260][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 10:49:13,853][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 10:49:30,707][root][INFO] - Domain : Property, Question : 6
[2025-03-06 10:49:46,520][root][INFO] - Domain : Property, Question : 13
[2025-03-06 10:50:05,876][root][INFO] - Domain : Property, Question : 20
[2025-03-06 10:50:18,518][root][INFO] - Domain : Property, Question : 33
[2025-03-06 10:50:33,643][root][INFO] - Domain : Property, Question : 39
[2025-03-06 10:50:48,355][root][INFO] - Domain : Property, Question : 48
[2025-03-06 10:51:00,316][root][INFO] - Domain : Property, Question : 54
[2025-03-06 10:51:16,384][root][INFO] - Domain : Property, Question : 61
[2025-03-06 10:51:26,386][root][INFO] - Processing question number 80
[2025-03-06 10:51:26,390][root][INFO] - Domain : Property, Question : 67
[2025-03-06 10:51:41,398][root][INFO] - Domain : Property, Question : 75
[2025-03-06 10:51:57,861][root][INFO] - Domain : Property, Question : 83
[2025-03-06 10:52:08,943][root][INFO] - Domain : Property, Question : 89
[2025-03-06 10:52:23,990][root][INFO] - Domain : Property, Question : 97
[2025-03-06 10:52:38,787][root][INFO] - Domain : Property, Question : 100
[2025-03-06 10:52:57,471][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 10:53:12,773][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 10:53:27,633][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 10:53:40,794][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 10:53:49,529][root][INFO] - Processing question number 90
[2025-03-06 10:53:49,533][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 10:54:04,305][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 10:54:14,948][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 10:54:30,779][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 10:54:39,776][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 10:54:52,551][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 10:55:06,017][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 10:55:16,554][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 10:55:30,307][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 10:55:47,204][root][INFO] - Inference complete
[2025-03-06 10:55:47,204][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,209][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,211][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 10:55:47,211][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 10:55:47,212][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 10:55:47,223][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,228][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,228][root][INFO] - Saved parsed outputs
[2025-03-06 10:55:47,228][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,229][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,229][root][INFO] - Saved parsing metadata
[2025-03-06 10:55:47,230][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,231][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:55:47,233][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 10:55:47,248][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 10:55:47,248][root][INFO] - Summary of metrics : {'label_accuracy': 0.3333333333333333, 'misclassification_rate': 0.6666666666666667, 'combined_accuracy': 0.010101010101010102, 'malformed_label': 31, 'malformed_domain': 97, 'total_predictions': 99, 'correct_predictions': 33, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.07142857142857142, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.010101010101010102, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.010101010101010102, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 32, 'both_wrong': 65}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 10:55:54,501][root][INFO] - Setting global seed to 206
[2025-03-06 10:55:54,508][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 10:55:54,508][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 10:55:54,509][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 10:55:54,511][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 10:55:54,513][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 10:55:54,514][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 10:55:54,694][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 10:55:55,218][root][INFO] - Full model selected, loading model
[2025-03-06 10:56:17,082][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 10:56:17,082][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 10:56:25,164][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 10:56:25,165][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 10:56:25,165][root][INFO] - Starting inference
[2025-03-06 10:56:25,320][root][INFO] - Processing question number 0
[2025-03-06 10:56:25,322][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 10:56:37,030][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 10:56:48,791][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 10:56:58,971][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 10:57:10,344][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 10:57:20,048][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 10:57:30,972][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 10:57:43,301][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 10:57:53,583][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 10:58:06,668][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 10:58:19,354][root][INFO] - Processing question number 10
[2025-03-06 10:58:19,356][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 10:58:30,014][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 10:58:41,831][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 10:58:53,258][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 10:59:03,076][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 10:59:16,033][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 10:59:28,510][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 10:59:41,353][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 10:59:51,776][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:00:00,223][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:00:11,548][root][INFO] - Processing question number 20
[2025-03-06 11:00:11,550][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:00:19,651][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:00:28,874][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:00:40,765][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:00:50,757][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:01:00,797][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:01:11,410][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:01:20,194][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:01:30,791][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:01:43,571][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:01:56,831][root][INFO] - Processing question number 30
[2025-03-06 11:01:56,833][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:02:10,101][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:02:19,065][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:02:29,429][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:02:41,774][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:02:51,028][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:03:01,975][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:03:12,497][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:03:24,822][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:03:35,773][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:03:45,561][root][INFO] - Processing question number 40
[2025-03-06 11:03:45,563][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:03:55,270][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:04:10,115][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:04:22,249][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:04:35,191][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:04:44,126][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:04:54,808][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:05:06,338][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:05:16,703][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:05:25,426][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:05:35,300][root][INFO] - Processing question number 50
[2025-03-06 11:05:35,303][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:05:48,840][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:06:02,323][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:06:12,661][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:06:23,983][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:06:38,814][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:06:48,798][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:07:02,038][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:07:13,231][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:07:25,170][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:07:35,572][root][INFO] - Processing question number 60
[2025-03-06 11:07:35,575][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:07:44,660][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:07:52,353][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:08:05,074][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:08:14,807][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:08:25,637][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:08:36,783][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:08:46,094][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:08:56,519][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:09:05,653][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:09:16,943][root][INFO] - Processing question number 70
[2025-03-06 11:09:16,947][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:09:29,806][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:09:38,422][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:09:48,652][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:09:59,000][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:10:10,424][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:10:20,476][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:10:41,319][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:10:50,752][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:10:59,730][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:11:13,037][root][INFO] - Processing question number 80
[2025-03-06 11:11:13,041][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:11:23,260][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:11:39,033][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:11:48,553][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:11:58,136][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:12:11,564][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:12:21,661][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:12:34,161][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:12:45,460][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:12:56,563][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:13:08,071][root][INFO] - Processing question number 90
[2025-03-06 11:13:08,075][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:13:22,947][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:13:32,762][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:13:43,876][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:13:52,911][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:14:01,765][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:14:13,382][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:14:22,348][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:14:38,002][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:14:49,876][root][INFO] - Inference complete
[2025-03-06 11:14:49,876][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,880][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,881][root][WARNING] - |Q. 1||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,882][root][WARNING] - |Q. 1||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,882][root][INFO] - |Q. 1||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,883][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,883][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,883][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,883][root][WARNING] - |Q. 21||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,883][root][WARNING] - |Q. 21||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,883][root][INFO] - |Q. 21||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,884][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,884][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,884][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,884][root][WARNING] - |Q. 42||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,884][root][WARNING] - |Q. 42||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,885][root][INFO] - |Q. 42||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,885][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,885][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,885][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,886][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,886][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,886][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,887][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,887][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,887][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,887][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,887][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,887][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,888][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,888][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,888][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,888][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,888][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,888][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,889][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,889][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,889][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,889][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,889][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,889][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,889][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,890][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,890][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,890][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,890][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,890][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,890][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,890][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,891][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,891][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,891][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,891][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,891][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,891][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,891][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,892][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,892][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,892][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,892][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,893][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,893][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,893][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,893][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,893][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,894][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,895][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,895][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,895][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,895][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,895][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,895][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,896][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,896][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,896][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,897][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,897][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,897][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,897][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,897][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,898][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,898][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,898][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,898][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,899][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,899][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,899][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,900][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,900][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,900][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,900][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,900][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,900][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,900][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,901][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,901][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,901][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,901][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,901][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,902][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,902][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,902][root][WARNING] - |Q. 75||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,902][root][WARNING] - |Q. 75||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,902][root][INFO] - |Q. 75||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,902][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,903][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,903][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,903][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,903][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,903][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,903][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,904][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,904][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,904][root][WARNING] - |Q. 36||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:14:49,904][root][WARNING] - |Q. 36||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:14:49,905][root][INFO] - |Q. 36||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:14:49,907][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,911][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,911][root][INFO] - Saved parsed outputs
[2025-03-06 11:14:49,911][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,912][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,912][root][INFO] - Saved parsing metadata
[2025-03-06 11:14:49,913][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,914][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:14:49,916][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:14:49,924][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 11:14:49,924][root][INFO] - Summary of metrics : {'label_accuracy': 0.4444444444444444, 'misclassification_rate': 0.5555555555555556, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 44, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 44, 'both_wrong': 55}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 11:14:57,634][root][INFO] - Setting global seed to 989
[2025-03-06 11:14:57,641][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:14:57,641][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:14:57,642][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:14:57,644][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:14:57,646][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:14:57,646][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:14:57,797][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:14:58,378][root][INFO] - Full model selected, loading model
[2025-03-06 11:15:15,289][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:16:55,838][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:16:55,881][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 11:17:32,005][root][INFO] - Peft model loaded successfully
[2025-03-06 11:17:39,319][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:17:39,321][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:17:39,321][root][INFO] - Starting inference
[2025-03-06 11:17:39,486][root][INFO] - Processing question number 0
[2025-03-06 11:17:39,488][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:17:52,825][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:18:05,645][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:18:17,380][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:18:34,673][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:18:48,536][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:19:01,159][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:19:14,497][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:19:28,640][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:19:40,627][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:19:51,046][root][INFO] - Processing question number 10
[2025-03-06 11:19:51,048][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:20:06,945][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:20:18,413][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:20:31,492][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:20:46,622][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:20:59,914][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:21:13,379][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:21:24,399][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:21:36,162][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:21:46,825][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:21:56,432][root][INFO] - Processing question number 20
[2025-03-06 11:21:56,434][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:22:09,761][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:22:23,181][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:22:35,591][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:22:48,603][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:23:00,978][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:23:13,115][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:23:25,770][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:23:38,060][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:23:51,393][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:24:00,185][root][INFO] - Processing question number 30
[2025-03-06 11:24:00,188][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:24:13,056][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:24:26,851][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:24:37,830][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:24:50,001][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:25:00,334][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:25:13,708][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:25:28,648][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:25:43,682][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:25:56,939][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:26:10,640][root][INFO] - Processing question number 40
[2025-03-06 11:26:10,643][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:26:25,111][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:26:40,567][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:26:55,949][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:27:11,087][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:27:22,535][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:27:36,331][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:27:48,734][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:28:01,408][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:28:12,887][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:28:24,801][root][INFO] - Processing question number 50
[2025-03-06 11:28:24,805][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:28:37,916][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:28:51,690][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:29:03,184][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:29:21,682][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:29:31,167][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:29:40,392][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:29:52,392][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:30:05,457][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:30:16,926][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:30:28,347][root][INFO] - Processing question number 60
[2025-03-06 11:30:28,352][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:30:39,476][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:30:49,442][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:31:05,027][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:31:15,187][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:31:28,645][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:31:39,144][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:31:49,263][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:32:04,831][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:32:17,102][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:32:29,328][root][INFO] - Processing question number 70
[2025-03-06 11:32:29,332][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:32:40,681][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:32:56,655][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:33:09,929][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:33:25,294][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:33:38,471][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:33:50,848][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:34:06,618][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:34:18,321][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:34:32,762][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:34:44,607][root][INFO] - Processing question number 80
[2025-03-06 11:34:44,611][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:34:58,819][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:35:15,419][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:35:26,389][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:35:40,798][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:35:53,561][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:36:08,883][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:36:22,291][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:36:35,132][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:36:47,185][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:36:57,691][root][INFO] - Processing question number 90
[2025-03-06 11:36:57,695][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:37:11,573][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:37:19,606][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:37:33,240][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:37:43,372][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:37:56,289][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:38:07,624][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:38:18,486][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:38:32,314][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:38:45,785][root][INFO] - Inference complete
[2025-03-06 11:38:45,785][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,791][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,804][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,809][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,809][root][INFO] - Saved parsed outputs
[2025-03-06 11:38:45,809][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,810][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,811][root][INFO] - Saved parsing metadata
[2025-03-06 11:38:45,811][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,812][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:38:45,814][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:38:45,828][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 11:38:45,828][root][INFO] - Summary of metrics : {'label_accuracy': 0.31313131313131315, 'misclassification_rate': 0.6868686868686869, 'combined_accuracy': 0.0, 'malformed_label': 34, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 31, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 31, 'both_wrong': 68}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 11:38:52,601][root][INFO] - Setting global seed to 989
[2025-03-06 11:38:52,608][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 11:38:52,608][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:38:52,609][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:38:52,611][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:38:52,613][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:38:52,613][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:38:52,859][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:38:53,436][root][INFO] - Full model selected, loading model
[2025-03-06 11:39:12,509][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 11:39:12,509][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 11:39:19,976][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 11:39:19,977][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:39:19,977][root][INFO] - Starting inference
[2025-03-06 11:39:20,200][root][INFO] - Processing question number 0
[2025-03-06 11:39:20,202][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 11:39:31,283][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 11:39:42,384][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 11:39:55,490][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 11:40:05,705][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 11:40:16,759][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 11:40:31,867][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 11:40:42,976][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 11:40:54,732][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 11:41:03,341][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 11:41:16,601][root][INFO] - Processing question number 10
[2025-03-06 11:41:16,603][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 11:41:27,710][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 11:41:37,145][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 11:41:48,620][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 11:41:58,181][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 11:42:08,034][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 11:42:17,568][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 11:42:29,055][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 11:42:38,243][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 11:42:47,675][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 11:42:59,964][root][INFO] - Processing question number 20
[2025-03-06 11:42:59,967][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 11:43:09,189][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 11:43:21,424][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 11:43:32,078][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 11:43:42,819][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 11:43:53,628][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 11:44:03,388][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 11:44:12,625][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 11:44:21,471][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 11:44:31,731][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 11:44:43,249][root][INFO] - Processing question number 30
[2025-03-06 11:44:43,252][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 11:44:54,943][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 11:45:06,337][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 11:45:18,692][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 11:45:29,940][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 11:45:37,161][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 11:45:50,183][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 11:46:01,279][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 11:46:11,770][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 11:46:23,407][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 11:46:34,886][root][INFO] - Processing question number 40
[2025-03-06 11:46:34,889][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 11:46:45,623][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 11:46:59,861][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 11:47:14,255][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 11:47:28,000][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 11:47:37,369][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 11:47:46,117][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 11:47:57,080][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 11:48:08,067][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 11:48:19,085][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 11:48:29,262][root][INFO] - Processing question number 50
[2025-03-06 11:48:29,265][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 11:48:40,093][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 11:48:51,291][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 11:48:59,835][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 11:49:09,325][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 11:49:20,592][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 11:49:30,078][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 11:49:49,669][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 11:50:00,320][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 11:50:13,201][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 11:50:23,679][root][INFO] - Processing question number 60
[2025-03-06 11:50:23,683][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 11:50:33,426][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 11:50:42,646][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 11:50:54,767][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 11:51:03,471][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 11:51:11,219][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 11:51:26,837][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 11:51:36,352][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 11:51:46,085][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 11:51:57,957][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 11:52:13,661][root][INFO] - Processing question number 70
[2025-03-06 11:52:13,665][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 11:52:25,030][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 11:52:37,371][root][INFO] - Domain : Property, Question : 6
[2025-03-06 11:52:47,254][root][INFO] - Domain : Property, Question : 13
[2025-03-06 11:52:57,625][root][INFO] - Domain : Property, Question : 20
[2025-03-06 11:53:07,339][root][INFO] - Domain : Property, Question : 33
[2025-03-06 11:53:15,762][root][INFO] - Domain : Property, Question : 39
[2025-03-06 11:53:28,536][root][INFO] - Domain : Property, Question : 48
[2025-03-06 11:53:37,579][root][INFO] - Domain : Property, Question : 54
[2025-03-06 11:53:49,758][root][INFO] - Domain : Property, Question : 61
[2025-03-06 11:54:00,677][root][INFO] - Processing question number 80
[2025-03-06 11:54:00,681][root][INFO] - Domain : Property, Question : 67
[2025-03-06 11:54:11,926][root][INFO] - Domain : Property, Question : 75
[2025-03-06 11:54:23,880][root][INFO] - Domain : Property, Question : 83
[2025-03-06 11:54:34,569][root][INFO] - Domain : Property, Question : 89
[2025-03-06 11:54:43,487][root][INFO] - Domain : Property, Question : 97
[2025-03-06 11:54:56,352][root][INFO] - Domain : Property, Question : 100
[2025-03-06 11:55:10,433][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 11:55:20,924][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 11:55:31,353][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 11:55:43,592][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 11:55:54,882][root][INFO] - Processing question number 90
[2025-03-06 11:55:54,887][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 11:56:07,995][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 11:56:15,722][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 11:56:30,989][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 11:56:39,068][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 11:56:51,637][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 11:57:01,884][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 11:57:10,381][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 11:57:24,291][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 11:57:34,680][root][INFO] - Inference complete
[2025-03-06 11:57:34,680][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,685][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,686][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,687][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,688][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,688][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,688][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,688][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,688][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,689][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,689][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,690][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,690][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,690][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,690][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,690][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,690][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,691][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,691][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,691][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,691][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,692][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,692][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,692][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,692][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,692][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,692][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,692][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,693][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,693][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,693][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,693][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,693][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,693][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,693][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,694][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,694][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,694][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,694][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,694][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,694][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,695][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,695][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,695][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,695][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,695][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,695][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,696][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,696][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,696][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,696][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,696][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,696][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,697][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,697][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,697][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,697][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,698][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,698][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,698][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,699][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,699][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,699][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,699][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,699][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,699][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,700][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,700][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,700][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,700][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,700][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,700][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,701][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,701][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,701][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,701][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,701][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,702][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,702][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,702][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,702][root][WARNING] - |Q. 12||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,703][root][WARNING] - |Q. 12||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,703][root][INFO] - |Q. 12||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,703][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,703][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,703][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,704][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,704][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,704][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,705][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,705][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,705][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,705][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,705][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,706][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,706][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,706][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,706][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,706][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,706][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,706][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,707][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,707][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,707][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,707][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,707][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,707][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,707][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,708][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,708][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,708][root][WARNING] - |Q. 61||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,708][root][WARNING] - |Q. 61||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,708][root][INFO] - |Q. 61||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,709][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,709][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,709][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,709][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,709][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,709][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,710][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 11:57:34,711][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 11:57:34,711][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 11:57:34,712][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,717][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,717][root][INFO] - Saved parsed outputs
[2025-03-06 11:57:34,717][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,718][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,718][root][INFO] - Saved parsing metadata
[2025-03-06 11:57:34,719][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,720][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 11:57:34,723][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 11:57:34,750][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 11:57:34,750][root][INFO] - Summary of metrics : {'label_accuracy': 0.48484848484848486, 'misclassification_rate': 0.5151515151515151, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 48, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 51}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 11:57:42,279][root][INFO] - Setting global seed to 989
[2025-03-06 11:57:42,286][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 11:57:42,286][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 11:57:42,287][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 11:57:42,289][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 11:57:42,292][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 11:57:42,292][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 11:57:42,445][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 11:57:42,989][root][INFO] - Full model selected, loading model
[2025-03-06 11:58:04,997][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 11:59:47,701][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 11:59:47,702][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:00:20,562][root][INFO] - Peft model loaded successfully
[2025-03-06 12:00:28,069][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:00:28,071][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:00:28,071][root][INFO] - Starting inference
[2025-03-06 12:00:28,293][root][INFO] - Processing question number 0
[2025-03-06 12:00:28,295][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:00:39,580][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:00:52,703][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:01:09,160][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:01:24,652][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:01:38,032][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:01:52,379][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:02:07,085][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:02:24,753][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:02:36,255][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:02:49,126][root][INFO] - Processing question number 10
[2025-03-06 12:02:49,128][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:03:03,147][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:03:13,858][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:03:26,446][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:03:41,500][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:03:54,658][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:04:08,528][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:04:20,067][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:04:31,286][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:04:43,739][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:04:53,903][root][INFO] - Processing question number 20
[2025-03-06 12:04:53,905][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:05:05,761][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:05:19,305][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:05:29,526][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:05:39,467][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:05:52,848][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:06:08,059][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:06:20,061][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:06:34,055][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:06:48,206][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:06:58,547][root][INFO] - Processing question number 30
[2025-03-06 12:06:58,550][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:07:13,466][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:07:28,344][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:07:42,048][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:07:54,947][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:08:06,164][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:08:20,052][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:08:32,775][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:08:46,902][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:09:02,093][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:09:15,697][root][INFO] - Processing question number 40
[2025-03-06 12:09:15,700][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:09:33,418][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:09:48,344][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:10:02,088][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:10:19,402][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:10:33,793][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:10:44,058][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:10:56,209][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:11:06,850][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:11:17,944][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:11:30,315][root][INFO] - Processing question number 50
[2025-03-06 12:11:30,318][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:11:46,020][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:11:59,360][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:12:11,723][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:12:26,032][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:12:35,597][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:12:44,396][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:12:58,543][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:13:10,197][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:13:21,891][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:13:33,295][root][INFO] - Processing question number 60
[2025-03-06 12:13:33,298][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:13:45,009][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:13:55,463][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:14:12,269][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:14:23,741][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:14:36,881][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:14:49,235][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:15:00,130][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:15:12,672][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:15:24,569][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:15:43,725][root][INFO] - Processing question number 70
[2025-03-06 12:15:43,729][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:15:56,400][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:16:13,599][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:16:26,056][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:16:43,136][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:16:57,263][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:17:12,943][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:17:26,310][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:17:38,280][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:17:53,824][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:18:07,634][root][INFO] - Processing question number 80
[2025-03-06 12:18:07,638][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:18:22,990][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:18:39,945][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:18:50,297][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:19:05,973][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:19:20,874][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:19:35,521][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:19:48,770][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:20:01,519][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:20:15,163][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:20:26,113][root][INFO] - Processing question number 90
[2025-03-06 12:20:26,117][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:20:41,627][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:20:51,364][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:21:08,828][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:21:19,572][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:21:33,456][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:21:46,366][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:21:56,592][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:22:08,941][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:22:23,021][root][INFO] - Inference complete
[2025-03-06 12:22:23,021][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,026][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,039][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,043][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,043][root][INFO] - Saved parsed outputs
[2025-03-06 12:22:23,043][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,044][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,045][root][INFO] - Saved parsing metadata
[2025-03-06 12:22:23,045][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,046][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:22:23,048][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:22:23,076][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 12:22:23,076][root][INFO] - Summary of metrics : {'label_accuracy': 0.30303030303030304, 'misclassification_rate': 0.696969696969697, 'combined_accuracy': 0.0, 'malformed_label': 33, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 30, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 30, 'both_wrong': 69}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 12:22:30,261][root][INFO] - Setting global seed to 989
[2025-03-06 12:22:30,268][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 12:22:30,268][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:22:30,270][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:22:30,272][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:22:30,275][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:22:30,275][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:22:30,470][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:22:31,039][root][INFO] - Full model selected, loading model
[2025-03-06 12:22:52,947][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 12:22:52,963][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 12:23:00,756][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:23:00,758][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:23:00,758][root][INFO] - Starting inference
[2025-03-06 12:23:00,902][root][INFO] - Processing question number 0
[2025-03-06 12:23:00,904][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:23:11,398][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:23:22,260][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:23:31,877][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:23:42,254][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:23:51,543][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:24:01,121][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:24:16,220][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:24:27,438][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:24:36,387][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:24:49,732][root][INFO] - Processing question number 10
[2025-03-06 12:24:49,733][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:25:02,241][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:25:11,614][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:25:22,894][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:25:32,952][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:25:44,529][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:25:56,217][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:26:07,806][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:26:17,899][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:26:26,941][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:26:35,626][root][INFO] - Processing question number 20
[2025-03-06 12:26:35,628][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:26:45,295][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:26:54,281][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:27:05,150][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:27:14,629][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:27:26,892][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:27:36,852][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:27:47,107][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:27:58,935][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:28:09,883][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:28:20,448][root][INFO] - Processing question number 30
[2025-03-06 12:28:20,451][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:28:30,492][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:28:40,553][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:28:52,267][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:29:04,091][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:29:13,605][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:29:25,448][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:29:36,468][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:29:48,289][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:30:01,508][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:30:11,984][root][INFO] - Processing question number 40
[2025-03-06 12:30:11,987][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:30:22,792][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:30:34,455][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:30:51,812][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:31:06,094][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:31:15,343][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:31:25,693][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:31:36,206][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:31:47,535][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:32:00,319][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:32:12,508][root][INFO] - Processing question number 50
[2025-03-06 12:32:12,511][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:32:22,127][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:32:32,682][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:32:41,682][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:32:51,518][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:33:01,498][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:33:11,936][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:33:22,747][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:33:34,354][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:33:52,812][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:34:04,845][root][INFO] - Processing question number 60
[2025-03-06 12:34:04,848][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:34:15,445][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:34:23,873][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:34:37,136][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:34:46,294][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:34:56,667][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:35:07,949][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:35:18,419][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:35:27,893][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:35:38,896][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:35:53,160][root][INFO] - Processing question number 70
[2025-03-06 12:35:53,164][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:36:07,564][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:36:20,407][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:36:30,958][root][INFO] - Domain : Property, Question : 13
[2025-03-06 12:36:43,230][root][INFO] - Domain : Property, Question : 20
[2025-03-06 12:36:53,997][root][INFO] - Domain : Property, Question : 33
[2025-03-06 12:37:02,478][root][INFO] - Domain : Property, Question : 39
[2025-03-06 12:37:15,563][root][INFO] - Domain : Property, Question : 48
[2025-03-06 12:37:25,503][root][INFO] - Domain : Property, Question : 54
[2025-03-06 12:37:37,848][root][INFO] - Domain : Property, Question : 61
[2025-03-06 12:37:46,559][root][INFO] - Processing question number 80
[2025-03-06 12:37:46,563][root][INFO] - Domain : Property, Question : 67
[2025-03-06 12:37:56,417][root][INFO] - Domain : Property, Question : 75
[2025-03-06 12:38:08,113][root][INFO] - Domain : Property, Question : 83
[2025-03-06 12:38:20,877][root][INFO] - Domain : Property, Question : 89
[2025-03-06 12:38:31,421][root][INFO] - Domain : Property, Question : 97
[2025-03-06 12:38:41,475][root][INFO] - Domain : Property, Question : 100
[2025-03-06 12:38:54,255][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 12:39:04,995][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 12:39:16,659][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 12:39:30,293][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 12:39:39,627][root][INFO] - Processing question number 90
[2025-03-06 12:39:39,631][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 12:39:52,722][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 12:40:01,128][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 12:40:13,185][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 12:40:21,449][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 12:40:31,590][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 12:40:42,547][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 12:40:50,824][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 12:41:03,829][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 12:41:13,994][root][INFO] - Inference complete
[2025-03-06 12:41:13,994][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:13,999][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:14,000][root][WARNING] - |Q. 35||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,001][root][WARNING] - |Q. 35||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,002][root][INFO] - |Q. 35||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,002][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,002][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,002][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,002][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,003][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,003][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,003][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,003][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,003][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,004][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,004][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,004][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,005][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,005][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,005][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,005][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,005][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,005][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,005][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,006][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,006][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,006][root][WARNING] - |Q. 37||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,006][root][WARNING] - |Q. 37||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,006][root][INFO] - |Q. 37||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,007][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,007][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,007][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,007][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,007][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,007][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,007][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,008][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,008][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,008][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,008][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,008][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,008][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,009][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,009][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,009][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,009][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,009][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,009][root][WARNING] - |Q. 3||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,009][root][WARNING] - |Q. 3||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,010][root][INFO] - |Q. 3||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,010][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,010][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,010][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,010][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,011][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,011][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,011][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,011][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,011][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,012][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,012][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,012][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,012][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,012][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,012][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,013][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,013][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,013][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,013][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,014][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,014][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,014][root][WARNING] - |Q. 4||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,014][root][WARNING] - |Q. 4||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,014][root][INFO] - |Q. 4||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,014][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,015][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,015][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,015][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,015][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,015][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,015][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,016][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,016][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,016][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,016][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,016][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,017][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,017][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,017][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,018][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,018][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,018][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,018][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,018][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,019][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,019][root][WARNING] - |Q. 53||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,019][root][WARNING] - |Q. 53||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,019][root][INFO] - |Q. 53||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,020][root][WARNING] - |Q. 96||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,020][root][WARNING] - |Q. 96||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,020][root][INFO] - |Q. 96||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,020][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,020][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,020][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,021][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,021][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,021][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,021][root][WARNING] - |Q. 20||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,021][root][WARNING] - |Q. 20||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,021][root][INFO] - |Q. 20||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,021][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,022][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,022][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,022][root][WARNING] - |Q. 39||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,022][root][WARNING] - |Q. 39||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,022][root][INFO] - |Q. 39||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,022][root][WARNING] - |Q. 48||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,023][root][WARNING] - |Q. 48||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,023][root][INFO] - |Q. 48||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,023][root][WARNING] - |Q. 54||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,023][root][WARNING] - |Q. 54||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,023][root][INFO] - |Q. 54||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,024][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,024][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,024][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,024][root][WARNING] - |Q. 89||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,024][root][WARNING] - |Q. 89||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,024][root][INFO] - |Q. 89||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,025][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,025][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,025][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,025][root][WARNING] - |Q. 10||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,025][root][WARNING] - |Q. 10||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,025][root][INFO] - |Q. 10||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,026][root][WARNING] - |Q. 64||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 12:41:14,026][root][WARNING] - |Q. 64||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 12:41:14,026][root][INFO] - |Q. 64||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 12:41:14,028][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:14,032][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:14,032][root][INFO] - Saved parsed outputs
[2025-03-06 12:41:14,033][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:14,034][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:14,034][root][INFO] - Saved parsing metadata
[2025-03-06 12:41:14,034][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:14,036][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:41:14,037][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 12:41:14,052][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 12:41:14,052][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 46, 'both_wrong': 53}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 12:41:21,733][root][INFO] - Setting global seed to 989
[2025-03-06 12:41:21,739][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-03-06 12:41:21,739][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 12:41:21,740][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 12:41:21,742][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 12:41:21,745][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 12:41:21,745][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 12:41:21,910][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 12:41:22,452][root][INFO] - Full model selected, loading model
[2025-03-06 12:41:42,612][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 12:43:26,738][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 12:43:26,738][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 12:44:01,605][root][INFO] - Peft model loaded successfully
[2025-03-06 12:44:09,103][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 12:44:09,104][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 12:44:09,104][root][INFO] - Starting inference
[2025-03-06 12:44:09,278][root][INFO] - Processing question number 0
[2025-03-06 12:44:09,280][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 12:44:19,454][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 12:44:30,776][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 12:44:47,318][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 12:45:02,089][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 12:45:17,911][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 12:45:30,091][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 12:45:45,126][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 12:45:57,133][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 12:46:06,863][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 12:46:17,864][root][INFO] - Processing question number 10
[2025-03-06 12:46:17,865][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 12:46:32,661][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 12:46:50,559][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 12:47:04,159][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 12:47:18,985][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 12:47:28,621][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 12:47:40,919][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 12:47:53,539][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 12:48:07,122][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 12:48:18,456][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 12:48:30,983][root][INFO] - Processing question number 20
[2025-03-06 12:48:30,985][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 12:48:42,257][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 12:48:53,547][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 12:49:04,595][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 12:49:17,716][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 12:49:32,802][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 12:49:47,351][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 12:49:59,016][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 12:50:11,987][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 12:50:26,039][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 12:50:37,252][root][INFO] - Processing question number 30
[2025-03-06 12:50:37,254][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 12:50:57,257][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 12:51:11,851][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 12:51:25,075][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 12:51:40,238][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 12:51:49,812][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 12:52:03,068][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 12:52:17,480][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 12:52:34,046][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 12:52:49,475][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 12:53:02,215][root][INFO] - Processing question number 40
[2025-03-06 12:53:02,218][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 12:53:15,448][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 12:53:30,274][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 12:53:43,684][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 12:53:57,960][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 12:54:09,486][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 12:54:20,213][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 12:54:31,926][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 12:54:44,752][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 12:54:54,792][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 12:55:05,627][root][INFO] - Processing question number 50
[2025-03-06 12:55:05,630][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 12:55:18,369][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 12:55:33,051][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 12:55:45,044][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 12:55:58,919][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 12:56:08,801][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 12:56:22,876][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 12:56:36,773][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 12:56:46,487][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 12:56:58,219][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 12:57:08,441][root][INFO] - Processing question number 60
[2025-03-06 12:57:08,453][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 12:57:18,919][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 12:57:30,813][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 12:57:44,031][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 12:57:52,647][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 12:58:02,198][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 12:58:13,512][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 12:58:24,068][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 12:58:38,381][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 12:58:47,924][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 12:59:04,609][root][INFO] - Processing question number 70
[2025-03-06 12:59:04,612][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 12:59:17,777][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 12:59:30,509][root][INFO] - Domain : Property, Question : 6
[2025-03-06 12:59:44,367][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:00:02,114][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:00:15,970][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:00:29,907][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:00:46,089][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:00:57,475][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:01:15,648][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:01:27,979][root][INFO] - Processing question number 80
[2025-03-06 13:01:27,983][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:01:39,283][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:01:57,714][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:02:08,417][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:02:21,525][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:02:38,955][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:02:53,242][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:03:07,523][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:03:19,177][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:03:31,950][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:03:42,558][root][INFO] - Processing question number 90
[2025-03-06 13:03:42,562][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:03:56,406][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:04:10,625][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:04:23,185][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:04:39,054][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:04:54,017][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:05:06,856][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:05:16,006][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:05:33,486][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:05:47,798][root][INFO] - Inference complete
[2025-03-06 13:05:47,798][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,803][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,815][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,828][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,828][root][INFO] - Saved parsed outputs
[2025-03-06 13:05:47,828][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,829][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,829][root][INFO] - Saved parsing metadata
[2025-03-06 13:05:47,830][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,831][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:05:47,845][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:05:47,852][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 13:05:47,852][root][INFO] - Summary of metrics : {'label_accuracy': 0.35353535353535354, 'misclassification_rate': 0.6464646464646464, 'combined_accuracy': 0.0, 'malformed_label': 33, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 35, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 35, 'both_wrong': 64}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 13:05:54,454][root][INFO] - Setting global seed to 989
[2025-03-06 13:05:54,459][root][INFO] - Running evaluation of the untrained model on the test_set_1
[2025-03-06 13:05:54,460][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:05:54,461][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_1.json
[2025-03-06 13:05:54,463][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:05:54,465][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:05:54,465][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
[2025-03-06 13:05:54,616][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:05:55,211][root][INFO] - Full model selected, loading model
[2025-03-06 13:06:10,125][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:06:10,125][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:06:17,716][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:06:17,717][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:06:17,717][root][INFO] - Starting inference
[2025-03-06 13:06:17,859][root][INFO] - Processing question number 0
[2025-03-06 13:06:17,873][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-03-06 13:06:32,036][root][INFO] - Domain : Civil_procedure, Question : 7
[2025-03-06 13:06:39,148][root][INFO] - Domain : Civil_procedure, Question : 14
[2025-03-06 13:06:50,420][root][INFO] - Domain : Civil_procedure, Question : 21
[2025-03-06 13:07:03,050][root][INFO] - Domain : Civil_procedure, Question : 28
[2025-03-06 13:07:16,050][root][INFO] - Domain : Civil_procedure, Question : 35
[2025-03-06 13:07:27,340][root][INFO] - Domain : Civil_procedure, Question : 42
[2025-03-06 13:07:37,621][root][INFO] - Domain : Civil_procedure, Question : 49
[2025-03-06 13:07:48,874][root][INFO] - Domain : Civil_procedure, Question : 56
[2025-03-06 13:07:57,999][root][INFO] - Domain : Civil_procedure, Question : 63
[2025-03-06 13:08:12,184][root][INFO] - Processing question number 10
[2025-03-06 13:08:12,186][root][INFO] - Domain : Civil_procedure, Question : 69
[2025-03-06 13:08:23,604][root][INFO] - Domain : Civil_procedure, Question : 70
[2025-03-06 13:08:35,361][root][INFO] - Domain : Civil_procedure, Question : 77
[2025-03-06 13:08:44,765][root][INFO] - Domain : Civil_procedure, Question : 84
[2025-03-06 13:08:56,459][root][INFO] - Domain : Civil_procedure, Question : 91
[2025-03-06 13:09:09,965][root][INFO] - Domain : Civil_procedure, Question : 98
[2025-03-06 13:09:22,127][root][INFO] - Domain : Constitutional_law, Question : 2
[2025-03-06 13:09:33,662][root][INFO] - Domain : Constitutional_law, Question : 9
[2025-03-06 13:09:43,607][root][INFO] - Domain : Constitutional_law, Question : 17
[2025-03-06 13:09:53,152][root][INFO] - Domain : Constitutional_law, Question : 25
[2025-03-06 13:10:02,749][root][INFO] - Processing question number 20
[2025-03-06 13:10:02,751][root][INFO] - Domain : Constitutional_law, Question : 29
[2025-03-06 13:10:13,244][root][INFO] - Domain : Constitutional_law, Question : 37
[2025-03-06 13:10:23,863][root][INFO] - Domain : Constitutional_law, Question : 43
[2025-03-06 13:10:35,554][root][INFO] - Domain : Constitutional_law, Question : 55
[2025-03-06 13:10:44,615][root][INFO] - Domain : Constitutional_law, Question : 60
[2025-03-06 13:10:55,437][root][INFO] - Domain : Constitutional_law, Question : 65
[2025-03-06 13:11:06,930][root][INFO] - Domain : Constitutional_law, Question : 71
[2025-03-06 13:11:16,166][root][INFO] - Domain : Constitutional_law, Question : 79
[2025-03-06 13:11:29,169][root][INFO] - Domain : Constitutional_law, Question : 87
[2025-03-06 13:11:38,104][root][INFO] - Domain : Constitutional_law, Question : 93
[2025-03-06 13:11:52,243][root][INFO] - Processing question number 30
[2025-03-06 13:11:52,246][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:12:03,105][root][INFO] - Domain : Contracts, Question : 8
[2025-03-06 13:12:10,655][root][INFO] - Domain : Contracts, Question : 16
[2025-03-06 13:12:23,448][root][INFO] - Domain : Contracts, Question : 22
[2025-03-06 13:12:32,425][root][INFO] - Domain : Contracts, Question : 27
[2025-03-06 13:12:42,595][root][INFO] - Domain : Contracts, Question : 38
[2025-03-06 13:12:58,922][root][INFO] - Domain : Contracts, Question : 46
[2025-03-06 13:13:12,669][root][INFO] - Domain : Contracts, Question : 51
[2025-03-06 13:13:24,131][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:13:37,373][root][INFO] - Domain : Contracts, Question : 66
[2025-03-06 13:13:47,014][root][INFO] - Processing question number 40
[2025-03-06 13:13:47,016][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:13:57,553][root][INFO] - Domain : Contracts, Question : 81
[2025-03-06 13:14:13,425][root][INFO] - Domain : Contracts, Question : 88
[2025-03-06 13:14:26,734][root][INFO] - Domain : Contracts, Question : 94
[2025-03-06 13:14:37,444][root][INFO] - Domain : Torts, Question : 4
[2025-03-06 13:14:46,832][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:14:59,195][root][INFO] - Domain : Torts, Question : 24
[2025-03-06 13:15:10,473][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:15:19,597][root][INFO] - Domain : Torts, Question : 41
[2025-03-06 13:15:30,029][root][INFO] - Domain : Torts, Question : 47
[2025-03-06 13:15:40,747][root][INFO] - Processing question number 50
[2025-03-06 13:15:40,751][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:15:50,787][root][INFO] - Domain : Torts, Question : 62
[2025-03-06 13:16:03,168][root][INFO] - Domain : Torts, Question : 76
[2025-03-06 13:16:13,448][root][INFO] - Domain : Torts, Question : 82
[2025-03-06 13:16:22,372][root][INFO] - Domain : Torts, Question : 90
[2025-03-06 13:16:34,029][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:16:43,455][root][INFO] - Domain : Torts, Question : 99
[2025-03-06 13:16:58,935][root][INFO] - Domain : Evidence, Question : 5
[2025-03-06 13:17:10,908][root][INFO] - Domain : Evidence, Question : 12
[2025-03-06 13:17:21,955][root][INFO] - Domain : Evidence, Question : 18
[2025-03-06 13:17:31,322][root][INFO] - Processing question number 60
[2025-03-06 13:17:31,326][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:17:41,721][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:17:51,224][root][INFO] - Domain : Evidence, Question : 34
[2025-03-06 13:18:05,582][root][INFO] - Domain : Evidence, Question : 40
[2025-03-06 13:18:14,778][root][INFO] - Domain : Evidence, Question : 44
[2025-03-06 13:18:26,287][root][INFO] - Domain : Evidence, Question : 53
[2025-03-06 13:18:47,051][root][INFO] - Domain : Evidence, Question : 59
[2025-03-06 13:18:56,789][root][INFO] - Domain : Evidence, Question : 68
[2025-03-06 13:19:11,564][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:19:22,245][root][INFO] - Domain : Evidence, Question : 78
[2025-03-06 13:19:35,368][root][INFO] - Processing question number 70
[2025-03-06 13:19:35,372][root][INFO] - Domain : Evidence, Question : 86
[2025-03-06 13:19:46,651][root][INFO] - Domain : Evidence, Question : 96
[2025-03-06 13:20:04,157][root][INFO] - Domain : Property, Question : 6
[2025-03-06 13:20:15,936][root][INFO] - Domain : Property, Question : 13
[2025-03-06 13:20:28,159][root][INFO] - Domain : Property, Question : 20
[2025-03-06 13:20:37,255][root][INFO] - Domain : Property, Question : 33
[2025-03-06 13:20:49,282][root][INFO] - Domain : Property, Question : 39
[2025-03-06 13:21:04,874][root][INFO] - Domain : Property, Question : 48
[2025-03-06 13:21:14,482][root][INFO] - Domain : Property, Question : 54
[2025-03-06 13:21:27,063][root][INFO] - Domain : Property, Question : 61
[2025-03-06 13:21:34,741][root][INFO] - Processing question number 80
[2025-03-06 13:21:34,745][root][INFO] - Domain : Property, Question : 67
[2025-03-06 13:21:46,570][root][INFO] - Domain : Property, Question : 75
[2025-03-06 13:21:59,926][root][INFO] - Domain : Property, Question : 83
[2025-03-06 13:22:09,425][root][INFO] - Domain : Property, Question : 89
[2025-03-06 13:22:20,334][root][INFO] - Domain : Property, Question : 97
[2025-03-06 13:22:31,840][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:22:46,478][root][INFO] - Domain : Criminal_law, Question : 10
[2025-03-06 13:22:58,201][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:23:07,760][root][INFO] - Domain : Criminal_law, Question : 26
[2025-03-06 13:23:20,490][root][INFO] - Domain : Criminal_law, Question : 30
[2025-03-06 13:23:31,194][root][INFO] - Processing question number 90
[2025-03-06 13:23:31,201][root][INFO] - Domain : Criminal_law, Question : 36
[2025-03-06 13:23:45,584][root][INFO] - Domain : Criminal_law, Question : 45
[2025-03-06 13:23:57,636][root][INFO] - Domain : Criminal_law, Question : 50
[2025-03-06 13:24:09,308][root][INFO] - Domain : Criminal_law, Question : 57
[2025-03-06 13:24:17,967][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:24:29,510][root][INFO] - Domain : Criminal_law, Question : 74
[2025-03-06 13:24:40,458][root][INFO] - Domain : Criminal_law, Question : 80
[2025-03-06 13:24:49,412][root][INFO] - Domain : Criminal_law, Question : 85
[2025-03-06 13:25:10,377][root][INFO] - Domain : Criminal_law, Question : 92
[2025-03-06 13:25:21,283][root][INFO] - Inference complete
[2025-03-06 13:25:21,284][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,288][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,290][root][WARNING] - |Q. 14||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,291][root][WARNING] - |Q. 14||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,291][root][INFO] - |Q. 14||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,292][root][WARNING] - |Q. 49||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,292][root][WARNING] - |Q. 49||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,293][root][INFO] - |Q. 49||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,293][root][WARNING] - |Q. 56||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,293][root][WARNING] - |Q. 56||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,293][root][INFO] - |Q. 56||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,293][root][WARNING] - |Q. 69||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,293][root][WARNING] - |Q. 69||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,294][root][INFO] - |Q. 69||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,294][root][WARNING] - |Q. 91||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,294][root][WARNING] - |Q. 91||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,294][root][INFO] - |Q. 91||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,295][root][WARNING] - |Q. 98||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,295][root][WARNING] - |Q. 98||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,295][root][INFO] - |Q. 98||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,295][root][WARNING] - |Q. 9||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,295][root][WARNING] - |Q. 9||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,295][root][INFO] - |Q. 9||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,296][root][WARNING] - |Q. 17||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,296][root][WARNING] - |Q. 17||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,296][root][INFO] - |Q. 17||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,296][root][WARNING] - |Q. 25||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,296][root][WARNING] - |Q. 25||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,296][root][INFO] - |Q. 25||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,296][root][WARNING] - |Q. 29||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,297][root][WARNING] - |Q. 29||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,297][root][INFO] - |Q. 29||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,297][root][WARNING] - |Q. 60||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,297][root][WARNING] - |Q. 60||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,297][root][INFO] - |Q. 60||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,298][root][WARNING] - |Q. 65||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,298][root][WARNING] - |Q. 65||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,298][root][INFO] - |Q. 65||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,298][root][WARNING] - |Q. 71||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,298][root][WARNING] - |Q. 71||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,298][root][INFO] - |Q. 71||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,298][root][WARNING] - |Q. 79||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,299][root][WARNING] - |Q. 79||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,299][root][INFO] - |Q. 79||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,299][root][WARNING] - |Q. 87||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,300][root][WARNING] - |Q. 87||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,300][root][INFO] - |Q. 87||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,300][root][WARNING] - |Q. 93||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,300][root][WARNING] - |Q. 93||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,300][root][INFO] - |Q. 93||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,300][root][WARNING] - |Q. 8||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,301][root][WARNING] - |Q. 8||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,301][root][INFO] - |Q. 8||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,301][root][WARNING] - |Q. 22||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,301][root][WARNING] - |Q. 22||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,301][root][INFO] - |Q. 22||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,301][root][WARNING] - |Q. 38||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,302][root][WARNING] - |Q. 38||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,302][root][INFO] - |Q. 38||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,302][root][WARNING] - |Q. 46||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,302][root][WARNING] - |Q. 46||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,302][root][INFO] - |Q. 46||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,302][root][WARNING] - |Q. 51||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,303][root][WARNING] - |Q. 51||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,303][root][INFO] - |Q. 51||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,303][root][WARNING] - |Q. 88||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,304][root][WARNING] - |Q. 88||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,304][root][INFO] - |Q. 88||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,304][root][WARNING] - |Q. 94||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,304][root][WARNING] - |Q. 94||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,304][root][INFO] - |Q. 94||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,305][root][WARNING] - |Q. 24||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,305][root][WARNING] - |Q. 24||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,305][root][INFO] - |Q. 24||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,305][root][WARNING] - |Q. 52||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,305][root][WARNING] - |Q. 52||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,306][root][INFO] - |Q. 52||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,306][root][WARNING] - |Q. 82||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,306][root][WARNING] - |Q. 82||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,306][root][INFO] - |Q. 82||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,306][root][WARNING] - |Q. 90||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,307][root][WARNING] - |Q. 90||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,307][root][INFO] - |Q. 90||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,307][root][WARNING] - |Q. 99||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,307][root][WARNING] - |Q. 99||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,307][root][INFO] - |Q. 99||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,307][root][WARNING] - |Q. 5||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,308][root][WARNING] - |Q. 5||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,308][root][INFO] - |Q. 5||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,308][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,308][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,308][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,309][root][WARNING] - |Q. 40||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,309][root][WARNING] - |Q. 40||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,309][root][INFO] - |Q. 40||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,309][root][WARNING] - |Q. 44||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,309][root][WARNING] - |Q. 44||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,309][root][INFO] - |Q. 44||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,310][root][WARNING] - |Q. 86||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,310][root][WARNING] - |Q. 86||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,310][root][INFO] - |Q. 86||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,311][root][WARNING] - |Q. 6||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,311][root][WARNING] - |Q. 6||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,311][root][INFO] - |Q. 6||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,311][root][WARNING] - |Q. 13||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,311][root][WARNING] - |Q. 13||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,311][root][INFO] - |Q. 13||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,312][root][WARNING] - |Q. 33||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,312][root][WARNING] - |Q. 33||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,312][root][INFO] - |Q. 33||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,313][root][WARNING] - |Q. 67||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,313][root][WARNING] - |Q. 67||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,313][root][INFO] - |Q. 67||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,313][root][WARNING] - |Q. 83||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,313][root][WARNING] - |Q. 83||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,313][root][INFO] - |Q. 83||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,314][root][WARNING] - |Q. 97||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 13:25:21,314][root][WARNING] - |Q. 97||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 13:25:21,314][root][INFO] - |Q. 97||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 13:25:21,316][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,321][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,321][root][INFO] - Saved parsed outputs
[2025-03-06 13:25:21,321][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,322][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,322][root][INFO] - Saved parsing metadata
[2025-03-06 13:25:21,322][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,324][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
[2025-03-06 13:25:21,325][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_1.json
Metrics successfully appended to master CSV.
[2025-03-06 13:25:21,361][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_1
[2025-03-06 13:25:21,361][root][INFO] - Summary of metrics : {'label_accuracy': 0.46464646464646464, 'misclassification_rate': 0.5353535353535354, 'combined_accuracy': 0.0, 'malformed_label': 5, 'malformed_domain': 99, 'total_predictions': 99, 'correct_predictions': 46, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 46, 'both_wrong': 53}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_1 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 13:25:32,827][root][INFO] - Setting global seed to 206
[2025-03-06 13:25:32,853][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 13:25:32,854][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:25:32,855][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:25:32,856][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:25:32,858][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:25:32,858][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:25:33,024][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:25:33,596][root][INFO] - Full model selected, loading model
[2025-03-06 13:25:55,729][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 13:27:39,376][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 13:27:39,414][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 13:28:15,968][root][INFO] - Peft model loaded successfully
[2025-03-06 13:28:23,483][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:28:23,485][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:28:23,485][root][INFO] - Starting inference
[2025-03-06 13:28:23,643][root][INFO] - Processing question number 0
[2025-03-06 13:28:23,645][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:28:39,317][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:28:52,796][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:29:07,807][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:29:20,275][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:29:31,210][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:29:43,201][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:29:55,414][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:30:08,766][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:30:16,764][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:30:28,295][root][INFO] - Processing question number 10
[2025-03-06 13:30:28,300][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:30:39,389][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:30:52,892][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:31:05,639][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:31:13,711][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:31:28,689][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:31:39,383][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:31:52,041][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:32:05,684][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:32:16,714][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:32:30,456][root][INFO] - Processing question number 20
[2025-03-06 13:32:30,458][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:32:40,311][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:32:52,768][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:33:02,234][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:33:10,121][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:33:22,649][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:33:34,958][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:33:47,825][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:34:01,469][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:34:14,651][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:34:30,393][root][INFO] - Processing question number 30
[2025-03-06 13:34:30,395][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:34:40,742][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:34:52,632][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:35:05,224][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:35:17,807][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:35:30,780][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:35:44,127][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:35:58,292][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:36:11,485][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:36:21,035][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:36:36,066][root][INFO] - Processing question number 40
[2025-03-06 13:36:36,069][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:36:48,418][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:36:58,520][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:37:12,749][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:37:20,920][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:37:40,216][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:37:51,017][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:38:03,135][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:38:14,207][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:38:26,910][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:38:38,740][root][INFO] - Processing question number 50
[2025-03-06 13:38:38,743][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:38:50,676][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:39:05,283][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:39:19,570][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 13:39:33,478][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 13:39:47,496][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 13:39:58,263][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 13:40:11,994][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 13:40:24,543][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 13:40:37,677][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 13:40:47,926][root][INFO] - Processing question number 60
[2025-03-06 13:40:47,929][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 13:41:00,221][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 13:41:12,924][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 13:41:26,413][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 13:41:38,789][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 13:41:50,196][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 13:42:03,197][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 13:42:14,064][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 13:42:23,725][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 13:42:37,763][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 13:42:49,053][root][INFO] - Processing question number 70
[2025-03-06 13:42:49,057][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 13:43:02,031][root][INFO] - Domain : Property, Question : 9
[2025-03-06 13:43:15,218][root][INFO] - Domain : Property, Question : 17
[2025-03-06 13:43:27,900][root][INFO] - Domain : Property, Question : 25
[2025-03-06 13:43:44,792][root][INFO] - Domain : Property, Question : 30
[2025-03-06 13:43:54,502][root][INFO] - Domain : Property, Question : 36
[2025-03-06 13:44:09,625][root][INFO] - Domain : Property, Question : 46
[2025-03-06 13:44:26,075][root][INFO] - Domain : Property, Question : 53
[2025-03-06 13:44:38,868][root][INFO] - Domain : Property, Question : 59
[2025-03-06 13:44:49,628][root][INFO] - Domain : Property, Question : 66
[2025-03-06 13:45:00,125][root][INFO] - Processing question number 80
[2025-03-06 13:45:00,129][root][INFO] - Domain : Property, Question : 69
[2025-03-06 13:45:11,881][root][INFO] - Domain : Property, Question : 81
[2025-03-06 13:45:27,338][root][INFO] - Domain : Property, Question : 88
[2025-03-06 13:45:42,467][root][INFO] - Domain : Property, Question : 91
[2025-03-06 13:45:53,007][root][INFO] - Domain : Property, Question : 94
[2025-03-06 13:46:09,169][root][INFO] - Domain : Property, Question : 100
[2025-03-06 13:46:21,672][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 13:46:34,502][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 13:46:48,144][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 13:47:01,383][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 13:47:12,152][root][INFO] - Processing question number 90
[2025-03-06 13:47:12,157][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 13:47:25,689][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 13:47:39,649][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 13:47:52,776][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 13:48:02,639][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 13:48:17,538][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 13:48:32,310][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 13:48:45,001][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 13:48:55,379][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 13:49:06,610][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 13:49:21,420][root][INFO] - Inference complete
[2025-03-06 13:49:21,420][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,425][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,438][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,454][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,454][root][INFO] - Saved parsed outputs
[2025-03-06 13:49:21,454][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,456][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,456][root][INFO] - Saved parsing metadata
[2025-03-06 13:49:21,456][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,458][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:21,459][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 13:49:21,490][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 13:49:21,490][root][INFO] - Summary of metrics : {'label_accuracy': 0.39, 'misclassification_rate': 0.61, 'combined_accuracy': 0.0, 'malformed_label': 28, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 13:49:29,097][root][INFO] - Setting global seed to 206
[2025-03-06 13:49:29,102][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 13:49:29,103][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 13:49:29,104][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 13:49:29,106][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 13:49:29,108][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 13:49:29,109][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 13:49:29,258][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 13:49:29,833][root][INFO] - Full model selected, loading model
[2025-03-06 13:49:49,451][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 13:49:49,451][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 13:49:57,180][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 13:49:57,182][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 13:49:57,182][root][INFO] - Starting inference
[2025-03-06 13:49:57,350][root][INFO] - Processing question number 0
[2025-03-06 13:49:57,353][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 13:50:13,731][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 13:50:26,904][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 13:50:39,694][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 13:50:51,142][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 13:51:00,314][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 13:51:10,072][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 13:51:23,198][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 13:51:33,571][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 13:51:43,078][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 13:51:55,081][root][INFO] - Processing question number 10
[2025-03-06 13:51:55,083][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 13:52:05,701][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 13:52:19,306][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 13:52:31,129][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 13:52:42,024][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 13:52:54,334][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 13:53:05,264][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 13:53:17,646][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 13:53:27,952][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 13:53:38,886][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 13:53:49,500][root][INFO] - Processing question number 20
[2025-03-06 13:53:49,502][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 13:53:57,528][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 13:54:06,958][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 13:54:17,156][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 13:54:23,679][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 13:54:34,074][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 13:54:44,829][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 13:54:53,716][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 13:55:03,732][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 13:55:14,183][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 13:55:25,163][root][INFO] - Processing question number 30
[2025-03-06 13:55:25,165][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 13:55:37,329][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 13:55:48,004][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 13:56:00,550][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 13:56:11,691][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 13:56:28,042][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 13:56:38,473][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 13:56:48,552][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 13:56:58,987][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 13:57:08,769][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 13:57:21,689][root][INFO] - Processing question number 40
[2025-03-06 13:57:21,692][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 13:57:31,605][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 13:57:43,116][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 13:57:55,179][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 13:58:02,913][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 13:58:22,433][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 13:58:31,614][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 13:58:41,145][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 13:58:56,433][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 13:59:09,098][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 13:59:19,816][root][INFO] - Processing question number 50
[2025-03-06 13:59:19,819][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 13:59:32,416][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 13:59:44,663][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 13:59:56,681][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:00:06,903][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:00:17,289][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:00:29,031][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:00:43,625][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:00:53,424][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:01:07,036][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:01:16,865][root][INFO] - Processing question number 60
[2025-03-06 14:01:16,868][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:01:25,048][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:01:40,184][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:01:52,885][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:02:06,016][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:02:15,977][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:02:30,854][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:02:39,613][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:02:53,230][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:03:04,202][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:03:14,524][root][INFO] - Processing question number 70
[2025-03-06 14:03:14,527][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:03:25,585][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:03:38,401][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:03:57,658][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:04:09,307][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:04:17,108][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:04:28,892][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:04:42,794][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:04:53,490][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:05:04,978][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:05:15,011][root][INFO] - Processing question number 80
[2025-03-06 14:05:15,015][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:05:27,243][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:05:36,486][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:05:50,337][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:06:02,183][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:06:14,640][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:06:26,592][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:06:39,574][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:06:52,036][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:07:05,514][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:07:15,303][root][INFO] - Processing question number 90
[2025-03-06 14:07:15,307][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:07:26,412][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:07:40,582][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:07:52,642][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:08:01,763][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:08:14,606][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:08:25,767][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:08:38,509][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:08:50,949][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:09:00,059][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:09:10,690][root][INFO] - Inference complete
[2025-03-06 14:09:10,690][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,695][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,696][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,696][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,697][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,697][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,697][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,698][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,698][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,698][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,698][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,698][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,698][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,699][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,699][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,699][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,699][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,699][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,699][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,699][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,700][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,700][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,700][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,700][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,700][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,700][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,701][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,701][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,701][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,701][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,701][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,701][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,702][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,702][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,702][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,702][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,702][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,702][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,703][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,703][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,703][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,703][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,703][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,703][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,704][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,704][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,704][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,704][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,704][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,704][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,705][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,705][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,705][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,706][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,706][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,706][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,706][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,707][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,707][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,707][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,707][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,708][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,708][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,708][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,708][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,708][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,708][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,709][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,709][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,709][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,709][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,709][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,710][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,710][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,710][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,710][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,710][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,710][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,711][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,711][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,711][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,711][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,711][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,712][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,712][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,712][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,712][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,712][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,712][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,713][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,713][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,713][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,713][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,713][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,713][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,715][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,715][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,715][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,716][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,716][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,716][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,716][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,716][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,717][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,717][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,717][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,717][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,717][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,717][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,718][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,718][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,718][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,718][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,718][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,718][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,718][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,719][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,719][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,719][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,719][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,719][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,720][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,720][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,720][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,720][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,720][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,720][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,720][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,721][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,721][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,721][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,721][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,721][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,721][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,722][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,722][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,722][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,722][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,722][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,723][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,723][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,723][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,723][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,724][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,724][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,724][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,724][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:09:10,724][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:09:10,724][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:09:10,726][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,730][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,731][root][INFO] - Saved parsed outputs
[2025-03-06 14:09:10,731][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,732][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,732][root][INFO] - Saved parsing metadata
[2025-03-06 14:09:10,733][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,734][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:09:10,738][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:09:10,756][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 14:09:10,756][root][INFO] - Summary of metrics : {'label_accuracy': 0.46, 'misclassification_rate': 0.54, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 46, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 46, 'both_wrong': 54}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 14:09:18,467][root][INFO] - Setting global seed to 206
[2025-03-06 14:09:18,475][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:09:18,475][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:09:18,476][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:09:18,477][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:09:18,480][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:09:18,480][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:09:18,627][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:09:19,186][root][INFO] - Full model selected, loading model
[2025-03-06 14:09:39,058][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:11:22,225][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:11:22,244][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:11:59,090][root][INFO] - Peft model loaded successfully
[2025-03-06 14:12:06,961][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:12:06,962][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:12:06,962][root][INFO] - Starting inference
[2025-03-06 14:12:07,157][root][INFO] - Processing question number 0
[2025-03-06 14:12:07,159][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:12:19,725][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:12:34,523][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:12:52,633][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:13:04,471][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:13:16,137][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:13:27,600][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:13:39,703][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:13:51,913][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:14:00,023][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:14:11,902][root][INFO] - Processing question number 10
[2025-03-06 14:14:11,904][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:14:23,812][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:14:36,603][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:14:51,402][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:15:00,240][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:15:14,698][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:15:25,729][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:15:38,975][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:15:51,197][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:16:02,137][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:16:13,270][root][INFO] - Processing question number 20
[2025-03-06 14:16:13,272][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:16:21,846][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:16:34,413][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:16:45,167][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:16:53,359][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:17:03,668][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:17:14,334][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:17:27,932][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:17:42,079][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:17:53,839][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:18:07,901][root][INFO] - Processing question number 30
[2025-03-06 14:18:07,903][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:18:18,230][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:18:30,558][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:18:42,559][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:18:56,685][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:19:09,355][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:19:23,400][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:19:39,534][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:19:51,136][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:20:04,338][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:20:19,173][root][INFO] - Processing question number 40
[2025-03-06 14:20:19,176][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:20:32,262][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:20:45,578][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:20:58,356][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:21:06,515][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:21:28,948][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:21:39,792][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:21:52,946][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:22:05,829][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:22:16,965][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:22:31,091][root][INFO] - Processing question number 50
[2025-03-06 14:22:31,094][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:22:44,269][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:22:57,438][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:23:15,174][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:23:29,232][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:23:41,930][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:23:52,197][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:24:08,260][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:24:23,338][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:24:39,046][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:24:51,261][root][INFO] - Processing question number 60
[2025-03-06 14:24:51,264][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:25:01,095][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:25:13,958][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:25:28,688][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:25:41,464][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:25:52,127][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:26:05,248][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:26:17,331][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:26:26,986][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:26:40,589][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:26:52,209][root][INFO] - Processing question number 70
[2025-03-06 14:26:52,213][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:27:07,054][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:27:19,936][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:27:31,263][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:27:48,109][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:27:59,336][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:28:14,544][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:28:33,589][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:28:46,029][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:28:56,105][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:29:07,067][root][INFO] - Processing question number 80
[2025-03-06 14:29:07,071][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:29:23,600][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:29:37,509][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:29:51,763][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:30:04,697][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:30:20,471][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:30:34,398][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:30:46,905][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:31:01,243][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:31:12,384][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:31:26,334][root][INFO] - Processing question number 90
[2025-03-06 14:31:26,338][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:31:40,221][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:31:54,739][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:32:07,308][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:32:19,274][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:32:33,008][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:32:47,282][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:33:01,411][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:33:12,186][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:33:23,935][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:33:40,715][root][INFO] - Inference complete
[2025-03-06 14:33:40,715][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,720][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,733][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,737][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,737][root][INFO] - Saved parsed outputs
[2025-03-06 14:33:40,738][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,742][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,742][root][INFO] - Saved parsing metadata
[2025-03-06 14:33:40,742][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,744][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:33:40,745][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:33:40,771][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 14:33:40,772][root][INFO] - Summary of metrics : {'label_accuracy': 0.35, 'misclassification_rate': 0.65, 'combined_accuracy': 0.0, 'malformed_label': 29, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 35, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 35, 'both_wrong': 65}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 14:33:47,937][root][INFO] - Setting global seed to 206
[2025-03-06 14:33:47,942][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 14:33:47,943][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:33:47,944][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:33:47,945][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:33:47,947][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:33:47,947][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:33:48,140][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:33:48,662][root][INFO] - Full model selected, loading model
[2025-03-06 14:34:10,320][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 14:34:10,320][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 14:34:18,223][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:34:18,224][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:34:18,225][root][INFO] - Starting inference
[2025-03-06 14:34:18,379][root][INFO] - Processing question number 0
[2025-03-06 14:34:18,381][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:34:31,573][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:34:42,831][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:34:57,312][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:35:06,977][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:35:16,077][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:35:26,948][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:35:38,208][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:35:49,152][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:35:58,703][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:36:10,969][root][INFO] - Processing question number 10
[2025-03-06 14:36:10,971][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:36:19,684][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:36:31,456][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:36:43,963][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:36:55,017][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:37:06,082][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:37:17,450][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 14:37:29,771][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 14:37:41,817][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 14:37:50,652][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 14:38:03,494][root][INFO] - Processing question number 20
[2025-03-06 14:38:03,496][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 14:38:11,527][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 14:38:21,950][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 14:38:29,884][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 14:38:38,329][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 14:38:50,147][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 14:39:02,231][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 14:39:13,765][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 14:39:24,353][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 14:39:35,343][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 14:39:46,216][root][INFO] - Processing question number 30
[2025-03-06 14:39:46,219][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 14:39:57,561][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 14:40:09,406][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 14:40:21,519][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 14:40:31,265][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 14:40:41,232][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 14:40:51,016][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 14:41:03,256][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 14:41:16,589][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 14:41:25,539][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 14:41:35,386][root][INFO] - Processing question number 40
[2025-03-06 14:41:35,389][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 14:41:47,514][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 14:41:58,109][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 14:42:10,992][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 14:42:20,859][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 14:42:36,869][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 14:42:45,169][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 14:42:54,612][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 14:43:04,157][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 14:43:15,350][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 14:43:26,320][root][INFO] - Processing question number 50
[2025-03-06 14:43:26,323][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 14:43:37,330][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 14:43:49,422][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 14:44:02,223][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 14:44:18,561][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 14:44:31,137][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 14:44:47,231][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 14:45:00,334][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 14:45:12,341][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 14:45:24,094][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 14:45:32,431][root][INFO] - Processing question number 60
[2025-03-06 14:45:32,434][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 14:45:41,341][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 14:45:54,165][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 14:46:09,965][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 14:46:24,590][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 14:46:34,770][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 14:46:45,706][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 14:46:55,974][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 14:47:07,111][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 14:47:17,451][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 14:47:31,790][root][INFO] - Processing question number 70
[2025-03-06 14:47:31,794][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 14:47:42,251][root][INFO] - Domain : Property, Question : 9
[2025-03-06 14:47:54,672][root][INFO] - Domain : Property, Question : 17
[2025-03-06 14:48:05,588][root][INFO] - Domain : Property, Question : 25
[2025-03-06 14:48:16,715][root][INFO] - Domain : Property, Question : 30
[2025-03-06 14:48:26,200][root][INFO] - Domain : Property, Question : 36
[2025-03-06 14:48:36,211][root][INFO] - Domain : Property, Question : 46
[2025-03-06 14:48:49,896][root][INFO] - Domain : Property, Question : 53
[2025-03-06 14:49:02,813][root][INFO] - Domain : Property, Question : 59
[2025-03-06 14:49:14,369][root][INFO] - Domain : Property, Question : 66
[2025-03-06 14:49:23,483][root][INFO] - Processing question number 80
[2025-03-06 14:49:23,487][root][INFO] - Domain : Property, Question : 69
[2025-03-06 14:49:35,025][root][INFO] - Domain : Property, Question : 81
[2025-03-06 14:49:45,573][root][INFO] - Domain : Property, Question : 88
[2025-03-06 14:50:00,800][root][INFO] - Domain : Property, Question : 91
[2025-03-06 14:50:13,841][root][INFO] - Domain : Property, Question : 94
[2025-03-06 14:50:26,721][root][INFO] - Domain : Property, Question : 100
[2025-03-06 14:50:39,309][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 14:50:53,955][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 14:51:04,480][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 14:51:15,876][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 14:51:31,294][root][INFO] - Processing question number 90
[2025-03-06 14:51:31,298][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 14:51:42,176][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 14:51:53,407][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 14:52:04,285][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 14:52:12,406][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 14:52:24,619][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 14:52:36,337][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 14:52:48,588][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 14:52:59,841][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 14:53:07,952][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 14:53:18,448][root][INFO] - Inference complete
[2025-03-06 14:53:18,448][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,453][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,454][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,455][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,455][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,456][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,456][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,456][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,456][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,456][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,456][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,457][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,457][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,457][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,457][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,457][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,457][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,458][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,458][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,458][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,458][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,458][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,458][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,459][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,459][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,459][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,459][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,459][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,459][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,460][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,460][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,460][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,460][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,460][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,460][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,460][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,461][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,461][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,461][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,461][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,461][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,461][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,462][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,462][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,462][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,462][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,462][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,463][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,463][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,463][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,464][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,464][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,464][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,464][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,465][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,465][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,465][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,465][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,465][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,465][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,466][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,466][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,466][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,466][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,467][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,467][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,467][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,467][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,467][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,467][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,468][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,468][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,468][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,468][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,468][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,468][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,469][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,469][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,469][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,469][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,469][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,470][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,470][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,470][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,470][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,470][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,471][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,471][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,471][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,472][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,472][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,472][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,472][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,473][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,473][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,473][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,473][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,473][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,473][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,474][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,474][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,474][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,474][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,474][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,475][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,475][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,475][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,475][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,476][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,476][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,476][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,476][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,476][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,476][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,477][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,477][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,477][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,477][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,477][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,477][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,477][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,477][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,478][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,478][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,478][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,478][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,479][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,479][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,479][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,479][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,479][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,479][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,480][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,480][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,480][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,480][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,480][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,480][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,481][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,481][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,481][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,481][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,481][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,482][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,482][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,482][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,482][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,483][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,483][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,483][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 14:53:18,483][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 14:53:18,483][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 14:53:18,485][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,489][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,489][root][INFO] - Saved parsed outputs
[2025-03-06 14:53:18,489][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,491][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,491][root][INFO] - Saved parsing metadata
[2025-03-06 14:53:18,492][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,503][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:53:18,505][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 14:53:18,524][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 14:53:18,524][root][INFO] - Summary of metrics : {'label_accuracy': 0.45, 'misclassification_rate': 0.55, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 45, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 45, 'both_wrong': 55}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 14:53:33,861][root][INFO] - Setting global seed to 206
[2025-03-06 14:53:33,869][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 14:53:33,869][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 14:53:33,871][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 14:53:33,873][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 14:53:33,874][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 14:53:33,875][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 14:53:34,040][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 14:53:34,618][root][INFO] - Full model selected, loading model
[2025-03-06 14:54:03,144][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 14:55:47,348][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 14:55:47,348][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 14:56:21,284][root][INFO] - Peft model loaded successfully
[2025-03-06 14:56:28,753][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 14:56:28,754][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 14:56:28,755][root][INFO] - Starting inference
[2025-03-06 14:56:28,917][root][INFO] - Processing question number 0
[2025-03-06 14:56:28,919][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 14:56:45,115][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 14:56:57,042][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 14:57:13,795][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 14:57:25,441][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 14:57:36,762][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 14:57:46,253][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 14:58:01,412][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 14:58:21,165][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 14:58:30,852][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 14:58:41,099][root][INFO] - Processing question number 10
[2025-03-06 14:58:41,101][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 14:58:51,600][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 14:59:07,797][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 14:59:21,336][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 14:59:31,698][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 14:59:45,646][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 14:59:56,214][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:00:07,312][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:00:20,109][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:00:30,727][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:00:41,259][root][INFO] - Processing question number 20
[2025-03-06 15:00:41,261][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:00:51,126][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:01:04,323][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:01:14,627][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:01:24,395][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:01:35,926][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:01:49,105][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:02:01,917][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:02:15,514][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:02:27,667][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:02:40,906][root][INFO] - Processing question number 30
[2025-03-06 15:02:40,908][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:02:50,661][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:03:03,298][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:03:14,659][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:03:29,076][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:03:41,448][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:03:55,168][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:04:06,453][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:04:18,536][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:04:28,836][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:04:41,620][root][INFO] - Processing question number 40
[2025-03-06 15:04:41,623][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:04:56,062][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:05:07,496][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:05:25,308][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:05:35,970][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:05:50,977][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:06:01,799][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:06:15,735][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:06:29,136][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:06:42,590][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:06:53,459][root][INFO] - Processing question number 50
[2025-03-06 15:06:53,462][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:07:06,892][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:07:21,227][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:07:34,597][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:07:48,222][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:08:01,266][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:08:10,663][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:08:24,338][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:08:38,761][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:08:52,281][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:09:05,267][root][INFO] - Processing question number 60
[2025-03-06 15:09:05,271][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:09:17,082][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:09:31,427][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:09:45,310][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:09:59,890][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:10:12,588][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:10:24,127][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:10:38,548][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:10:50,524][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:11:07,147][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:11:18,895][root][INFO] - Processing question number 70
[2025-03-06 15:11:18,898][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:11:33,667][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:11:48,837][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:12:01,409][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:12:17,112][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:12:27,201][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:12:44,301][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:13:01,603][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:13:15,051][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:13:26,892][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:13:39,038][root][INFO] - Processing question number 80
[2025-03-06 15:13:39,058][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:13:52,256][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:14:08,881][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:14:27,650][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:14:40,182][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:14:56,809][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:15:10,007][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:15:25,413][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:15:40,061][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:15:53,156][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:16:06,090][root][INFO] - Processing question number 90
[2025-03-06 15:16:06,095][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:16:18,161][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:16:29,875][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:16:42,184][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:16:54,032][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:17:09,041][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:17:21,046][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:17:36,513][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:17:48,898][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:17:59,749][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:18:17,186][root][INFO] - Inference complete
[2025-03-06 15:18:17,186][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,192][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,205][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,210][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,210][root][INFO] - Saved parsed outputs
[2025-03-06 15:18:17,210][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,211][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,211][root][INFO] - Saved parsing metadata
[2025-03-06 15:18:17,212][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,214][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:17,215][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:18:17,227][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 15:18:17,227][root][INFO] - Summary of metrics : {'label_accuracy': 0.36, 'misclassification_rate': 0.64, 'combined_accuracy': 0.01, 'malformed_label': 33, 'malformed_domain': 99, 'total_predictions': 100, 'correct_predictions': 36, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.06666666666666667, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.01, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.01, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 35, 'both_wrong': 64}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 15:18:24,116][root][INFO] - Setting global seed to 206
[2025-03-06 15:18:24,123][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 15:18:24,123][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:18:24,124][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:18:24,126][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:18:24,127][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:18:24,128][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:18:24,310][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:18:24,855][root][INFO] - Full model selected, loading model
[2025-03-06 15:18:47,486][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 15:18:47,499][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 15:18:55,936][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:18:55,938][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:18:55,938][root][INFO] - Starting inference
[2025-03-06 15:18:56,141][root][INFO] - Processing question number 0
[2025-03-06 15:18:56,144][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:19:09,441][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:19:26,894][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:19:39,248][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:19:51,828][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:20:02,392][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:20:14,450][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:20:24,347][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:20:34,345][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:20:42,692][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:20:53,255][root][INFO] - Processing question number 10
[2025-03-06 15:20:53,257][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:21:01,321][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:21:09,878][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:21:20,542][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:21:30,528][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:21:42,239][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:21:54,721][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:22:06,604][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:22:19,059][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:22:29,207][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:22:39,620][root][INFO] - Processing question number 20
[2025-03-06 15:22:39,622][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:22:47,759][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:23:01,209][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:23:11,499][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:23:20,689][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:23:31,836][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:23:40,715][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:23:53,978][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:24:04,740][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:24:18,544][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:24:30,498][root][INFO] - Processing question number 30
[2025-03-06 15:24:30,501][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:24:41,818][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:24:51,698][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:25:01,692][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:25:10,900][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:25:23,386][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:25:36,399][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:25:47,087][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:25:57,284][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:26:05,807][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:26:20,976][root][INFO] - Processing question number 40
[2025-03-06 15:26:20,979][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:26:32,900][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:26:42,378][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:26:54,303][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:27:04,439][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:27:18,415][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:27:27,261][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:27:38,413][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:27:51,610][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:28:01,477][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:28:09,521][root][INFO] - Processing question number 50
[2025-03-06 15:28:09,524][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:28:20,006][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:28:32,319][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:28:46,067][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:28:57,130][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:29:11,098][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:29:25,339][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:29:36,723][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:29:51,853][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:30:05,204][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:30:15,587][root][INFO] - Processing question number 60
[2025-03-06 15:30:15,590][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:30:24,994][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:30:40,855][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:30:52,326][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:31:04,079][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:31:16,476][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:31:30,676][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:31:40,292][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:31:51,055][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:32:03,484][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:32:12,238][root][INFO] - Processing question number 70
[2025-03-06 15:32:12,242][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:32:22,598][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:32:31,455][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:32:52,786][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:33:06,168][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:33:14,455][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:33:24,837][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:33:34,767][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:33:50,120][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:33:59,832][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:34:11,681][root][INFO] - Processing question number 80
[2025-03-06 15:34:11,685][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:34:23,498][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:34:31,974][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:34:46,285][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:34:56,828][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:35:08,262][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:35:20,505][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:35:34,075][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:35:47,175][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 15:35:59,169][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 15:36:10,120][root][INFO] - Processing question number 90
[2025-03-06 15:36:10,135][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 15:36:20,162][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 15:36:35,508][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 15:36:43,715][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 15:36:52,546][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 15:37:06,965][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 15:37:19,522][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 15:37:33,040][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 15:37:44,146][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 15:37:55,261][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 15:38:08,546][root][INFO] - Inference complete
[2025-03-06 15:38:08,546][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,553][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,553][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,554][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,555][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,555][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,555][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,555][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,555][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,556][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,556][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,556][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,556][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,556][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,556][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,557][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,557][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,557][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,557][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,557][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,557][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,558][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,558][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,558][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,558][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,558][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,558][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,558][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,558][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,559][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,559][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,559][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,559][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,559][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,559][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,559][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,560][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,560][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,560][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,560][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,560][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,560][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,561][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,561][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,561][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,561][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,561][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,562][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,562][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,562][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,563][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,563][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,563][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,564][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,564][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,564][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,564][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,564][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,564][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,565][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,565][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,565][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,565][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,566][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,566][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,566][root][WARNING] - |Q. 65||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,566][root][WARNING] - |Q. 65||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,566][root][INFO] - |Q. 65||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,566][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,566][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,567][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,567][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,567][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,567][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,567][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,567][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,568][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,568][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,568][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,568][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,569][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,569][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,569][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,569][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,569][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,570][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,570][root][WARNING] - |Q. 80||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,570][root][WARNING] - |Q. 80||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,570][root][INFO] - |Q. 80||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,571][root][WARNING] - |Q. 90||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,571][root][WARNING] - |Q. 90||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,571][root][INFO] - |Q. 90||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,571][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,571][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,571][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,572][root][WARNING] - |Q. 19||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,572][root][WARNING] - |Q. 19||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,572][root][INFO] - |Q. 19||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,572][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,572][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,572][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,573][root][WARNING] - |Q. 47||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,573][root][WARNING] - |Q. 47||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,573][root][INFO] - |Q. 47||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,573][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,573][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,573][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,574][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,574][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,574][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,575][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,575][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,575][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,575][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,575][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,575][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,576][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,576][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,576][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,576][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,576][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,576][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,577][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,577][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,577][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,577][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,578][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,578][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,578][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,578][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,578][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,578][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,579][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,579][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,579][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,579][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,579][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,580][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,580][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,580][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,580][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,580][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,580][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,581][root][WARNING] - |Q. 57||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,581][root][WARNING] - |Q. 57||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,581][root][INFO] - |Q. 57||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,581][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,581][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,582][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,582][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,582][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,582][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,582][root][WARNING] - |Q. 92||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 15:38:08,583][root][WARNING] - |Q. 92||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 15:38:08,583][root][INFO] - |Q. 92||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 15:38:08,584][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,589][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,589][root][INFO] - Saved parsed outputs
[2025-03-06 15:38:08,589][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,590][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,590][root][INFO] - Saved parsing metadata
[2025-03-06 15:38:08,591][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,592][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:38:08,594][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_206/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 15:38:08,613][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 15:38:08,613][root][INFO] - Summary of metrics : {'label_accuracy': 0.48, 'misclassification_rate': 0.52, 'combined_accuracy': 0.0, 'malformed_label': 2, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 48, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 48, 'both_wrong': 52}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_206 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 15:38:14,827][root][INFO] - Setting global seed to 989
[2025-03-06 15:38:14,833][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 15:38:14,833][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 15:38:14,834][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 15:38:14,835][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 15:38:14,837][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 15:38:14,837][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 15:38:14,995][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 15:38:17,029][root][INFO] - Full model selected, loading model
[2025-03-06 15:38:35,185][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 15:40:18,989][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 15:40:18,989][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 15:41:19,913][root][INFO] - Peft model loaded successfully
[2025-03-06 15:41:28,161][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 15:41:28,164][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 15:41:28,164][root][INFO] - Starting inference
[2025-03-06 15:41:28,337][root][INFO] - Processing question number 0
[2025-03-06 15:41:28,339][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 15:41:44,125][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 15:41:57,677][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 15:42:12,806][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 15:42:25,288][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 15:42:36,219][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 15:42:48,210][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 15:43:00,420][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 15:43:13,800][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 15:43:21,795][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 15:43:33,326][root][INFO] - Processing question number 10
[2025-03-06 15:43:33,328][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 15:43:44,401][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 15:43:57,903][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 15:44:10,649][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 15:44:18,721][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 15:44:33,702][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 15:44:44,394][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 15:44:57,050][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 15:45:10,694][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 15:45:21,723][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 15:45:35,464][root][INFO] - Processing question number 20
[2025-03-06 15:45:35,466][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 15:45:45,317][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 15:45:57,774][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 15:46:07,238][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 15:46:15,126][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 15:46:27,650][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 15:46:39,951][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 15:46:52,816][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 15:47:06,460][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 15:47:19,650][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 15:47:35,394][root][INFO] - Processing question number 30
[2025-03-06 15:47:35,396][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 15:47:45,744][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 15:47:57,632][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 15:48:10,224][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 15:48:22,808][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 15:48:35,782][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 15:48:49,131][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 15:49:03,293][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 15:49:16,486][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 15:49:26,036][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 15:49:41,068][root][INFO] - Processing question number 40
[2025-03-06 15:49:41,071][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 15:49:53,384][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 15:50:03,417][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 15:50:17,395][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 15:50:25,485][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 15:50:44,749][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 15:50:55,550][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 15:51:07,665][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 15:51:18,746][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 15:51:31,473][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 15:51:43,314][root][INFO] - Processing question number 50
[2025-03-06 15:51:43,318][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 15:51:55,249][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 15:52:09,851][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 15:52:24,140][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 15:52:38,045][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 15:52:52,061][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 15:53:02,829][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 15:53:16,555][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 15:53:29,099][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 15:53:42,230][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 15:53:52,478][root][INFO] - Processing question number 60
[2025-03-06 15:53:52,482][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 15:54:04,774][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 15:54:17,536][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 15:54:31,173][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 15:54:43,628][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 15:54:55,129][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 15:55:08,246][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 15:55:19,215][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 15:55:28,890][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 15:55:43,032][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 15:55:54,424][root][INFO] - Processing question number 70
[2025-03-06 15:55:54,449][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 15:56:07,546][root][INFO] - Domain : Property, Question : 9
[2025-03-06 15:56:20,831][root][INFO] - Domain : Property, Question : 17
[2025-03-06 15:56:33,868][root][INFO] - Domain : Property, Question : 25
[2025-03-06 15:56:50,949][root][INFO] - Domain : Property, Question : 30
[2025-03-06 15:57:00,797][root][INFO] - Domain : Property, Question : 36
[2025-03-06 15:57:16,009][root][INFO] - Domain : Property, Question : 46
[2025-03-06 15:57:32,513][root][INFO] - Domain : Property, Question : 53
[2025-03-06 15:57:45,337][root][INFO] - Domain : Property, Question : 59
[2025-03-06 15:57:56,124][root][INFO] - Domain : Property, Question : 66
[2025-03-06 15:58:06,659][root][INFO] - Processing question number 80
[2025-03-06 15:58:06,663][root][INFO] - Domain : Property, Question : 69
[2025-03-06 15:58:18,456][root][INFO] - Domain : Property, Question : 81
[2025-03-06 15:58:33,975][root][INFO] - Domain : Property, Question : 88
[2025-03-06 15:58:49,168][root][INFO] - Domain : Property, Question : 91
[2025-03-06 15:58:59,751][root][INFO] - Domain : Property, Question : 94
[2025-03-06 15:59:15,985][root][INFO] - Domain : Property, Question : 100
[2025-03-06 15:59:28,546][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 15:59:41,437][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 15:59:55,136][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:00:08,388][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:00:19,112][root][INFO] - Processing question number 90
[2025-03-06 16:00:19,117][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:00:32,618][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:00:46,649][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:00:59,838][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:01:09,740][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:01:24,703][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:01:39,536][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:01:52,291][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:02:02,701][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:02:13,897][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:02:28,661][root][INFO] - Inference complete
[2025-03-06 16:02:28,661][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,668][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,680][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,685][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,685][root][INFO] - Saved parsed outputs
[2025-03-06 16:02:28,685][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,687][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,687][root][INFO] - Saved parsing metadata
[2025-03-06 16:02:28,689][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,690][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:02:28,691][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:02:28,755][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 16:02:28,755][root][INFO] - Summary of metrics : {'label_accuracy': 0.39, 'misclassification_rate': 0.61, 'combined_accuracy': 0.0, 'malformed_label': 28, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 39, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 39, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 16:02:38,539][root][INFO] - Setting global seed to 989
[2025-03-06 16:02:38,547][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 16:02:38,547][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:02:38,548][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:02:38,550][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:02:38,555][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:02:38,555][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:02:38,761][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:02:39,340][root][INFO] - Full model selected, loading model
[2025-03-06 16:03:03,861][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:03:03,861][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:03:11,598][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:03:11,601][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:03:11,601][root][INFO] - Starting inference
[2025-03-06 16:03:11,764][root][INFO] - Processing question number 0
[2025-03-06 16:03:11,781][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:03:27,852][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:03:40,948][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:03:53,672][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:04:05,105][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:04:14,281][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:04:24,033][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:04:37,094][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:04:47,415][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:04:56,900][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:05:08,941][root][INFO] - Processing question number 10
[2025-03-06 16:05:08,943][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:05:19,599][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:05:33,257][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:05:45,125][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:05:56,059][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:06:08,417][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:06:19,386][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:06:31,812][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:06:42,163][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:06:53,142][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:07:03,794][root][INFO] - Processing question number 20
[2025-03-06 16:07:03,797][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:07:11,825][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:07:21,295][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:07:31,535][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:07:38,082][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:07:48,513][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:07:59,307][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:08:08,231][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:08:18,281][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:08:28,771][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:08:39,788][root][INFO] - Processing question number 30
[2025-03-06 16:08:39,790][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:08:52,002][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:09:02,714][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:09:15,306][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:09:26,487][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:09:42,902][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:09:53,406][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:10:03,521][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:10:13,986][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:10:23,802][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:10:36,769][root][INFO] - Processing question number 40
[2025-03-06 16:10:36,772][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:10:46,721][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:10:58,272][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:11:10,371][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:11:18,125][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:11:37,718][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:11:46,930][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:11:56,494][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:12:11,833][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:12:24,543][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:12:35,295][root][INFO] - Processing question number 50
[2025-03-06 16:12:35,298][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:12:47,935][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:13:00,218][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:13:12,278][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:13:22,532][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:13:32,953][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:13:44,729][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:13:59,376][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:14:09,211][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:14:22,868][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:14:32,730][root][INFO] - Processing question number 60
[2025-03-06 16:14:32,733][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:14:40,941][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:14:56,126][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:15:08,869][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:15:22,038][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:15:32,032][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:15:46,942][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:15:55,731][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:16:09,386][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:16:20,396][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:16:30,749][root][INFO] - Processing question number 70
[2025-03-06 16:16:30,753][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:16:41,852][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:16:54,715][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:17:14,028][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:17:25,713][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:17:33,539][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:17:45,358][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:17:59,305][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:18:10,033][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:18:21,561][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:18:31,631][root][INFO] - Processing question number 80
[2025-03-06 16:18:31,635][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:18:43,902][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:18:53,173][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:19:07,076][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:19:18,960][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:19:31,435][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:19:43,423][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:19:56,444][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:20:08,945][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:20:22,465][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:20:32,280][root][INFO] - Processing question number 90
[2025-03-06 16:20:32,285][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:20:43,429][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:20:57,640][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:21:09,731][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:21:18,883][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:21:31,745][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:21:42,862][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:21:55,438][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:22:07,960][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:22:17,251][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:22:27,956][root][INFO] - Inference complete
[2025-03-06 16:22:27,956][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:27,963][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:27,964][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,964][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,965][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,965][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,965][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,965][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,966][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,966][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,966][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,966][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,966][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,966][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,967][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,967][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,967][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,967][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,967][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,967][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,968][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,968][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,968][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,968][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,968][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,968][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,968][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,969][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,969][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,969][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,969][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,969][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,969][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,970][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,970][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,970][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,970][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,970][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,970][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,971][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,971][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,971][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,971][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,971][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,971][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,972][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,972][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,972][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,972][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,972][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,972][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,973][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,973][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,973][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,974][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,974][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,974][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,975][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,975][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,975][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,975][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,975][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,976][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,976][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,976][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,976][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,976][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,976][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,977][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,977][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,977][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,977][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,977][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,978][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,978][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,978][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,978][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,978][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,978][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,979][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,979][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,979][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,979][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,979][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,980][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,980][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,980][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,980][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,980][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,980][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,981][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,981][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,981][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,981][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,981][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,983][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,983][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,983][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,984][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,984][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,984][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,984][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,984][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,984][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,985][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,985][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,985][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,985][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,985][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,985][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,986][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,986][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,986][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,986][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,986][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,986][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,986][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,987][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,987][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,987][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,987][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,987][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,988][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,988][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,988][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,988][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,988][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,988][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,989][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,989][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,989][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,989][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,989][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,989][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,989][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,990][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,990][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,990][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,990][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,990][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,991][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,991][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,991][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,991][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,992][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,992][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,992][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 16:22:27,992][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:22:27,992][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 16:22:27,994][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:27,998][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:27,998][root][INFO] - Saved parsed outputs
[2025-03-06 16:22:27,999][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:28,000][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:28,000][root][INFO] - Saved parsing metadata
[2025-03-06 16:22:28,001][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:28,003][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:22:28,004][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/greedy/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:22:28,010][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 16:22:28,010][root][INFO] - Summary of metrics : {'label_accuracy': 0.46, 'misclassification_rate': 0.54, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 46, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 46, 'both_wrong': 54}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 16:22:34,362][root][INFO] - Setting global seed to 989
[2025-03-06 16:22:34,367][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 16:22:34,367][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:22:34,369][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:22:34,370][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:22:34,372][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:22:34,372][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:22:34,517][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:22:35,565][root][INFO] - Full model selected, loading model
[2025-03-06 16:22:52,813][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 16:24:37,423][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 16:24:37,454][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 16:25:15,253][root][INFO] - Peft model loaded successfully
[2025-03-06 16:25:22,747][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:25:22,750][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:25:22,750][root][INFO] - Starting inference
[2025-03-06 16:25:22,932][root][INFO] - Processing question number 0
[2025-03-06 16:25:22,934][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:25:38,852][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:25:52,212][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:26:08,099][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:26:19,873][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:26:31,289][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:26:43,270][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:26:54,539][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:27:06,952][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:27:14,928][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:27:27,465][root][INFO] - Processing question number 10
[2025-03-06 16:27:27,466][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:27:38,784][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:27:51,344][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:28:05,070][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:28:14,310][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:28:27,686][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:28:37,352][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:28:50,233][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:29:03,448][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:29:14,526][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:29:28,172][root][INFO] - Processing question number 20
[2025-03-06 16:29:28,174][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:29:38,166][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:29:49,987][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:29:59,358][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:30:07,030][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:30:17,804][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:30:27,340][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:30:40,732][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:30:56,707][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:31:09,275][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:31:23,203][root][INFO] - Processing question number 30
[2025-03-06 16:31:23,206][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:31:33,979][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:31:47,497][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:31:59,319][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:32:12,263][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:32:25,606][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:32:40,801][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:32:54,261][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:33:07,338][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:33:19,134][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:33:29,910][root][INFO] - Processing question number 40
[2025-03-06 16:33:29,913][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:33:42,364][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:33:54,962][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:34:08,228][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:34:16,479][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:34:37,723][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:34:48,764][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:35:01,185][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:35:14,626][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:35:28,022][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:35:38,358][root][INFO] - Processing question number 50
[2025-03-06 16:35:38,361][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:35:50,878][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:36:02,407][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:36:19,054][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:36:34,776][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:36:46,601][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:37:00,099][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:37:13,389][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:37:29,299][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:37:41,720][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:37:52,625][root][INFO] - Processing question number 60
[2025-03-06 16:37:52,628][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:38:05,560][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:38:19,474][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:38:34,798][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:38:47,244][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:38:59,987][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 16:39:13,732][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 16:39:24,472][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 16:39:35,426][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 16:39:51,091][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 16:40:02,856][root][INFO] - Processing question number 70
[2025-03-06 16:40:02,860][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 16:40:16,909][root][INFO] - Domain : Property, Question : 9
[2025-03-06 16:40:32,127][root][INFO] - Domain : Property, Question : 17
[2025-03-06 16:40:45,217][root][INFO] - Domain : Property, Question : 25
[2025-03-06 16:41:01,797][root][INFO] - Domain : Property, Question : 30
[2025-03-06 16:41:13,495][root][INFO] - Domain : Property, Question : 36
[2025-03-06 16:41:26,762][root][INFO] - Domain : Property, Question : 46
[2025-03-06 16:41:44,466][root][INFO] - Domain : Property, Question : 53
[2025-03-06 16:41:57,435][root][INFO] - Domain : Property, Question : 59
[2025-03-06 16:42:06,455][root][INFO] - Domain : Property, Question : 66
[2025-03-06 16:42:17,326][root][INFO] - Processing question number 80
[2025-03-06 16:42:17,330][root][INFO] - Domain : Property, Question : 69
[2025-03-06 16:42:34,422][root][INFO] - Domain : Property, Question : 81
[2025-03-06 16:42:48,015][root][INFO] - Domain : Property, Question : 88
[2025-03-06 16:43:03,206][root][INFO] - Domain : Property, Question : 91
[2025-03-06 16:43:14,552][root][INFO] - Domain : Property, Question : 94
[2025-03-06 16:43:33,797][root][INFO] - Domain : Property, Question : 100
[2025-03-06 16:43:48,265][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 16:44:03,537][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 16:44:19,050][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 16:44:33,038][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 16:44:43,755][root][INFO] - Processing question number 90
[2025-03-06 16:44:43,760][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 16:44:57,950][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 16:45:12,203][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 16:45:25,220][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 16:45:36,819][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 16:45:52,272][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 16:46:05,942][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 16:46:21,920][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 16:46:34,241][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 16:46:45,062][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 16:47:01,249][root][INFO] - Inference complete
[2025-03-06 16:47:01,250][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,256][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,262][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 16:47:01,263][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 16:47:01,263][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 16:47:01,270][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,274][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,274][root][INFO] - Saved parsed outputs
[2025-03-06 16:47:01,274][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,276][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,276][root][INFO] - Saved parsing metadata
[2025-03-06 16:47:01,277][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,278][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:01,279][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 16:47:01,292][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 16:47:01,292][root][INFO] - Summary of metrics : {'label_accuracy': 0.37, 'misclassification_rate': 0.63, 'combined_accuracy': 0.0, 'malformed_label': 28, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 37, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 37, 'both_wrong': 63}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 16:47:10,567][root][INFO] - Setting global seed to 989
[2025-03-06 16:47:10,574][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 16:47:10,574][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 16:47:10,576][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 16:47:10,578][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 16:47:10,580][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 16:47:10,580][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 16:47:10,754][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 16:47:11,384][root][INFO] - Full model selected, loading model
[2025-03-06 16:47:38,762][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 16:47:38,773][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 16:47:46,909][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 16:47:46,912][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 16:47:46,912][root][INFO] - Starting inference
[2025-03-06 16:47:47,075][root][INFO] - Processing question number 0
[2025-03-06 16:47:47,077][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 16:48:00,757][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 16:48:11,736][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 16:48:26,446][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 16:48:36,593][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 16:48:45,045][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 16:48:55,283][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 16:49:07,644][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 16:49:19,738][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 16:49:34,715][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 16:49:45,600][root][INFO] - Processing question number 10
[2025-03-06 16:49:45,602][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 16:49:54,521][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 16:50:05,434][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 16:50:13,393][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 16:50:25,076][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 16:50:39,296][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 16:50:49,052][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 16:50:58,821][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 16:51:09,029][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 16:51:18,501][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 16:51:31,331][root][INFO] - Processing question number 20
[2025-03-06 16:51:31,333][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 16:51:40,443][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 16:51:49,287][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 16:52:00,223][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 16:52:09,412][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 16:52:19,710][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 16:52:30,311][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 16:52:39,499][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 16:52:50,770][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 16:53:01,029][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 16:53:13,231][root][INFO] - Processing question number 30
[2025-03-06 16:53:13,233][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 16:53:24,093][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 16:53:34,114][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 16:53:45,315][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 16:53:55,791][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 16:54:05,228][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 16:54:14,852][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 16:54:24,832][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 16:54:38,335][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 16:54:48,994][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 16:55:04,264][root][INFO] - Processing question number 40
[2025-03-06 16:55:04,267][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 16:55:15,957][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 16:55:26,023][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 16:55:38,700][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 16:55:48,270][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 16:56:05,441][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 16:56:15,958][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 16:56:24,965][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 16:56:36,365][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 16:56:50,420][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 16:56:59,998][root][INFO] - Processing question number 50
[2025-03-06 16:57:00,001][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 16:57:10,852][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 16:57:23,815][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 16:57:35,700][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 16:57:47,133][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 16:57:58,353][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 16:58:10,806][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 16:58:24,332][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 16:58:36,330][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 16:58:49,020][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 16:58:58,036][root][INFO] - Processing question number 60
[2025-03-06 16:58:58,039][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 16:59:08,842][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 16:59:21,661][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 16:59:34,517][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 16:59:44,359][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 16:59:54,349][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:00:05,564][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:00:13,384][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:00:23,912][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:00:33,776][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:00:46,794][root][INFO] - Processing question number 70
[2025-03-06 17:00:46,797][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:00:56,774][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:01:07,398][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:01:23,169][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:01:35,633][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:01:44,044][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:01:54,180][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:02:07,528][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:02:21,114][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:02:30,910][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:02:41,308][root][INFO] - Processing question number 80
[2025-03-06 17:02:41,312][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:02:55,362][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:03:04,909][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:03:15,360][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:03:25,799][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:03:37,663][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:03:49,387][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:04:02,869][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:04:15,356][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:04:27,393][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:04:39,372][root][INFO] - Processing question number 90
[2025-03-06 17:04:39,377][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:04:48,841][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:05:00,778][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:05:11,137][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:05:19,822][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:05:31,747][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:05:44,498][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:05:59,261][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:06:11,016][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:06:22,600][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:06:31,902][root][INFO] - Inference complete
[2025-03-06 17:06:31,902][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,908][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,909][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,910][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,910][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,911][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,911][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,911][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,911][root][WARNING] - |Q. 13||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,911][root][WARNING] - |Q. 13||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,911][root][INFO] - |Q. 13||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,912][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,912][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,912][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,912][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,912][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,912][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,913][root][WARNING] - |Q. 35||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,913][root][WARNING] - |Q. 35||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,913][root][INFO] - |Q. 35||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,913][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,913][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,913][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,914][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,914][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,914][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,914][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,914][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,914][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,915][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,915][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,915][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,915][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,915][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,915][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,915][root][WARNING] - |Q. 78||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,916][root][WARNING] - |Q. 78||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,916][root][INFO] - |Q. 78||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,916][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,916][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,916][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,916][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,917][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,917][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,917][root][WARNING] - |Q. 21||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,917][root][WARNING] - |Q. 21||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,917][root][INFO] - |Q. 21||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,918][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,918][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,918][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,919][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,919][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,919][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,919][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,919][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,920][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,920][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,920][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,920][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,920][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,920][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,921][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,921][root][WARNING] - |Q. 42||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,921][root][WARNING] - |Q. 42||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,921][root][INFO] - |Q. 42||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,922][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,922][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,922][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,922][root][WARNING] - |Q. 58||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,922][root][WARNING] - |Q. 58||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,922][root][INFO] - |Q. 58||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,923][root][WARNING] - |Q. 72||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,923][root][WARNING] - |Q. 72||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,923][root][INFO] - |Q. 72||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,923][root][WARNING] - |Q. 84||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,923][root][WARNING] - |Q. 84||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,923][root][INFO] - |Q. 84||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,924][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,924][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,924][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,925][root][WARNING] - |Q. 38||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,925][root][WARNING] - |Q. 38||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,925][root][INFO] - |Q. 38||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,925][root][WARNING] - |Q. 51||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,925][root][WARNING] - |Q. 51||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,926][root][INFO] - |Q. 51||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,926][root][WARNING] - |Q. 85||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,926][root][WARNING] - |Q. 85||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,926][root][INFO] - |Q. 85||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,927][root][WARNING] - |Q. 5||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,927][root][WARNING] - |Q. 5||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,927][root][INFO] - |Q. 5||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,927][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,927][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,927][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,928][root][WARNING] - |Q. 26||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,928][root][WARNING] - |Q. 26||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,928][root][INFO] - |Q. 26||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,929][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,929][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,929][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,929][root][WARNING] - |Q. 93||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,929][root][WARNING] - |Q. 93||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,930][root][INFO] - |Q. 93||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,930][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,930][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,930][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,930][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,931][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,931][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,931][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,931][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,931][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,931][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,931][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,931][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,932][root][WARNING] - |Q. 46||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,932][root][WARNING] - |Q. 46||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,932][root][INFO] - |Q. 46||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,932][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,932][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,932][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,933][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,933][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,933][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,933][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,934][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,934][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,934][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,934][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,934][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,934][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,934][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,935][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,935][root][WARNING] - |Q. 11||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,935][root][WARNING] - |Q. 11||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,935][root][INFO] - |Q. 11||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,935][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,936][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,936][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,936][root][WARNING] - |Q. 67||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,937][root][WARNING] - |Q. 67||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,937][root][INFO] - |Q. 67||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,937][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:06:31,937][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:06:31,937][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:06:31,939][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,943][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,943][root][INFO] - Saved parsed outputs
[2025-03-06 17:06:31,943][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,945][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,945][root][INFO] - Saved parsing metadata
[2025-03-06 17:06:31,945][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,964][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:06:31,965][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_025/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:06:32,054][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 17:06:32,054][root][INFO] - Summary of metrics : {'label_accuracy': 0.47, 'misclassification_rate': 0.53, 'combined_accuracy': 0.0, 'malformed_label': 0, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 47, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 47, 'both_wrong': 53}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_025 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 17:06:51,417][root][INFO] - Setting global seed to 989
[2025-03-06 17:06:51,473][root][INFO] - Running evaluation of the trained model on the test_set_2
[2025-03-06 17:06:51,473][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:06:51,474][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:06:51,476][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:06:51,481][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:06:51,481][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:06:51,651][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:06:52,255][root][INFO] - Full model selected, loading model
[2025-03-06 17:07:18,473][root][INFO] - Tokenizer special tokens: {'bos_token': '<|begin_of_text|>', 'eos_token': '<|end_of_text|>', 'pad_token': '[PAD]'} have been added
[2025-03-06 17:09:02,757][root][INFO] - Fine-tuned model selected, loading adapter
[2025-03-06 17:09:02,757][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-03-06 17:09:42,004][root][INFO] - Peft model loaded successfully
[2025-03-06 17:09:49,584][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:09:49,585][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:09:49,585][root][INFO] - Starting inference
[2025-03-06 17:09:49,760][root][INFO] - Processing question number 0
[2025-03-06 17:09:49,762][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:10:04,011][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:10:14,741][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:10:28,110][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:10:42,674][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:10:54,706][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:11:05,991][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:11:18,955][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:11:31,448][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:11:39,745][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:11:50,599][root][INFO] - Processing question number 10
[2025-03-06 17:11:50,600][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:12:00,038][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:12:12,324][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:12:26,350][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:12:35,696][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:12:50,167][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:13:00,351][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:13:12,518][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:13:22,644][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:13:32,782][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:13:45,144][root][INFO] - Processing question number 20
[2025-03-06 17:13:45,146][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:13:56,387][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:14:07,741][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:14:18,173][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:14:26,350][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:14:38,951][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:14:49,817][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:15:02,301][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:15:16,565][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:15:27,568][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:15:41,812][root][INFO] - Processing question number 30
[2025-03-06 17:15:41,815][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:15:54,759][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:16:06,203][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:16:20,869][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:16:35,438][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:16:45,822][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:17:00,360][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:17:15,292][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:17:32,133][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:17:43,464][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:17:57,461][root][INFO] - Processing question number 40
[2025-03-06 17:17:57,464][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:18:12,330][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:18:24,657][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:18:37,685][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:18:46,994][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:19:07,604][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:19:18,599][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:19:30,645][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:19:42,770][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:19:53,627][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:20:09,642][root][INFO] - Processing question number 50
[2025-03-06 17:20:09,645][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:20:25,782][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:20:38,522][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:20:54,886][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:21:07,942][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:21:19,958][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:21:32,987][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:21:47,193][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:22:00,012][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:22:13,674][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:22:26,941][root][INFO] - Processing question number 60
[2025-03-06 17:22:26,944][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:22:38,136][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:22:51,910][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:23:06,270][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:23:18,196][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:23:30,423][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:23:42,800][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:23:54,193][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:24:05,840][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:24:14,699][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:24:27,032][root][INFO] - Processing question number 70
[2025-03-06 17:24:27,036][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:24:43,925][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:24:57,291][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:25:13,982][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:25:29,788][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:25:41,068][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:25:55,624][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:26:11,263][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:26:28,228][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:26:38,675][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:26:50,585][root][INFO] - Processing question number 80
[2025-03-06 17:26:50,590][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:27:04,937][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:27:17,663][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:27:35,866][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:27:47,682][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:27:58,981][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:28:11,322][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:28:24,515][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:28:39,824][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:28:57,934][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:29:10,767][root][INFO] - Processing question number 90
[2025-03-06 17:29:10,772][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:29:22,264][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:29:38,349][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:29:51,341][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:30:01,276][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:30:15,030][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:30:29,793][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:30:45,204][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:30:57,163][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:31:07,735][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:31:23,542][root][INFO] - Inference complete
[2025-03-06 17:31:23,542][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,548][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,554][root][WARNING] - |Q. 43||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:23,554][root][WARNING] - |Q. 43||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:31:23,555][root][INFO] - |Q. 43||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:23,559][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:31:23,559][root][WARNING] - |Q. 88||D: Property| Successfully fixed invalid JSON. Not all fields may be present.
[2025-03-06 17:31:23,559][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:31:23,562][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,567][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,567][root][INFO] - Saved parsed outputs
[2025-03-06 17:31:23,567][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,568][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,569][root][INFO] - Saved parsing metadata
[2025-03-06 17:31:23,569][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,571][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:31:23,573][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/trained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:31:23,654][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 17:31:23,654][root][INFO] - Summary of metrics : {'label_accuracy': 0.38, 'misclassification_rate': 0.62, 'combined_accuracy': 0.01, 'malformed_label': 25, 'malformed_domain': 98, 'total_predictions': 100, 'correct_predictions': 38, 'correct_label_and_domain': 1, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.07142857142857142, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.01, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.01, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 1, 'correct_label_wrong_domain': 37, 'both_wrong': 61}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Running evaluation with config: seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'running']
Updating eval for job 6 to status running with exit code None
Eval status update completed for job 6
[2025-03-06 17:31:41,929][root][INFO] - Setting global seed to 989
[2025-03-06 17:31:41,937][root][INFO] - Running evaluation of the untrained model on the test_set_2
[2025-03-06 17:31:41,938][root][INFO] - Current evaluation config is : 
 Prompt type : zero_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-03-06 17:31:41,939][root][INFO] - Loading dataset from /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/dataset/test_sets/bar_set_2.json
[2025-03-06 17:31:41,940][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-03-06 17:31:41,956][root][INFO] - Indexing complete, sampling of questions set to False
[2025-03-06 17:31:41,957][root][INFO] - Questions selected, dataset contains 100 questions with 14.285714285714286 questions per domain
[2025-03-06 17:31:42,105][root][INFO] - Loading model : meta-llama/Llama-3.1-8B-Instruct
[2025-03-06 17:31:42,975][root][INFO] - Full model selected, loading model
[2025-03-06 17:32:12,308][root][INFO] - Baseline model selected, no adapter needed
[2025-03-06 17:32:12,322][root][WARNING] - Inference will be done using hf pipeline since model.generate consistently generates gibberish
[2025-03-06 17:32:20,956][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'zero_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-03-06 17:32:20,957][root][INFO] - Raw output for this run will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:32:20,957][root][INFO] - Starting inference
[2025-03-06 17:32:21,395][root][INFO] - Processing question number 0
[2025-03-06 17:32:21,397][root][INFO] - Domain : Constitutional_law, Question : 1
[2025-03-06 17:32:34,554][root][INFO] - Domain : Constitutional_law, Question : 6
[2025-03-06 17:32:55,478][root][INFO] - Domain : Constitutional_law, Question : 13
[2025-03-06 17:33:14,895][root][INFO] - Domain : Constitutional_law, Question : 20
[2025-03-06 17:33:26,357][root][INFO] - Domain : Constitutional_law, Question : 27
[2025-03-06 17:33:37,642][root][INFO] - Domain : Constitutional_law, Question : 35
[2025-03-06 17:33:45,993][root][INFO] - Domain : Constitutional_law, Question : 41
[2025-03-06 17:33:56,840][root][INFO] - Domain : Constitutional_law, Question : 49
[2025-03-06 17:34:07,887][root][INFO] - Domain : Constitutional_law, Question : 56
[2025-03-06 17:34:15,701][root][INFO] - Domain : Constitutional_law, Question : 62
[2025-03-06 17:34:26,471][root][INFO] - Processing question number 10
[2025-03-06 17:34:26,473][root][INFO] - Domain : Constitutional_law, Question : 70
[2025-03-06 17:34:37,624][root][INFO] - Domain : Constitutional_law, Question : 78
[2025-03-06 17:34:51,946][root][INFO] - Domain : Constitutional_law, Question : 86
[2025-03-06 17:35:02,165][root][INFO] - Domain : Constitutional_law, Question : 99
[2025-03-06 17:35:10,106][root][INFO] - Domain : Criminal_law, Question : 2
[2025-03-06 17:35:23,403][root][INFO] - Domain : Criminal_law, Question : 8
[2025-03-06 17:35:34,264][root][INFO] - Domain : Criminal_law, Question : 15
[2025-03-06 17:35:42,168][root][INFO] - Domain : Criminal_law, Question : 21
[2025-03-06 17:35:55,402][root][INFO] - Domain : Criminal_law, Question : 29
[2025-03-06 17:36:06,979][root][INFO] - Domain : Criminal_law, Question : 37
[2025-03-06 17:36:18,888][root][INFO] - Processing question number 20
[2025-03-06 17:36:18,890][root][INFO] - Domain : Criminal_law, Question : 44
[2025-03-06 17:36:25,758][root][INFO] - Domain : Criminal_law, Question : 55
[2025-03-06 17:36:35,313][root][INFO] - Domain : Criminal_law, Question : 64
[2025-03-06 17:36:46,461][root][INFO] - Domain : Criminal_law, Question : 71
[2025-03-06 17:36:59,830][root][INFO] - Domain : Criminal_law, Question : 76
[2025-03-06 17:37:11,135][root][INFO] - Domain : Criminal_law, Question : 83
[2025-03-06 17:37:21,674][root][INFO] - Domain : Criminal_law, Question : 89
[2025-03-06 17:37:30,154][root][INFO] - Domain : Criminal_law, Question : 96
[2025-03-06 17:37:40,983][root][INFO] - Domain : Contracts, Question : 3
[2025-03-06 17:37:52,020][root][INFO] - Domain : Contracts, Question : 7
[2025-03-06 17:38:02,597][root][INFO] - Processing question number 30
[2025-03-06 17:38:02,600][root][INFO] - Domain : Contracts, Question : 14
[2025-03-06 17:38:13,207][root][INFO] - Domain : Contracts, Question : 24
[2025-03-06 17:38:23,300][root][INFO] - Domain : Contracts, Question : 28
[2025-03-06 17:38:32,807][root][INFO] - Domain : Contracts, Question : 34
[2025-03-06 17:38:44,070][root][INFO] - Domain : Contracts, Question : 42
[2025-03-06 17:38:57,094][root][INFO] - Domain : Contracts, Question : 48
[2025-03-06 17:39:09,283][root][INFO] - Domain : Contracts, Question : 58
[2025-03-06 17:39:20,551][root][INFO] - Domain : Contracts, Question : 65
[2025-03-06 17:39:30,765][root][INFO] - Domain : Contracts, Question : 72
[2025-03-06 17:39:39,101][root][INFO] - Domain : Contracts, Question : 77
[2025-03-06 17:39:50,466][root][INFO] - Processing question number 40
[2025-03-06 17:39:50,469][root][INFO] - Domain : Contracts, Question : 84
[2025-03-06 17:40:01,007][root][INFO] - Domain : Contracts, Question : 87
[2025-03-06 17:40:10,822][root][INFO] - Domain : Contracts, Question : 97
[2025-03-06 17:40:22,512][root][INFO] - Domain : Evidence, Question : 4
[2025-03-06 17:40:32,752][root][INFO] - Domain : Evidence, Question : 10
[2025-03-06 17:40:48,742][root][INFO] - Domain : Evidence, Question : 16
[2025-03-06 17:40:57,525][root][INFO] - Domain : Evidence, Question : 23
[2025-03-06 17:41:08,079][root][INFO] - Domain : Evidence, Question : 31
[2025-03-06 17:41:30,867][root][INFO] - Domain : Evidence, Question : 38
[2025-03-06 17:41:44,138][root][INFO] - Domain : Evidence, Question : 43
[2025-03-06 17:41:55,904][root][INFO] - Processing question number 50
[2025-03-06 17:41:55,907][root][INFO] - Domain : Evidence, Question : 50
[2025-03-06 17:42:10,852][root][INFO] - Domain : Evidence, Question : 51
[2025-03-06 17:42:20,971][root][INFO] - Domain : Evidence, Question : 60
[2025-03-06 17:42:33,731][root][INFO] - Domain : Evidence, Question : 73
[2025-03-06 17:42:46,607][root][INFO] - Domain : Evidence, Question : 80
[2025-03-06 17:42:56,100][root][INFO] - Domain : Evidence, Question : 85
[2025-03-06 17:43:06,663][root][INFO] - Domain : Evidence, Question : 90
[2025-03-06 17:43:18,070][root][INFO] - Domain : Evidence, Question : 98
[2025-03-06 17:43:32,750][root][INFO] - Domain : Civil_procedure, Question : 5
[2025-03-06 17:43:41,002][root][INFO] - Domain : Civil_procedure, Question : 12
[2025-03-06 17:43:51,706][root][INFO] - Processing question number 60
[2025-03-06 17:43:51,710][root][INFO] - Domain : Civil_procedure, Question : 19
[2025-03-06 17:44:02,072][root][INFO] - Domain : Civil_procedure, Question : 26
[2025-03-06 17:44:12,687][root][INFO] - Domain : Civil_procedure, Question : 33
[2025-03-06 17:44:27,064][root][INFO] - Domain : Civil_procedure, Question : 40
[2025-03-06 17:44:39,956][root][INFO] - Domain : Civil_procedure, Question : 47
[2025-03-06 17:44:52,105][root][INFO] - Domain : Civil_procedure, Question : 54
[2025-03-06 17:45:03,937][root][INFO] - Domain : Civil_procedure, Question : 61
[2025-03-06 17:45:14,589][root][INFO] - Domain : Civil_procedure, Question : 68
[2025-03-06 17:45:25,094][root][INFO] - Domain : Civil_procedure, Question : 75
[2025-03-06 17:45:33,467][root][INFO] - Domain : Civil_procedure, Question : 82
[2025-03-06 17:45:44,594][root][INFO] - Processing question number 70
[2025-03-06 17:45:44,598][root][INFO] - Domain : Civil_procedure, Question : 93
[2025-03-06 17:45:56,909][root][INFO] - Domain : Property, Question : 9
[2025-03-06 17:46:09,530][root][INFO] - Domain : Property, Question : 17
[2025-03-06 17:46:22,159][root][INFO] - Domain : Property, Question : 25
[2025-03-06 17:46:37,439][root][INFO] - Domain : Property, Question : 30
[2025-03-06 17:46:47,624][root][INFO] - Domain : Property, Question : 36
[2025-03-06 17:46:57,830][root][INFO] - Domain : Property, Question : 46
[2025-03-06 17:47:11,151][root][INFO] - Domain : Property, Question : 53
[2025-03-06 17:47:23,606][root][INFO] - Domain : Property, Question : 59
[2025-03-06 17:47:35,217][root][INFO] - Domain : Property, Question : 66
[2025-03-06 17:47:45,035][root][INFO] - Processing question number 80
[2025-03-06 17:47:45,039][root][INFO] - Domain : Property, Question : 69
[2025-03-06 17:47:56,256][root][INFO] - Domain : Property, Question : 81
[2025-03-06 17:48:06,816][root][INFO] - Domain : Property, Question : 88
[2025-03-06 17:48:19,037][root][INFO] - Domain : Property, Question : 91
[2025-03-06 17:48:29,403][root][INFO] - Domain : Property, Question : 94
[2025-03-06 17:48:44,718][root][INFO] - Domain : Property, Question : 100
[2025-03-06 17:48:56,085][root][INFO] - Domain : Torts, Question : 11
[2025-03-06 17:49:09,722][root][INFO] - Domain : Torts, Question : 18
[2025-03-06 17:49:21,781][root][INFO] - Domain : Torts, Question : 22
[2025-03-06 17:49:32,660][root][INFO] - Domain : Torts, Question : 32
[2025-03-06 17:49:47,533][root][INFO] - Processing question number 90
[2025-03-06 17:49:47,537][root][INFO] - Domain : Torts, Question : 39
[2025-03-06 17:49:59,648][root][INFO] - Domain : Torts, Question : 45
[2025-03-06 17:50:09,568][root][INFO] - Domain : Torts, Question : 52
[2025-03-06 17:50:19,382][root][INFO] - Domain : Torts, Question : 57
[2025-03-06 17:50:27,716][root][INFO] - Domain : Torts, Question : 63
[2025-03-06 17:50:41,769][root][INFO] - Domain : Torts, Question : 67
[2025-03-06 17:50:52,585][root][INFO] - Domain : Torts, Question : 74
[2025-03-06 17:51:03,953][root][INFO] - Domain : Torts, Question : 79
[2025-03-06 17:51:14,651][root][INFO] - Domain : Torts, Question : 92
[2025-03-06 17:51:28,240][root][INFO] - Domain : Torts, Question : 95
[2025-03-06 17:51:38,930][root][INFO] - Inference complete
[2025-03-06 17:51:38,930][root][INFO] - Saving raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,936][root][INFO] - Starting parsing of raw outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,937][root][WARNING] - |Q. 1||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,937][root][WARNING] - |Q. 1||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,938][root][INFO] - |Q. 1||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,938][root][WARNING] - |Q. 6||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,939][root][WARNING] - |Q. 6||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,939][root][INFO] - |Q. 6||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,939][root][WARNING] - |Q. 20||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,939][root][WARNING] - |Q. 20||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,939][root][INFO] - |Q. 20||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,940][root][WARNING] - |Q. 27||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,940][root][WARNING] - |Q. 27||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,940][root][INFO] - |Q. 27||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,940][root][WARNING] - |Q. 41||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,940][root][WARNING] - |Q. 41||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,940][root][INFO] - |Q. 41||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,941][root][WARNING] - |Q. 49||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,941][root][WARNING] - |Q. 49||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,941][root][INFO] - |Q. 49||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,941][root][WARNING] - |Q. 56||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,941][root][WARNING] - |Q. 56||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,941][root][INFO] - |Q. 56||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,942][root][WARNING] - |Q. 62||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,942][root][WARNING] - |Q. 62||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,942][root][INFO] - |Q. 62||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,942][root][WARNING] - |Q. 70||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,942][root][WARNING] - |Q. 70||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,942][root][INFO] - |Q. 70||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,943][root][WARNING] - |Q. 86||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,943][root][WARNING] - |Q. 86||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,943][root][INFO] - |Q. 86||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,943][root][WARNING] - |Q. 99||D: Constitutional_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,943][root][WARNING] - |Q. 99||D: Constitutional_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,943][root][INFO] - |Q. 99||D: Constitutional_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,944][root][WARNING] - |Q. 8||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,944][root][WARNING] - |Q. 8||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,944][root][INFO] - |Q. 8||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,944][root][WARNING] - |Q. 29||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,944][root][WARNING] - |Q. 29||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,945][root][INFO] - |Q. 29||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,945][root][WARNING] - |Q. 83||D: Criminal_law| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,945][root][WARNING] - |Q. 83||D: Criminal_law| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,946][root][INFO] - |Q. 83||D: Criminal_law| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,946][root][WARNING] - |Q. 7||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,946][root][WARNING] - |Q. 7||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,946][root][INFO] - |Q. 7||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,947][root][WARNING] - |Q. 24||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,947][root][WARNING] - |Q. 24||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,947][root][INFO] - |Q. 24||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,947][root][WARNING] - |Q. 28||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,947][root][WARNING] - |Q. 28||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,947][root][INFO] - |Q. 28||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,947][root][WARNING] - |Q. 34||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,948][root][WARNING] - |Q. 34||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,948][root][INFO] - |Q. 34||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,948][root][WARNING] - |Q. 48||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,948][root][WARNING] - |Q. 48||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,948][root][INFO] - |Q. 48||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,949][root][WARNING] - |Q. 87||D: Contracts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,949][root][WARNING] - |Q. 87||D: Contracts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,949][root][INFO] - |Q. 87||D: Contracts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,950][root][WARNING] - |Q. 4||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,950][root][WARNING] - |Q. 4||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,950][root][INFO] - |Q. 4||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,950][root][WARNING] - |Q. 16||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,950][root][WARNING] - |Q. 16||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,950][root][INFO] - |Q. 16||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,951][root][WARNING] - |Q. 23||D: Evidence| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,951][root][WARNING] - |Q. 23||D: Evidence| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,951][root][INFO] - |Q. 23||D: Evidence| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,952][root][WARNING] - |Q. 12||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,952][root][WARNING] - |Q. 12||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,953][root][INFO] - |Q. 12||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,953][root][WARNING] - |Q. 33||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,953][root][WARNING] - |Q. 33||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,953][root][INFO] - |Q. 33||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,954][root][WARNING] - |Q. 54||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,954][root][WARNING] - |Q. 54||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,954][root][INFO] - |Q. 54||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,954][root][WARNING] - |Q. 61||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,954][root][WARNING] - |Q. 61||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,954][root][INFO] - |Q. 61||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,954][root][WARNING] - |Q. 68||D: Civil_procedure| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,955][root][WARNING] - |Q. 68||D: Civil_procedure| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,955][root][INFO] - |Q. 68||D: Civil_procedure| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,955][root][WARNING] - |Q. 9||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,955][root][WARNING] - |Q. 9||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,955][root][INFO] - |Q. 9||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,956][root][WARNING] - |Q. 25||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,956][root][WARNING] - |Q. 25||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,956][root][INFO] - |Q. 25||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,956][root][WARNING] - |Q. 30||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,956][root][WARNING] - |Q. 30||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,957][root][INFO] - |Q. 30||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,957][root][WARNING] - |Q. 36||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,957][root][WARNING] - |Q. 36||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,957][root][INFO] - |Q. 36||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,957][root][WARNING] - |Q. 53||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,957][root][WARNING] - |Q. 53||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,957][root][INFO] - |Q. 53||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,958][root][WARNING] - |Q. 69||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,958][root][WARNING] - |Q. 69||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,958][root][INFO] - |Q. 69||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,958][root][WARNING] - |Q. 81||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,958][root][WARNING] - |Q. 81||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,959][root][INFO] - |Q. 81||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,959][root][WARNING] - |Q. 88||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,959][root][WARNING] - |Q. 88||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,959][root][INFO] - |Q. 88||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,959][root][WARNING] - |Q. 94||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,959][root][WARNING] - |Q. 94||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,959][root][INFO] - |Q. 94||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,960][root][WARNING] - |Q. 100||D: Property| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,960][root][WARNING] - |Q. 100||D: Property| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,960][root][INFO] - |Q. 100||D: Property| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,961][root][WARNING] - |Q. 32||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,961][root][WARNING] - |Q. 32||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,961][root][INFO] - |Q. 32||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,961][root][WARNING] - |Q. 45||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,961][root][WARNING] - |Q. 45||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,961][root][INFO] - |Q. 45||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,962][root][WARNING] - |Q. 79||D: Torts| has broken JSON output. Attempting to fix it.
[2025-03-06 17:51:38,962][root][WARNING] - |Q. 79||D: Torts| Failed to fix invalid JSON, extracting as many fields as possible.
[2025-03-06 17:51:38,962][root][INFO] - |Q. 79||D: Torts| was made valid into Valid json. Extracting responses.
[2025-03-06 17:51:38,964][root][INFO] - Saving parsed outputs to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,968][root][INFO] - Dumped the response to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/parsed_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,968][root][INFO] - Saved parsed outputs
[2025-03-06 17:51:38,968][root][INFO] - Saving parsing metadata to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,970][root][INFO] - Dumped the stats to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/parsing_metadata/raw_responses/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,970][root][INFO] - Saved parsing metadata
[2025-03-06 17:51:38,971][root][INFO] - Metrics will be saved to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,972][root][INFO] - Metrics calculated, saving backup to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
[2025-03-06 17:51:38,973][root][INFO] - Dumped the metrics to /pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/model_outputs/metrics/llama3/seed_989/all_domains_1_samples/untrained_full_model/temp_06/json_answer_first_zero_shot_structured/test_set_2.json
Metrics successfully appended to master CSV.
[2025-03-06 17:51:39,001][root][INFO] - Evaluation completed for json_answer_first_zero_shot_structured, on test_set_2
[2025-03-06 17:51:39,001][root][INFO] - Summary of metrics : {'label_accuracy': 0.43, 'misclassification_rate': 0.5700000000000001, 'combined_accuracy': 0.0, 'malformed_label': 3, 'malformed_domain': 100, 'total_predictions': 100, 'correct_predictions': 43, 'correct_label_and_domain': 0, 'Constitutional_Law_accuracy': 0.0, 'Contracts_accuracy': 0.0, 'Criminal_Law_accuracy': 0.0, 'Evidence_accuracy': 0.0, 'Real_Property_accuracy': 0.0, 'Torts_accuracy': 0.0, 'Civil_Procedure_accuracy': 0.0, 'Constitutional_Law_confidence': 0.0, 'Contracts_confidence': 0.0, 'Criminal_Law_confidence': 0.0, 'Evidence_confidence': 0.0, 'Real_Property_confidence': 0.0, 'Torts_confidence': 0.0, 'Civil_Procedure_confidence': 0.0, 'correct_domain_wrong_label': 0, 'correct_label_wrong_domain': 43, 'both_wrong': 57}
Starting update_eval_status.py
Received arguments: ['/pfs/work7/workspace/scratch/fr_rf1031-model_temp_storage/bar-llama/scripts/update_eval_status.py', '6', 'seeds=seed_989 model=llama3 tokenizer=llama3 dataset=all_domains_1_samples generation=temp_06 evaluation_dataset=test_set_2 eval=json_answer_first_zero_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=untrained', 'completed', '0']
Updating eval for job 6 to status completed with exit code 0
Eval status update completed for job 6
Job 6 completed at Thu Mar  6 17:51:40 CET 2025

============================= JOB FEEDBACK =============================

NodeName=uc2n508
Job ID: 25358381
Cluster: uc2
User/Group: fr_rf1031/fr_fr
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 10
CPU Utilized: 08:46:02
CPU Efficiency: 9.87% of 3-16:50:20 core-walltime
Job Wall-clock time: 08:53:02
Memory Utilized: 34.72 GB
Memory Efficiency: 96.45% of 36.00 GB
