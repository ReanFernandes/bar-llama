Running configuration: seeds=seed_21 dataset=all_domains_1_samples generation=greedy evaluation_dataset=test_set_1 eval=json_answer_first_few_shot_structured ++eval.quantisation_status=full_model ++eval.training_status=trained
[2025-01-12 16:06:47,116][root][INFO] - Setting global seed to 21
[2025-01-12 16:06:47,124][root][INFO] - Running evaluation of the trained model on the test_set_1
[2025-01-12 16:06:47,124][root][INFO] - Current evaluation config is : 
 Prompt type : few_shot 
 Response type : answer_first 
 Explanation type : structured 
 Response Format : json 
[2025-01-12 16:06:47,125][root][INFO] - Loading dataset from /work/dlclarge1/fernandr-thesis_workspace/bar-llama/dataset/test_sets/bar_set_1.json
[2025-01-12 16:06:47,127][root][INFO] - Dataset loaded successfully, indexing questions...
[2025-01-12 16:06:47,131][root][INFO] - Indexing complete, sampling of questions set to False
[2025-01-12 16:06:47,131][root][INFO] - Questions selected, dataset contains 99 questions with 14.142857142857142 questions per domain
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: write).
Your token has been saved to /home/fernandr/.cache/huggingface/token
Login successful
[2025-01-12 16:06:47,350][root][INFO] - Loading model : meta-llama/Llama-2-7b-hf
[2025-01-12 16:06:47,594][root][INFO] - Full model selected, loading model
[2025-01-12 16:07:10,887][root][INFO] - Tokenizer special tokens: {'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<unk>', 'pad_token': '[PAD]'} have been added
[2025-01-12 16:07:13,210][root][INFO] - Fine-tuned model selected, loading adapter
[2025-01-12 16:07:13,211][root][WARNING] - Inference will be done using model.generate instead of hf pipeline since peft model is not compatible with it
[2025-01-12 16:07:47,670][root][INFO] - Peft model loaded successfully
[2025-01-12 16:07:56,623][root][INFO] - Prompt Handler initialized with configuration: {'prompt_type': 'few_shot', 'example_path': '${hydra:runtime.cwd}/prompt/examples/structured_example.json', 'explanation_type': 'structured', 'response_type': 'answer_first', 'response_format': 'json', 'store_prompt': False, 'include_system_prompt': True, 'system_prompt': '${hydra:runtime.cwd}/prompt/system_prompt/system_${eval.prompt.response_format}_${eval.prompt.response_type}_${eval.prompt.explanation_type}.txt'}
[2025-01-12 16:07:56,639][root][INFO] - Raw output for this run will be saved to /work/dlclarge1/fernandr-thesis_workspace/bar-llama/model_outputs/raw_responses/seed_21/all_domains_1_samples/trained_full_model/greedy/json_answer_first_few_shot_structured/test_set_1.json
[2025-01-12 16:07:56,640][root][INFO] - Starting inference
[2025-01-12 16:07:56,922][root][INFO] - Processing question number 0
[2025-01-12 16:07:56,924][root][INFO] - Domain : Civil_procedure, Question : 1
[2025-01-12 16:08:26,175][root][INFO] - Domain : Civil_procedure, Question : 7
